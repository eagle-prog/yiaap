<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8">

<meta http-equiv="X-UA-Compatible" content="IE=9" />
<link rel="shortcut icon" type="image/x-icon" href="/mail/favicon.ico">

<script type="text/JavaScript" src="js/jquery-1.8.0.min.js"></script>
<script type="text/javascript" src="js/ckeditor/ckeditor.js"></script>

<!--[if lt IE 9]>
<link rel="stylesheet" href="ie.css" type="text/css" media="screen" />

<![endif]-->
<script type="text/JavaScript">

var insKey=0;			
$(document).ready(function(){
 $(document).keydown(function(e)
 {
 
     if (e.keyCode == 45) insKey = 1;
 }).keyup(function(e)
 {
     if (e.keyCode == 45) insKey = 0;
 });
$(".fromDate").click(function(){
$(this).toggleClass("active");
});
var headrwidth="";
headrwidth=$("body").width();
$(".header").css("width",headrwidth+"px");

$("a").click(function(){
headrwidth=$("body").width();
$(".header").css("width",headrwidth+"px");
});

$(window).resize(function(){
headrwidth=$("body").width();
$(".header").css("width",headrwidth+"px");
});
}); 

//jQuery("time.timeago").timeago();
</script>
 
<script type="text/JavaScript">
$(document).ready(function(e) {
							
		 
							
							var totalheight = $(window).outerHeight(); // left menu height setting
							var leftm_height = totalheight -116; // left menu height setting
							
							//var leftm_heights = totalheight -66; // left menu height setting
							// contact list height
							
						// Adjusting height of Msg divs
						
						var hedr1h = $('.header').outerHeight(true);
						var hedr2h = $('.second_headr').outerHeight(true);
						 var folderHeight = $('.folderHfirst').outerHeight(true);
						var totalheadr = hedr1h + hedr2h + folderHeight;

						  
						 var msg_list_height= totalheight-150;
						 $('.splitmsg_list').css({"height": msg_list_height});	
						 
						 $('.splitiuterdiv').css({"min-height": msg_list_height});	
		 
							
							$('.vertmenu').css({"height": leftm_height}); // left menu height setting




					 



	
	
    $('.user_picnd_arw').click(function(e) {
        $('.search_options').slideUp(200);
		$('.user_details_drpdwn').slideToggle(200);
    });
	$('.user_picnd_arw, .user_details_drpdwn').click(function(event){
	event.stopPropagation();
	});
	$(document).click(function(e) {
        $('.user_details_drpdwn').slideUp(200);
    });
	
	//advnce search
	
	$('.searchBtn').click(function(e) {
        $('.user_details_drpdwn').slideUp(200);
		$('.search_options').slideToggle(200);
		
    });
	$('.searchBtn, .search_options').click(function(event){
	event.stopPropagation();
	});
	$('#cancelsrchbtn').click(function (e) {
		$('.search_options').slideUp(200);
	});
	$(document).click(function(e) {
        $('.search_options').slideUp(200);
    });
	
	// chat box position set


//header hideee

	$(window).resize(function(){
							
							var totalheight = $(window).outerHeight(); // left menu height setting
							
						

							var leftm_height = totalheight -116; // left menu height setting
							
							
							//var leftm_heights = totalheight -66; // left menu height setting
							$('.vertmenu').css({"height": leftm_height}); // left menu height setting
								 
							//var msg_list_height=totalheight -116;
							//$('#msg_list').css({"min-height": msg_list_height});
							
						var hedr1h = $('.header').outerHeight(true);
						var hedr2h = $('.second_headr').outerHeight(true);
						  var folderHeight = $('.folderHfirst').outerHeight(true);
						var totalheadr = hedr1h + hedr2h + folderHeight;
						  
						
						 var msg_list_height= totalheight-150;
						 $('.splitmsg_list').css({"height": msg_list_height});	
							 $('.splitiuterdiv').css({"min-height": msg_list_height});	
							
							
							}); // window resize
	
	
	
	
	
	$('.secondscroll').scroll(function(e) {
	
  
});
	
	
}); // document redy ends



</script>
<title>{$username} - {$servicename}</title>
<style type="text/css">
.nicEdit-main {
	padding: 8px !important;
	font: small arial;
}
{$header_theme}

</style>
<!--[if IE 7]>
<style type="text/css">
    .nicedit_textarea_new{background-color:#FFF;height:500px; width:1096px !important;}
</style>
<![endif]-->
<!--[if IE 8]>
<style type="text/css">
     .nicedit_textarea_new{background-color:#FFF;height:500px; width:1096px !important;}
</style>
<![endif]-->
<link rel="stylesheet" href="style.css" type="text/css" media="screen" />
<!-- <link href="js/toastr/toastr.min.css" rel="stylesheet"/> -->
<link rel="stylesheet" href="css/font-awesome.min.css" type="text/css" media="screen" />
<!-- <script src="js/toastr/toastr.min.js"></script> -->
<script type="text/javascript" src="js/jquery-1.3.2.min.js.php"></script>
<script type="text/javascript">
//toastr.options={ "positionClass": "toast-top-center"};
function SetCookie(nameC,value,days)
{
if (days) {
      var date = new Date();
      date.setTime(date.getTime()+(days*24*60*60*1000));
      var expires = "; expires="+date.toGMTString();
  }
  else var expires = "";
  document.cookie = nameC+"="+value+expires+"; path=/";

}

function getCookievalue(c_name1)
{
if (document.cookie.length>0)
{
c_start1=document.cookie.indexOf(c_name1 + "=");
if (c_start1!=-1)
  {
  c_start1=c_start1 + c_name1.length+1;
  c_end1=document.cookie.indexOf(";",c_start1);
  if (c_end1==-1) c_end1=document.cookie.length;
  return unescape(document.cookie.substring(c_start1,c_end1));
  }
}
return "";
}
var last_send_object="";//stores the reference to last send setinterval to clear later
var last_send_timer="";//Last send delay timer.
var mail_sending_delay="{$mail_sending_delay}";
var recipients_per_message_limits="{$recipients_per_message_limits}";
var right_ads_status="{$rightadtype}";
var sessTimeOut=180;
var chat_enable ="{$chat_enable}";
var contact_name_change=0;// whether conatct name is changed or not
var new_contact_add=0;//whether new contact is added
var new_contact_gp_add=0;//whether new contact group is added
var contact_moreaction=1;
var c_cpcount="{$gpcount}";
var m_cpcount="{$mpcount}";
var conatct_drop_down=new Array(c_cpcount);
var q=0;
var reply_mail_id="";
var mycontactNo="{$mycontact_total}";
SetCookie("mycontacts",mycontactNo,1);
var globalcontactNo="{$g_contact}";
SetCookie("globalcontacts",globalcontactNo,1);
{loopstart:groups:1000}
conatct_drop_down[q]=new Array(2);
conatct_drop_down[q][0]="{$groups[0]}";
conatct_drop_down[q][1]="{$groups[1]}";
conatct_drop_down[q][2]="{$groups[2]}";
SetCookie("cont_"+conatct_drop_down[q][0],conatct_drop_down[q][2],1);
q++;
{loopend:groups}
var contactidString="";

var new_flag=0;
var nicEditor1;
var totl=0;
var idString=":";
var idz="";
var idStringChat=":";
var idzChat="";
var drafTcount=0;
var pair="";var pair1="";
var click=1;
var filevar_count=0;
var smileypath="{$path}";
var filevar=0;
var moveflag=0;
var moreflag=0;
var folderCreated=0;
var totalInbox="{$totalInbox}";
var totalDraft="{$totalDraft}";
var totalSent="{$totalSent}";
var totalSpam="{$totalSpam}";
var totalStarred="{$totalStarred}";
var totalTrash="{$totalTrash}";
var detail=0;
var global_draftcount=0;
var xxx=1;
var latestInboxid="{$latest}";
var mailsPerpage="{$sizeMail}";
var backref_string="";

var signature="";     
var totalchat="{$totalchat}";
SetCookie("chats",totalchat,1);
var moreflagchat=0;
var mail_open=0;
var portal_status="{$portal_status}";
var addressbook="{$addressbook}";
var chat_refresh_flag=0;
var Unread=new Array(20);
var customUnread1=new Array(3);

//Ckeditor Configurations
CKEDITOR.config.allowedContent = true;

///

for(var customFoldercount=0;customFoldercount<6;customFoldercount++)
{
  if(customFoldercount==0)
  {
      var customUnread1=new Array(3);
      customUnread1[0]='inbox';
      customUnread1[1]='{$inboxUnread}';
      customUnread1[2]=0;
      Unread[customFoldercount]=customUnread1;
  }
  else if(customFoldercount==1)
  {
      var customUnread1=new Array(3);
      customUnread1[0]='draft';
      customUnread1[1]='{$totalDraft}';
      customUnread1[2]=0;
      Unread[customFoldercount]=customUnread1;
  }
  else if(customFoldercount==2)
  {
      var customUnread1=new Array(3);
      customUnread1[0]='sent';
      customUnread1[1]='';
      customUnread1[2]=0;
      Unread[customFoldercount]=customUnread1;
  }
  else if(customFoldercount==3)
  {
      var customUnread1=new Array(3);
      customUnread1[0]='spam';
      customUnread1[1]='{$spamUnread}';
      customUnread1[2]=0;
      Unread[customFoldercount]=customUnread1;
  }
  else if(customFoldercount==4)
  {
      var customUnread1=new Array(3);
      customUnread1[0]='trash';
      customUnread1[1]='';
      customUnread1[2]=0;
      Unread[customFoldercount]=customUnread1;
  }
  else if(customFoldercount==5)
  {
      var customUnread1=new Array(3);
      customUnread1[0]='starred';
      customUnread1[1]='';
      customUnread1[2]=0;
      Unread[customFoldercount]=customUnread1;
  }
  
}

{loopstart:customfolders:1000}
{
  if('{$customfolders[0]}'>=10)
     {
             var customUnread1=new Array(3);
             customUnread1[0]='custom{$customfolders[0]}';
             customUnread1[1]='{$customfolders[3]}';
customUnread1[2]=0;
             if(customUnread1[1]=="")
             customUnread1[1]=0;
             Unread[customFoldercount]=customUnread1;
             customFoldercount=parseInt(customFoldercount)+parseInt(1);
     }
  
}
{loopend:customfolders}

function getmails_per_page()
{
return mailsPerpage;
}
var keyStr = "ABCDEFGHIJKLMNOP" +
             "QRSTUVWXYZabcdef" +
             "ghijklmnopqrstuv" +
             "wxyz0123456789+/" +
             "_>\.\*" +
             "=";
function encode64(input) {
   input = escape(input);
   var output = "";
   var chr1, chr2, chr3 = "";
   var enc1, enc2, enc3, enc4 = "";
   var i = 0;

   do {
      chr1 = input.charCodeAt(i++);
      chr2 = input.charCodeAt(i++);
      chr3 = input.charCodeAt(i++);

      enc1 = chr1 >> 2;
      enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);
      enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);
      enc4 = chr3 & 63;

      if (isNaN(chr2)) {
         enc3 = enc4 = 64;
      } else if (isNaN(chr3)) {
         enc4 = 64;
      }

      output = output +
         keyStr.charAt(enc1) +
         keyStr.charAt(enc2) +
         keyStr.charAt(enc3) +
         keyStr.charAt(enc4);
      chr1 = chr2 = chr3 = "";
      enc1 = enc2 = enc3 = enc4 = "";
   } while (i < input.length);

   return output;
}

 function decode64(input) {
   var output = "";
   var chr1, chr2, chr3 = "";
   var enc1, enc2, enc3, enc4 = "";
   var i = 0;

   // remove all characters that are not A-Z, a-z, 0-9, +, /, or =
   var base64test = /[^A-Za-z0-9\+>\/\=_>\.\*]/g;
   if (base64test.exec(input)) {
      alert("There were invalid base64 characters in the input text.\n" +
            "Valid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\n" +
            "Expect errors in decoding.");
   }
   input = input.replace(/[^A-Za-z0-9\+>\/\=_>\.\*]/g, "");

   do {
      enc1 = keyStr.indexOf(input.charAt(i++));enc2 = keyStr.indexOf(input.charAt(i++));enc3 = keyStr.indexOf(input.charAt(i++));
      enc4 = keyStr.indexOf(input.charAt(i++));
      chr1 = (enc1 << 2) | (enc2 >> 4);
      chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);
      chr3 = ((enc3 & 3) << 6) | enc4;

      output = output + String.fromCharCode(chr1);

      if (enc3 != 64) {
         output = output + String.fromCharCode(chr2);
      }
      if (enc4 != 64) {
         output = output + String.fromCharCode(chr3);
      }

      chr1 = chr2 = chr3 = "";
      enc1 = enc2 = enc3 = enc4 = "";

   } while (i < input.length);

   return unescape(output);
}


              
 function decode64chat(input) {
    var output = "";
    var chr1, chr2, chr3 = "";
    var enc1, enc2, enc3, enc4 = "";
    var i = 0;

    // remove all characters that are not A-Z, a-z, 0-9, +, /, or =
    var base64test = /[^A-Za-z0-9\+\/\=]/g;
    if (base64test.exec(input)) {
       alert("There were invalid base64 characters in the input text.");
    }
    input = input.replace(/[^A-Za-z0-9\+\/\=]/g, "");

    do {
       enc1 = keyStr.indexOf(input.charAt(i++));
       enc2 = keyStr.indexOf(input.charAt(i++));
       enc3 = keyStr.indexOf(input.charAt(i++));
       enc4 = keyStr.indexOf(input.charAt(i++));

       chr1 = (enc1 << 2) | (enc2 >> 4);
       chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);
       chr3 = ((enc3 & 3) << 6) | enc4;

       output = output + String.fromCharCode(chr1);

       if (enc3 != 64) {
          output = output + String.fromCharCode(chr2);
       }
       if (enc4 != 64) {
          output = output + String.fromCharCode(chr3);
       }

       chr1 = chr2 = chr3 = "";
       enc1 = enc2 = enc3 = enc4 = "";

    } while (i < input.length);

    return output;
 }


</script>
<script type="text/javascript" language="javascript">
//Updates the mail sending timer
function update_send_timer(){

if(last_send_timer<mail_sending_delay)
{
last_send_timer=parseInt(last_send_timer)+parseInt(1);
}
else
{
 if(last_send_timer==mail_sending_delay){last_send_timer=0;clearInterval(last_send_object);}
}
}
//Clears the mail sending timer
function clear_send_timer(){
last_send_timer=0;
clearInterval(last_send_object);
}


function clickHandler(e){
           var o=document.getElementById('sessTimer');
           o.value="0";
              var ppq=document.getElementById("ajaxupdation").value;
              document.getElementById("ajaxupdation").value=0;
              if(ppq==1)
              abc();

     }
         
          function generateTimer(){
              var o=document.getElementById('sessTimer');
              o.value=parseInt(o.value)+1;
              if(o.value>=sessTimeOut){
                    clearInterval(timer);
                   document.getElementById("ajaxupdation").value=1;
              }
        }
var userid3="{$userid}";

function showPreloadDiv()
{
document.getElementById('preloaddiv').style.display="";
          document.getElementById('preloadimage').style.display="none";
}
function checkcookie(c_name)
{


if (document.cookie.length>0)
{
c_start=document.cookie.indexOf(c_name + "=");
if (c_start!=-1)
  {
  c_start=c_start + c_name.length+1;
  c_end=document.cookie.indexOf(";",c_start);

  if (c_end==-1) c_end=document.cookie.length;
if( unescape(document.cookie.substring(c_start,c_end))>1)
{
return 1;


}
else
return 0;
  }
}

}
function chatfun(){

//alert("ssss");
          var w=screen.width;
    var h=screen.height;var chatcnt=0;
    
    if(w>=1152 && h>=768)
    chatcnt=5;
    else if(w>=1024 && h>=768)
    chatcnt=4;
    else if(w<1024 && h<768)
    chatcnt=3;
    
      var currentTime = new Date();
var crttime = currentTime.getTime(); 

var now= new Date();
$.ajax({

type: "POST",cache: false,
url: "{url:(chat/getdetails)}",
data: "arr="+arr+"&crttime="+crttime+"&chatcnt="+chatcnt+"&userid="+{$userid},
success: function(data) {//alert(data);

if(data!="(*&q#)(*&q#)(*&q#)(*&q#)" && data!="")
{

          var msg="";var divid="";var title="";
          var text1=data;
         
          var openids=new Array(); 
          var value=new Array(); value[1]="";value[2]="";
          openids=arr.split(",");
          var openidscount=openids.length-1;
        
        
        var closedids="";var closedidscount=0;
        value=text1.split("(*&q#)");

        if(value.length>1)
        {
        if(value[1]!="")
        {
              closedids=value[1].split(",");
              
              closedidscount=closedids.length;
         }
         else
               closedidscount=0;
          
        }
  var newarr = arr.substring(0, arr.length-1);

           if(value[3]!="")
           {//alert(value[3]);
              var typestatussetup=value[3].split("$*&*$");var typestatusmsg="";
              opids1=newarr.split(",");
              opidscnt1=opids1.length;
              for(var k=0;k<opidscnt1;k++)
                  {
                  if(opids1[k]==typestatussetup[0])
                    {
                      var id00="typestatus_"+typestatussetup[0];
                      if(document.getElementById("typestatus_"+typestatussetup[0]))
                      {
                     if(typestatussetup[1]!="" || typestatussetup[1]=="CLEAR")
                     {
                        document.getElementById("typestatus_"+typestatussetup[0]).style.display="";
                        if(typestatussetup[1]=="CLEAR")
                      document.getElementById("typestatus_"+typestatussetup[0]).innerHTML="";
                      else
                      document.getElementById("typestatus_"+typestatussetup[0]).innerHTML=typestatussetup[1];
                      }
                      else
                       document.getElementById("typestatus_"+typestatussetup[0]).style.display="none";
                       }
                    }
                }
         }
         var strcount=0;
         str=value[0].split("@{~}@");
         
         if(str[1]=="")
         strcount=str.length-1;
         if(str[0]=="")
         strcount=0;
        
         var divid="";var lastuser="";
        for(var i=0;i<strcount;i++)
        {
          var retvalue=str[i].split("(&!~&)");
          divid=retvalue[0];
          divid=divid.replace(/^[\s]+/,'').replace(/[\s]+$/,'').replace(/[\s]{2,}/,' ');//for trimming 
          gpstatus=retvalue[3];
          message=retvalue[4];
          lastuser=retvalue[5];
          
          if(gparr!="")
          {
          var newgparr=new Array(); var existvalue=0;
          newgparr=gparr.substring(0,gparr.length-1);
          newgparr=newgparr.split(",");
          gpcnt=newgparr.length;
         for(var j=0;j<gpcnt;j++)
         {
         if(divid==newgparr[j])
          {
              existvalue=1;break;
          }
          else
          existvalue=0;
         }
         if(existvalue==0)
         gparr+=divid+",";
        }
        else if(gpstatus==1)
              gparr+=divid+",";
         
         
         userid=retvalue[1];title=retvalue[2];
     
       if(title!="")
       {
           if(gpstatus==1)
           document.getElementById("titlesetup").value=">{cfn:getmessage(396)}";
           else
           document.getElementById("titlesetup").value=title;
           lostFocus();
       }
         for(var j=0;j<openidscount;j++)
         {
           if(openids[j]==divid)
               {
                      document.getElementById("lastuser"+divid).value=lastuser; 

                      document.getElementById("chatboxhead"+divid).className="chatboxalert";
                       var id2="headername_"+divid;
                       var s=document.getElementById("headername_"+divid).innerHTML;
                       if(s!=title)
                       {
                          document.getElementById("headername_"+divid).innerHTML=title;
                       }
                      var t1="{$sounds}";
                      if(t1==1)
                      playSound();
                      var id1="chatboxmessage_"+divid;
                      var prevmessage=document.getElementById(id1).innerHTML;
                      message=prevmessage+message;
                      document.getElementById("chatboxmessage_"+divid).innerHTML=message;
                      document.getElementById("typestatus_"+divid).style.display="none";
                      var id123="chattextarea"+divid;
                      document.getElementById("chattextarea"+divid).focus();
                      document.getElementById("chattextarea"+divid).className="chatboxtextareaselected";
                      document.getElementById(id1).scrollTop=document.getElementById(id1).scrollHeight
               }
          }
              for(var k=0;k<closedidscount;k++)
                  { 
                      if(closedids[k]==divid)
                      {
                  
                          arr+=divid+",";userarr+=userid+",";
                          
                          filestring3="";
                          var di="close"+divid;
                          var pos=""; 
                          if(arr=="")
                          pos=0;
                          else
                          {
                            var newarr1=arr.substring(0,arr.length-1);
                            var recentids1=newarr1.split(",");
                            pos=recentids1.length-1;
                          }
                          filestring3+="<input type=\"hidden\" value=\"0\" id=\"divhide"+divid+"\">";  
                          filestring3+="<div id=\"chatboxhead"+divid+"\" class=\"chatboxalert\">";
                          if((pos%2)==0)
                          filestring3+="<div class=\"chatTheme\" id=\"chatTheme"+divid+"\"></div>";
                          else
                          filestring3+="<div class=\"chatTheme2\" id=\"chatTheme"+divid+"\"></div>";
                          filestring3+="<a href=\"javascript:void(0)\" class=\"aclass\" onclick=\"javascript:toggleChatBoxGrowth('"+divid+"','"+userid+"')\">";
                          filestring3+="<div class=\"chatboxtitle\" id=\"headername_"+divid+"\">"+title+"</div>";
                          filestring3+="</a>";
                          filestring3+="<div class=\"chatboxoptions\" style=\"padding:2px;\">";
                          filestring3+="<a href=\"javascript:void(0)\" id=\"minimize_"+divid+"\" title=\"{cfn:getmessage(439)}\" onclick=\"javascript:toggleChatBoxGrowth('"+divid+"','"+userid+"')\">";
                          filestring3+="<i class='fa fa-minus fachatbox'></i>";
                          filestring3+="</a>";
                          filestring3+=" <a href=\"javascript:void(0)\" onclick=\"javascript:closeChatBox('"+divid+"','"+userid+"')\" title=\"Close\">";
                          filestring3+="<i class='fa fa-times fachatbox'></i>";
                          filestring3+="</a>";
                          filestring3+="</div>";
                          filestring3+="<br clear=\"all\"/>";
                          filestring3+="</div>";
                          filestring3+="<div id=\"chatminimize"+divid+"\" style=\"display:\" class=\"minimzeclaas\" onclick=\"javascript:ss123('"+divid+"')\" >";
                          filestring3+="<div class=\"chatboxcontent1\" id=\"chatcontent"+divid+"\" >";
                          filestring3+="<div  id=\"chatrequest_"+divid+"\">";
                          filestring3+="<a href=\"#\" class=\"invitechat\" onclick=\"javascript:invitechat('"+divid+"')\">{cfn:getmessage(395)}</a>";
                          filestring3+="</div>";
                          filestring3+="<div id=\"chataccept_"+divid+"\" style=\"display:none;\">{cfn:getmessage(395)}<br><input type=\"text\"  autocomplete=\"off\" name=\"chatuser"+divid+"\" id=\"chatuser"+divid+"\" value=\"\" size=\"22\" class=\"invitechattextbox\" onKeyUp=\"javascript:keymovement_ch(event,this.value,'"+divid+"','"+userid+"');\"  ><div style=\"clear:both\"></div>";
                          filestring3+="<div id=\"livesearch_ch_"+divid+"\"   class=\"livesearchchat\" style=\"display:none; border: 0px;  background-color: white;float:left;\"></div><div style=\"clear:both\"></div>";
                          filestring3+="<span style=\"padding-left:2px;\">";
                          filestring3+="<a href=\"#\" onclick=\"javascript:invitetochatfn('"+divid+"','"+userid+"')\" class=\"invitechat\">{cfn:getmessage(372)}</a>";
                          filestring3+="</span>";
                          filestring3+="<span style=\"padding-left:10px;\">";
                          filestring3+="<a href=\"#\" class=\"invitechat\" onclick=\"javascript:cancelinvitechat('"+divid+"')\">{cfn:getmessage(267)}</a>";
                          filestring3+="</span>";
                          filestring3+="</div>";
                          filestring3+="</div>";
                          filestring3+="<div id=\"chatboxmessage_"+divid+"\" class=\"chatboxcontent\">"+message+"</div>";
                          filestring3+="<div class=\"chatboxinput\" ><div class=\"typestatus\" id=\"typestatus_"+divid+"\" style=\"display:none\">&nbsp;&nbsp;&nbsp;</div><div class=\"statusmsg\" id=\"statusmsg_"+divid+"\" style=\"display:none\">&nbsp;&nbsp;&nbsp;</div><div id=\"smileys_"+divid+"\" style=\"z-index:3;position:absolute;margin-bottom:365px;margin-left:88px;background-color:gray;\"></div>";
                          var sml="{$smileys}";
                          if(sml==1)
                          filestring3+="<div style=\"z-index:1;position:absolute;margin-bottom:0px;margin-left:194px;margin-top:23px;\"><a href=\"javascript:getsmiley("+divid+")\"><img src='images/filler.gif' class='iconsCornner chat-sml' border='0' ></a></div>";
                          filestring3+="<textarea class=\"chatboxtextarea\" id=\"chattextarea"+divid+"\" onclick=\"javascript:clickyfn('"+divid+"')\" onblur=\"javascript:blurfnchat('"+divid+"')\" onkeydown=\"javascript:return checkChatBoxInputKey(event,'"+divid+"');\" onkeypress=\"javascript:return checkChatBoxInputKey1(event,'"+divid+"',this.value);\" onkeyup=\"javascript:return checkChatBoxInputKey2(event,'"+divid+"',this.value);\" wrap=\"hard\" cols=\"27\" rows=\"2\"></textarea></div>";
                          // modify filestring3+="<textarea class=\"chatboxtextarea\" id=\"chattextarea"+divid+"\" onclick=\"javascript:clickyfn('"+divid+"')\" onblur=\"javascript:blurfnchat('"+divid+"')\" onkeydown=\"javascript:return checkChatBoxInputKey(event,'"+divid+"');\"  wrap=\"hard\" cols=\"27\" rows=\"2\"></textarea></div>";
                          filestring3+="</div>";
                          filestring3+="<input type=\"hidden\" id=\"smileyvalue_"+divid+"\" value=\"0\"><input type=\"hidden\" id=\"search_ch_"+divid+"\" value=\"\"><input id=\"chat_id_"+divid+"\" type=\"hidden\" value=\"\"><input id=\"lastuser"+divid+"\" type=\"hidden\" value=\"\">";//value=\""+lastuser+"\"
                          creatediv(pos,di,filestring3,200,200,10,10);
                          document.getElementById("chattextarea"+divid).focus();
                          document.getElementById("chattextarea"+divid).className="chatboxtextareaselected";
                          document.getElementById(di).className="newchatwindow";
                          var newholddiv = document.createElement('div'); 
                          var new_div_string="<div class=\"holdingDiv\" id=\"holdingDiv_"+divid +"\"></div>";		
                          newholddiv.innerHTML = new_div_string;
                          document.getElementById(di).appendChild(newholddiv);	
                          document.getElementById("chatboxmessage_"+divid).scrollTop=document.getElementById("chatboxmessage_"+divid).scrollHeight
                          var t1="{$sounds}";//alert(t1);
                          if(t1==1)
                          playSound();
                          var w=screen.width;
                          var h=screen.height;var chatcnt=0;
                          if(w>=1152 && h>=768)
                          chatcnt=5;
                          else if(w>=1024 && h>=768)
                          chatcnt=4;
                          else if(w<=800 && h<=600)
                          chatcnt=3;
                          var newarr="";var q="";var arrcount=0;
                          if(arr!="")
                          {
                          newarr=arr.substring(0,arr.length-1);
                          q=newarr.split(",");
                          }
                          arrcount=q.length;
                          if(arrcount>chatcnt && value[4]!="")
                          {
                          newarr+=",";
                          if(value[4]!="")
                              {
                                  var recentids=value[4].split(",");
                                  var s=newarr;
                                  for(var i=0;i<recentids.length;i++)
                                   {
                                      var t=recentids[i]+",";
                                      s=s.replace(t,"");
                                    } 
                  
                                  var u=s.split(",");
             
                                  for(var j=0;j<u.length-1;j++)
                                  {
                                  var closeid=u[j];
                                  var abc=arr;
                                  var id19="chatminimize"+closeid;var id29="chatboxhead"+closeid;
                                  var id39=closeid+",";
                                  arr=arr.replace(id39,"");
                                  gparr=gparr.replace(id39,"");
                                  var qwert=rearrange(closeid,abc,arr);
                                  }
     
                              }
                          }
       
                      if(arrcount>chatcnt && value[5]!="")
                           {
                               newarr+=",";
                              if(value[5]!="")
                              {
                                  var recentids=value[5].split(",");
                                  var s=newarr;
                                  for(var i=0;i<recentids.length;i++)
                                       {
                                           var t=recentids[i]+",";
                                          s=s.replace(t,"");
                                       } 
                                  var u=s.split(",");
                                  for(var j=0;j<u.length-1;j++)
                                  {
                                  userarr=userarr.replace(u[j],"");
                                  }
                              }
                          }
              }
          }
          
          
          
         
        }
    }

chatfun();
}

});

}
function returnuserarr()
          {
          return userarr;
          }
          function returnarr()
          {
          return arr;
          }
function abc(){
              
              
              
              
              if (document.addEventListener){
                    document.addEventListener("mouseover", clickHandler, true);
                    document.addEventListener("mouseout", clickHandler, true);
                    document.addEventListener("keypress", clickHandler, true);
                    document.addEventListener("click", clickHandler, true);
                    document.addEventListener("focus", clickHandler, true);
                    
              }else if(document.attachEvent){
                    document.attachEvent("onmouseover", clickHandler);
                    document.attachEvent("onmouseout", clickHandler);
                    document.attachEvent("onclick", clickHandler);
                    document.attachEvent("onkeypress", clickHandler);
                    document.attachEvent("onFocus", clickHandler);
              }
              timer=setInterval("generateTimer()",1000);//1000
        }
function chatrefreshfn(){document.getElementById("titlesetup").value="";var a=(new Date).getTime();$.ajax({type:"GET",cache:!1,url:"{url:(chat/chatrefresh/)}"+a,success:function(){}})};
var fnPtr = null;
function getMouseXY1(e) {
if (IE) { // grab the x-y pos.s if browser is IE
 tempX = event.clientX + document.body.scrollLeft
 tempY = event.clientY + document.body.scrollTop
} else {  // grab the x-y pos.s if browser is NS
 tempX = e.pageX
 tempY = e.pageY
}  
// catch possible negative values in NS4
if (tempX < 0){tempX = 0}
if (tempY < 0){tempY = 0}  
// show the position values in the form named Show
// in the text fields named MouseX and MouseY

//document.Show.MouseY.value = tempY
return true
}
var IE = document.all?true:false

// If NS -- that is, !IE -- then set up for mouse capture
if (!IE) document.captureEvents(Event.MOUSEMOVE)

// Set-up to use getMouseXY function onMouseMove
document.onmousemove = getMouseXY1;

// Temporary variables to hold mouse x-y pos.s
var tempX = 0
var tempY = 0
var msg434="{cfn:getmessage(434)}";
var msg435="{cfn:getmessage(435)}";
var msg461="{cfn:getmessage(461)}";
var msg455="{cfn:getmessage(455)}";
var img1=document.createElement("IMG");img1.src='images/smilyeset.jpg';var img2=document.createElement("IMG");img2.src="images/usedIcons.png";var img3=document.createElement("IMG");img3.src="images/filler.gif";
          function preloadfun()
          {
          chatfun();
          //setInterval("chatfun()",10000);
          chatrefreshfn();
          abc();
          }
          var arr="";var arr123="";var userarr="";var gparr="";
                  
function display()
{
if({$chat_enable}==1)
{
var pp=gethideoptvalue();
if(pp==1)
{
sethideoptvalue(0);
hideoptdiv();
}
else
sethideoptvalue(1);
if(document.getElementById("option_bar").style.display=="")
document.getElementById("option_bar").style.display="none";
if({$override_themes}==1)
{
if(document.getElementById("themeDiv").style.display=="")
document.getElementById("themeDiv").style.display="none";
}
if(document.getElementById("livesearch_invite").style.display=="")
{
document.getElementById("livesearch_invite").style.display="none";
document.getElementById("receiver_invite").value="{cfn:getmessage(462)}";
}

if(document.getElementById("livesearch_invite").style.display=="")
{
document.getElementById("livesearch_invite").style.display="none";
document.getElementById("receiver_invite").value="{cfn:getmessage(462)}";
}

}


document.getElementById("moreList2").style.display="none";

if(document.getElementById("contact_more_div").style.display=="")
document.getElementById("contact_more_div").style.display="none";

document.getElementById('livesearch_0_0').style.display="none";
document.getElementById('livesearch_0_0').style.display="none";
document.getElementById('livesearch_0_0').style.border="0px";
           document.getElementById('livesearch_0_0').style.padding="0px";
          
           document.getElementById('livesearchcc_0_0').style.display="none";
document.getElementById('livesearchcc_0_0').style.border="0px";
           document.getElementById('livesearchcc_0_0').style.padding="0px";
          
           document.getElementById('livesearchbcc_0_0').style.display="none";
document.getElementById('livesearchbcc_0_0').style.border="0px";
           document.getElementById('livesearchbcc_0_0').style.padding="0px";
          
          
          var mail_ids=new Array();
          mail_ids=reply_mail_id.split(",");
          if(mail_ids!="")
          {
              for(var t=0;t<mail_ids.length;t++)
              {
                  if(document.getElementById('livesearch_'+mail_ids[t]))
                     {
                          if(document.getElementById('livesearch_'+mail_ids[t]).style.display=="")
                          document.getElementById('livesearch_'+mail_ids[t]).style.display="none";
                          
                     }
                  if(document.getElementById('livesearchcc_'+mail_ids[t]))
                     {
                          if(document.getElementById('livesearchcc_'+mail_ids[t]).style.display=="")
                          document.getElementById('livesearchcc_'+mail_ids[t]).style.display="none";
                          
                     }
                     if(document.getElementById('livesearchbcc_'+mail_ids[t]))
                     {
                          if(document.getElementById('livesearchbcc_'+mail_ids[t]).style.display=="")
                          document.getElementById('livesearchbcc_'+mail_ids[t]).style.display="none";
                          
                     }
                  
              
              }
          }
}	
function gotFocus(){
	document.title="{$username} - {$servicename}";state="focus";played=0};
function changeColorRed(){document.getElementById("ss").style.background="#FF8A00"};
var state="";var played;
function lostFocus(){
var a=document.getElementById("titlesetup").value;
if(a!=""&&(a+="#",string=str2=a.match(RegExp("(>)(.+?)(#)","gi"))[0].replace(">","").replace("#",""),string!=""))document.title=string=="{cfn:getmessage(396)}"?string+"...":string+" {cfn:getmessage(397)}...",state="nonfocus",played=0,setTimeout("alterTitle(string,state,played)",2E3)};
function getajaxupdation()
      {
      var ajaxupdation=document.getElementById("ajaxupdation").value;
      return ajaxupdation;
      }
      
      function validateKey(e)
      { 
       if(e.keyCode==67 && insKey==1)
       {//c--->compose
  
       var current_url_w = window.location.hash;
       if(current_url_w=="#contacts")
       {
       window.location.hash="#inbox";mainMenu(1);
       }
       else
       {
           var current_url_w = window.location.hash;
           if(current_url_w=="#settings")
              {window.location.hash="#inbox";mainMenu(1);}
       }
       newMail(0);
       }
       else if(e.keyCode==81 && insKey==1)
       {//q--->getmail1()
       
       var current_url_w = window.location.hash;
       if(current_url_w=="#contacts")
       {
       window.location.hash="#inbox";mainMenu(1);
       }
       else{
           var current_url_w = window.location.hash;
           if(current_url_w=="#settings")
            {window.location.hash="#inbox";mainMenu(1);}
        }
       getmail1();
       }
       else if(e.keyCode==86 && insKey==1)
       {//v--movetofn()
       
       var current_url_w = window.location.hash;
       if(current_url_w=="#contacts")
       {
       window.location.hash="#inbox";mainMenu(1);
       }
       else{
           var current_url_w = window.location.hash;
           if(current_url_w=="#settings")
            {window.location.hash="#inbox";mainMenu(1);}
        }
       movetofn();
       }
       else if(e.keyCode==85 && insKey==1)
       {//u--> morefn()
       
       var current_url_w = window.location.hash;
       if(current_url_w=="#contacts")
       {
       window.location.hash="#inbox";mainMenu(1);
       }
       else{
           var current_url_w = window.location.hash;
           if(current_url_w=="#settings")
            {window.location.hash="#inbox";mainMenu(1);}
        }
       morefn();
       }
       else if(e.keyCode==72 && insKey==1)
       {//h-->new folder
       
       var current_url_w = window.location.hash;
       if(current_url_w=="#contacts")
       {
       window.location.hash="#inbox";mainMenu(1);
       }
       else{
           var current_url_w = window.location.hash;
           if(current_url_w=="#settings")
            {window.location.hash="#inbox";mainMenu(1);}
        }
       addcustomfolder();
       }
       else if(e.keyCode==87 && insKey==1)
       {//w--->deletefolder()
       
       var current_url_w = window.location.hash;
       if(current_url_w=="#contacts")
       {
       window.location.hash="#inbox";mainMenu(1);
       }
       else{
           var current_url_w = window.location.hash;
           if(current_url_w=="#settings")
            {window.location.hash="#inbox";mainMenu(1);}
        }
       deletecustomFolder();
       }
       else if(e.keyCode==89 && insKey==1)
       {//y
       popinvite('');
       }
       else if(e.keyCode==88 && insKey==1)
       {//x
       
       window.location.href="{url:(index/logout)}";
       }
       else if(e.keyCode==82 && e.altKey!=0 && insKey==0)
       {//Alt+r-->Read
       var spl=new Array();
       var current_url_w = window.location.hash;
       if(current_url_w!="#contacts")
       {
           var current_url_w = window.location.hash;
           if(current_url_w!="#settings")
            {
            if((current_url_w.substring(0,6)=="#chats") && (current_url_w.substring(0,2)!=""))
            {
            readChat(1,'');
            }
            else if((current_url_w.substring(0,6)!="#chats") && (current_url_w.substring(0,2)!=""))
            {
            read(1,'');
            }
            
            }
        }
       }
       else if(e.keyCode==85 && e.altKey!=0 && insKey==0)
       {//Alt+u-->Unread
       var spl=new Array();
       var current_url_w = window.location.hash;
       if(current_url_w!="#contacts")
       {
           var current_url_w = window.location.hash;
           if(current_url_w!="#settings")
            {
            if((current_url_w.substring(0,6)=="#chats") && (current_url_w.substring(0,2)!=""))
            {
            readChat(0,'');
            }
            else if((current_url_w.substring(0,6)!="#chats") && (current_url_w.substring(0,2)!=""))
            {
            read(0,'');
            }
            
            }
        }
       }
       else if(e.keyCode==88 && e.altKey!=0 && insKey==0)
       {//Alt+x-->Star
       var spl=new Array();
       var current_url_w = window.location.hash;
       if(current_url_w!="#contacts")
       {
           var current_url_w = window.location.hash;
           if(current_url_w!="#settings")
            {
            if((current_url_w.substring(0,6)!="#chats") && (current_url_w.substring(0,2)!=""))
            {
            star(1);
            }
            
            }
        }
       }
       else if(e.keyCode==81 && e.altKey!=0 && insKey==0)
       {//Alt+q-->UnStar
       var spl=new Array();
       var current_url_w = window.location.hash;
       if(current_url_w!="#contacts")
       {
           var current_url_w = window.location.hash;
           if(current_url_w!="#settings")
            {
            if((current_url_w.substring(0,6)!="#chats") && (current_url_w.substring(0,2)!=""))
            {
            star(0);
            }
            }
        }
       }
       else if(e.keyCode==89 && e.altKey!=0 && insKey==0)
       {//Alt+y-->Select All
       var spl=new Array();
       var current_url_w = window.location.hash;
       if(current_url_w!="#contacts")
       {
           var current_url_w = window.location.hash;
           if(current_url_w!="#settings")
            {
            if((current_url_w.substring(0,6)=="#chats") && (current_url_w.substring(0,2)!=""))
            {
            selectallchat();
            }
            else if((current_url_w.substring(0,6)!="#chats") && (current_url_w.substring(0,2)!=""))
            {
            selectall();
            }
            
            }
        }
       }
       else if(e.keyCode==90 && e.altKey!=0 && insKey==0)
       {//Alt+z-->Deselect All
       var spl=new Array();
       var current_url_w = window.location.hash;
       if(current_url_w!="#contacts")
       {
           var current_url_w = window.location.hash;
           if(current_url_w!="#settings")
            {
            if((current_url_w.substring(0,6)=="#chats") && (current_url_w.substring(0,2)!=""))
            {
            deselectallchat();
            }
            else if((current_url_w.substring(0,6)!="#chats") && (current_url_w.substring(0,2)!=""))
            {
            deselectall();
            }
            
            }
        }
       }
       else if(e.keyCode==82 && insKey==1)
       {//r-->Reply
       var spl=new Array();
       var current_url_w = window.location.hash;
       if(current_url_w!="#contacts")
       {
           var current_url_w = window.location.hash;
           if(current_url_w!="#settings")
            {
            if((current_url_w.substring(0,6)=="#chats") && (current_url_w.substring(0,2)!=""))
            {
            spl=current_url_w.split("/");
           if(spl.length>=2)
            {
            createDraftChat(spl[1],1,spl[1]);
            }
            }
            else if((current_url_w.substring(0,6)!="#chats") && (current_url_w.substring(0,2)!=""))
            {
             spl=current_url_w.split("/");
           
              if(spl.length>=2)
               {actionfn(2);}
            }
            
            }
        }
       }
       else if(e.keyCode==65 && insKey==1)
       {//a-->Reply All
       var spl="";
       var current_url_w = window.location.hash;
       if(current_url_w!="#contacts")
       {
           var current_url_w = window.location.hash;
           if(current_url_w!="#settings")
            {
            if((current_url_w.substring(0,6)=="#chats") && (current_url_w.substring(0,2)!=""))
            {
            spl=current_url_w.split("/");
            if(spl.length>=2)
            {/*actionfnChat(3);*/createDraftChat(spl[1],2,spl[1]);}
            }
            else if((current_url_w.substring(0,6)!="#chats") && (current_url_w.substring(0,2)!=""))
            {
             spl=current_url_w.split("/");
             if(spl.length>=2)
               {actionfn(3);}
            }
            
            }
        }
        }
       else if(e.keyCode==70 && insKey==1)
       {//f -->Forward
      
       var spl="";
       var current_url_w = window.location.hash;
       if(current_url_w!="#contacts")
       {
           var current_url_w = window.location.hash;
           if(current_url_w!="#settings")
            {
            if((current_url_w.substring(0,6)=="#chats") && (current_url_w.substring(0,2)!=""))
            {
            spl=current_url_w.split("/");
            if(spl.length>=2)
            {/*actionfnChat(4);*/createDraftChat(spl[1],3,spl[1]);}
            }
            else if((current_url_w.substring(0,6)!="#chats") && (current_url_w.substring(0,2)!=""))
            {
             spl=current_url_w.split("/");
             if(spl.length>=2)
               {actionfn(4);}
            }
            
            }
        }
        }
       else if(e.keyCode==68 && insKey==1)
       {//d-->delete
       
       
       var spl="";
       var current_url_w = window.location.hash;
       if(current_url_w!="#contacts")
       {
           var current_url_w = window.location.hash;
           if(current_url_w!="#settings")
            {
            if((current_url_w.substring(0,6)=="#chats") && (current_url_w.substring(0,2)!=""))
            {
            spl=current_url_w.split("/");
            if(spl.length>=2)
            {actionfnChat(1);/*createDraftChat(spl[1],3,spl[1]);*/}
            }
            else if((current_url_w.substring(0,6)!="#chats") && (current_url_w.substring(0,2)!=""))
            {
             spl=current_url_w.split("/");
             if(spl.length>=2)
               {actionfn(1);}
            }
            
            }
        }
        
       }
       else if(e.keyCode==83 && insKey==1)
       {//s-->save to draft
      
  
        var spl="";
       var current_url_w = window.location.hash;
       if(current_url_w!="#contacts")
       {
           var current_url_w = window.location.hash;
           if(current_url_w!="#settings")
            {
            if((current_url_w.substring(0,6)=="#chats") && (current_url_w.substring(0,2)!=""))
            {
            spl=current_url_w.split("/");
            if(spl.length>=2 && pair1!="")
            {mailFurtherChat(2,spl[1]);}
            }
            else if((current_url_w.substring(0,6)!="#chats") && (current_url_w.substring(0,2)!=""))
            {
             spl=current_url_w.split("/");
             if(spl.length>=2)
               {
               if(pair!="")
               mailFurther(2,spl[1],spl[1]+"_0");
               }
            }
            }
        }
       
       }
       else if(e.keyCode==90 && insKey==1)
       {//z-->send
      
       
        var spl="";
       var current_url_w = window.location.hash;
       if(current_url_w!="#contacts")
       {
           var current_url_w = window.location.hash;
           if(current_url_w!="#settings")
            {
            if((current_url_w.substring(0,6)=="#chats") && (current_url_w.substring(0,2)!=""))
            {
            spl=current_url_w.split("/");
            if(spl.length>=2  && pair1!="")
            {mailFurtherChat(1,spl[1]);}
            }
            else if((current_url_w.substring(0,6)!="#chats") && (current_url_w.substring(0,2)!=""))
            {
             spl=current_url_w.split("/");
             if(spl.length>=2  && pair!="")
               {mailFurther(1,spl[1],spl[1]+"_0");}
            }
            
            }
        }
       
       }
       else if(e.keyCode==27 && insKey==1)
       {//esc-->discard
        var spl="";
       var current_url_w = window.location.hash;
       if(current_url_w!="#contacts")
       {
           var current_url_w = window.location.hash;
           if(current_url_w!="#settings")
            {
            if((current_url_w.substring(0,6)=="#chats") && (current_url_w.substring(0,2)!=""))
            {
            spl=current_url_w.split("/");
            if(spl.length>=2  && pair1!="")
            {mailFurtherChat(3,spl[1]);}
            }
            else if((current_url_w.substring(0,6)!="#chats") && (current_url_w.substring(0,2)!=""))
            {
             spl=current_url_w.split("/");
             if(spl.length>=2  && pair!="")
               {mailFurther(3,spl[1],spl[1]+"_0");}
            }
            
            }
        }
       
       }
       else if(e.keyCode==80 && insKey==1)
       {//p-->print
       
       
        var spl="";
       var current_url_w = window.location.hash;
       if(current_url_w!="#contacts")
       {
           var current_url_w = window.location.hash;
           if(current_url_w!="#settings")
            {
            if((current_url_w.substring(0,6)=="#chats") && (current_url_w.substring(0,2)!=""))
            {
            spl=current_url_w.split("/");
            if(spl.length>=2)
            {spl[0]=spl[0].replace("#",'');window.open("{url:(chat/printmailChat/)}"+spl[0]+"/"+spl[1],'_blank');}
            }
            else if((current_url_w.substring(0,6)!="#chats") && (current_url_w.substring(0,2)!=""))
            {
             spl=current_url_w.split("/");
             if(spl.length>=2)
               {spl[0]=spl[0].replace("#",'');window.open("{url:(mail/printmail/)}"+spl[0]+"/"+spl[1],'_blank');}
            }
            
            }
        }
       
       }
       else if(e.keyCode==32 && insKey==1)
       {//space-->seacrh focus
        searchfn();
        document.getElementById("search").focus();
       }
      // else if(e.keyCode==33  && insKey==1)
       //alert("Next Page");
      // else if(e.keyCode==34  && insKey==1)
      // alert("Previous Page");
       else if(e.keyCode==71  && insKey==1)
       {//g-->add contact group
       var current_url_w = window.location.hash;
       if(current_url_w!="#contacts")
       {
       window.location.hash="#contacts";mainMenu(2);
       }
        addcustomfolder_contact(0);
       }
       else if(e.keyCode==79 && insKey==1)
       {//o-->delete contact group
       var current_url_w = window.location.hash;
       if(current_url_w!="#contacts")
       {
       window.location.hash="#contacts";mainMenu(2);
       }
        deletecontactF();
       }
       else if(e.keyCode==78 && insKey==1)
       {//n-->new conact
       
       var current_url_w = window.location.hash;
       if(current_url_w!="#contacts")
       {
       window.location.hash="#contacts";
       mainMenu(2);}
       newcontact();
       }
       else if(e.keyCode==87 && e.altKey!=0 && insKey==0)
       {//Alt+w-->settings section
        var current_url_w = window.location.hash;
       if(current_url_w!="#settings")
       window.location.hash="#settings";
        mainMenu(3);
       }
       else if(e.keyCode==67 && e.altKey!=0 && insKey==0)
       {//Alt+c-->contacts section
        var current_url_w = window.location.hash;
       if(current_url_w!="#contacts")
       window.location.hash="#contacts";
        mainMenu(2);
       }
       else if(e.keyCode==77  && e.altKey!=0 && insKey==0)
       {//Alt+m-->mail section
        var current_url_w = window.location.hash;
       if(current_url_w!="#inbox")
       window.location.hash="#inbox";
        mainMenu(1);
       }
       else if(e.keyCode==84 && insKey==1)
       {//t-->open theme div
       if({$override_themes}==1)
       showTheme();
       }
       else if(e.keyCode==74 && insKey==1)
       {//j-->calendar
       if({$calendar_enable}==1)
       window.open("{url:(calendar/calendar)}",'_blank');
       }
       else if(e.keyCode==75 && insKey==1)
       {//k-->todolist
         if({$todo}!=0) 
         todolist('');
       }
       else if(e.keyCode==76 && insKey==1)
       {//l-->empty spam
       emptyspam();
       }
       else if(e.keyCode==77 && insKey==1)
       {//m-->empty trash
       emptytrash();
       }
      }
</script>

</head>

<body onclick="display()" class="bodyClass" id="body"   {if($chat_enable==1)} onLoad="preloadfun()" onBlur="lostFocus();" onFocus="gotFocus()" {endif} {if($shallow==1)}onkeydown="validateKey(event)"{endif}>
{if($portal_status==1)}{cfn:getloggedheader()}{endif}

<!--[if lt IE 9]>
<script src="js/warning.js"></script>
<script>window.onload=function(){e("images/")}</script>
<![endif]-->
<div class="iewarng"></div>
<div class="darken" id="darken" style="display: none;"></div>
<div class="themeSelWrap" id="themeSelWrap"  style="display: none;">
  <div class="themeSelHead">
    <div class="left">{cfn:getmessage(756)}</div>
    <div class="close" onClick="showTheme()" title="{cfn:getmessage(450)}"></div>
  </div>
  <div class="themeSelBox" > {loopstart:themestyle:1000}
    {if($themestyle[0]==1)} <a href="javascript:setthemeheader(1)" class="thumb car">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==2)} <a href="javascript:setthemeheader(2)" class="thumb sct">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==3)} <a href="javascript:setthemeheader(3)" class="thumb dce">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==4)} <a href="javascript:setthemeheader(4)" class="thumb dceGrn">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==5)} <a href="javascript:setthemeheader(5)" class="thumb schl">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==6)} <a href="javascript:setthemeheader(6)" class="thumb cartoon">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==7)} <a href="javascript:setthemeheader(7)" class="thumb pln">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==8)} <a href="javascript:setthemeheader(8)" class="thumb org">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==9)} <a href="javascript:setthemeheader(9)" class="thumb fd">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==10)} <a href="javascript:setthemeheader(10)" class="thumb bFly">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==11)} <a href="javascript:setthemeheader(11)" class="thumb flr">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==12)} <a href="javascript:setthemeheader(12)" class="thumb snd">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==13)} <a href="javascript:setthemeheader(13)" class="thumb frst">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==14)} <a href="javascript:setthemeheader(14)" class="thumb gold">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==15)} <a href="javascript:setthemeheader(15)" class="thumb hny">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==16)} <a href="javascript:setthemeheader(16)" class="thumb elpnt">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==17)} <a href="javascript:setthemeheader(17)" class="thumb pupy">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==18)} <a href="javascript:setthemeheader(18)" class="thumb spdr">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==100)} <a href="javascript:setthemeheader(100)" class="thumb toy">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==20)} <a href="javascript:setthemeheader(20)" class="thumb night">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==21)} <a href="javascript:setthemeheader(21)" class="thumb viln">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==22)} <a href="javascript:setthemeheader(22)" class="thumb knn">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==23)} <a href="javascript:setthemeheader(23)" class="thumb plnclr c">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==24)} <a href="javascript:setthemeheader(24)" class="thumb plnclr a">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==25)} <a href="javascript:setthemeheader(25)" class="thumb plnclr e">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==26)} <a href="javascript:setthemeheader(26)" class="thumb plnclr f">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==27)} <a href="javascript:setthemeheader(27)" class="thumb plnclr g">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==28)} <a href="javascript:setthemeheader(28)" class="thumb plnclr b">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==29)} <a href="javascript:setthemeheader(29)" class="thumb plnclr h">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==30)} <a href="javascript:setthemeheader(30)" class="thumb plnclr i">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==31)} <a href="javascript:setthemeheader(31)" class="thumb plnclr j">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==32)} <a href="javascript:setthemeheader(32)" class="thumb plnclr d">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==33)} <a href="javascript:setthemeheader(33)" class="thumb plnclr k">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==34)} <a href="javascript:setthemeheader(34)" class="thumb plnclr l">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==35)} <a href="javascript:setthemeheader(35)" class="thumb plnclr m">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==36)} <a href="javascript:setthemeheader(36)" class="thumb plnclr n">
    <div class="shade"></div>
    </a> {elseif($themestyle[0]==37)} <a href="javascript:setthemeheader(37)" class="thumb dft">
    <div class="shade"></div>
    </a> 
    {elseif($themestyle[0]==75)}<a href="javascript:setthemeheader(75)" class="thumb"><img width="93px" height="93px" src="images/bg1.jpg"></a>
    <div class="shade"></div>    
    {endif}
    {loopend:themestyle} </div>
</div>
<div id="page" >
  <input type="hidden" id="titlesetup" name="titlesetup" value="" size="60">
  <input type="hidden" id="mailC_load" name="mailC_load" value="0" >
  <input type="hidden" value="0" id="sessTimer">
  <input type="hidden" value="" id="ajaxupdation">
  <center>
    <div id="preloadimage" class="preloader" ><img src="images/cMap_loading.gif"/>
      <div class="preloaderTxt">{cfn:getmessage(333)}....</div>
    </div>
  </center>
  <div style="display: none;" id="preloaddiv">
    <div class="loadingDiv" id="loadingDiv" style="display: none;">
      <center>
      <!-- -Notification Div Starts -->
        <div class="loadingTxt"  id="notify_msg_div" style="display:none;"></div> 
      <!-- -Notification Div Ends -->
        <div class="loadingTxt"  id="load_msg"><i class="fa fa-spinner fa-spin"></i> {cfn:getmessage(451)}....</div>
      </center>
    </div>
    <input type="hidden" id="crntfolderMailcount" value="">
    <div id="t"></div>
    <div class="header" id="themeheader">
      <div class="clear"></div>
      <div class="logotopp"> <a href="{url:(mail/mailbox)}" ><img src="{$imgpath}" border="0"></a> </div>
      <div class="headerD left"> <span id="mainMail1" class="selectedMainMenu"><i class="fa fa-envelope headerDicon"></i> {cfn:getmessage(1)}</span>
      <span id="mainMail2" class="unselectedMainMenu" style="display: none">
      <i class="fa fa-envelope headerDicon"></i>
      <a href="#inbox" onClick="javascript:mainMenu(1)">{cfn:getmessage(1)}</a></span>
      <span id="mainContact1" class="selectedMainMenu" style="display: none">{cfn:getmessage(2)}</span>
      
      <span id="mainContact2" class="unselectedMainMenu hedrhide">
      <a href="#contacts" onClick="javascript:mainMenu(2)"><i class="fa fa-user headerDicon"></i>{cfn:getmessage(2)}</a></span>{if($todo!=0)}<span class="unselectedMainMenu hedrhide">
      <a href="javascript:todolist('')">
      
      <i class="fa fa-clock-o headerDicon"></i>{cfn:getmessage(626)}</a></span>{endif}{if($calendar_enable==1)}<span class="unselectedMainMenu"><a href="{url:(calendar/calendar)}" target="_blank">
      
      <i class="fa fa-calendar headerDicon"></i>{cfn:getmessage(3)}</a></span>{endif}<span id="mainSetting1" class="selectedMainMenu" style="display: none">{cfn:getmessage(4)}</span>
      
      <span id="mainSetting2" class="unselectedMainMenu hedrhide"><a href="#settings/webmail" onClick="javascript:mainMenu(3)">
      
      <i class="fa fa-wrench headerDicon"></i>{cfn:getmessage(4)}</a></span>{if($override_themes==1)}<span class="unselectedMainMenu" ><a href="javascript:showTheme()">
      
      <i class="fa fa fa-picture-o headerDicon"></i>{cfn:getmessage(170)}</a></span>
       
        <div id="themeDiv" style="display: none">
          <map name="Map">
            <area shape="rect" coords="0,0,60,75" href="javascript:changeTheme(1)">
            <area shape="rect" coords="61,0,121,75" href="javascript:changeTheme(2)">
            <area shape="rect" coords="123,0,188,75" href="javascript:changeTheme(3)">
          </map>
          <img src="images/thumbs/theme.jpg" border="0" usemap="#Map" style="z-index:10001"></div>
        {endif}</div>
      <div class="fsearch">
        <div id="searchMain" class="searchMain" >
          <div class="serchinputouter">
            <input type="text" name="search" placeholder="{cfn:getmessage(323)}" value="{cfn:getmessage(323)}" id="search" class="searchD" onClick="searchfn()" onBlur="displayfn()" onKeyUp="search(event)">
         <!--   <div class="selctlabeldiv " id="folderdisplay">
              <label class="seclt_labl">
                <select id="folders" class="searchSelect">
                  <option value="0"></option>
                  <option value="1">{cfn:getmessage(164)}</option>
                  <option value="2">{cfn:getmessage(19)}</option>
                  <option value="3">{cfn:getmessage(12)}</option>
                  <option value="4">{cfn:getmessage(21)}</option>
                  <option value="5">{cfn:getmessage(20)}</option>
                  
          
           {loopstart:customfolders:1000} 
          
          
                  <option value="{$customfolders[0]}" >{$customfolders[1]}</option>
                  
          
           {loopend:customfolders} 
        
        
                </select>
              </label>
            </div> -->
            <div class="searchBtn" style="font-size:11px;padding:3px;"><span style="width:100px;" ><a href="#"  style="text-decoration:none;padding-top:5px" class="advanced_link" title="{cfn:getmessage(657)}"><i class="fa fa-caret-down advnceserchtip"></i>
            </a></span></div>
            <button class="srch_btn" onClick="select_search()" value="{cfn:getmessage(452)}"> <i class="fa fa-search"></i> </button>
          </div>
          <div class="clear"></div>
          
        </div>
        <input type="hidden" id="advance_search" value="0">
        <div id="search_options" class="search_options">
          <table border=0 cellpadding="0" cellspacing="0" style="padding:10px;font-size:12px;" width="100%" height="100%">
            <tr>
              <td colspan="2" style="padding:5px;font-weight:700;font-size:14px;">{cfn:getmessage(669)}</td>
            </tr>
            <tr>
              <td colspan="2">&nbsp;</td>
            </tr>
            <tr>
              <td ><span class="boldTxt">{cfn:getmessage(663)}</span></td>
              <td ><select	id="adfolders" >
                  <option value="0">{cfn:getmessage(164)}</option>
                  <option value="1">{cfn:getmessage(19)}</option>
                  <option value="4">{cfn:getmessage(12)}</option>
                  <option value="3">{cfn:getmessage(21)}</option>
                  <option value="2">{cfn:getmessage(20)}</option>
                  <option value="5">{cfn:getmessage(22)}</option>
                  
              
              
                                              {loopstart:customfolders:1000}
                                              
              
              
                  <option value="{$customfolders[0]}" >{$customfolders[1]}</option>
                  
              
              
                                              {loopend:customfolders}
                                          
            
            
                </select></td>
              <td colspan=2 style="padding-left:45px"><input type="checkbox" id="se_check" name="se_check">
                <span class="boldTxt">{cfn:getmessage(656)}</span></td>
            </tr>
            <tr>
              <td colspan="2">&nbsp;</td>
            </tr>
            <tr>
              <td><span class="boldTxt">{cfn:getmessage(54)}</span></td>
              <td><span>
                <input type="text" value="" name="se_from" id="se_from" class="adsearch">
                </span></td>
              <td><span class="boldTxt">{cfn:getmessage(31)}</span></td>
              <td><span>
                <input type="text" value="" name="se_to" id="se_to" class="adsearch">
                </span></td>
            </tr>
            <tr>
              <td colspan="2">&nbsp;</td>
            </tr>
            <tr>
              <td><span class="boldTxt">{cfn:getmessage(34)}</span></td>
              <td><span>
                <input type="text" value="" name="se_subject" id="se_subject" class="adsearch">
                </span></td>
              <td><span class="boldTxt">{cfn:getmessage(655)}</span></td>
              <td><span>
                <input type="text" value="" name="se_keywords" id="se_keywords" class="adsearch">
                </span></td>
            </tr>
            <tr>
              <td colspan="2">&nbsp;</td>
            </tr>
            <tr>
              <td colspan=4 >
              <input type="button" class="advnceserchb" value="{cfn:getmessage(452)}" name="se_search" onClick="select_adsearch()">
                <input type="button" class="advnceserchbcncl" value="{cfn:getmessage(267)}" id="cancelsrchbtn"></td>
            </tr>
          </table>
        </div>
      </div>
      <!-- Full search ends  -->
      <div class="user_details">
        <div class="user_picnd_arw"> <span class="userpriamge"><img src="{$userimage}" alt="User Profile photo"></span> <span class="usertip"><i class="fa fa-caret-down"></i> </span> </div>
        <div class="user_details_drpdwn">
          <span class="usermail ">{$username}&nbsp;{if($portal_status==0)}</span>
          <span class="logoutspan"><a class="logoutbtn" href="{url:(index/logout)}" target="_top">{cfn:getmessage(39)}</a>{endif}</span>
        </div>
      </div>
      </div>
      <div class="second_headr" id="second_headrid">
      <div class="left_mailsection" id="left_mailsectionid">
      <div id="settings_left_section"></div>
      <div class="sddmb" id="sddmbid">
      <a href="#newmail" class="newmailbtn " onClick="javascript: newMail(0)" id="new_mail" >
      <i class="fa fa-pencil-square-o position_tooltip" data-asTooltip-position="n" title="{cfn:getmessage(10)}" ></i>
</a>
      <a class="getmailbtn " href="javascript:getmail1()" id="getmail" >
      <i id="getmailbtnid" class="fa fa-repeat position_tooltip" data-asTooltip-position="n"title="{cfn:getmessage(11)}"  ></i></a></div>
      <div class="contactleftmenu" id="cotnct_lmenuid">
       <div class=""><a class="newcntctbtn" href="javascript:newcontact()" title="{cfn:getmessage(24)}" id="new_cnt_btn" class="">
       {cfn:getmessage(24)}
       </a></div>
      </div> <!-- contact left menu ends -->
      </div>
      	<div class="right_mailsection" id="right_mailsectionid">
        <div class="topmain-Menu">
                  <div id="mail_subheader" class="mail_subheader">
                  <a id="backmailbtnid" class="backmailbtn" href="javascript:clickback();" ><i id="back_tootltip" title="{cfn:getmessage(769)}" class="fa fa-long-arrow-left position_tooltip" data-asTooltip-position="n" ></i></a>
                    <ul style="list-style: none; " id="sddm" class="sddm sddmul">
                      <li id="seven_7" style=" border-right:none;"><a href="javascript:actionfn(7)" class="discrddrft" id=7>{cfn:getmessage(661)}</a></li>
                      <li id="one_1" style="">
                      <a class="topmenu_a delete_a position_tooltip" data-asTooltip-position="n" title=" {cfn:getmessage(14)}" href="javascript:actionfn(1)" id=2 >
                     
</a>
                      </li>
                  
                  
                  
                  
                      <li id="five_5" style="">
                      <a class="topmenu_a spam_a position_tooltip" data-asTooltip-position="n" href="javascript:actionfn(5)" title="{cfn:getmessage(12)}" id=5></a></li>
                      <li id="six_6" style="">
                      <a class="topmenu_a notspama position_tooltip" data-asTooltip-position="n" title=" {cfn:getmessage(659)}" href="javascript:actionfn(6)" id=6></a></li>
                      
                       <li id="emptyspam" style="display: none;" class="sddmlinone"><a class="topmenu_a emptyspama position_tooltip" data-asTooltip-position="n" href="javascript:emptyspam()" title="{cfn:getmessage(642)}"></a></li>
                      <li id="emptytrash"  style="display: none;" ><a class="topmenu_a emptytrasha position_tooltip" data-asTooltip-position="n" href="javascript:emptytrash()" title="{cfn:getmessage(643)}"> </a></li>
                      <li id="movetoList" class="sddmlinone" style="position:relative;z-index:1000;">
                      <a class="topmenu_a move_a position_tooltip" data-asTooltip-position="n" title="{cfn:getmessage(13)}" href="javascript:movetofn()">
                      
                      </a>
                      <i class="fa fa-caret-down movedown"></i>
                        <div id="moveto2" class="roundDropdown" style="display: none;"></div>
                      </li>
                      
                     
                    </ul>
                    <span style="float: right;padding-left:10px;"><a id="splitbuttonid" class="backmailbtn" href="javascript:splitview()"><i id="split_tootltip" class="fa fa-columns position_tooltip" data-asTooltip-position="n" title=""></i></a>
                    </span>
                    <div id="moreList"  class="morelist" style="position:relative;z-index:1000;">
                      <a class="more_a" title="{cfn:getmessage(18)}" href="javascript:morefn()">{cfn:getmessage(18)}</a>
                      <i class="fa fa-caret-down movedowns"></i>
                        <div class="roundDropdown" id="moreList2" style="display: none;"> </div>
                      </div>
                      {if($tip_ofthe_day!=0 && $tip_of_day_title!="" && $tip_of_day_msg!="" )}<div  class="tip_of_day_cnew" id="tip_span">{cfn:getmessage(667)} : <marquee class="pointer" style="display: inline-block; width: 300px; overflow: hidden;">{$tip_of_day_title}:{$tip_of_day_msg}</marquee> </div>{endif} 
                  </div>
                  <div id="chat_subheader" class="mail_subheader" style="display: none;">
                    <a id="backchatbtnid" class="backmailbtn" href="javascript:clickback();"><i id="backchat_tootltip" class="fa fa-long-arrow-left position_tooltip" data-asTooltip-position="n" title=""></i></a>
                    
                    <ul style="list-style: none; " id="sddm" class="sddm sddmul">
                      <!-- <li id="new_mail" ><a href="#newmail" onClick="javascript: newMail()"><span>{cfn:getmessage(10)} </span></a></li>
                         <li id="getmail" style=""><a href="javascript:getmail1()"><span>{cfn:getmessage(11)}&nbsp;</span></a></li> -->
                     <!--  <li id="four_chat_4" style="float:right"><a href="javascript:actionfnChat(4)" id="chat_4"><span>{cfn:getmessage(17)}</span></a></li>
                      <li id="three_chat_3" style="float:right"><a href="javascript:actionfnChat(3)" id="chat_3"><span>{cfn:getmessage(16)}</span></a></li>
                      <li id="two_chat_2" style="float:right">
                      <a href="javascript:actionfnChat(2)" id="chat_2"><span>{cfn:getmessage(15)}</span></a></li> -->
                      
                      <li style=" border-right:none;"><a class="topmenu_a delete_a position_tooltip" href="javascript:actionfnChat(1)" id="chat_1" data-astooltip-position="n" title="{cfn:getmessage(14)}"></a></li>

                    </ul>
                    <span style="float: right;padding-left:10px;"><a id="splitbuttonid" class="backmailbtn" href="javascript:splitview()"><i id="back_tootltip" class="fa fa-columns position_tooltip" data-asTooltip-position="n" title="{cfn:getmessage(769)}"></i></a>
                    </span>
               
                                          <div id="moreListChat" class="morelist" style="position:relative;z-index:1000;"><a href="javascript:morefnChat()" class="more_a">{cfn:getmessage(18)}<i class="fa fa-caret-down movedowns"></i></a>
                        <div id="moreListChat2" style="display: none;" class="roundDropdown"></div>
                      </div>
                      
                  </div>
                  <div id="setting_subheader" style="display: none">&nbsp;</div>
                  <div id="messages" style="display: none;padding-left:20px;margin-left:30px;float:left;" ><span class="messageTabL"></span><span class="messageTabM" id="message_mail"></span><span class="messageTabR"></span></div>
                </div>
        </div>
        <div class="contsubmenuright">
        	<div id="contact_subheader">
                        <ul class="sddm sddmul" id="sddm" >
                         
                          <li class="">
                          <a class="topmenu_a newgropa position_tooltip" href="javascript:javascript:addcustomfolder_contact(0)" data-astooltip-position="n" title="{cfn:getmessage(25)}">
                          </a></li>
                          <li class="" id="hideedit" style="display: none;">
                          {cfn:getmessage(179)}
                            <input type="hidden" id="stringid" name="stringid" value="">
                            </li>
                          <li class="" id="edit_groupli">
                         
                          <a class="topmenu_a editgroup_a position_tooltip" data-astooltip-position="n" href="javascript:editgroup_select();" id="edit_groupa" title=" {cfn:getmessage(180)}" >
                         </a></li>
                          <li class="" id="hideeditgroup" style="display: none;">
                          {cfn:getmessage(180)}
                          </li>
                          <li class="" id="delete_li">
                           <a class="topmenu_a delete_a position_tooltip" data-astooltip-position="n" href="javascript:deleteContact()" id="delete_a" title="{cfn:getmessage(206)}">
                          </a>
                         </li>
                          <li class="" id="hidedelete" style="display: none;">
                          {cfn:getmessage(206)}</li>
                          
                          <li id="import_c"  style="position:relative;z-index:1000;">
                          <a class="topmenu_a importc_a position_tooltip" data-astooltip-position="n" href="javascript:load_import()" title=" {cfn:getmessage(664)}">
                         </a></li>
                          <li id="export_c" class="sddmlinone" style="position:relative;z-index:1000;">
                          <a class="topmenu_a export_a position_tooltip" data-astooltip-position="n" href="javascript:load_export()" title="{cfn:getmessage(28)}">
                         </a></li>
                          <input type="hidden" name="selectall" id="selectall" value="0">
                        </ul>
                        <div id="contact_more_dropdown" class="morelist" style="position:relative;z-index:1000;">
                          <a class="more_a"  href="javascript:contactMorefn()" >{cfn:getmessage(18)}</a>
                          <i class="fa fa-caret-down movedowns"></i>
                            <div style="display: none;" id="contact_more_div" class="roundDropdown"></div>
                          </div>
                      </div>
        </div>
        <div class="settingsright_hader">
        	 <span class="usermail "></span>
        </div>
      </div>
    <div class="clear"></div>
    <div class="bottommailswraper" id="bottommailswraperid">
      <div class="first_tr">
        <div class="vertmenu firsttd" id="vertmenuid" >
          <div id="mailLeft" class="mailLeft">
            
            <div class="clear"></div>
            <input type="hidden" id="execute1" value="0" name="execute1">
            <input type="hidden" id="folderid" value="{$f}" name="folderid">
            <input type="hidden" id="foldername" value="{cfn:getfoldername($f)}" name="foldername">
            <ul id="leftMenu">
              <li id="leftmenu_inbox"><a href="#inbox" onClick="javascript:mainWindow('inbox',1,{$sizeMail},{$totalInbox},2)"> <span class="abc"><i class="fa fa-inbox"></i> {cfn:getmessage(19)}<span id="1_count" class="mailcounter"></span></span></a></li>
              <li id="leftmenu_starred"><a href="#starred" onClick="javascript:mainWindow('starred',1,{$sizeMail},{$totalStarred},2)"><span class="abc"><i class="fa fa-star"></i> {cfn:getmessage(205)}</span></a></li>
              {if($chat_enable==1)}
              <li id="leftmenu_chats"><a href="#chats" onClick="javascript:mainWindowChat('chats',1,{$sizeMail},{$totalchat},2)"><span class="abc"><i class="fa fa-comments"></i> {cfn:getmessage(429)}</span></a></li>
              {endif}
              <li id="leftmenu_draft"><a href="#draft" onClick="javascript:mainWindow('draft',1,{$sizeMail},{$totalDraft},2)"><span class="abc"><i class="fa fa-file-text"></i> {cfn:getmessage(20)}<span id="2_count" class="mailcounter"></span></span></a></li>
              <li id="leftmenu_sent"><a href="#sent" onClick="javascript:mainWindow('sent',1,{$sizeMail},{$totalSent},2)"><span class="abc"><i class="fa fa-paper-plane "></i> {cfn:getmessage(21)}</span></a></li>
              <li id="leftmenu_spam"><a href="#spam" onClick="javascript:mainWindow('spam',1,{$sizeMail},{$totalSpam},2)"><span class="abc"><i class="fa fa-exclamation-triangle"></i> {cfn:getmessage(12)}<span id="4_count" class="mailcounter"></span></span></a></li>
              <li id="leftmenu_trash"><a href="#trash" onClick="javascript:mainWindow('trash',1,{$sizeMail},{$totalTrash},2)"><span class="abc"><i class="fa fa-trash"></i> {cfn:getmessage(22)}</span></a></li>
              {loopstart:customfolders:1000}
              <li id="customFLI{$customfolders[0]}" >
                <div style="clear:both"></div>
                <div id="{$customfolders[0]}" style="width:100%;"><a href="#custom{$customfolders[0]}" onClick="javascript:mainWindow({$customfolders[0]},1,{$sizeMail},{$customfolders[2]},2)" onMouseOver="showeditImage({$customfolders[0]})" onMouseOut="hideeditImage({$customfolders[0]})" ><span id="custom{$customfolders[0]}_name"><i class="fa fa-folder"></i>{$customfolders[1]}<span id="custom{$customfolders[0]}_count" class="mailcounter"></span></span><span style="display:none;" id="editimage{$customfolders[0]}" onClick="editfolderfn({$customfolders[0]})" class="editBtn"><img src="images/filler.gif" border="0" align="absmiddle" class="iconsCornner arrow-d" title="{cfn:getmessage(26)}" border="0" alt=" "></span></a></div>
                <div id="edit{$customfolders[0]}" style="display: none;float:left;padding-left:25px;padding-right:0px;width:100%;" >
                  <input type="text" id="editgroupname{$customfolders[0]}" name="editgroupname{$customfolders[0]}" value="{$customfolders[1]}" onKeyUp="addgroupfn(event,this.value,{$customfolders[0]})" onBlur="blurfn1({$customfolders[0]})" size="15" align="absmiddle" style="height:18px; margin-top:2px; font-size:11px;">
                </div>
              </li>
              {loopend:customfolders}
            </ul>
            <div id="div_custm">
              <div id="custom_divcontainer0"></div>
            </div>
            <div class="buttons" style="">
              <div class="butteniner"><i class="fa fa-folder"></i>Folder
                <div class="ad_deltebuttons">
                  <div class=" left" > <a href="javascript:deletecustomFolder()" title="Delete Folder" class="spriteimg deletbutton"> </a> </div>
                  <div class=" left" > <a href="javascript:addcustomfolder()" title="Add New Folder" class="spriteimg addtbutton" > </a></div>
                </div>
              </div>
              <span id="deletebutton"></span>
              <input type="hidden" value="" id="addf">
              <input type="hidden" value="" id="attachcount">
            </div>
          </div>
          <div id="contactLeft" style="display: none;" class="">
            <div id="mailLeftMenu" class="mailLeftMenu">
              <ul id="C_customfolders" style="list-style: none;">
                <li id="0"><a href="javascript:mainContactWindow('mycontacts',1,{$mycontact_total},{$mycontact_total},2,0);" id="folder0" title="{cfn:getmessage(209)}"><span class="abc"><i class="fa fa-book"></i>
{cfn:getmessage(209)}&nbsp;<span id="all_count1"></span></span></a></li>
                {if($addressbook==1)}
                <li id="-1"><a href="javascript:mainContactWindow('global',1,{$g_contact},{$g_contact},2,-1);" id="folder0" title="{cfn:getmessage(209)}"><span class="abc"><i class="fa fa-globe"></i>
{cfn:getmessage(456)} <span id="all_count1"></span></span></a></li>
                {endif} {loopstart:groups:1000}
                <li id="{$groups[0]}">
                  <div style="clear:both"></div>
                  <div id="spC{$groups[0]}" style="width:100%; height:26px;"><a class='cg_href' href="javascript:mainContactWindow({$groups[0]},1,{$groups[2]},{$groups[2]},2,'{$groups[1]}')" title="{$groups[1]}" onMouseOver="showeditImageC({$groups[0]})" onMouseOut="hideeditImageC({$groups[0]})"> <i class="fa fa-users"></i>
                  {noescape:$groups[1]} <span style="display:none;" id="editimageC{$groups[0]}" onClick="editgropufnC({$groups[0]})" class="editBtn"><img src="images/filler.gif"  alt=" " class="iconsCornner arrow-d" title="{cfn:getmessage(26)}" border="0" align="absmiddle" alt=" "></span></a></div>
                  <div id="editC{$groups[0]}" style="display: none;float:left;padding-left:25px;padding-right:0px;width:100%; height:26px;">
                    <input type="text" id="editgroupnameC{$groups[0]}" name="editgroupnameC{$groups[0]}" value="{$groups[1]}" onKeyUp="addcontactgroupfn(event,this.value,{$groups[0]},2)" onBlur="ConatctblurfnE({$groups[0]})" maxlength="12" size="15" align="absmiddle" style="height:26px;">
                  </div>
                </li>
                {loopend:groups}
              </ul>
              <div id="div_custm_c" >
                <div id="C_filedivcontainer0"></div>
              </div>
              <div class="buttons contgroup">
                <div class="addBtn left">
                <a class="addtbutton spriteimg" href="javascript:addcustomfolder_contact(0)" title="Add New Folder" ></a></div>
                <div class="delBtn left" id="deletebutton">
                <a class="deletbutton spriteimg" href="javascript:deletecontactF()" title="Delete Folder"></a></div>
              </div>
            </div>
          </div>
          <div id="settingLeft" style="display: none;">
            <div class="">
              <ul >
                <li id="settings_webmail"><a href="#settings/webmail" onClick="javascript:settingswindow(1)" class="leftpanel"><i class="fa fa-envelope "></i>{cfn:getmessage(68)}</a></li>
                <li id="settings_spam"><a href="#settings/spam" onClick="javascript:settingswindow(2)" class="leftpanel"><i class="fa fa-exclamation-triangle"></i>{cfn:getmessage(70)}</a></li>
                <li id="settings_filter"><a href="#settings/filter" onClick="javascript:settingswindow(3)" class="leftpanel"><i class="fa fa-filter"></i>
{cfn:getmessage(71)}</a></li>
                <li id="settings_option"><a href="#settings/option" onClick="javascript:settingswindow(4)" class="leftpanel"><i class="fa fa-cog"></i>
{cfn:getmessage(72)}</a></li>
                {if($chat_enable==1)}
                <li id="settings_chat"><a href="#settings/chat" onClick="javascript:settingswindow(7)" class="leftpanel"><i class="fa fa-comments"></i>
 {cfn:getmessage(370)}</a></li>
                {endif}{if($calendar_enable==1)}
                <li id="settings_calendar"><a href="#settings/calendar" onClick="javascript:settingswindow(8)" class="leftpanel"><i class="fa fa-calendar "></i>{cfn:getmessage(3)}</a></li>
                {endif}
                <li id="settings_profile"><a href="#settings/profile" onClick="javascript:settingswindow(6)" class="leftpanel"><i class="fa fa-user"></i>
{cfn:getmessage(361)}</a></li>
                {if($portal_status==0)}
                <li id="settings_password"><a href="#settings/password" onClick="javascript:settingswindow(5)" class="leftpanel"><i class="fa fa-lock"></i>
{cfn:getmessage(73)}</a></li>
                {endif}
              </ul>
            </div>
          </div>
          <div class="clear"></div>
          {if($chat_enable==1)}
          <div class="chatwrperdiv">
          	<div class="chrwrperin_1">
          {showpage:chat/ajaxlivesearch} {showpage:chat/chat}
          </div>
          </div>
          {endif}
          
          <div style="text-indent:-999px; height:1px;">
            <object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7,0,19,0" width="1" height="1" id="swfFile">
              <param name="movie" value="FlashSoundNew/flashSound.swf" />
              <param name="flashVars" id="newsound" value="{$sp}"/>
              <param name="quality" value="high" />
              <span id="chatsoundembeded">
              <embed src="FlashSoundNew/flashSound.swf" quality="high" name="swfFile" flashVars="{$sp}" pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" width="1" height="1"></embed>
              </span>
            </object>
          </div>
          <div >
            <input name="newmsg" type="hidden" value="default" />
            <input name="newmsg" type="hidden" value="user" />
          </div>
        </div>
        <!-- first td close -->

 <!-- chat box start -->
 <div class="chatouter">
<div id="overdiv" class="overdiv" style="display: none;">
</div>
</div>
<!-- chat box end -->
</div>
<div class="folderHfirst">
                  <div class="folderLH"></div>
                  
                  <div class="folderMH" align="left">
                  
                    <table width="100%">
                      <tr>
                        <td valign="top"><span id="heading" style="float:left;">{cfn:getmessage(19)}</span></td>
                        <td valign="top"><span class="top_ads_desc " style="float:right;"> {if($topadtype==1)}{noescape:$topads}{else}<span class="ads_span" >{loopstart:toparray:100}{if($toparray[0]!="")}<a href="{$toparray[3]}" class="top_ads_title"	>{noescape:$toparray[0]}</a><span style="text-decoration:none;color:#CCCCCC;">&nbsp;-&nbsp;</span><span class="top_ads_desc">{noescape:$toparray[1]}</span>&nbsp;&nbsp;{endif}{loopend:toparray}</span>{endif} </td>
                      </tr>
                    </table>
                  </div>
                  <div class="folderRH"></div>
                </div>
<div id="second_scroll" class="secondscroll">
        <div class="mailPageOuter" id="mailPageOuterid">
       
    

       
       
          <div class="innerTheme">
            <div class="innerThemeiner">
              <div name="mail" id="mail" class="mailPage">
        
                
                <input type="hidden" id="foldrd" value="">
                <input type="hidden" id="noConvrstns" value="1">
                
                <div style="clear:both"></div>
                         
                
  
                <div class="shortmail" id="short_detail">
                
                <ul class="inbxrplyul">
                 <li id="two_chat_2" class="inbxrli"  style="float:right">
                 <a href="javascript:actionfnChat(2)"  id="chat_2">
                 <i class="fa fa-share position_tooltip" data-asTooltip-position="n" title="{cfn:getmessage(17)}"></i>
</a></li>
                      <li id="three_chat_3" class="inbxrli"  style="float:right"><a href="javascript:actionfnChat(3)"  id="chat_3">
                     
                      <i class="fa fa-reply-all position_tooltip" data-asTooltip-position="n" title=" {cfn:getmessage(16)}"></i>

                      </a></li>
                      <li id="four_chat_4" class="inbxrli" style="float:right"><a href="javascript:actionfnChat(4)"  id="chat_4">
                      <i class="fa fa-reply position_tooltip" data-asTooltip-position="n" title="{cfn:getmessage(15)}"></i>
</a></li></ul>
                
                 <ul class="inbxrplyul" id="mail_box_reply_links">
                 <li id="four_4" class="inbxrli"  style="float:right">
                 <a href="javascript:actionfn(4)"  id=4>
                 <i class="fa fa-share position_tooltip" data-asTooltip-position="n" title="{cfn:getmessage(17)}"></i>
</a></li>
                      <li id="three_3" class="inbxrli"  style="float:right"><a href="javascript:actionfn(3)"  id=3>
                     
                      <i class="fa fa-reply-all position_tooltip" data-asTooltip-position="n" title=" {cfn:getmessage(16)}"></i>

                      </a></li>
                      <li id="two_2" class="inbxrli" style="float:right"><a href="javascript:actionfn(2)"  id=2>
                      <i class="fa fa-reply position_tooltip" data-asTooltip-position="n" title="{cfn:getmessage(15)}"></i>
</a></li></ul>
                 </div>     <div style="clear:both"></div>
                  <table cellpadding="0" cellspacing="0" style="height: auto;" width="100%" border="0">
                    <tr >
                      <td valign="top">
                     <div id="splitdiv1" class="splitiuterdiv" style="display:none;" >
  <div id="msg_list" class="splitmsg_list" >
  <div id="mailContent11" class="mailContentmain"> </div>
    <div class="endline"></div>  
  </div>
  <div id="msg_display" class="splitmsgdisplay">
   </div>
   <div class="clear"></div>
   </div>
   <!-- Loading Div 2 pane starts -->
   <div id="load_2pane" class="2paneload" style="display:none;"><i class="fa fa-spinner fa-spin"></i> {cfn:getmessage(451)}....</div>
        <!-- Ends -->
           
                      <div id="mailContent" class="mailContentmain">
                      
                      
                       </div>
                     <!--  <div class="endline"></div> -->
                       <div id="preview" style="display: none;position:absolute;z-index:100003;width: 800px; border: 1px solid #000;background-color: #fff;height: auto;padding: 2px 2px 10px 10px;margin: 20px 300px;" > </div></td>
                    
                    </tr>
                    <tr>
                      <td></td>
                    </tr>
                  </table>
                  <div id="newMail" style="display: none;padding-left:10px;padding-right:10px;">
                    <div class="mailBox">
                      <div class="mailBoxFooter" id="sendFooter" ><span class="mailBoxLF"></span><span class="mailBoxBM" style="padding-top:2px;">
                        <div class="sendBtn floatL"><a href="javascript:mailFurther(1,0,'0_0')">{cfn:getmessage(37)}</a></div>
                        <div class="commonBtn commonBtngc floatL"><a class="position_tooltip" href="javascript:mailFurther(2,0,'0_0')" title="{cfn:getmessage(36)}"><i class="fa fa-file-text"></i></a></div>
                        <div class="commonBtn commonBtngc floatL"><a class="position_tooltip" href="javascript:mailFurther(3,0,'0_0')" title="{cfn:getmessage(59)}"><i class="fa fa-trash"></i>
                        </a></div>
                        </span><span class="mailBoxRF"></span></div>
                      <div class="row marginT10"></div>
                      <div class="mailBoxM" style="position:relative;">
                        <input type="hidden" name="search_0_0" id="search_0_0" value="">
                        <input type="hidden" name="searchcc_0_0" id="searchcc_0_0" value="">
                        <input type="hidden" name="searchbcc_0_0" id="searchbcc_0_0" value="">
                        <input type="hidden" name="draftid_0_0" id="draftid_0_0" value="">
                        <div class="row" >
                          <div class="coloum70 floatL"><span class="boldTxt">{cfn:getmessage(31)}:</span></div>
                          <div class="coloum floatL" style="width: 89%;float: left;">
                            <input autocomplete="off" type="text" name="to_0_0" id="to_0_0" value="" onKeyUp="javascript:keymovement(event,this.value,'0_0',1);" style="width: 99%; height: 30px;">
                          </div>
                          <div style="clear: both;" ></div>
                          <div id="livesearch_0_0" style="position:static;margin-left:74px;" onblur="display();" class=" livesearch"></div>
                        </div>
                        <div class="row marginT10" >
                          <div class="coloum70 floatL"><span class="boldTxt">{cfn:getmessage(34)}:</span></div>
                          <div class="coloum floatL" style="width: 89%;">
                            <input type="text" name="subject_0_0" id="subject_0_0" value="" style="width: 99%; height: 30px;">
                          </div>
                        </div>
                        <div style="clear: both;"></div>
                        <div class="row marginT10" id="cc_bcc_0">
                          <div class="coloum70 floatL" ></div>
                          <span id="spancc_0" class="commonLink" ><a href="javascript:showccfun_new(0)">{cfn:getmessage(201)}</a></span><span class="normalTxt floatL">|</span><span id="spanbcc_0" class="commonLink"><a href="javascript:showbccfun_new(0)">{cfn:getmessage(202)}</a></span></div>
                        <div class="row marginT10" id="showcc_0" style="display: none;">
                          <div class="coloum70 floatL"><span class="boldTxt">{cfn:getmessage(32)}:</span></div>
                          <div class="coloum floatL" style="width: 89%;">
                            <input autocomplete="off" type="text" name="cc_0_0" id="cc_0_0" value="" style="width: 99%; height: 30px;" onKeyUp="javascript:keymovement(event,this.value,'0_0',2);">
                          </div>
                          <div style="clear: both;" ></div>
                          <div id="livesearchcc_0_0" style="position:static;margin-left:74px;" class=" livesearch"></div>
                        </div>
                        <div style="clear: both;"></div>
                        <div class="row marginT10" id="showbcc_0" style="display: none;">
                          <div class="coloum70 floatL"><span class="boldTxt">{cfn:getmessage(33)}:</span></div>
                          <div class="coloum floatL" style="width: 89%;">
                            <input autocomplete="off" type="text" name="bcc_0_0" id="bcc_0_0" value="" onKeyUp="javascript:keymovement(event,this.value,'0_0',3);" style="width: 99%; height: 30px;">
                          </div>
                          <div style="clear: both;" ></div>
                          <div id="livesearchbcc_0_0" style="position:static;margin-left:74px;" class=" livesearch"></div>
                        </div>
                        <div class="row marginT10" id="cc_only_0" style="display: none;">
                          <div class="coloum70 floatL" ></div>
                          <span id="spancc_0" class="commonLink"><a href="javascript:showccfun2_new(0)">{cfn:getmessage(201)}</a></span></div>
                        <div class="row marginT10" id="bcc_only_0" style="display: none;">
                          <div class="coloum70 floatL" ></div>
                          <span id="spanbcc_0" class="commonLink"><a href="javascript:showbccfun2_new(0)">{cfn:getmessage(202)}</a></span></div>
                        <div style="clear: both;"></div>
                        <span class="attachLink marginL10" ><a href="javascript:addfilefield('0_0')">
                        <div id="bodytest" style="display:none;"><img src="images/34.gif" border="0"></div>
                        <div id="forwardz" ></div>
                        <div id="attachlink_0_0" class="marginL10"><span><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner attach-a" alt=" "></span><span class="boldTxt">{cfn:getmessage(35)}</span></div>
                        </a></span>
                        <input type="hidden" value="" id="attachcount_0_0" name="attachcount_0_0"/>
                        <div style="clear: both;"></div>
                        <div class="attachwrap">
                          <div id="filedivcontainer_0_0_0" class="attachBox"></div>
                        </div>
                        <div style="clear: both;"></div>
                        <div id="additionalattach_0_0" class="attachLink" style="display: none"><a href="javascript:addfilefield('0_0')"><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner attach-a" alt=" ">{cfn:getmessage(60)} </a></div>
                        <div style="clear: both;"></div>
                        <div class="row " >
                          <div onKeyUp="autoSave(0)" class="nicedit_div_new" style="">
                            <textarea  name="mailBody_0_0"  class="nicedit_textarea_new" id="mailBody_0_0"></textarea>
                          </div>
                        </div>
                      </div>
                      <div class="mailBoxFooter" id="sendFooter" ><span class="mailBoxLF"></span><span class="mailBoxBM" style="padding-top:2px;">
                        <div class="sendBtn floatL"><a href="javascript:mailFurther(1,0,'0_0')">{cfn:getmessage(37)}</a></div>
                        <div class="commonBtn commonBtngc floatL"><a class="position_tooltip" href="javascript:mailFurther(2,0,'0_0')" title="{cfn:getmessage(36)}"><i class="fa fa-file-text"></i></a></div>
                        <div class="commonBtn commonBtngc floatL"><a class="position_tooltip" href="javascript:mailFurther(3,0,'0_0')" title="{cfn:getmessage(59)}"><i class="fa fa-trash"></i></a></div>
                        </span><span class="mailBoxRF"></span></div>
                    </div>
                  </div>
                </div>
              </div>
              <div name="contacts" id="contactsC" style="display: none;" class="contactPage">
                <div id="import_div" style="display:none; position:absolute;z-index:100;background-color:#FFFFFF;border:1px solid #CCC;margin:85px 200px;width:400px;height:200px;border-radius:5px;">
                  <div style="background: #0096B4;height: 30px;color: #FFFFFF;line-height: 32px;font-size: 14px;font-weight: bold;">&nbsp;Import Contacts <span style="padding: 4px 2px; float: right;"><a href="javascript: import_hide()" title="{cfn:getmessage(450)}"><i class="fa fa-times fachatbox" style="margin-right: 5px;
    margin-top: 4px;"></i></a></span> </div>
                  <div style="text-align: center;margin: 25px 0;"> <img src = 'images/google.png' alt='Google Connect' style="position: relative;"> <a href="JavaScript:newPopup('class/social_library/google_connected.php','google')" style="text-decoration: none;"> <span style="font-size: 13px;margin-left:5px;">Import gmail contacts</span> </a> </div>
                
                  <div style="text-align: center; margin:5px 0;"> <span style="font-size: 13px;margin-left:5px;"><b>OR</b></span></div>
                
                  <div style="text-align: center;margin:5px 0;"> 
           <span>Please select a Vcard file to upload.</span>
                  <form id="import_contacts_form" name="import_contacts_form" action="{url:(contacts/import_vcard)}" method="post" enctype="multipart/form-data">
         
                  <input type="file" name="vcard_holder" id="vcard_holder" onchange="Javascript:import_vcard(this);">
                  
                  </form>
                  
                  </div>
                
                
                </div>
                <!-- ---------------------------------Used for Contact Export -->
	
	
	<div id="export_div" style="display:none; position:absolute;z-index:100;background-color:#FFFFFF;border:1px solid #CCC;margin:85px 200px;width:400px;height:200px;border-radius:5px;">	

		
	  <div style="background: #0096B4;height: 30px;color: #FFFFFF;line-height: 32px;font-size: 14px;font-weight: bold;"> &nbsp;Export Contacts
	  <span style="padding: 4px 2px; float: right;"><a href="javascript: export_hide()" title="{cfn:getmessage(450)}"><i class="fa fa-times fachatbox" style="margin-right: 5px;
    margin-top: 4px;"></i></a></span>
	  </div>
	<div id="export_div1" style="text-align:center;margin: 50px 0"> 
	<!-- <img src ='images/vcard.jpg' height="50px" width="50px" alt='Vcard' style="position: relative;"> 
<a href="JavaScript:export_contacts(2)" style="text-decoration: none;"> <span style="font-size: 13px;margin-left:5px;">Vcard</span> </a> -->
	             <p>Select a file format to export:</p>
		</div>
		
		<div class="exportbtm_div" id="exportbtndiv">
        <!-- <button id="vcfbutton"  type="button" class="ui-state-default ui-corner-all">.vcf</button>
        <button id="csvbutton" type="button" class="ui-state-default ui-corner-all">.csv</button>
        <button onclick="javascript:export_hide()" type="button" class="ui-state-default ui-corner-all">Cancel</button> -->
        </div>
		
	
	
	</div>
	
	
	
	<!-- ---------------------------------Contact Export End -->
	
                <table border="0" class="" width="100%" cellpadding="0" cellspacing="0">
                 <!-- <tr>
                    <td colspan="2" ><div class="folderH">
                        <div class="folderLH"></div>
                        <div class="folderMH" align="left"><span id="c_heading" >{cfn:getmessage(209)}</span></div>
                        <div class="folderRH"></div>
                      </div></td>
                  </tr>-->
                 
                  <tr>
                    <td colspan="2"><div id="noContactDiv" style="display:none;padding:10px;" ></div></td>
                  </tr>
                  <!-- <tr><td colspan="2"  style="height:5px; font-size:5px">&nbsp;</td></tr> -->
                  <tr id="noContactTD" class="contactwrapeer">
                    <td valign="top" width="350px"  style="padding:0px;margin:0px;"><div class="cc_list" id="contactList" style="overflow:auto;"></div></td>
                    <td valign="top" align="left" class="conatctsrightTD" style="" ><div id="contactDetails" class="contactDetails"></div></td>
                  </tr>
                </table>
                <div style="height: auto;display: none;padding-left: 25px;" id="newcontact">
                  <div style="padding:20px 10px 10px 0px; font-weight:700;">{cfn:getmessage(24)}</div>
                  <table class="newContact" style="">
                    <tr>
                      <td><span class="boldTxt">{cfn:getmessage(40)} </span></td>
                      <td><input type="text" name="cfirstname" value="" size="30" id="cfirstname">
                        <strong><span class="mandatory">*</span></strong></td>
                    </tr>
                    <tr>
                      <td><span class="boldTxt">{cfn:getmessage(41)}</span></td>
                      <td><input type="text" name="clastname" id="clastname" value="" size="30" >
                        <strong><span class="mandatory">*</span></strong></td>
                    </tr>
                    <tr>
                      <td><span class="boldTxt">{cfn:getmessage(42)} </span></td>
                      <td><input type="text" name="cemail" id="cemail" value="" size="30">
                        <strong><span class="mandatory">*</span></strong></td>
                    </tr>
                    <tr>
                      <td><span class="boldTxt">{cfn:getmessage(43)} </span></td>
                      <td><input type="text" name="cdob" id="cdob" value="" size="30">
                        &nbsp;<font class="boldTxt">{cfn:getmessage(62)}</font></td>
                    </tr>
                    <tr>
                      <td><span class="boldTxt">{cfn:getmessage(44)} </span></td>
                      <td><input type="text" name="ctitle" id="ctitle" value="" size="30"></td>
                    </tr>
                    <tr>
                      <td><span class="boldTxt">{cfn:getmessage(45)} </span></td>
                      <td><input type="text" name="ccompany" id="ccompany" value="" size="30"></td>
                    </tr>
                    <tr>
                      <td><span class="boldTxt">{cfn:getmessage(46)} </span></td>
                      <td><input type="text" name="cphone" id="cphone" value="" size="30" ></td>
                    </tr>
                    <tr>
                      <td><span class="boldTxt">{cfn:getmessage(47)} </span></td>
                      <td><textarea name="caddress" id="caddress" rows="5" cols="35"></textarea></td>
                    </tr>
                    <tr>
                      <td><span class="boldTxt">{cfn:getmessage(48)}</span></td>
                      <td><input type="text" placeholder="http://www.example.com" name="cwebsite" id="cwebsite" value="" size="30"></td>
                    </tr>
                    <tr>
                      <td ><span class="boldTxt">{cfn:getmessage(49)} </span></td>
                      <td id="contact_dropdown" style="padding-left:0px;"><select name="cgroup" id="cgroup" class="SelectContact" >
                          <option selected="selected" value="0">{cfn:getmessage(453)}</option>
                          
                        
                       {loopstart:groups:1000} 
                      
                        
                          <option value="{$groups[0]}">{$groups[1]}</option>
                          
                        
                       {loopend:groups} 
                    
                      
                        </select></td>
                    </tr>
                    <tr>
                      <td><br>
                        &nbsp;</td>
                      <td align="left"><input type="submit" name="csubmit" value="{cfn:getmessage(63)} " onClick="submitNewContact()"></td>
                    </tr>
                  </table>
                </div>
              </div>
              <div name="settings" id="settings" style="display: none; " class="settingsPage">
                <!-- <div class="folderH">
                  <div class="folderLH"></div>
                  <div class="folderMH" align="left"><span id="s_heading" >{cfn:getmessage(454)}</span></div>
                  <div class="folderRH"></div>
                </div-->
                <div id="settingsDiv" class="settingsDiv"></div>
              </div>
              <table id="footer_table" cellpadding="0" cellspacing="0" align="center" border="0" width="100%">
                <tr>
                  <td align="center" valign="bottom"><div class="footer_table">
                      <div id="footer_txt_id" class="footer_txt">{$footer} {if($memoryusage_publicview_area==1)} <br>
                        <br>
                        {$memorymsg} {endif}</div>
                    </div></td>
                </tr>
              </table>
            </div>
          </div>
        
        <!-- second td close -->
        <div  id="rightads_td"  style="padding-top: 20px; background:#fff;padding-left:8px;overflow:hidden;width:193px;" > {if($rightadtype==1)} {noescape:$rightads} {else}
          <table id="rightads_div" cellpadding="0" cellspacing="0" class="rightads_table" style=" table-layout:fixed;" border="0">
            {loopstart:rightarray:100} {if($rightarray[0]!="")}
            <tr>
              <td style="padding-top:10px;overflow:hidden;width:20%;text-overflow:ellipsis;overflow:hidden; word-wrap:break-word;" valign="top" align="left" ><span class="right_ads_title"><a class="" href="{$rightarray[3]}">{noescape:$rightarray[0]}<br>
                </a></span><span class="right_ads_desc">{noescape:$rightarray[1]}<br>
                </span><span class="right_ads_url" style="padding-top:10px;overflow:hidden;width:20%;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;"> {noescape:$rightarray[2]}</span>{cfn:getbreak($rightarray[2])} </td>
            </tr>
            <tr style="line-height: 10px">
              <td class="" valign="top" align="left" >&nbsp;</td>
            </tr>
            {endif}{loopend:rightarray}
          </table>
          {endif} </div>
        <!-- third td close --> 
        </div>
      </div>
      <!-- first tr close --> 
      
    </div>
    <!-- closing table --> 
  </div>
</div>
<script type="text/javascript">
  
  function import_vcard()
  {        var res112=Validate_File(document.forms["import_contacts_form"]);
	  if(res112)
	  document.forms["import_contacts_form"].submit()
  }
  
  var _validFileExtensions = [".vcf", ".vcard"];    
  function Validate_File(oForm) {
      var arrInputs = oForm.getElementsByTagName("input");
      for (var i = 0; i < arrInputs.length; i++) {
          var oInput = arrInputs[i];
          if (oInput.type == "file") {
              var sFileName = oInput.value;
              if (sFileName.length > 0) {
                  var blnValid = false;
                  for (var j = 0; j < _validFileExtensions.length; j++) {
                      var sCurExtension = _validFileExtensions[j];
                      if (sFileName.substr(sFileName.length - sCurExtension.length, sCurExtension.length).toLowerCase() == sCurExtension.toLowerCase()) {
                          blnValid = true;
                          break;
                      }
                  }
                  
                  if (!blnValid) {
                      alert("Sorry, " + sFileName + " is invalid, allowed extensions are: " + _validFileExtensions.join(", "));
                      return false;
                  }
              }
          }
      }
    
      return true;
  }
function myTrim(x) {
    return x.replace(/^\s+|\s+$/gm,'');
}
function load_export()
{
	if(document.getElementById("export_div").style.display=="none")
	{	document.getElementById("export_div").style.display="";
	var contactids=encodeURI(contactidString);
	var current_contact_type=getCookievalue("currentcontact");
	var check=myTrim(contactidString);
	if(check=="" || current_contact_type==-1)
		{ 
		   document.getElementById("export_div1").innerHTML="<b>No Contacts available to export.</b>";
		   document.getElementById("exportbtndiv").style.display="none";
		}
	else
		{document.getElementById("export_div1").innerHTML="<p>Select a file format to export:</p>";
		   if(document.getElementById("exportbtndiv").style.display=="none")
			   document.getElementById("exportbtndiv").style.display="";
	var html="<button id='vcfbutton' onclick=\"window.open('{url:(contacts/exportcontacts/2/"+encodeURIComponent(contactids)+")}')\" type='button' class='ui-state-default ui-corner-all'>.vcf</button>";
   <!-- html+="<button id='csvbutton' type='button' class='ui-state-default ui-corner-all'>.csv</button>"; -->
    html+="<button onclick='javascript:export_hide()' type='button' class='ui-state-default ui-corner-all'>Cancel</button>";
     document.getElementById("exportbtndiv").innerHTML=html;
		}
	}
	else
		document.getElementById("export_div").style.display="none";
	
}
  
  

function export_hide()
{
if(document.getElementById("export_div").style.display=="")
document.getElementById("export_div").style.display="none";
}

 
  
  
  // Popup window code
  function newPopup(url,text) {
  
          popupWindow = window.open(
          url,'popUpWindow','height=700,width=800,left=10,top=10,resizable=yes,scrollbars=yes,toolbar=no,menubar=no,location=no,directories=no,status=yes')
  }
  
  //To implement Back Button
  function clickback()
  {
  	var prev_url=getCookievalue("backurl");
       var prev_url_temp=getCookievalue("prev_url_temp");

                    if(prev_url_temp!=="")
                     {
                           prev_url=prev_url_temp;//Assign Old Previous URL before Page Reload
                      SetCookie("prev_url_temp","",-1);
                     }
  	window.location.href=prev_url;
  	getCurrentSection();
  }
  
  
  
function loadScript(url, callback){

  var script = document.createElement("script")
  script.type = "text/javascript";

  if (script.readyState){  //IE
      script.onreadystatechange = function(){
          if (script.readyState == "loaded" ||
                  script.readyState == "complete"){
              script.onreadystatechange = null;
              callback();
          }
      };
  } else {  //Others
      script.onload = function(){
          callback();
      };
  }

  script.src = url;
  document.getElementsByTagName("head")[0].appendChild(script);
}
</script>
</body>
<script type="text/javascript" src="js/nicEdit.js.php"></script>
<script type="text/javascript" src="jslib/table.js.php"></script>
<script type="text/javascript">




function load_import()
{
if(document.getElementById("import_div").style.display=="none")
document.getElementById("import_div").style.display="";
else
document.getElementById("import_div").style.display="none";

}
function import_hide()
{
if(document.getElementById("import_div").style.display=="")
document.getElementById("import_div").style.display="none";
}
function import_contacts()
{
  var contact="mycontacts";
  var obj=this[contact];
var username=document.getElementById("username_c").value;
var password=document.getElementById("password_c").value;
username=encodeURIComponent(username);
password=encodeURIComponent(password);
  var url="{url:(contacts/import)}/"+username+"/"+password;
$.ajax({

type: "GET",cache: false,
url: url,
success: function(data) {
var x=data;
var x1=x.split("{nesote_c#123}");
data=x1[1];

  var c_total=data;
  SetCookie("mycontacts",c_total,1);
  var name="mycontacts";
  
      var arry=new Array(11);
      arry[0]='id';
      arry[1]='mailid';
      arry[2]='conatctgroup';
      arry[3]='firstname';
      arry[4]='lastname';
      arry[5]='date_of_birth';
      arry[6]='title';
      arry[7]='company';
      arry[8]='phone';
      arry[9]='address';
      arry[10]='website';
      
      this[obj]=new Table(name,arry,c_total,20);
      
  fetchContactAjax(this[obj],1,c_total,arry,c_total,2,name,contact);
  document.getElementById("import_div").style.display="none";
  window.location.reload();
  }

});
}
function fetchPageAjax(nam,pageNo,size,fieldz,totl,insrt,name)
{

var refresh_array=0;
if((Unread[0][2]==1)&&(name=="inbox"))
{
Unread[0][2]=0;
refresh_array=1;
}
else if((Unread[2][2]==1)&&(name=="sent"))
{
Unread[2][2]=0;
refresh_array=1;
}
else if((Unread[3][2]==1)&&(name=="spam"))
{
Unread[3][2]=0;
refresh_array=1;
}
else if((Unread[4][2]==1)&&(name=="trash"))
{
Unread[4][2]=0;
refresh_array=1;
}
else if((Unread[5][2]==1)&&(name=="starred"))
{
Unread[5][2]=0;
refresh_array=1;
}
for(var urdcnt=0;urdcnt<customFoldercount;urdcnt++)
{
if((Unread[urdcnt][2]==1)&&(Unread[urdcnt][0]==name))
{
Unread[urdcnt][2]=0;
refresh_array=1;
}
}


    
document.getElementById("mailC_load").value=0;

var currentTime=new Date();
var crntime=currentTime.getTime();

var current_url_w = window.location.hash;
SetCookie("flag_browser_back",current_url_w,1);

var advnc_search=document.getElementById("advance_search").value;
advnc_search=encodeURIComponent(advnc_search);
 
  if(advnc_search=="")
  var url="{url:(mail/getmails)}/"+name+"/"+pageNo+"/"+size+"/"+fieldz+"/"+totl+"/"+crntime;
  else
  var url="{url:(mail/getmails)}/"+name+"/"+pageNo+"/"+size+"/"+fieldz+"/"+totl+"/"+crntime+"/"+advnc_search;
  
  $.ajax({

type: "GET",cache: false,
url: url,
success: function(data) {$(document).ready(function(){//alert(data);
           var currentTime=new Date();
  var crntime=currentTime.toGMTString();
  
              var x=data;
              var x1=x.split("{nesote_count}");
              var x2=x1[0].split("{nesote_separator}");//alert(x2);
          var no_pages=Math.floor(totl/size);
          if((totl%size)!=0)
          no_pages=no_pages+1;
          var insrtPstn=parseInt((parseInt(pageNo)-parseInt(1))*size)+parseInt(1);
          var values=new Array(100);var mailcnt=x1[1];if(mailcnt==0)
          document.getElementById("mailC_load").value=1;
          for(var i=0;i<x1[1];i++)
          { 
              var x4=x2[i].split("{nesote_:}");
              x4[0]=x4[0].replace(/^[\s]+/,'').replace(/[\s]+$/,'').replace(/[\s]{2,}/,' ');//for trimming 
              var arry=new Array(14);
              for(var j=0;j<16;j++)
              {
                  var x3=x4[0].split("{nesote_,}");
                  arry[j]=x3[j];
              }
              nam.insertToposition(name,insrtPstn,arry);
              insrtPstn++;
              nam.totl++;
              var x5=x4[1].split("{nesote_ref}");//alert(x5);
              var insrt_flag=0;
              if((!isArrayAvailable(arry[14]) || (refresh_array==1)))
              {
                      
                      for(var i1=0;i1<x3[13];i1++)
                      {
                      
                          for(var i2=0;i2<19;i2++)
                          {
                              var x6=x5[i1].split("{nesote_,}");
                              x6[i2]=x6[i2];
                              
                          }
                          
                      
                          var namez=x6[17];//alert(x6[19]);
                          insertArray(namez,x6,x3[13]);
                      
                      }
                      
              }
              
          }
          
          var id=2;var itr=0;
       var opj=nam.getResultPage(name,pageNo,size);//alert(pageNo);
          var ss="<div id=\"additionalMail_1\" style=\"display: none;\";></div>";
         var ss1=ss;
          var mailid_array="";
          while(xx=nam.fetchRow(opj))
          {  
              if(xx[0]!="")
              {
              var mailId=xx[0];
              mailid_array=mailid_array+xx[14]+",";//alert(xx[12]);
              var subject=xx[5];
              if(subject=="" || subject==false)
              subject="{cfn:getmessage(472)}";
              var from=xx[1];
              var  from1=from.substring(from.length-1);
              if(from1==",")
              from=from.substring(0,from.length-1);
              if(xx[2]!="")
              var to=xx[2];
              else if(xx[3]!="")
              var to=xx[3];
              else
              var to=xx[4];
              
              var  to1=to.substring(to.length-1);
              if(to1==",")
              to=to.substring(0,to.length-1);
              if(xx[6]=="" || xx[6]==false)
              var mailContentShort="";
              else
              var mailContentShort=xx[6];
              
              if(xx[13]>1)
              var mailCount="("+xx[13]+")";
              else
              var mailCount="";


              
              if((name!="trash")&&(xx[15].substring(0,5)!="trash")&&(xx[15].substring(0,4)!="spam")&&name!="spam")//Exclude Spam Folder
              {
              if(xx[8]==0)
              var starflag="<a href=\"javascript:markstar("+mailId+","+pageNo+",1,0,'"+xx[14]+"','"+xx[15]+"')\"><img src=\"images/filler.gif\"  border=\"0\" align=\"absmiddle\" class=\"iconsCornner str-g\" alt=\" \"></a>";
              else
              var starflag="<a href=\"javascript:markstar("+mailId+","+pageNo+",0,0,'"+xx[14]+"','"+xx[15]+"')\"><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner str-y\" ></a>";
              
              }
              else if(name=="spam" || (xx[15].substring(0,4)=="spam"))//Exclude Spam Folder
            	  {
            	    starflag="<i class=\"fa fa-exclamation-triangle\"></i>";
            	  }
              else
              
              var starflag="<i class=\"fa fa-trash-o\"></i>";
              
              var hash_var=mailId+"/"+xx[14]+"/"+xx[15];
               hash_var=encode64(hash_var);
              var array_name=name;
              var time=xx[9];
              var attach=xx[10];
              //var attach="";
              var readflag=xx[7];
              if(readflag==1)
              {
                  var readclass="readmail";
                  var readcontent="readContent";
                  var twopaneMail="twopaneMailRead";

                  var threepaneMail="threepaneMailRead";

              }
              else
              {

                  var readclass="unreadmail";
                  var readcontent="unreadContent";
                  var twopaneMail="twopaneMailUnRead";
                  
                  var threepaneMail="threepaneMailUnRead";
                  
              }
                      
          ss=ss+"<div class=\""+twopaneMail+"\" id=\"twopaneMail_"+xx[0]+"\" onMouseOver=\"mouseoverMail("+mailId+",'"+name+"','"+nam+"','"+xx[14]+"')\" onMouseOut=\"mouseoutMail("+mailId+",'"+name+"','"+nam+"','"+xx[14]+"')\"><div id=\"shortDiv_mail_"+mailId+"\" class=\"mail-list-in\"><table class=\"mail-list-tbl\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"table-layout:fixed;border-collapse: collapse;height:40px;vertical-align:middle;\"><tr  ><td width=\"24px\" style=\"\"><input type=\"checkbox\" class=\"mailCheckBox\"  id=\"cb_"+xx[0]+"\" onClick=\"clickCheckbox("+mailId+",'"+name+"','"+nam+"',"+pageNo+",0,'"+xx[14]+"','"+xx[15]+"')\"></td><td width=\"22px\" style=\"\"><div class=\"star\" id=\"star_"+xx[0]+"\"  >"+starflag+"</div></td><td width=\"20%\"  style=\"text-overflow:ellipsis;overflow:hidden;white-space:nowrap;line-height:25px;vertical-align:middle;padding-left:5px;cursor: pointer;padding-right:15px;\"  onClick=\"clickonDiv('"+name+"',"+mailId+","+itr+",0,"+xx[13]+","+mailId+","+pageNo+",0,'"+xx[12]+"','"+xx[14]+"','"+xx[15]+"')\" >";
          
            if((name=='draft')||(name=='sent'))
              ss=ss+"<span class='readmail'><a href='#"+name+"/"+hash_var+"'>{cfn:getmessage(31)}:"+to+mailCount+"</a></span>";
              else
              {
                  ss=ss+"<span id='fromaddress_span"+xx[0]+"'class='"+readclass+"'><a href='#"+name+"/"+hash_var+"'>"+from+mailCount+"</a></span>";
              }
              ss=ss+"</td><td style=\"text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:55%;cursor:pointer;padding-left:10px;\"  onClick=\"clickonDiv('"+name+"',"+mailId+","+itr+",0,"+xx[13]+","+mailId+","+pageNo+",0,'"+xx[12]+"','"+xx[14]+"','"+xx[15]+"')\">";
              ss=ss+"<span  class='mail_sub_cont'><span  id='mailsubject_span"+xx[0]+"' class='"+readclass+"' ><a href='#"+name+"/"+hash_var+"'>"+subject+"</a>";
               ss=ss+"</span><span id='mailcontent_span"+xx[0]+"' class='"+readcontent+"'><a href='#"+name+"/"+hash_var+"'>";
             //console.log(ss);
               if(mailContentShort!="" && subject!="")
              ss=ss+"&nbsp;-&nbsp;";
              ss=ss+""+mailContentShort+"</a></span></span></td>";
              ss=ss+"<td width=\"32px\" style=\"padding-left:10px;cursor: pointer;\" onClick=\"clickonDiv('"+name+"',"+mailId+","+itr+",0,"+xx[13]+","+mailId+","+pageNo+",0,'"+xx[12]+"','"+xx[14]+"','"+xx[15]+"')\" ><div class=\"attachIcon\">"+attach+"</div></td><td onClick=\"clickonDiv('"+name+"',"+mailId+","+itr+",0,"+xx[13]+","+mailId+","+pageNo+",0,'"+xx[12]+"','"+xx[14]+"','"+xx[15]+"')\" style=\"cursor: pointer;\"><span class=\"fromDate_short\"><a href=\"#"+name+"/"+hash_var+"\" >"+time+"</a></span></td></table></div></div>";
              

              
              ss1=ss1+"<div onClick=\"clickonDiv('"+name+"',"+mailId+","+itr+",0,"+xx[13]+","+mailId+","+pageNo+",0,'"+xx[12]+"','"+xx[14]+"','"+xx[15]+"')\" class=\""+threepaneMail+"\" id=\"threepaneMail_"+xx[0]+"\" onMouseOver=\"mouseoverMail("+mailId+",'"+name+"','"+nam+"','"+xx[14]+"')\" onMouseOut=\"mouseoutMail("+mailId+",'"+name+"','"+nam+"','"+xx[14]+"')\"><div id=\"shortDiv_mail_"+mailId+"\" class=\"mail-list-in\"><table class=\"mail-list-tbl\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"table-layout:fixed;border-collapse: collapse;height:40px;vertical-align:middle;\"><tr><td width=\"10%\" style=\"\"><input type=\"checkbox\" class=\"mailCheckBox\"  id=\"cb1_"+xx[0]+"\" onClick=\"clickCheckbox("+mailId+",'"+name+"','"+nam+"',"+pageNo+",0,'"+xx[14]+"','"+xx[15]+"')\"></td><td width=\"10%\" style=\"\"><div class=\"star\" id=\"star_3pane_"+xx[0]+"\"  >"+starflag+"</div></td><td width=\"50%\"  style=\"text-overflow:ellipsis;overflow:hidden;white-space:nowrap;line-height:25px;vertical-align:middle;padding-left:5px;cursor: pointer;padding-right:15px;\"  onClick=\"clickonDiv('"+name+"',"+mailId+","+itr+",0,"+xx[13]+","+mailId+","+pageNo+",0,'"+xx[12]+"','"+xx[14]+"','"+xx[15]+"')\" >";
              
              if((name=='draft')||(name=='sent'))
                ss1=ss1+"<span class=\"readmail\"><a href=\"#"+name+"/"+hash_var+"\" >{cfn:getmessage(31)}:"+to+mailCount+"</a></span>";
                else
                {
                    ss1=ss1+"<span id=\"fromaddress_span"+xx[0]+"\" ";
                    
                    ss1=ss1+" class=\""+readclass+"\"><a href=\"#"+name+"/"+hash_var+"\" >"+from+mailCount+"</a></span>";
                }
                ss1=ss1+"</td><td style=\"text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:50%;cursor: pointer;padding-left:10px;\" width='30%' onClick=\"clickonDiv('"+name+"',"+mailId+","+itr+",0,"+xx[13]+","+mailId+","+pageNo+",0,'"+xx[12]+"','"+xx[14]+"','"+xx[15]+"')\" style=\"cursor: pointer;\"><span class=\"fromDate_short\"><a href=\"#"+name+"/"+hash_var+"\" >"+time+"</a></span></td></tr><tr><td colspan='4'style=\"text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:55%;cursor: pointer;padding-left:10px;\"  onClick=\"clickonDiv('"+name+"',"+mailId+","+itr+",0,"+xx[13]+","+mailId+","+pageNo+",0,'"+xx[12]+"','"+xx[14]+"','"+xx[15]+"')\">";
                ss1=ss1+"<span  class=\"mail_sub_cont\"><span  id=\"mailsubject_span"+xx[0]+"\" ";
                
                ss1=ss1+" class=\""+readclass+"\" ><a href=\"#"+name+"/"+hash_var+"\">"+subject+"</a>";
                    ss1=ss1+" </span></td></tr><tr><td style=\"text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:50%;cursor: pointer;padding-left:10px;\" colspan='4'><span id=\"mailcontent_span"+xx[0]+"\" onClick=\"clickonDiv('"+name+"',"+mailId+","+itr+",0,"+xx[13]+","+mailId+","+pageNo+",0,'"+xx[12]+"','"+xx[14]+"','"+xx[15]+"')\" class=\""+readcontent+"\" style=\"\"><a href=\"#"+name+"/"+hash_var+"\">";
                if(mailContentShort!="" && subject!="")
                ss1=ss1+"&nbsp;-&nbsp; ";
                ss1=ss1+""+mailContentShort+"</a></span></span></td></tr>";
                ss1=ss1+"<td width=\"32px\" style=\"padding-left:10px;cursor: pointer;\" onClick=\"clickonDiv('"+name+"',"+mailId+","+itr+",0,"+xx[13]+","+mailId+","+pageNo+",0,'"+xx[12]+"','"+xx[14]+"','"+xx[15]+"')\" ><div class=\"attachIcon\">"+attach+"</div></td></tr></table></div></div>";
                
              
              
              
              
              itr=itr+1;
          }
          }
          if(no_pages>1)
          {
              if(pageNo==1)
              {
                  var hash_var1="p"+no_pages;
               hash_var1=encode64(hash_var1);
               var hash_var2="p2";
               hash_var2=encode64(hash_var2);
                  ss=ss+"<div class=\"pageingDiv sddm\"> <a class=\"last_bvtn cntrl_btn\" href=\"#"+name+"/"+hash_var1+"\" onClick=\"javascript:mainWindow('"+name+"',"+no_pages+","+size+","+totl+",3)\"><span>{cfn:getmessage(431)}</span></a> <a class=\"prv_bvtn cntrl_btn\" href=\"#"+name+"/"+hash_var2+"\" onClick=\"javascript:mainWindow('"+name+"',2,"+size+","+totl+",2)\"><span>{cfn:getmessage(433)}</span></a></div>";
                  ss1=ss1+"<div class=\"pageingDiv sddm\"> <a class=\"last_bvtn cntrl_btn\" href=\"#"+name+"/"+hash_var1+"\" onClick=\"javascript:mainWindow('"+name+"',"+no_pages+","+size+","+totl+",3)\"><span>{cfn:getmessage(431)}</span></a> <a class=\"prv_bvtn cntrl_btn\" href=\"#"+name+"/"+hash_var2+"\" onClick=\"javascript:mainWindow('"+name+"',2,"+size+","+totl+",2)\"><span>{cfn:getmessage(433)}</span></a></div>";
              }
              else if(pageNo==no_pages)
              {
                       prev=parseInt(no_pages)-parseInt(1);
                       var hash_var1="p"+prev;
                       
                       hash_var1=encode64(hash_var1);
                       var hash_var2="p1";
                       hash_var2=encode64(hash_var2);
                  ss=ss+"<div class=\"pageingDiv sddm\"><a class=\"last_bvtn cntrl_btn\" href=\"#"+name+"/"+hash_var1+"\" onClick=\"javascript:mainWindow('"+name+"',"+prev+","+size+","+totl+",3)\"><span>{cfn:getmessage(432)}</span></a><a class=\"last_bvtn cntrl_btn\" href=\"#"+name+"/"+hash_var2+"\" onClick=\"javascript:mainWindow('"+name+"',1,"+size+","+totl+",2)\"><span>{cfn:getmessage(442)}</span></a></div>";	
                  ss1=ss1+"<div class=\"pageingDiv sddm\"><a class=\"last_bvtn cntrl_btn\" href=\"#"+name+"/"+hash_var1+"\" onClick=\"javascript:mainWindow('"+name+"',"+prev+","+size+","+totl+",3)\"><span>{cfn:getmessage(432)}</span></a><a class=\"last_bvtn cntrl_btn\" href=\"#"+name+"/"+hash_var2+"\" onClick=\"javascript:mainWindow('"+name+"',1,"+size+","+totl+",2)\"><span>{cfn:getmessage(442)}</span></a></div>";	

              }
              else
              {
                  prev=parseInt(pageNo)-parseInt(1);
                  next=parseInt(pageNo)+parseInt(1);
                  
                   var hash_var1="p"+next;
                   hash_var1=encode64(hash_var1);
                   var hash_var2="p"+prev;
                   hash_var2=encode64(hash_var2);
                      
                  ss=ss+"<div class=\"pageingDiv sddm\"><a  class=\"last_bvtn cntrl_btn\" href=\"#"+name+"/"+hash_var1+"\" onClick=\"javascript:mainWindow('"+name+"',"+next+","+size+","+totl+",2)\"><span>{cfn:getmessage(433)}</span></a><a class=\"last_bvtn cntrl_btn\" href=\"#"+name+"/"+hash_var2+"\" onClick=\"javascript:mainWindow('"+name+"',"+prev+","+size+","+totl+",3)\"><span>{cfn:getmessage(432)}</span></a></div>";
                  ss1=ss1+"<div class=\"pageingDiv sddm\"><a  class=\"last_bvtn cntrl_btn\" href=\"#"+name+"/"+hash_var1+"\" onClick=\"javascript:mainWindow('"+name+"',"+next+","+size+","+totl+",2)\"><span>{cfn:getmessage(433)}</span></a><a class=\"last_bvtn cntrl_btn\" href=\"#"+name+"/"+hash_var2+"\" onClick=\"javascript:mainWindow('"+name+"',"+prev+","+size+","+totl+",3)\"><span>{cfn:getmessage(432)}</span></a></div>";

              }
          }
          ss=ss+"";
          ss1=ss1+"";
          if(name.substring(0,6)!="search")
          getfolderName(name);
          //document.getElementById('loadingDiv').style.display="none";
          document.getElementById("short_detail").setAttribute("class", "short");
          document.getElementById('preloaddiv').style.display="";
          document.getElementById('preloadimage').style.display="none";
          if(document.getElementById('rightads_td').style.display=="")
              document.getElementById('rightads_td').style.display="none";
          if(itr==0)
          {document.getElementById('mailContent').innerHTML="<div class=\"warningTxt\"><i class='fa fa-exclamation-circle'></i> {cfn:getmessage(30)}</div> ";
          document.getElementById("mail_subheader").style.display="none";}
          else
          {
          
          $("#mailContent").html(ss);
          
          $("#mailContent11").html(ss1);
          
          addcontent(nam,pageNo,size,fieldz,totl,insrt,name,mailid_array);
          }
          
  });		
}
});
  
 
}

function addcontent(nam,pageNo,size,fieldz,totl,insrt,name,mailid_array)
{
	
  var fieldz=new Array(2);

  fieldz[0]="original_body";
  fieldz[1]="body";
$.ajax({

type: "GET",cache: false,
url: "{url:(mail/getmailsbody)}/"+name+"/"+pageNo+"/"+size+"/"+fieldz+"/"+totl+"/"+mailid_array+"/"+crntime,

success: function(data) { $(document).ready(function(){
var x=data;
              var x1=x.split("{nesote_count}");
              var x2=x1[0].split("{nesote_separator}");
  
              for(var i=0;i<x1[1];i++)
              {

              
              var x3=x2[i].split("{nesote_,}");//alert(x3);
      
                  x3[0]=x3[0].replace(/^[\s]+/,'').replace(/[\s]+$/,'').replace(/[\s]{2,}/,' ');//for trimming 
              if(x3[0]!="")
              {
              
                  var mailid=x3[0];
                  var body_ext=x3[1];
                  var body1=x3[3];
                  var ext_flag=x3[2];
                  var objct=x3[4];//alert(objct);
                  var org_folder=x3[5];
                  aValues=new Array(2);
                      aValues[0]=body1;
                      aValues[1]=body_ext;
                  
                      
                      
                      insertBody(objct,fieldz,aValues,mailid,org_folder);
                      document.getElementById("mailC_load").value=1;
                  
              
              }
              }
                  
          

});	
}
});

}

function changeReadflag(folderName,object)
{
      var currentTime=new Date();
      var crntime=currentTime.getTime();
      if(folderName=="chats")
      var url3="{url:(mail/changeChatreadflag)}/"+object+"/"+crntime;
      else
      var url3="{url:(mail/changereadflag)}/"+folderName+"/"+object+"/"+crntime;
      
      $.ajax({

type: "GET",cache: false,
url: url3,

success: function(data) {
              var x=data;
              //alert(x);
          }
      });
  
}
function insertBody(namez,fieldz,aValues,mailid,org_folder)
{
//console.log("\n"+namez);console.log("\n"+fieldz);console.log("\n"+aValues);console.log("\n"+mailid);console.log("\n"+org_folder+"\n");
var arz3=new Array(1);
arz3[0]=mailid;
arz3[1]=org_folder;
var arz4=new Array(1);
arz4[0]=org_folder;
this[namez].update(namez,fieldz,aValues);
this[namez].where('id=?',arz3);
this[namez].action();

}

/**This function is called when page is refreshed and mail is open
 * 
 */
function clickonDiv(names,mailId,pageNo,pageStatus,noConversations,currentId,mainPage,loopvariable,org_folder,object,search_object)
{	
	var c_theme=getCookievalue("Current_Theme");
	if(c_theme!="100")
		{
	//Fix Transparency for themes.
	
	document.getElementById("second_scroll").style.background="#FFFFFF";
	document.getElementById("footer_txt_id").style.color="#000000";
	document.getElementById("footer_txt_id").style.textShadow="none";
	//
	}
	
   var current_view=getCookievalue("current_view");

	var current_url1=window.location.href;
	var current_url2=current_url1.split("#");

	var remaining_url=encode64("p"+mainPage);
	remaining_url=names+"/"+remaining_url;
	var new_url=current_url2[0]+"#"+remaining_url;
	SetCookie("backurl",new_url,1);

	var foldername=getCookievalue("folder");
/*Coded for issues with mail open refresh**/
	disableReplylinks();
	disableReplylinksChat();
	/*End*/
	
	//console.log(foldername);
	var t_pattern1=/search0_(.*)$/i;//Define test patern for search
	var t_pattern2=/from?(.*)$/i;//Define test patern for advanced search
     var chk1=t_pattern1.test(foldername);
     var chk2=t_pattern2.test(foldername);
     
	//console.log("\n Search Status"+chk1);console.log("Advanced Search \n"+chk2);
    
     
     
   if(document.getElementById("backmailbtnid").style.display=="none" && current_view!="3pane" && (chk1!==true && chk2!==true))
	   {
	   //Check and displays Back Button if applicable.
	     
	     document.getElementById("backmailbtnid").style.display="";
	     

	   }
   //Reactivate Back Button.
	if(current_view=="3pane" && (foldername=="starred" || foldername=="draft"))
		{
	     document.getElementById("backmailbtnid").style.display="";
	   	}
	
	
	

if(isNaN(mainPage))
mainPage=getCookievalue("mail_page");

mail_open=1;

document.getElementById("preview").style.display="none";
header(names);

var folder_c=getCookievalue("folder");
var hash_url=encode64(mailId+"/"+object+"/"+search_object);
window.location.hash=folder_c+"/"+hash_url;
if(noConversations<=0)
  {
  findNoconvrstns(names,mailId,pageNo,pageStatus,noConversations,currentId,mainPage,loopvariable,org_folder,object,search_object);
  getfolderName(names);
  }
  else
  {
  document.getElementById("noConvrstns").value=noConversations;
  if(current_view=="3pane" && folder_c!="starred" && (chk1!==true && chk2!==true))
	  {
	  
	  //Added to show a loading image on  mail opening
		document.getElementById("msg_display").innerHTML="<div class=\"Load_info_msg\"><i class=\"fa fa-spinner fa-spin\"></i> {cfn:getmessage(451)}....</div>";
		  
	  clickonDiv3pane(names,mailId,pageNo,pageStatus,noConversations,currentId,mainPage,loopvariable,org_folder,object,search_object);

	  }
  else
	  {
	  clickonDiv3(names,mailId,pageNo,pageStatus,noConversations,currentId,mainPage,loopvariable,org_folder,object,search_object);
	    
	  }
  }
  var current_url_w = window.location.hash;
SetCookie("flag_browser_back",current_url_w,1);

  return true;
}
/**
This Function finds the conversation mails
*/
function findNoconvrstns(names,mailId,pageNo,pageStatus,noConversations,currentId,mainPage,loopvariable,org_folder,object,search_object)
{
var currentTime=new Date;var crntime=currentTime.getTime();
$.ajax({type:"GET",cache:false,
url:"{url:(mail/getconvrstns)}/"+org_folder+"/"+mailId+"/"+crntime,
success:function(data){var x=data;
document.getElementById("noConvrstns").value=x;
var current_view=getCookievalue("current_view");
if(current_view=="3pane")
{
	clickonDiv3pane(names,mailId,pageNo,pageStatus,x,currentId,mainPage,loopvariable,org_folder,object,search_object);
}
else
	{clickonDiv3(names,mailId,pageNo,pageStatus,x,currentId,mainPage,loopvariable,org_folder,object,search_object);}
}})};

function timeConverter(UNIX_timestamp){
var a = new Date(UNIX_timestamp*1000);
var months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
   var year = a.getFullYear();
   var month = months[a.getMonth()];
   var date = a.getDate();
   var hour = a.getHours();
   var min = a.getMinutes();
   var sec = a.getSeconds();
   var time = date+','+month+' '+year+' '+hour+':'+min+':'+sec ;
   return time;
}

var wait_timer=0,tm_1;

function clickonDiv3(names,mailId,pageNo,pageStatus,noConversations,currentId,mainPage,loopvariable,org_folder,object,search_object)
{ 
document.getElementById("splitbuttonid").style.display="none";
   
var c_view=getCookievalue('current_view');
	
	//Declare Global Variable Storing Email
	var email_content_store;
	//
  var mailC_load=document.getElementById("mailC_load").value;
  
     name=object; 
      var avail=isArrayAvailable(name);  
  
      if(avail>=1)
      {
      if(mailC_load==0)
      {
    	      if(wait_timer==5)
    	     {wait_timer=0;
    	     clearTimeout(tm_1);   
    	     window.location.reload();return false;
    		  }
         wait_timer++;
      document.getElementById("loadingDiv").style.display="";
      tm_1=setTimeout("clickonDiv3('"+names+"',"+mailId+","+pageNo+","+pageStatus+","+noConversations+","+currentId+","+mainPage+","+loopvariable+",'"+org_folder+"','"+object+"','"+search_object+"')",1000);
      return;
      }
      }
  {loopstart:customfolders:1000}
  {
      if('{$customfolders[1]}'==org_folder)
      {
          org_folder='custom{$customfolders[0]}';
      }
  }
  {loopend:customfolders}
  
  var arry=new Array(17);
  arry[0]='id';
  arry[1]='from_list';
  arry[2]='to_list';
  arry[3]='cc';
  arry[4]='bcc';
  arry[5]='subject';
  arry[6]='body';
  arry[7]='readflag';
  arry[8]='starflag';
  arry[9]='time';
  arry[10]='attach';
  arry[11]='mail_references';
  arry[12]='original_folder';
  arry[13]='original_body';
  arry[14]='cntnt_display';
  arry[15]='time_int';
  arry[16]='short_cntnt';
  arry[17]='object';
  arry[18]='date';
  arry[19]='search_object';
  var avail=isArrayAvailable(name);
  if(names!='draft')
  enableReplylinks();
  var mailDetails="";
  detail=1;
  

  if(avail==0)
  {
      this[name]=new Table(name,arry,noConversations,20);
  }

  if(pageStatus==0)
  {
      clickCheckbox(mailId,names,this[names],mainPage,1,object,search_object);
      var avail1=isArrayAvailable(names);
      if(avail1!=0)
      {
          if((names!='sent')&&(names!='draft')&&(names!='trash')&&(names!='starred'))
          { 
              //var aaaa=this[names].getResultItem(names,mailId);
              var aaaa=this[names].getResultItemM(names,currentId,mainPage,mailsPerpage);
              var asas=this[names].fetchRow(aaaa);
              var rdflg=asas[7];
              for(var urdcnt=0;urdcnt<customFoldercount;urdcnt++)
              {
                  if((Unread[urdcnt][0]==names)&&(rdflg==0))
                  Unread[urdcnt][1]=parseInt(Unread[urdcnt][1])-parseInt(1);
              }
          }
          var arz1=new Array(1);
          arz1[0]='readflag';
          var arz2=new Array(1)
          arz2[0]=1;
          var arz3=new Array(1);
          arz3[0]=mailId;
          //alert(org_folder);
          this[names].update(names,arz1,arz2);
          this[names].where('id=?',arz3);
          this[names].action();
          
         
         
         var all_obj=search_object.split(".");
         for(var i=0;i<((all_obj.length)-1);i++)
         {
           var all_object=all_obj[i].split("_");
           
          var avail2=isArrayAvailable(all_object[0]);
          var avail3=isArrayAvailable("starred");
          if(avail3!=0)
          { 
           var itemavail=this["starred"].isItemAvailable("starred",all_object[1]);
          if(itemavail!=0)
          {
          var ids1=new Array(1);
          ids1[0]=all_object[1];
          this["starred"].update(all_object[0],arz1,arz2);
          this["starred"].where('id=?',ids1);
          this["starred"].action();
          }
           
          }
          if(avail2!=0)
          {
              var itemavail1=this[all_object[0]].isItemAvailable(all_object[0],all_object[1]);
              if(itemavail1!=0)
              {
              var aaa=this[all_object[0]].getResultItemM(all_object[0],all_object[1],mainPage,mailsPerpage);
              var bbb=this[all_object[0]].fetchRow(aaa);
              var readflag=bbb[7];
              for(var urdcnt=0;urdcnt<customFoldercount;urdcnt++)
                  {
                  if((Unread[urdcnt][0]==all_object[0])&&(readflag==0))
                  Unread[urdcnt][1]=parseInt(Unread[urdcnt][1])-parseInt(1);
                  }
              var ids=new Array(1);
              ids[0]=all_object[1];
              this[all_object[0]].update(all_object[0],arz1,arz2);
              this[all_object[0]].where('id=?',ids);
              this[all_object[0]].action();
              }
          }
          
          }
      
          
      }
      
      var currentTime=new Date();
      var crntime=currentTime.getTime();
      if(name=="chats")
      var url31="{url:(mail/changeChatreadflag)}/"+mailId+"/"+crntime;
      else
      var url31="{url:(mail/changereadflag)}/"+name+"/"+mailId+"/"+crntime;
      changeReadflag(names,object);
      var avlble=this[name].isItemAvailable(name,currentId);
      var img_url="{url:(mail/adddisplaynow/)}";
          var img_url_a="{url:(mail/adddisplay/)}";
      if(avlble>=1)
      {
              
          var aa=this[name].getResultPage(object,1,noConversations);
          var no=1;var j=0;var a=1;
          var values=new Array(noConversations);
          var tble=" <div class=\"messageTab\" id=\"msg_div\"  style=\"display: none;\" ><span class=\"messageTabL\"></span>   <span class=\"messageTabM\" id=\"message\"></span>      <span class=\"messageTabR\"></span>       </div>";
          while(tempArray=this[name].fetchRow(aa))
          {
              values[j]=tempArray;
              j++;
          }
          for(var coUnt=parseInt(j)-parseInt(1);coUnt>=0;coUnt--)
          {	var a_new=parseInt(a)-parseInt(1);//console.log(values[coUnt]);
              var from=values[coUnt][1];
              var subject=values[coUnt][5];
              if(a==1)
                  tble=tble+"<h2>"+subject+"</h2><div class=\"mailBox\">";

              var readflag=values[coUnt][7];
          var mailTime=values[coUnt][9];
          var d = values[coUnt][15];
          
          var mailTime1=values[coUnt][18];
              if(values[coUnt][10]=="")
              var attach="";
              else
              var attach="<img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner attach-a\" alt=\" \">";
              var mailsId=values[coUnt][0];
              var designId=mailId+"_"+a_new;
              if((names!="trash")&&(search_object.substring(0,5)!="trash")&&(search_object.substring(0,4)!="spam")&&(names!="spam"))
              {
              if(values[coUnt][8]==0)
              var starField="<a href=\"javascript:markstar("+mailsId+","+mainPage+",1,"+mailId+",'"+object+"','"+search_object+"')\"><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner str-g\" alt=\" \"></a>";
              else
              var starField="<a href=\"javascript:markstar("+mailsId+","+mainPage+",0,"+mailId+",'"+object+"','"+search_object+"')\"><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner str-y\" alt=\" \"></a>";
              }
              else if(names=='spam'||(search_object.substring(0,4)=="spam"))
            	  {
            	  var starField="<i class=\"fa fa-exclamation-triangle\"></i>";
            	  }
              else
              var starField="<i class=\"fa fa-trash-o\"></i>";
          
                  
              if(values[coUnt][6]=="")
              var mailContentShort="";
              else
              var mailContentShort=reduceChar(values[coUnt][6]);
              var mailContent=values[coUnt][6];
              var no=a;
                  
              if((names=="draft")||(values[coUnt][12]=="draft"))
                  {	
                  document.getElementById("draftid_0_0").value=values[coUnt][0];
                  if(document.getElementById("filedivcontainer_0_0_0").style.display=="")
                      document.getElementById("filedivcontainer_0_0_0").style.display="none";
                  if(new_flag==0)
                      {
                      new_flag=1;
                      }
                      else if(new_flag==1)
                      {
                  
                    	  CKEDITOR.instances.mailBody_0_0.destroy();
                         
                    	  //nicEditor1.removeInstance('mailBody_0_0');
                      }
                  document.getElementById("mailContent").style.display="none";
                  document.getElementById("newMail").style.display="";
                  document.getElementById("to_0_0").value=values[coUnt][2];
                  if((trim(values[coUnt][3])!="")&&(trim(values[coUnt][4])!=""))
                  {
                      document.getElementById("cc_bcc_0").style.display="none";
                      document.getElementById("showcc_0").style.display="";
                      document.getElementById("cc_0_0").style.display="";
                      document.getElementById("cc_0_0").value=values[coUnt][3];
                      document.getElementById("showbcc_0").style.display="";
                      document.getElementById("bcc_0_0").style.display="";
                      document.getElementById("bcc_0_0").value=values[coUnt][4];
                  }
                  else if(trim(values[coUnt][3])!="")
                  {
                      document.getElementById("cc_bcc_0").style.display="none";
                      document.getElementById("showcc_0").style.display="";
                      document.getElementById("bcc_only_0").style.display="";
                      document.getElementById("cc_0_0").style.display="";
                      document.getElementById("cc_0_0").value=values[coUnt][3];
                  }
                  else if(trim(values[coUnt][4])!="")
                  {
                      document.getElementById("cc_bcc_0").style.display="none";
                      document.getElementById("showbcc_0").style.display="";
                      document.getElementById("cc_only_0").style.display="";
                      document.getElementById("bcc_0_0").style.display="";
                      document.getElementById("bcc_0_0").value=values[coUnt][4];
                  }
                  else
                  {
                      if(document.getElementById("cc_bcc_0").style.display=="none")
                      document.getElementById("cc_bcc_0").style.display="";
                      if(document.getElementById("showbcc_0").style.display=="")
                      document.getElementById("showbcc_0").style.display="none";
                      if(document.getElementById("cc_only_0").style.display=="")
                      document.getElementById("cc_only_0").style.display="none";
                      if(document.getElementById("bcc_only_0").style.display=="")
                      document.getElementById("bcc_only_0").style.display="none";	
                      if(document.getElementById("showcc_0").style.display=="")
                      document.getElementById("showcc_0").style.display="none";
                      if(document.getElementById("cc_0_0").style.display=="")
                      document.getElementById("cc_0_0").style.display="none";
                      if(document.getElementById("bcc_0_0").style.display=="")
                      document.getElementById("bcc_0_0").style.display="none";
                  }
                  if(values[coUnt][10]!="")
                  {
                      if(document.getElementById("additionalattach_0_0").style.display=="none")
                      document.getElementById("additionalattach_0_0").style.display="";
                      if(document.getElementById('attachlink_0_0').style.display=="")
                      document.getElementById('attachlink_0_0').style.display="none";
                      if(document.getElementById("forwardz").style.display=="none")
                      document.getElementById("forwardz").style.display="";
           if(filevar_a!=0)
          {
            for(var d=1;d<=filevar_a;d++)
            {
            if(document.getElementById("upload_target"+d))
             document.getElementById("upload_target"+d).style.display="none";
           }
          }document.getElementById("forwardz").innerHTML="";
                  createAttachmentdiv(values[coUnt][12],values[coUnt][0]);
                  }
                  else
                  {
                      filevar_a=0;
                      filevar_count=0;
                      if(document.getElementById("additionalattach_0_0").style.display=="")
                      document.getElementById("additionalattach_0_0").style.display="none";
                      if(document.getElementById('attachlink_0_0').style.display=="none")
                      document.getElementById('attachlink_0_0').style.display="";
                      if(document.getElementById("forwardz").style.display=="")
                      document.getElementById("forwardz").style.display="none";
         if(filevar_a!=0)
          {
            for(var d=1;d<=filevar_a;d++)
            {
            if(document.getElementById("upload_target"+d))
             document.getElementById("upload_target"+d).style.display="none";
           }
          }
                      if(document.getElementById("filedivcontainer_0_0_0").style.display=="")
                      document.getElementById("filedivcontainer_0_0_0").style.display="none";
                      
                  }
                  if(values[coUnt][5]!="")
                  document.getElementById("subject_0_0").value=values[coUnt][5];
                   //nicEditor1= new nicEditor({fullPanel : true}).panelInstance("mailBody_0_0");
      
                   CKEDITOR.replace('mailBody_0_0');
                   
                  var editor= CKEDITOR.instances.mailBody_0_0;
                  editor.setData(values[coUnt][6]);
                  //nicEditors.findEditor("mailBody_0_0").setContent(values[coUnt][6]);
              
                  
              }
              else
              {c_view=getCookievalue("current_view");
                  if((readflag==1)&&(coUnt>0))
                  {
                      if(values[coUnt][6]=="")
                      values[coUnt][6]="";
                      else
                      values[coUnt][6]=reduceChar(values[coUnt][6]);
                      if(c_view=="3pane")
                    	  tble=tble+"<div  id=\"mailDivshort_"+designId+"\" class=\"mailBoxTitle\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\" id=\"star_3pane_" +values[coUnt][0]+ "\" >"+starField+"</span><span  class=\"fromName\" ><a href=\"javascript:clickonDiv1('"+name+"','"+designId+"','"+values[coUnt][12]+"',"+values[coUnt][0]+","+pageNo+",'"+object+"','"+search_object+"');\">"+from+"</a></span><span class=\"titleContent\"><a href=\"javascript:clickonDiv1('"+name+"','"+designId+"','"+values[coUnt][12]+"',"+values[coUnt][0]+","+pageNo+",'"+object+"','"+search_object+"')\">"+mailContentShort+"</a></span></span><span class=\"mailBoxRT\"></span><span class=\"fromDate\"><a href=\"javascript:clickonDiv1('"+name+"','"+designId+"','"+values[coUnt][12]+"',"+values[coUnt][0]+","+pageNo+",'"+object+"','"+search_object+"')\">"+attach+"  "+mailTime+"</a></span></div>";
                      else
                      tble=tble+"<div  id=\"mailDivshort_"+designId+"\" class=\"mailBoxTitle\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\" id=\"star_" +values[coUnt][0]+ "\" >"+starField+"</span><span  class=\"fromName\" ><a href=\"javascript:clickonDiv1('"+name+"','"+designId+"','"+values[coUnt][12]+"',"+values[coUnt][0]+","+pageNo+",'"+object+"','"+search_object+"');\">"+from+"</a></span><span class=\"titleContent\"><a href=\"javascript:clickonDiv1('"+name+"','"+designId+"','"+values[coUnt][12]+"',"+values[coUnt][0]+","+pageNo+",'"+object+"','"+search_object+"')\">"+mailContentShort+"</a></span></span><span class=\"mailBoxRT\"></span><span class=\"fromDate\"><a href=\"javascript:clickonDiv1('"+name+"','"+designId+"','"+values[coUnt][12]+"',"+values[coUnt][0]+","+pageNo+",'"+object+"','"+search_object+"')\">"+attach+"  "+mailTime+"</a></span></div>";
                      tble=tble+"<div id=\"mailDiv_"+designId+"\" class=\"mailBoxOpened\" style=\"display: none;\"></div>";
                  }
                  else if(coUnt>0)
                  {
                    
                	  values[coUnt][11]=1;
                      tble=tble+"<div  id=\"mailDivshort_"+designId+"\" class=\"mailBoxTitle\"  style=\"display:none;\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\" id=\"star_" +values[coUnt][0]+ "\" >"+starField+"</span><span  class=\"fromName\" ><a href=\"javascript:clickonDiv('"+names+"',"+mailId+","+no+",1,"+noConversations+","+mailsId+","+pageNo+","+a_new+",'"+org_folder+"','"+object+"');\">"+from+"</a></span><span class=\"titleContent\"><a href=\"javascript:clickonDiv('"+names+"',"+mailId+","+no+",1,"+noConversations+","+mailsId+","+pageNo+","+a_new+",'"+org_folder+"','"+object+"')\">"+mailContentShort+"</a></span></span><span class=\"mailBoxRT\"></span><span class=\"fromDate\"><a href=\"javascript:clickonDiv('"+names+"',"+mailId+","+no+",1,"+noConversations+","+mailsId+","+pageNo+","+a_new+",'"+org_folder+"','"+object+"','"+search_object+"')\">"+attach+" "+mailTime+"</a></span></div>";
                      tble=tble+"<div id=\"mailDiv_"+designId+"\" class=\"mailBoxOpened\" >";
                      if(c_view=="3pane")
                      tble=tble+"<div id=\"short_"+designId+"\" class=\"mailBoxTitle\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\" id=\"star_3pane_" +values[coUnt][0]+ "\" >"+starField+"</span><span  class=\"fromName\" ><a href=\"javascript: hide('"+designId+"')\" >{cfn:getmessage(54)}:"+from+"</a></span> <span class=\"showDetailBtn\"><a href=\"javascript:showDetails('"+designId+"');\">{cfn:getmessage(282)}</a></span></span><span class=\"mailBoxRT\"></span><span class=\"fromDate\"><a href=\"javascript:showDetails('"+designId+"');\">"+mailTime+"</a></span></div>";
                      else
                      tble=tble+"<div id=\"short_"+designId+"\" class=\"mailBoxTitle\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\" id=\"star_" +values[coUnt][0]+ "\" >"+starField+"</span><span  class=\"fromName\" ><a href=\"javascript: hide('"+designId+"')\" >{cfn:getmessage(54)}:"+from+"</a></span> <span class=\"showDetailBtn\"><a href=\"javascript:showDetails('"+designId+"');\">{cfn:getmessage(282)}</a></span></span><span class=\"mailBoxRT\"></span><span class=\"fromDate\"><a href=\"javascript:showDetails('"+designId+"');\">"+mailTime+"</a></span></div>";
                      if(c_view=="3pane")
                      tble=tble+"<div  class=\"mailBoxTitle\" style=\"display: none;\" id=\"detail_"+designId+"\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\"  id=\"star_3pane_" +values[coUnt][0]+ "\" >"+starField+"</span><span  class=\"fromName\" >{cfn:getmessage(54)}:"+from+"</span>	<span class=\"showDetailBtn\"> <a href=\"javascript:hideDetails('"+designId+"')\">{cfn:getmessage(283)}</a></span></span><span class=\"mailBoxRT\"></span>";
                      else
                      tble=tble+"<div  class=\"mailBoxTitle\" style=\"display: none;\" id=\"detail_"+designId+"\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\"  id=\"star_" +values[coUnt][0]+ "\" >"+starField+"</span><span  class=\"fromName\" >{cfn:getmessage(54)}:"+from+"</span>	<span class=\"showDetailBtn\"> <a href=\"javascript:hideDetails('"+designId+"')\">{cfn:getmessage(283)}</a></span></span><span class=\"mailBoxRT\"></span>";
                      tble=tble+"<span class=\"fromDate noArrow\"><div class=\"in\">"+mailTime+"</div></span></div>";
                      tble=tble+"<div class=\"mailBoxM\"   ><div class=\"row\" id=\"detail1_"+designId+"\" style=\"display:none;\"><div class=\"detailedList\" >";
                      if(values[coUnt][2]!="")
                      tble=tble+"<div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(31)}:</div><div class=\"row floatL\"><div>"+values[coUnt][2]+"</div></div></div><div style=\"clear:both\"></div>";
                      if(values[coUnt][3]!="")
                      tble=tble+"<div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(32)}:</div><div class=\"row floatL\"><div>"+values[coUnt][3]+"</div></div></div><div style=\"clear:both\"></div>";
                      tble=tble+"<div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(34)}:</div><div class=\"row floatL\"><div>"+values[coUnt][5]+"</div></div></div><div style=\"clear:both\"></div><div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(383)}:</div><div class=\"row floatL\"><div>"+mailTime1+"</div></div></div></div></div><div style=\"clear:both\"></div>";
                      
                      if((values[coUnt][14]!=0)&&(values[coUnt][6]!=values[coUnt][13]) && org_folder!="sent")
                      {
                          tble=tble+"<div class=\"row imageDisplay\"  align=\"center\" id=\"imagez_"+designId+"\"><span style=\"font-weight:700;\">{cfn:getmessage(216)}</span><a href=\"javascript:display_image('"+name+"','"+designId+"',"+values[coUnt][0]+",'"+values[coUnt][12]+"','"+img_url+"')\">{cfn:getmessage(217)}</a><span style=\"padding:2px;\">&nbsp;|&nbsp;</span><a href=\"javascript:display_imagealltime('"+name+"','"+designId+"',"+values[coUnt][0]+",'"+values[coUnt][12]+"','"+img_url_a+"')\">{cfn:getmessage(218)} "+from+"</a>";
                         <!-- tble=tble+"</div><span class=\"mailContent\" id=\"contentmaildiv_"+designId+"\" >"+mailContent+"</span>"; -->
                         tble=tble+"</div><iframe frameborder='0' scrolling='yes'  onload='javascript:resizeIframe(this);' id=\"mail_frame"+designId+"\" src='{url:(mail/mail_message_frame/"+designId+")}'></iframe>";
                       	 email_content_store=mailContent;
                         
                      }
                      else
                      { 
                        	  <!-- tble=tble+"<span class=\"mailContent\" id=\"contentmaildiv_"+designId+"\"0 >"+values[coUnt][6]+"</span>"; -->
                     
                        	 tble=tble+"<iframe frameborder='0' scrolling='yes'  onload='javascript:resizeIframe(this);' id=\"mail_frame"+designId+"\" src='{url:(mail/mail_message_frame/"+designId+")}'></iframe>";
                           	 email_content_store=values[coUnt][6];

                      }
                    if(name!="draft")
                      {
                          if(values[coUnt][10]!="")
                              {
                                  var ar=new Array(100);
                              ar=values[coUnt][10].split(",");
                                  for(var k=0;k<(ar.length);k++)
                                  {
                                      var pathArray=ar[k].split("::");
                                      var path=pathArray[0];var attachName=pathArray[1];
                                  tble=tble+"<div class=\"row\" style=\"padding-left:10px;width:100%;\">";
                                      if(pathArray[5]==1)
                                      tble=tble+"<span  class=\"attachedImage\"><img width=\"100px\" height=\"150px\" src=\""+path+"\"></span><span class=\"attachments\">"+attachName+"</span><span class=\"attachments\" >";
                                      else
                                      tble=tble+"<span  class=\"attachedImage_nb\"><img  src=\""+path+"\"></span><span class=\"attachments\">"+attachName+"</span><span class=\"attachments\" >";
                                      if(pathArray[5]==1)
                                      tble=tble+"<a href=\"{url:(mail/showimage)}/"+pathArray[2]+"/"+pathArray[3]+"/"+pathArray[4]+"\" target=\"_blank\"> {cfn:getmessage(102)} </a></span><span class=\"attachments\" >";

                                      tble=tble+"<a href=\"{url:(mail/downloadattachment)}/"+pathArray[2]+"/"+pathArray[3]+"/"+pathArray[6]+"/"+pathArray[4]+"\"><i class=\"fa fa-download\"></i> {cfn:getmessage(101)} </a></span></div><div style=\"clear:both\"></div>";
                                  }
                              }
                           tble=tble+"</div>";
                           var url_mail="{url:(mail/createdraft)}";var url_print="{url:(mail/printmail/)}"+values[coUnt][12]+"/"+mailsId;
                          tble=tble+"<div class=\"mailBoxFooter\" id=replyfooter1_"+designId+"><span class=\"mailBoxLF\"></span><span class=\"mailBoxBM\"><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-r\" alt=\" \"></span><a href=\"javascript:createDraft("+mailsId+",'"+names+"',"+no+",'"+name+"',1,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(15)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-a\" alt=\" \"></span><a href=\"javascript:createDraft("+mailsId+",'"+names+"',"+no+",'"+name+"',2,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(16)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-f\" alt=\" \"></span><a href=\"javascript:createDraft("+mailsId+",'"+names+"',"+no+",'"+name+"',3,'"+designId+"','"+url_mail+"')\"> {cfn:getmessage(17)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner print-btn\"></span><a href="+url_print+" target=\"_blank\">{cfn:getmessage(646)}</a></div></span><span class=\"mailBoxRF\"></span></div>";
                          tble=tble+"<div id=reply_"+designId+" style=\"display: none;\" class=\"replyWindow\">";
                          tble=tble+"<div class=\"row\" style=\"display: none;\"  id=replyfooter2_"+designId+" style=\"padding-top:5px;\"><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-r\" alt=\" \"></span><a href=\"javascript:createDraft("+mailsId+",'"+names+"',"+no+",'"+name+"',1,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(15)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-a\" alt=\" \"></span><a href=\"javascript:createDraft("+mailsId+",'"+names+"',"+no+",'"+name+"',2,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(16)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-f\" alt=\" \"></span><a href=\"javascript:createDraft("+mailsId+",'"+names+"',"+no+",'"+name+"',3,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(17)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner print-btn\"></span><a href="+url_print+" target=\"_blank\">{cfn:getmessage(646)}</a></div></div>";
                          tble=tble+"</div>";
                      }
                      tble=tble+"</div>";
                  }
                  else
                  {
                      c_view=getCookievalue("current_view");
          
                      var url_mail="{url:(mail/createdraft)}";var url_print="{url:(mail/printmail/)}"+values[coUnt][12]+"/"+mailsId;
                      tble=tble+"<div id=\"mailDiv_"+designId+"\" class=\"mailBoxOpened\">";
                      if(c_view=="3pane")
                      tble=tble+"<div id=\"short_"+designId+"\" class=\"mailBoxTitle\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\"  id=\"star_3pane_" +values[coUnt][0]+ "\" >"+starField+"</span>";
                      else
                      tble=tble+"<div id=\"short_"+designId+"\" class=\"mailBoxTitle\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\"  id=\"star_" +values[coUnt][0]+ "\" >"+starField+"</span>";
                      tble=tble+"<span  class=\"fromName\" >{cfn:getmessage(54)}:"+from+"</span> <span class=\"showDetailBtn\"><a href=\"javascript:showDetails('"+designId+"');\">{cfn:getmessage(282)}</a></span></span><span class=\"mailBoxRT\"></span><!-- <span id=\"mailactionsdrop\" class=\"fromDate noArrow\"><div class=\"popup\"><a href=\"javascript:createDraft("+mailsId+",'"+name+"',"+no+",'"+names+"',1,'"+designId+"','"+url_mail+"')\" class=\"fromDate noArrow\"><div class=\"in\">{cfn:getmessage(15)}</div></a><a href=\"javascript:createDraft("+mailsId+",'"+name+"',"+no+",'"+names+"',2,'"+designId+"','"+url_mail+"')\" class=\"fromDate noArrow\"><div class=\"in\">{cfn:getmessage(16)}</div></a><a href=\"javascript:createDraft("+mailsId+",'"+name+"',"+no+",'"+names+"',3,'"+designId+"','"+url_mail+"')\" class=\"fromDate noArrow\"><div class=\"in\">{cfn:getmessage(17)}</div></a><a class=\"fromDate noArrow\" href="+url_print+" target=\"_blank\"><div class=\"in\">{cfn:getmessage(646)}</div></a></div><div class=\"in\"><img class=\"iconsCornner arLt\" alt=\"\" src=\"images/filler.gif\"></div></span> --><span class=\"fromDate noArrow\"><div class=\"in\">"+attach+" "+mailTime+"</div></span></div>";
                      if(c_view=="3pane")
                      tble=tble+"<div  class=\"mailBoxTitle\" style=\"display: none;\" id=\"detail_"+designId+"\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\"  id=\"star_3pane_" +values[coUnt][0]+ "\" >"+starField+"</span><span  class=\"fromName\" >{cfn:getmessage(54)}:"+from+"</span>	<span class=\"showDetailBtn\"> <a href=\"javascript:hideDetails('"+designId+"')\">{cfn:getmessage(283)}</a></span></span><span class=\"mailBoxRT\"></span>";
                      else
                      tble=tble+"<div  class=\"mailBoxTitle\" style=\"display: none;\" id=\"detail_"+designId+"\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\"  id=\"star_" +values[coUnt][0]+ "\" >"+starField+"</span><span  class=\"fromName\" >{cfn:getmessage(54)}:"+from+"</span>	<span class=\"showDetailBtn\"> <a href=\"javascript:hideDetails('"+designId+"')\">{cfn:getmessage(283)}</a></span></span><span class=\"mailBoxRT\"></span>";
                      tble=tble+"<span class=\"fromDate noArrow\"><div class=\"in\">"+mailTime+"</div></span></div>";
                      tble=tble+"<div class=\"mailBoxM\"   ><div class=\"row\" id=\"detail1_"+designId+"\" style=\"display:none;\"><div class=\"detailedList\" >";
                      if(values[coUnt][2]!="")
                      tble=tble+"<div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(31)}:</div><div class=\"row floatL\"><div>"+values[coUnt][2]+"</div></div></div><div style=\"clear:both\"></div>";
                      if(values[coUnt][3]!="")
                      tble=tble+"<div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(32)}:</div><div class=\"row floatL\"><div>"+values[coUnt][3]+"</div></div></div><div style=\"clear:both\"></div>";
                      tble=tble+"<div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(34)}:</div><div class=\"row floatL\"><div>"+values[coUnt][5]+"</div></div></div><div style=\"clear:both\"></div><div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(383)}:</div><div class=\"row floatL\"><div>"+mailTime1+"</div></div></div></div></div><div style=\"clear:both\"></div>";
                      
                      if((values[coUnt][14]!=0)&&(values[coUnt][6]!=values[coUnt][13]) && org_folder!="sent")
                      {
                          tble=tble+"<div class=\"row imageDisplay\"  align=\"center\" id=\"imagez_"+designId+"\"><span style=\"font-weight:700;\">{cfn:getmessage(216)}</span><br><a href=\"javascript:display_image('"+name+"','"+designId+"',"+values[coUnt][0]+",'"+values[coUnt][12]+"','"+img_url+"')\">{cfn:getmessage(217)}</a><span style=\"padding:2px;\">&nbsp;|&nbsp;</span><a href=\"javascript:display_imagealltime('"+name+"','"+designId+"',"+values[coUnt][0]+",'"+values[coUnt][12]+"','"+img_url_a+"')\">{cfn:getmessage(218)} "+from+"</a>";
                          <!-- tble=tble+"</div><span class=\"mailContent\" id=\"contentmaildiv_"+designId+"\" >"+mailContent+"</span>"; -->
                          tble=tble+"</div><iframe frameborder='0' scrolling='yes'  onload='javascript:resizeIframe(this);' id=\"mail_frame"+designId+"\" src='{url:(mail/mail_message_frame/"+designId+")}'></iframe>";
                      	 email_content_store=mailContent;

                      }
                      else
                      { 
                    	<!--  tble=tble+"<span class=\"mailContent\" id=\"contentmaildiv_"+designId+"\" >"+values[coUnt][13]+"</span>"; -->
                    	
                     	  tble=tble+"<iframe frameborder='0' scrolling='yes'  onload='javascript:resizeIframe(this);' name='mail_frame' id=\"mail_frame"+designId+"\" src='{url:(mail/mail_message_frame/"+designId+")}'></iframe>";
                     	 email_content_store=values[coUnt][13];
                      
                      }
                    
                      
                      if(name!="draft")
                      {
                          if(values[coUnt][10]!="")
                          {
                              var ar=new Array(100);
                              ar=values[coUnt][10].split(",");
                          for(var k=0;k<(ar.length);k++)
                                  {
                                      var pathArray=ar[k].split("::");
                                      var path=pathArray[0];var attachName=pathArray[1];
                                      tble=tble+"<div class=\"row\" style=\"padding-left:10px;width:100%;\">";
                                      if(pathArray[5]==1)
                                      tble=tble+"<span  class=\"attachedImage\"><img width=\"100px\" height=\"150px\" src=\""+path+"\"></span><span class=\"attachments\">"+attachName+"</span><span class=\"attachments\" >";
                                      else
                                      tble=tble+"<span  class=\"attachedImage_nb\"><img  src=\""+path+"\"></span><span class=\"attachments\">"+attachName+"</span><span class=\"attachments\" >";
                                      if(pathArray[5]==1)
                                      tble=tble+"<a href=\"{url:(mail/showimage)}/"+pathArray[2]+"/"+pathArray[3]+"/"+pathArray[4]+"\" target=\"_blank\"> {cfn:getmessage(102)} </a></span><span class=\"attachments\" >";
          tble=tble+"<a href=\"{url:(mail/downloadattachment)}/"+pathArray[2]+"/"+pathArray[3]+"/"+pathArray[6]+"/"+pathArray[4]+"\"><i class=\"fa fa-download\"></i> {cfn:getmessage(101)} </a></span></div><div style=\"clear:both\"></div>";
                                  }
                          }
                            tble=tble+"</div>";
                            var url_mail="{url:(mail/createdraft)}";var url_print="{url:(mail/printmail/)}"+values[coUnt][12]+"/"+mailsId;
                          tble=tble+"<div class=\"mailBoxFooter\" id=replyfooter1_"+designId+"><span class=\"mailBoxLF\"></span><span class=\"mailBoxBM\"><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-r\" alt=\" \"></span><a href=\"javascript:createDraft("+mailsId+",'"+name+"',"+no+",'"+names+"',1,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(15)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-a\" alt=\" \"></span><a href=\"javascript:createDraft("+mailsId+",'"+name+"',"+no+",'"+names+"',2,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(16)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-f\" alt=\" \"></span><a href=\"javascript:createDraft("+mailsId+",'"+name+"',"+no+",'"+names+"',3,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(17)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner print-btn\"></span><a href="+url_print+" target=\"_blank\">{cfn:getmessage(646)}</a></div></span><span class=\"mailBoxRF\"></span></div>";
                          tble=tble+"<div id=reply_"+designId+" style=\"display: none;\" class=\"replyWindow\">";
                          tble=tble+"<div class=\"row\" style=\"display: none;\"  id=replyfooter2_"+designId+" style=\"padding-top:5px;\"><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-r\" alt=\" \"></span><a href=\"javascript:createDraft("+mailsId+",'"+name+"',"+no+",'"+names+"',1,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(15)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-a\" alt=\" \"></span><a href=\"javascript:createDraft("+mailsId+",'"+name+"',"+no+",'"+names+"',2,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(16)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-f\" alt=\" \"></span><a href=\"javascript:createDraft("+mailsId+",'"+name+"',"+no+",'"+names+"',3,'"+designId+"','"+url_mail+"')\"> {cfn:getmessage(17)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner print-btn\"></span><a href="+url_print+" target=\"_blank\">{cfn:getmessage(646)}</a></div></div>";
                          tble=tble+"</div>";
                      }
                      tble=tble+"";
                  }
              }
              

a++;
              
          }

          document.getElementById('preloaddiv').style.display="";
          document.getElementById('preloadimage').style.display="none";
          
         
          document.getElementById('mailContent').innerHTML=tble;
          if(names!="draft")
            writeToFrame(email_content_store,designId); 
         
          document.getElementById("short_detail").setAttribute("class", "detailmail");
          document.getElementById('mailContent').style.width="100%";
              if(names!="draft")
              {
                  if(right_ads_status!=0)//Check Global Ad display Status.
                {
                 if(document.getElementById('rightads_td').style.display=="none")
                  {document.getElementById('rightads_td').style.display="";					
                    
                   document.getElementById('mailPageOuterid').style.right="201px";
                  }
                }
                  
                  
              }
              else
              {
                  document.getElementById('rightads_td').style.display="none";
                      document.getElementById('mailPageOuterid').style.right="0px";

              }
          document.getElementById("loadingDiv").style.display="none";
      
       for(var i=0;i<((all_obj.length)-1);i++)
         {
         if(isArrayAvailable(all_obj[i]))
          {
           var inr_objct=this[all_obj[i]];
           var op=inr_objct.getResultPage(all_obj[i],1,50);
           while(aa=inr_objct.fetchRow(op))
           {
             var ids1=new Array(1);
             ids1[0]=aa[0];
             inr_objct.update(all_obj[i],arz1,arz2);
             inr_objct.where('id=?',ids1);
             inr_objct.action();
           }
          }
         }
          
          
      }
      else
      { //Executed is mail is open and refreshed
    	  if(right_ads_status!=0)//Check Global Ad display Status.
			{              
    	  document.getElementById('mailPageOuterid').style.right="201px";
			}           
      
          fetchDetails(names,currentId,this[name],arry,1,pageNo,1,mailId,mainPage,org_folder,object,search_object);
          
          
      }
      setUnreadcount();
  }
  else
  {

      var designId=mailId+"_"+loopvariable;
      var  loopvariable1=parseInt(loopvariable)+parseInt(1);
      var avlble=this[name].isPageAvailable(name,loopvariable1,1);
      var sep=name.split("_");
      if(avlble==1)
      {
                  var aa=this[name].getResultItemM(name,currentId,1,mailsPerpage);
          var no=1;
          while(mailDetails=this[name].fetchRow(aa))
          { 
                  if(mailDetails[11]==1)
                  {
                      if(mailDetails[10]=="")
                      var attach="";
                      else
                      var attach="<img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner attach-a\" alt=\" \">";
                      if(names!="trash"&&names!="spam")
                      {
                      if(mailDetails[8]==0)
                      var starField="<a href=\"javascript:markstar("+currentId+","+mainPage+",1,"+currentId+",'"+object+"'+'"+search_object+"')\"><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner str-g\" alt=\" \"></a>";
                      else
                      var starField="<a href=\"javascript:markstar("+currentId+","+mainPage+",0,"+currentId+",'"+object+"','"+search_object+"')\"><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner str-y\" alt=\" \"></a>";
                      }
                       else if(names=="spam")
                         {var starField="<i class=\"fa fa-exclamation-triangle\"></i>";}                                                   
                      else
                      var starField="<i class=\"fa fa-trash-o\"></i>";
                      
                      var mailContent=mailDetails[6];
                      var from=mailDetails[1];
                      var subject=mailDetails[5];
                      var mailsId=mailDetails[0];
                          var tble="";

                      var readflag=mailDetails[7];
                      var mailTime=mailDetails[9];
                      tble=tble+"<div id=\"mailDiv_"+designId+"\" class=\"mailBoxOpened\" >";
                      if(c_view=="3pane")
                      tble=tble+"<div id=\"short_"+designId+"\" class=\"mailBoxTitle\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\" id=\"star_3pane_" +mailDetails[0]+ "\" >"+starField+"</span><span  class=\"fromName\" ><a href=\"javascript: hide('"+designId+"')\" >{cfn:getmessage(54)}:"+from+"</a></span> <span class=\"showDetailBtn\"><a href=\"javascript:showDetails('"+designId+"');\">{cfn:getmessage(282)}</a></span></span><span class=\"mailBoxRT\"></span><span class=\"fromDate\"><a href=\"javascript:showDetails('"+designId+"');\">"+mailTime+"</a></span></div>";
                      else                                                                                                                                                                                   
                      tble=tble+"<div id=\"short_"+designId+"\" class=\"mailBoxTitle\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\" id=\"star_" +mailDetails[0]+ "\" >"+starField+"</span><span  class=\"fromName\" ><a href=\"javascript: hide('"+designId+"')\" >{cfn:getmessage(54)}:"+from+"</a></span> <span class=\"showDetailBtn\"><a href=\"javascript:showDetails('"+designId+"');\">{cfn:getmessage(282)}</a></span></span><span class=\"mailBoxRT\"></span><span class=\"fromDate\"><a href=\"javascript:showDetails('"+designId+"');\">"+mailTime+"</a></span></div>";
                      if(c_view=="3pane")
                      tble=tble+"<div  class=\"mailBoxTitle\" style=\"display: none;\" id=\"detail_"+designId+"\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\"  id=\"star_3pane_" +mailDetails[0]+ "\" >"+starField+"</span><span  class=\"fromName\" >{cfn:getmessage(54)}:"+from+"</span>	<span class=\"showDetailBtn\"> <a href=\"javascript:hideDetails('"+designId+"')\">{cfn:getmessage(283)}</a></span></span><span class=\"mailBoxRT\"></span>";
                      else
                      tble=tble+"<div  class=\"mailBoxTitle\" style=\"display: none;\" id=\"detail_"+designId+"\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\"  id=\"star_" +mailDetails[0]+ "\" >"+starField+"</span><span  class=\"fromName\" >{cfn:getmessage(54)}:"+from+"</span>	<span class=\"showDetailBtn\"> <a href=\"javascript:hideDetails('"+designId+"')\">{cfn:getmessage(283)}</a></span></span><span class=\"mailBoxRT\"></span>";
                      tble=tble+"<span class=\"fromDate\">"+mailTime+"</span></div>";
                      tble=tble+"<div class=\"mailBoxM\"   ><div class=\"row\" id=\"detail1_"+designId+"\" style=\"display:none;\"><div class=\"detailedList\" >";
                      if(mailDetails[2]!="")
                      tble=tble+"<div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(31)}:</div><div class=\"row floatL\"><div>"+mailDetails[2]+"</div></div></div><div style=\"clear:both\"></div>";
                      if(mailDetails[3]!="")
                      tble=tble+"<div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(32)}:</div><div class=\"row floatL\"><div>"+mailDetails[3]+"</div></div></div><div style=\"clear:both\"></div>";
                      tble=tble+"<div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(34)}:</div><div class=\"row floatL\"><div>"+mailDetails[5]+"</div></div></div><div style=\"clear:both\"></div><div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(383)}:</div><div class=\"row floatL\"><div>"+mailDetails[9]+"</div></div></div></div></div><div style=\"clear:both\"></div>";
                      
                      if((mailDetails[14]!=0)&&(mailDetails[6]!=mailDetails[13]) && org_folder!="sent")
                      {
                             tble=tble+"<div class=\"row imageDisplay\"  align=\"center\" id=\"imagez_"+designId+"\"><span style=\"font-weight:700;\">{cfn:getmessage(216)}</span><a href=\"javascript:display_image('"+name+"','"+designId+"',"+mailDetails[0]+",'"+mailDetails[12]+"','"+img_url+"')\">{cfn:getmessage(217)}</a><span style=\"padding:2px;\">&nbsp;|&nbsp;</span><a href=\"javascript:display_imagealltime('"+name+"','"+designId+"',"+mailDetails[0]+",'"+mailDetails[12]+"','"+img_url_a+"')\">{cfn:getmessage(218)} "+from+"</a>";
                             //tble=tble+"</div><span class=\"mailContent\" id=\"contentmaildiv_"+designId+"\" >"+mailContent+"</span>";
                               tble=tble+"</div><iframe name='mail_frame' frameborder='0' scrolling='yes'  onload='javascript:resizeIframe(this);' id=\"mail_frame"+designId+"\" src='{url:(mail/mail_message_frame/"+designId+")}'></iframe>";
                       	 email_content_store=mailContent;
                             tble=tble+"</div>";
                             
                      
                      }
                      else
                      {
                    	  tble=tble+"</div><iframe name='mail_frame' frameborder='0' scrolling='yes'  onload='javascript:resizeIframe(this);' id=\"mail_frame"+designId+"\" src='{url:(mail/mail_message_frame/"+designId+")}'></iframe>";
                       	 email_content_store=mailDetails[13];
                    	  //tble=tble+"<span class=\"mailContent\" id=\"contentmaildiv_"+designId+"\" >"+mailDetails[13]+"</span>";
                      }
                      tble=tble+"</div>";
                      
              
                      if((name!="draft")&&(mailDetails[12]!="draft"))
                      {
                          if(mailDetails[10]!="")
                          {
                              var ar=new Array(100);
                              ar=mailDetails[10].split(",");
                              for(var k=0;k<(ar.length);k++)
                              {
                                  var pathArray=ar[k].split("::");
                                  var path=pathArray[0];var attachName=pathArray[1];
                                  tble=tble+"<div class=\"row\" style=\"padding-left:10px;width:100%;\">";
                                      if(pathArray[5]==1)
                                      tble=tble+"<span  class=\"attachedImage\"><img width=\"100px\" height=\"150px\" src=\""+path+"\"></span><span class=\"attachments\">"+attachName+"</span><span class=\"attachments\" >";
                                      else
                                      tble=tble+"<span  class=\"attachedImage_nb\"><img  src=\""+path+"\"></span><span class=\"attachments\">"+attachName+"</span><span class=\"attachments\" >";
                                      if(pathArray[5]==1)
                                      tble=tble+"<a href=\"{url:(mail/showimage)}/"+pathArray[2]+"/"+pathArray[3]+"/"+pathArray[4]+"\" target=\"_blank\"> {cfn:getmessage(102)} </a></span><span class=\"attachments\" >";
                                      tble=tble+"<a href=\"{url:(mail/downloadattachment)}/"+pathArray[2]+"/"+pathArray[3]+"/"+pathArray[6]+"/"+pathArray[4]+"\"><i class=\"fa fa-download\"></i> {cfn:getmessage(101)} </a></span></div><div style=\"clear:both\"></div>";
                              }
                          }
                          var url_mail="{url:(mail/createdraft)}";var url_print="{url:(mail/printmail/)}"+mailDetails[12]+"/"+currentId;
                          tble=tble+"<div class=\"mailBoxFooter\" id=replyfooter1_"+designId+"><span class=\"mailBoxLF\"></span><span class=\"mailBoxBM\"><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-r\" alt=\" \"></span><a href=\"javascript:createDraft("+currentId+",'"+name+"',"+no+",'"+sep[0]+"',1,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(15)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-a\" alt=\" \"></span><a href=\"javascript:createDraft("+currentId+",'"+name+"',"+no+",'"+sep[0]+"',2,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(16)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" alt=\" \" class=\"iconsCornner reply-f\"></span><a href=\"javascript:createDraft("+currentId+",'"+name+"',"+no+",'"+sep[0]+"',3,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(17)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner print-btn\"></span><a href="+url_print+" target=\"_blank\">{cfn:getmessage(646)}</a></div></span><span class=\"mailBoxRF\"></span></div>";
                          tble=tble+"<div id=reply_"+designId+" style=\"display: none;\" class=\"replyWindow\">";
                          tble=tble+"<div class=\"row\" style=\"display: none;\"  id=replyfooter2_"+designId+" style=\"padding-top:5px;\"><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" alt=\" \" align=\"absmiddle\" class=\"iconsCornner reply-r\"></span><a href=\"javascript:createDraft("+currentId+",'"+name+"',"+no+",'"+sep[0]+"',1,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(15)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-a\"></span><a href=\"javascript:createDraft("+currentId+",'"+name+"',"+no+",'"+sep[0]+"',2,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(16)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-f\"></span><a href=\"javascript:createDraft("+currentId+",'"+name+"',"+no+",'"+sep[0]+"',3,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(17)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner print-btn\"></span><a href="+url_print+" target=\"_blank\">{cfn:getmessage(646)}</a></div></div>";
                          tble=tble+"</div>";
                      }
                      tble=tble+"</div>";
                      
                      
                      document.getElementById('mailDivshort_'+designId).style.display="none";
                      document.getElementById('mailDiv_'+designId).style.display="";
                      document.getElementById('mailDiv_'+designId).innerHTML=tble;
                      if(name!="draft")
                      writeToFrame(email_content_store,designId);
                  }
                  else if(no==1)
                  {
                  
                      fetchDetailResults(names,mailId,arry,1,pageNo,1,names,mailId,loopvariable,object,search_object);
                      
                  }
              
              
              no=no+1;
          
          }
          if(no==1)
          {
              fetchDetailResults(names,mailId,arry,1,pageNo,1,names,mailId,loopvariable,object,search_object);
          }
              
      }
      else
      {
          fetchDetailResults(names,mailId,arry,1,pageNo,1,names,mailId,loopvariable,object,search_object);
      }
  
  }
  
}


function writeToFrame(html_string,design_id) {
	
	//Added to support cross browser testing.
	 var iframe = document.getElementById('mail_frame'+design_id);
	//step 2: obtain the document associated with the iframe tag
	 
	     //most of the browser supports .document. Some supports (such as the NetScape series) .contentDocumet, while some (e.g. IE5/6) supports .contentWindow.document
	 
	     //we try to read whatever that exists.
	 
	     var iframedoc = iframe.document;
	 
	         if (iframe.contentDocument)
	 
	             iframedoc = iframe.contentDocument;
	 
	         else if (iframe.contentWindow)
	 
	             iframedoc = iframe.contentWindow.document;
	 
	  
	 
	      if (iframedoc){
	 
	          // Put the content in the iframe
	 
	          iframedoc.open();
	 
	          iframedoc.writeln(html_string);
	 
	          iframedoc.close();
	 
	      } else {
	 
	         //just in case of browsers that don't support the above 3 properties.
	 
	         //fortunately we don't come across such case so far.
	 
	         alert('Cannot inject dynamic contents into iframe.');
	 
	      }

	
	//var iframe = window.frames["mail_frame"].document;
	//iframe.open();
	//iframe.write(email_content);
	//iframe.close();
	}


/*The below function checks the mail stataus*/
function mail_exists_status(mailid)
{
	
}
var tm_1;


// Called for 3Pane Mail Viewing
function clickonDiv3pane(names,mailId,pageNo,pageStatus,noConversations,currentId,mainPage,loopvariable,org_folder,object,search_object)
{ 
	// Check the mail 
	//document.getElementById("threepaneMail_"+mailId).className = "tickedselect1";

	SetCookie("current_open_mail",mailId,1);

	//Declare Global Variable Storing Email Content
	var email_content_store;
	//
  var mailC_load=document.getElementById("mailC_load").value;
  
  name=object;
      var avail=isArrayAvailable(name);
  
      if(avail>=1)
      {
      if(mailC_load==0)
      {
    	  
          if(wait_timer==5)
 	     {wait_timer=0;
 	    clearTimeout(tm_1);
 		    window.location.reload();return false;
 		  }
      wait_timer++;
       document.getElementById("loadingDiv").style.display="";
       tm_1=setTimeout("clickonDiv3pane('"+names+"',"+mailId+","+pageNo+","+pageStatus+","+noConversations+","+currentId+","+mainPage+","+loopvariable+",'"+org_folder+"','"+object+"','"+search_object+"')",1000);
      return;
      }
      }
  {loopstart:customfolders:1000}
  {
      if('{$customfolders[1]}'==org_folder)
      {
          org_folder='custom{$customfolders[0]}';
      }
  }
  {loopend:customfolders}
  
  var arry=new Array(17);
  arry[0]='id';
  arry[1]='from_list';
  arry[2]='to_list';
  arry[3]='cc';
  arry[4]='bcc';
  arry[5]='subject';
  arry[6]='body';
  arry[7]='readflag';
  arry[8]='starflag';
  arry[9]='time';
  arry[10]='attach';
  arry[11]='mail_references';
  arry[12]='original_folder';
  arry[13]='original_body';
  arry[14]='cntnt_display';
  arry[15]='time_int';
  arry[16]='short_cntnt';
  arry[17]='object';
  arry[18]='date';
  arry[19]='search_object';
  var avail=isArrayAvailable(name);
  if(names!='draft')
  enableReplylinks();
  var mailDetails="";
  detail=1;
  

  if(avail==0)
  {
      this[name]=new Table(name,arry,noConversations,20);
  }

  if(pageStatus==0)
  {
      clickCheckbox(mailId,names,this[names],mainPage,1,object,search_object);
      var avail1=isArrayAvailable(names);
      if(avail1!=0)
      {
          if((names!='sent')&&(names!='draft')&&(names!='trash')&&(names!='starred'))
          { 
              //var aaaa=this[names].getResultItem(names,mailId);
              var aaaa=this[names].getResultItemM(names,currentId,mainPage,mailsPerpage);
              var asas=this[names].fetchRow(aaaa);
              var rdflg=asas[7];
              for(var urdcnt=0;urdcnt<customFoldercount;urdcnt++)
              {
                  if((Unread[urdcnt][0]==names)&&(rdflg==0))
                  Unread[urdcnt][1]=parseInt(Unread[urdcnt][1])-parseInt(1);
              }
          }
          var arz1=new Array(1)
          arz1[0]='readflag';
          var arz2=new Array(1)
          arz2[0]=1;
          var arz3=new Array(1);
          arz3[0]=mailId;
          //alert(org_folder);
          this[names].update(names,arz1,arz2);
          this[names].where('id=?',arz3);
          this[names].action();
          
         
         
         var all_obj=search_object.split(".");
         for(var i=0;i<((all_obj.length)-1);i++)
         {
           var all_object=all_obj[i].split("_");
           
          var avail2=isArrayAvailable(all_object[0]);
          var avail3=isArrayAvailable("starred");
          if(avail3!=0)
          { 
           var itemavail=this["starred"].isItemAvailable("starred",all_object[1]);
          if(itemavail!=0)
          {
          var ids1=new Array(1);
          ids1[0]=all_object[1];
          this["starred"].update(all_object[0],arz1,arz2);
          this["starred"].where('id=?',ids1);
          this["starred"].action();
          }
           
          }
          if(avail2!=0)
          {
              var itemavail1=this[all_object[0]].isItemAvailable(all_object[0],all_object[1]);
              if(itemavail1!=0)
              {
              var aaa=this[all_object[0]].getResultItemM(all_object[0],all_object[1],mainPage,mailsPerpage);
              var bbb=this[all_object[0]].fetchRow(aaa);
              var readflag=bbb[7];
              for(var urdcnt=0;urdcnt<customFoldercount;urdcnt++)
                  {
                  if((Unread[urdcnt][0]==all_object[0])&&(readflag==0))
                  Unread[urdcnt][1]=parseInt(Unread[urdcnt][1])-parseInt(1);
                  }
              var ids=new Array(1);
              ids[0]=all_object[1];
              this[all_object[0]].update(all_object[0],arz1,arz2);
              this[all_object[0]].where('id=?',ids);
              this[all_object[0]].action();
              }
          }
          
          }
      
          
      }
      
      var currentTime=new Date();
      var crntime=currentTime.getTime();
      if(name=="chats")
      var url31="{url:(mail/changeChatreadflag)}/"+mailId+"/"+crntime;
      else
      var url31="{url:(mail/changereadflag)}/"+name+"/"+mailId+"/"+crntime;
      changeReadflag(names,object);
      var avlble=this[name].isItemAvailable(name,currentId);
      var img_url="{url:(mail/adddisplaynow/)}";
          var img_url_a="{url:(mail/adddisplay/)}";
      if(avlble>=1)
      {
              
          var aa=this[name].getResultPage(object,1,noConversations);
          var no=1;var j=0;var a=1;
          var values=new Array(noConversations);
          var tble=" <div class=\"messageTab\" id=\"msg_div\"  style=\"display: none;\" ><span class=\"messageTabL\"></span>   <span class=\"messageTabM\" id=\"message\"></span>      <span class=\"messageTabR\"></span>       </div>";
          while(tempArray=this[name].fetchRow(aa))
          {
              values[j]=tempArray;
              j++;
          }
          for(var coUnt=parseInt(j)-parseInt(1);coUnt>=0;coUnt--)
          {	var a_new=parseInt(a)-parseInt(1);
              var from=values[coUnt][1];
              var subject=values[coUnt][5];
              if(a==1)
                  tble=tble+"<h2>"+subject+"</h2><div class=\"mailBox\">";

              var readflag=values[coUnt][7];
          var mailTime=values[coUnt][9];
          var d = values[coUnt][15];
          
          var mailTime1=values[coUnt][18];
              if(values[coUnt][10]=="")
              var attach="";
              else
              var attach="<img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner attach-a\" alt=\" \">";
              var mailsId=values[coUnt][0];
              var designId=mailId+"_"+a_new;
              if((names!="trash")&&(search_object.substring(0,5)!="trash")&&(search_object.substring(0,4)!="spam")&&names!="spam")
              {
              if(values[coUnt][8]==0)
              var starField="<a href=\"javascript:markstar("+mailsId+","+mainPage+",1,"+mailId+",'"+object+"','"+search_object+"')\"><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner str-g\" alt=\" \"></a>";
              else
              var starField="<a href=\"javascript:markstar("+mailsId+","+mainPage+",0,"+mailId+",'"+object+"','"+search_object+"')\"><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner str-y\" alt=\" \"></a>";
              }
              else if(names=='spam'||(search_object.substring(0,4)=="spam"))
        	  {
        	  var starField="<i class=\"fa fa-exclamation-triangle\"></i>";
        	  }
              else
              var starField="<i class=\"fa fa-trash-o\"></i>";
          
                  
              if(values[coUnt][6]=="")
              var mailContentShort="";
              else
              var mailContentShort=reduceChar(values[coUnt][6]);
              var mailContent=values[coUnt][6];
              var no=a;
                  
              if((names=="draft")||(values[coUnt][12]=="draft"))
                  {	
                  document.getElementById("draftid_0_0").value=values[coUnt][0];
                  if(document.getElementById("filedivcontainer_0_0_0").style.display=="")
                      document.getElementById("filedivcontainer_0_0_0").style.display="none";
                  if(new_flag==0)
                      {
                      new_flag=1;
                      }
                      else if(new_flag==1)
                      {
                  
                    	  CKEDITOR.instances.mailBody_0_0.destroy();
                         
                    	  //nicEditor1.removeInstance('mailBody_0_0');
                      }
                  document.getElementById("mailContent").style.display="none";
                  document.getElementById("newMail").style.display="";
                  document.getElementById("to_0_0").value=values[coUnt][2];
                  if((trim(values[coUnt][3])!="")&&(trim(values[coUnt][4])!=""))
                  {
                      document.getElementById("cc_bcc_0").style.display="none";
                      document.getElementById("showcc_0").style.display="";
                      document.getElementById("cc_0_0").style.display="";
                      document.getElementById("cc_0_0").value=values[coUnt][3];
                      document.getElementById("showbcc_0").style.display="";
                      document.getElementById("bcc_0_0").style.display="";
                      document.getElementById("bcc_0_0").value=values[coUnt][4];
                  }
                  else if(trim(values[coUnt][3])!="")
                  {
                      document.getElementById("cc_bcc_0").style.display="none";
                      document.getElementById("showcc_0").style.display="";
                      document.getElementById("bcc_only_0").style.display="";
                      document.getElementById("cc_0_0").style.display="";
                      document.getElementById("cc_0_0").value=values[coUnt][3];
                  }
                  else if(trim(values[coUnt][4])!="")
                  {
                      document.getElementById("cc_bcc_0").style.display="none";
                      document.getElementById("showbcc_0").style.display="";
                      document.getElementById("cc_only_0").style.display="";
                      document.getElementById("bcc_0_0").style.display="";
                      document.getElementById("bcc_0_0").value=values[coUnt][4];
                  }
                  else
                  {
                      if(document.getElementById("cc_bcc_0").style.display=="none")
                      document.getElementById("cc_bcc_0").style.display="";
                      if(document.getElementById("showbcc_0").style.display=="")
                      document.getElementById("showbcc_0").style.display="none";
                      if(document.getElementById("cc_only_0").style.display=="")
                      document.getElementById("cc_only_0").style.display="none";
                      if(document.getElementById("bcc_only_0").style.display=="")
                      document.getElementById("bcc_only_0").style.display="none";	
                      if(document.getElementById("showcc_0").style.display=="")
                      document.getElementById("showcc_0").style.display="none";
                      if(document.getElementById("cc_0_0").style.display=="")
                      document.getElementById("cc_0_0").style.display="none";
                      if(document.getElementById("bcc_0_0").style.display=="")
                      document.getElementById("bcc_0_0").style.display="none";
                  }
                  if(values[coUnt][10]!="")
                  {
                      if(document.getElementById("additionalattach_0_0").style.display=="none")
                      document.getElementById("additionalattach_0_0").style.display="";
                      if(document.getElementById('attachlink_0_0').style.display=="")
                      document.getElementById('attachlink_0_0').style.display="none";
                      if(document.getElementById("forwardz").style.display=="none")
                      document.getElementById("forwardz").style.display="";
           if(filevar_a!=0)
          {
            for(var d=1;d<=filevar_a;d++)
            {
            if(document.getElementById("upload_target"+d))
             document.getElementById("upload_target"+d).style.display="none";
           }
          }document.getElementById("forwardz").innerHTML="";
                  createAttachmentdiv(values[coUnt][12],values[coUnt][0]);
                  }
                  else
                  {
                      filevar_a=0;
                      filevar_count=0;
                      if(document.getElementById("additionalattach_0_0").style.display=="")
                      document.getElementById("additionalattach_0_0").style.display="none";
                      if(document.getElementById('attachlink_0_0').style.display=="none")
                      document.getElementById('attachlink_0_0').style.display="";
                      if(document.getElementById("forwardz").style.display=="")
                      document.getElementById("forwardz").style.display="none";
         if(filevar_a!=0)
          {
            for(var d=1;d<=filevar_a;d++)
            {
            if(document.getElementById("upload_target"+d))
             document.getElementById("upload_target"+d).style.display="none";
           }
          }
                      if(document.getElementById("filedivcontainer_0_0_0").style.display=="")
                      document.getElementById("filedivcontainer_0_0_0").style.display="none";
                      
                  }
                  if(values[coUnt][5]!="")
                  document.getElementById("subject_0_0").value=values[coUnt][5];
                   //nicEditor1= new nicEditor({fullPanel : true}).panelInstance("mailBody_0_0");
      
                   CKEDITOR.replace('mailBody_0_0');
                   
                  var editor= CKEDITOR.instances.mailBody_0_0;
                  editor.setData(values[coUnt][6]);
                  //nicEditors.findEditor("mailBody_0_0").setContent(values[coUnt][6]);
              
                  
              }
              else
              {c_view=getCookievalue("current_view");
                  if((readflag==1)&&(coUnt>0))
                  {
                      if(values[coUnt][6]=="")
                      values[coUnt][6]="";
                      else
                      values[coUnt][6]=reduceChar(values[coUnt][6]);
                      if(c_view=="3pane")
                      tble=tble+"<div  id=\"mailDivshort_"+designId+"\" class=\"mailBoxTitle\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\" id=\"star_3pane_" +values[coUnt][0]+ "\" >"+starField+"</span><span  class=\"fromName\" ><a href=\"javascript:clickonDiv1('"+name+"','"+designId+"','"+values[coUnt][12]+"',"+values[coUnt][0]+","+pageNo+",'"+object+"','"+search_object+"');\">"+from+"</a></span><span class=\"titleContent\"><a href=\"javascript:clickonDiv1('"+name+"','"+designId+"','"+values[coUnt][12]+"',"+values[coUnt][0]+","+pageNo+",'"+object+"','"+search_object+"')\">"+mailContentShort+"</a></span></span><span class=\"mailBoxRT\"></span><span class=\"fromDate\"><a href=\"javascript:clickonDiv1('"+name+"','"+designId+"','"+values[coUnt][12]+"',"+values[coUnt][0]+","+pageNo+",'"+object+"','"+search_object+"')\">"+attach+"  "+mailTime+"</a></span></div>";
                      else
                      tble=tble+"<div  id=\"mailDivshort_"+designId+"\" class=\"mailBoxTitle\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\" id=\"star_" +values[coUnt][0]+ "\" >"+starField+"</span><span  class=\"fromName\" ><a href=\"javascript:clickonDiv1('"+name+"','"+designId+"','"+values[coUnt][12]+"',"+values[coUnt][0]+","+pageNo+",'"+object+"','"+search_object+"');\">"+from+"</a></span><span class=\"titleContent\"><a href=\"javascript:clickonDiv1('"+name+"','"+designId+"','"+values[coUnt][12]+"',"+values[coUnt][0]+","+pageNo+",'"+object+"','"+search_object+"')\">"+mailContentShort+"</a></span></span><span class=\"mailBoxRT\"></span><span class=\"fromDate\"><a href=\"javascript:clickonDiv1('"+name+"','"+designId+"','"+values[coUnt][12]+"',"+values[coUnt][0]+","+pageNo+",'"+object+"','"+search_object+"')\">"+attach+"  "+mailTime+"</a></span></div>";
                      tble=tble+"<div id=\"mailDiv_"+designId+"\" class=\"mailBoxOpened\" style=\"display: none;\"></div>";
                  }
                  else if(coUnt>0)
                  {var current_view=getCookievalue('current_view');
                     //Addded to get design id unique for 2 views
                     if(current_view=="3pane")
                     designId=designId+"3pane";
                     //Ends Here
                	  values[coUnt][11]=1;//alert(values[coUnt][6]);
                      if(c_view=="3pane")
                  	  tble=tble+"<div  id=\"mailDivshort_"+designId+"\" class=\"mailBoxTitle\"  style=\"display:none;\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\" id=\"star_3pane_" +values[coUnt][0]+ "\" >"+starField+"</span><span  class=\"fromName\" ><a href=\"javascript:clickonDiv('"+names+"',"+mailId+","+no+",1,"+noConversations+","+mailsId+","+pageNo+","+a_new+",'"+org_folder+"','"+object+"');\">"+from+"</a></span><span class=\"titleContent\"><a href=\"javascript:clickonDiv('"+names+"',"+mailId+","+no+",1,"+noConversations+","+mailsId+","+pageNo+","+a_new+",'"+org_folder+"','"+object+"')\">"+mailContentShort+"</a></span></span><span class=\"mailBoxRT\"></span><span class=\"fromDate\"><a href=\"javascript:clickonDiv('"+names+"',"+mailId+","+no+",1,"+noConversations+","+mailsId+","+pageNo+","+a_new+",'"+org_folder+"','"+object+"','"+search_object+"')\">"+attach+" "+mailTime+"</a></span></div>";
                  	  else
                	  tble=tble+"<div  id=\"mailDivshort_"+designId+"\" class=\"mailBoxTitle\"  style=\"display:none;\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\" id=\"star_" +values[coUnt][0]+ "\" >"+starField+"</span><span  class=\"fromName\" ><a href=\"javascript:clickonDiv('"+names+"',"+mailId+","+no+",1,"+noConversations+","+mailsId+","+pageNo+","+a_new+",'"+org_folder+"','"+object+"');\">"+from+"</a></span><span class=\"titleContent\"><a href=\"javascript:clickonDiv('"+names+"',"+mailId+","+no+",1,"+noConversations+","+mailsId+","+pageNo+","+a_new+",'"+org_folder+"','"+object+"')\">"+mailContentShort+"</a></span></span><span class=\"mailBoxRT\"></span><span class=\"fromDate\"><a href=\"javascript:clickonDiv('"+names+"',"+mailId+","+no+",1,"+noConversations+","+mailsId+","+pageNo+","+a_new+",'"+org_folder+"','"+object+"','"+search_object+"')\">"+attach+" "+mailTime+"</a></span></div>";
                      tble=tble+"<div id=\"mailDiv_"+designId+"\" class=\"mailBoxOpened\" >";
                      if(c_view=="3pane")
                      tble=tble+"<div id=\"short_"+designId+"\" class=\"mailBoxTitle\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\" id=\"star_3pane_" +values[coUnt][0]+ "\" >"+starField+"</span><span  class=\"fromName\" ><a href=\"javascript: hide('"+designId+"')\" >{cfn:getmessage(54)}:"+from+"</a></span> <span class=\"showDetailBtn\"><a href=\"javascript:showDetails('"+designId+"');\">{cfn:getmessage(282)}</a></span></span><span class=\"mailBoxRT\"></span><span class=\"fromDate\"><a href=\"javascript:showDetails('"+designId+"');\">"+mailTime+"</a></span></div>";
                      else
                      tble=tble+"<div id=\"short_"+designId+"\" class=\"mailBoxTitle\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\" id=\"star_" +values[coUnt][0]+ "\" >"+starField+"</span><span  class=\"fromName\" ><a href=\"javascript: hide('"+designId+"')\" >{cfn:getmessage(54)}:"+from+"</a></span> <span class=\"showDetailBtn\"><a href=\"javascript:showDetails('"+designId+"');\">{cfn:getmessage(282)}</a></span></span><span class=\"mailBoxRT\"></span><span class=\"fromDate\"><a href=\"javascript:showDetails('"+designId+"');\">"+mailTime+"</a></span></div>";
                      
                      tble=tble+"<div  class=\"mailBoxTitle\" style=\"display: none;\" id=\"detail_"+designId+"\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\"  id=\"star_" +values[coUnt][0]+ "\" >"+starField+"</span><span  class=\"fromName\" >{cfn:getmessage(54)}:"+from+"</span>	<span class=\"showDetailBtn\"> <a href=\"javascript:hideDetails('"+designId+"')\">{cfn:getmessage(283)}</a></span></span><span class=\"mailBoxRT\"></span>";
                      tble=tble+"<span class=\"fromDate noArrow\"><div class=\"in\">"+mailTime+"</div></span></div>";
                      tble=tble+"<div class=\"mailBoxM\"   ><div class=\"row\" id=\"detail1_"+designId+"\" style=\"display:none;\"><div class=\"detailedList\" >";
                      if(values[coUnt][2]!="")
                      tble=tble+"<div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(31)}:</div><div class=\"row floatL\"><div>"+values[coUnt][2]+"</div></div></div><div style=\"clear:both\"></div>";
                      if(values[coUnt][3]!="")
                      tble=tble+"<div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(32)}:</div><div class=\"row floatL\"><div>"+values[coUnt][3]+"</div></div></div><div style=\"clear:both\"></div>";
                      tble=tble+"<div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(34)}:</div><div class=\"row floatL\"><div>"+values[coUnt][5]+"</div></div></div><div style=\"clear:both\"></div><div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(383)}:</div><div class=\"row floatL\"><div>"+mailTime1+"</div></div></div></div></div><div style=\"clear:both\"></div>";
                      
                      if((values[coUnt][14]!=0)&&(values[coUnt][6]!=values[coUnt][13]) && org_folder!="sent")
                      {
                          tble=tble+"<div class=\"row imageDisplay\"  align=\"center\" id=\"imagez_"+designId+"\"><span style=\"font-weight:700;\">{cfn:getmessage(216)}</span><a href=\"javascript:display_image('"+name+"','"+designId+"',"+values[coUnt][0]+",'"+values[coUnt][12]+"','"+img_url+"')\">{cfn:getmessage(217)}</a><span style=\"padding:2px;\">&nbsp;|&nbsp;</span><a href=\"javascript:display_imagealltime('"+name+"','"+designId+"',"+values[coUnt][0]+",'"+values[coUnt][12]+"','"+img_url_a+"')\">{cfn:getmessage(218)} "+from+"</a>";
                         <!-- tble=tble+"</div><span class=\"mailContent\" id=\"contentmaildiv_"+designId+"\" >"+mailContent+"</span>"; -->
                         tble=tble+"</div><iframe frameborder='0' scrolling='yes'  onload='javascript:resizeIframe(this);' id=\"mail_frame"+designId+"\" src='{url:(mail/mail_message_frame/"+designId+")}'></iframe>";
                       	 email_content_store=mailContent;
                         
                      }
                      else
                      { 
                        	  <!-- tble=tble+"<span class=\"mailContent\" id=\"contentmaildiv_"+designId+"\"0 >"+values[coUnt][6]+"</span>"; -->
                     
                        	 tble=tble+"<iframe frameborder='0' scrolling='yes'  onload='javascript:resizeIframe(this);'id=\"mail_frame"+designId+"\" src='{url:(mail/mail_message_frame/"+designId+")}'></iframe>";
                           	 email_content_store=values[coUnt][6];

                      }
                    if(name!="draft")
                      {
                          if(values[coUnt][10]!="")
                              {
                                  var ar=new Array(100);
                              ar=values[coUnt][10].split(",");
                                  for(var k=0;k<(ar.length);k++)
                                  {
                                      var pathArray=ar[k].split("::");
                                      var path=pathArray[0];var attachName=pathArray[1];
                                  tble=tble+"<div class=\"row\" style=\"padding-left:10px;width:100%;\">";
                                      if(pathArray[5]==1)
                                      tble=tble+"<span  class=\"attachedImage\"><img width=\"100px\" height=\"150px\" src=\""+path+"\"></span><span class=\"attachments\">"+attachName+"</span><span class=\"attachments\" >";
                                      else
                                      tble=tble+"<span  class=\"attachedImage_nb\"><img  src=\""+path+"\"></span><span class=\"attachments\">"+attachName+"</span><span class=\"attachments\" >";
                                      if(pathArray[5]==1)
                                      tble=tble+"<a href=\"{url:(mail/showimage)}/"+pathArray[2]+"/"+pathArray[3]+"/"+pathArray[4]+"\" target=\"_blank\"> {cfn:getmessage(102)} </a></span><span class=\"attachments\" >";

                                      tble=tble+"<a href=\"{url:(mail/downloadattachment)}/"+pathArray[2]+"/"+pathArray[3]+"/"+pathArray[6]+"/"+pathArray[4]+"\"> <i class=\"fa fa-download\"></i>{cfn:getmessage(101)} </a></span></div><div style=\"clear:both\"></div>";
                                  }
                              }
                           tble=tble+"</div>";
                           var url_mail="{url:(mail/createdraft)}";var url_print="{url:(mail/printmail/)}"+values[coUnt][12]+"/"+mailsId;
                          tble=tble+"<div class=\"mailBoxFooter\" id=replyfooter1_"+designId+"><span class=\"mailBoxLF\"></span><span class=\"mailBoxBM\"><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-r\" alt=\" \"></span><a href=\"javascript:createDraft("+mailsId+",'"+names+"',"+no+",'"+name+"',1,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(15)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-a\" alt=\" \"></span><a href=\"javascript:createDraft("+mailsId+",'"+names+"',"+no+",'"+name+"',2,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(16)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-f\" alt=\" \"></span><a href=\"javascript:createDraft("+mailsId+",'"+names+"',"+no+",'"+name+"',3,'"+designId+"','"+url_mail+"')\"> {cfn:getmessage(17)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner print-btn\"></span><a href="+url_print+" target=\"_blank\">{cfn:getmessage(646)}</a></div></span><span class=\"mailBoxRF\"></span></div>";
                          tble=tble+"<div id=reply_"+designId+" style=\"display: none;\" class=\"replyWindow\">";
                          tble=tble+"<div class=\"row\" style=\"display: none;\"  id=replyfooter2_"+designId+" style=\"padding-top:5px;\"><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-r\" alt=\" \"></span><a href=\"javascript:createDraft("+mailsId+",'"+names+"',"+no+",'"+name+"',1,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(15)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-a\" alt=\" \"></span><a href=\"javascript:createDraft("+mailsId+",'"+names+"',"+no+",'"+name+"',2,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(16)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-f\" alt=\" \"></span><a href=\"javascript:createDraft("+mailsId+",'"+names+"',"+no+",'"+name+"',3,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(17)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner print-btn\"></span><a href="+url_print+" target=\"_blank\">{cfn:getmessage(646)}</a></div></div>";
                          tble=tble+"</div>";
                      }
                      tble=tble+"</div>";
                  }
                  else
                  {
                      c_view=getCookievalue("current_view");
          
                      var url_mail="{url:(mail/createdraft)}";var url_print="{url:(mail/printmail/)}"+values[coUnt][12]+"/"+mailsId;
                      tble=tble+"<div id=\"mailDiv_"+designId+"\" class=\"mailBoxOpened\">";
                      if(c_view=="3pane")
                      tble=tble+"<div id=\"short_"+designId+"\" class=\"mailBoxTitle\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\"  id=\"star_3pane_" +values[coUnt][0]+ "\" >"+starField+"</span>";
                      else
                      tble=tble+"<div id=\"short_"+designId+"\" class=\"mailBoxTitle\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\"  id=\"star_" +values[coUnt][0]+ "\" >"+starField+"</span>";
                      tble=tble+"<span  class=\"fromName\" >{cfn:getmessage(54)}:"+from+"</span> <span class=\"showDetailBtn\"><a href=\"javascript:showDetails('"+designId+"');\">{cfn:getmessage(282)}</a></span></span><span class=\"mailBoxRT\"></span><!-- <span id=\"mailactionsdrop\" class=\"fromDate noArrow\"><div class=\"popup\"><a href=\"javascript:createDraft("+mailsId+",'"+name+"',"+no+",'"+names+"',1,'"+designId+"','"+url_mail+"')\" class=\"fromDate noArrow\"><div class=\"in\">{cfn:getmessage(15)}</div></a><a href=\"javascript:createDraft("+mailsId+",'"+name+"',"+no+",'"+names+"',2,'"+designId+"','"+url_mail+"')\" class=\"fromDate noArrow\"><div class=\"in\">{cfn:getmessage(16)}</div></a><a href=\"javascript:createDraft("+mailsId+",'"+name+"',"+no+",'"+names+"',3,'"+designId+"','"+url_mail+"')\" class=\"fromDate noArrow\"><div class=\"in\">{cfn:getmessage(17)}</div></a><a class=\"fromDate noArrow\" href="+url_print+" target=\"_blank\"><div class=\"in\">{cfn:getmessage(646)}</div></a></div><div class=\"in\"><img class=\"iconsCornner arLt\" alt=\"\" src=\"images/filler.gif\"></div></span> --><span class=\"fromDate noArrow\"><div class=\"in\">"+attach+" "+mailTime+"</div></span></div>";
                      if(c_view=="3pane")
                      tble=tble+"<div  class=\"mailBoxTitle\" style=\"display: none;\" id=\"detail_"+designId+"\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\"  id=\"star_3pane_" +values[coUnt][0]+ "\" >"+starField+"</span><span  class=\"fromName\" >{cfn:getmessage(54)}:"+from+"</span>	<span class=\"showDetailBtn\"> <a href=\"javascript:hideDetails('"+designId+"')\">{cfn:getmessage(283)}</a></span></span><span class=\"mailBoxRT\"></span>";
                      else
                      tble=tble+"<div  class=\"mailBoxTitle\" style=\"display: none;\" id=\"detail_"+designId+"\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\"  id=\"star_" +values[coUnt][0]+ "\" >"+starField+"</span><span  class=\"fromName\" >{cfn:getmessage(54)}:"+from+"</span>	<span class=\"showDetailBtn\"> <a href=\"javascript:hideDetails('"+designId+"')\">{cfn:getmessage(283)}</a></span></span><span class=\"mailBoxRT\"></span>";
                      tble=tble+"<span class=\"fromDate noArrow\"><div class=\"in\">"+mailTime+"</div></span></div>";
                      tble=tble+"<div class=\"mailBoxM\"   ><div class=\"row\" id=\"detail1_"+designId+"\" style=\"display:none;\"><div class=\"detailedList\" >";
                      if(values[coUnt][2]!="")
                      tble=tble+"<div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(31)}:</div><div class=\"row floatL\"><div>"+values[coUnt][2]+"</div></div></div><div style=\"clear:both\"></div>";
                      if(values[coUnt][3]!="")
                      tble=tble+"<div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(32)}:</div><div class=\"row floatL\"><div>"+values[coUnt][3]+"</div></div></div><div style=\"clear:both\"></div>";
                      tble=tble+"<div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(34)}:</div><div class=\"row floatL\"><div>"+values[coUnt][5]+"</div></div></div><div style=\"clear:both\"></div><div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(383)}:</div><div class=\"row floatL\"><div>"+mailTime1+"</div></div></div></div></div><div style=\"clear:both\"></div>";
                      
                      if((values[coUnt][14]!=0)&&(values[coUnt][6]!=values[coUnt][13]) && org_folder!="sent")
                      {
                          tble=tble+"<div class=\"row imageDisplay\"  align=\"center\" id=\"imagez_"+designId+"\"><span style=\"font-weight:700;\">{cfn:getmessage(216)}</span><br><a href=\"javascript:display_image('"+name+"','"+designId+"',"+values[coUnt][0]+",'"+values[coUnt][12]+"','"+img_url+"')\">{cfn:getmessage(217)}</a><span style=\"padding:2px;\">&nbsp;|&nbsp;</span><a href=\"javascript:display_imagealltime('"+name+"','"+designId+"',"+values[coUnt][0]+",'"+values[coUnt][12]+"','"+img_url_a+"')\">{cfn:getmessage(218)} "+from+"</a>";
                          <!-- tble=tble+"</div><span class=\"mailContent\" id=\"contentmaildiv_"+designId+"\" >"+mailContent+"</span>"; -->
                          tble=tble+"</div><iframe frameborder='0' scrolling='yes'  onload='javascript:resizeIframe(this);' id=\"mail_frame"+designId+"\" src='{url:(mail/mail_message_frame/"+designId+")}'></iframe>";
                      	 email_content_store=mailContent;

                      }
                      else
                      { 
                    	<!--  tble=tble+"<span class=\"mailContent\" id=\"contentmaildiv_"+designId+"\" >"+values[coUnt][13]+"</span>"; -->
                    	
                     	  tble=tble+"<iframe frameborder='0' scrolling='yes'  onload='javascript:resizeIframe(this);' name='mail_frame' id=\"mail_frame"+designId+"\" src='{url:(mail/mail_message_frame/"+designId+")}'></iframe>";
                     	 email_content_store=values[coUnt][13];
                      
                      }
                    
                      
                      if(name!="draft")
                      {
                          if(values[coUnt][10]!="")
                          {
                              var ar=new Array(100);
                              ar=values[coUnt][10].split(",");
                          for(var k=0;k<(ar.length);k++)
                                  {
                                      var pathArray=ar[k].split("::");
                                      var path=pathArray[0];var attachName=pathArray[1];
                                      tble=tble+"<div class=\"row\" style=\"padding-left:10px;width:100%;\">";
                                      if(pathArray[5]==1)
                                      tble=tble+"<span  class=\"attachedImage\"><img width=\"100px\" height=\"150px\" src=\""+path+"\"></span><span class=\"attachments\">"+attachName+"</span><span class=\"attachments\" >";
                                      else
                                      tble=tble+"<span  class=\"attachedImage_nb\"><img  src=\""+path+"\"></span><span class=\"attachments\">"+attachName+"</span><span class=\"attachments\" >";
                                      if(pathArray[5]==1)
                                      tble=tble+"<a href=\"{url:(mail/showimage)}/"+pathArray[2]+"/"+pathArray[3]+"/"+pathArray[4]+"\" target=\"_blank\"> {cfn:getmessage(102)} </a></span><span class=\"attachments\" >";
          tble=tble+"<a href=\"{url:(mail/downloadattachment)}/"+pathArray[2]+"/"+pathArray[3]+"/"+pathArray[6]+"/"+pathArray[4]+"\"><i class=\"fa fa-download\"></i> {cfn:getmessage(101)} </a></span></div><div style=\"clear:both\"></div>";
                                  }
                          }
                            tble=tble+"</div>";
                            var url_mail="{url:(mail/createdraft)}";var url_print="{url:(mail/printmail/)}"+values[coUnt][12]+"/"+mailsId;
                          tble=tble+"<div class=\"mailBoxFooter\" id=replyfooter1_"+designId+"><span class=\"mailBoxLF\"></span><span class=\"mailBoxBM\"><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-r\" alt=\" \"></span><a href=\"javascript:createDraft("+mailsId+",'"+name+"',"+no+",'"+names+"',1,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(15)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-a\" alt=\" \"></span><a href=\"javascript:createDraft("+mailsId+",'"+name+"',"+no+",'"+names+"',2,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(16)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-f\" alt=\" \"></span><a href=\"javascript:createDraft("+mailsId+",'"+name+"',"+no+",'"+names+"',3,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(17)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner print-btn\"></span><a href="+url_print+" target=\"_blank\">{cfn:getmessage(646)}</a></div></span><span class=\"mailBoxRF\"></span></div>";
                          tble=tble+"<div id=reply_"+designId+" style=\"display: none;\" class=\"replyWindow\">";
                          tble=tble+"<div class=\"row\" style=\"display: none;\"  id=replyfooter2_"+designId+" style=\"padding-top:5px;\"><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-r\" alt=\" \"></span><a href=\"javascript:createDraft("+mailsId+",'"+name+"',"+no+",'"+names+"',1,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(15)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-a\" alt=\" \"></span><a href=\"javascript:createDraft("+mailsId+",'"+name+"',"+no+",'"+names+"',2,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(16)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-f\" alt=\" \"></span><a href=\"javascript:createDraft("+mailsId+",'"+name+"',"+no+",'"+names+"',3,'"+designId+"','"+url_mail+"')\"> {cfn:getmessage(17)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner print-btn\"></span><a href="+url_print+" target=\"_blank\">{cfn:getmessage(646)}</a></div></div>";
                          tble=tble+"</div>";
                      }
                      tble=tble+"";
                  }
              }
              

a++;
              
          }

          document.getElementById('preloaddiv').style.display="";
          document.getElementById('preloadimage').style.display="none";
          
         
          document.getElementById('msg_display').innerHTML=tble;
       
          if(names!="draft")
          writeToFrame(email_content_store,designId); 
         
          document.getElementById("short_detail").setAttribute("class", "detailmail");
          document.getElementById('mailContent').style.width="100%";
              if(names!="draft")
              {
                  if(right_ads_status!=0)//Check Global Ad display Status.
				{
              if(document.getElementById('rightads_td').style.display=="none")
                  {document.getElementById('rightads_td').style.display="";	
                  document.getElementById('mailPageOuterid').style.right="201px";
                  }
				}
                  
                  
              }
              else
              {
                  document.getElementById('rightads_td').style.display="none";
                      document.getElementById('mailPageOuterid').style.right="0px";

              }
          document.getElementById("loadingDiv").style.display="none";
      
       for(var i=0;i<((all_obj.length)-1);i++)
         {
         if(isArrayAvailable(all_obj[i]))
          {
           var inr_objct=this[all_obj[i]];
           var op=inr_objct.getResultPage(all_obj[i],1,50);
           while(aa=inr_objct.fetchRow(op))
           {
             var ids1=new Array(1);
             ids1[0]=aa[0];
             inr_objct.update(all_obj[i],arz1,arz2);
             inr_objct.where('id=?',ids1);
             inr_objct.action();
           }
          }
         }
          
          
      }
      else
      { 
    	  if(right_ads_status!=0)//Check Global Ad display Status.
			{              
    	  document.getElementById('mailPageOuterid').style.right="201px";
			}     
      
          fetchDetails(names,currentId,this[name],arry,1,pageNo,1,mailId,mainPage,org_folder,object,search_object);
          
          
      }
      setUnreadcount();
  }
  else
  {

      var designId=mailId+"_"+loopvariable;
      var  loopvariable1=parseInt(loopvariable)+parseInt(1);
      var avlble=this[name].isPageAvailable(name,loopvariable1,1);
      var sep=name.split("_");
      if(avlble==1)
      {
                  var aa=this[name].getResultItemM(name,currentId,1,mailsPerpage);
          var no=1;
          while(mailDetails=this[name].fetchRow(aa))
          { 
                  if(mailDetails[11]==1)
                  {
                      if(mailDetails[10]=="")
                      var attach="";
                      else
                      var attach="<img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner attach-a\" alt=\" \">";
                      if(names!="trash"&&names!="spam")
                      {
                      if(mailDetails[8]==0)
                      var starField="<a href=\"javascript:markstar("+currentId+","+mainPage+",1,"+currentId+",'"+object+"'+'"+search_object+"')\"><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner str-g\" alt=\" \"></a>";
                      else
                      var starField="<a href=\"javascript:markstar("+currentId+","+mainPage+",0,"+currentId+",'"+object+"','"+search_object+"')\"><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner str-y\" alt=\" \"></a>";
                      }
                     else if(names=="spam")
                        {var starField="<i class=\"fa fa-exclamation-triangle\"></i>";}
                      else
                      var starField="<i class=\"fa fa-trash-o\"></i>";
                      
                      var mailContent=mailDetails[6];
                      var from=mailDetails[1];
                      var subject=mailDetails[5];
                      var mailsId=mailDetails[0];
                          var tble="";

                      var readflag=mailDetails[7];
                      var mailTime=mailDetails[9];
                      tble=tble+"<div id=\"mailDiv_"+designId+"\" class=\"mailBoxOpened\" >";
                      if(c_view=="3pane")
                      tble=tble+"<div id=\"short_"+designId+"\" class=\"mailBoxTitle\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\" id=\"star_3pane_" +mailDetails[0]+ "\" >"+starField+"</span><span  class=\"fromName\" ><a href=\"javascript: hide('"+designId+"')\" >{cfn:getmessage(54)}:"+from+"</a></span> <span class=\"showDetailBtn\"><a href=\"javascript:showDetails('"+designId+"');\">{cfn:getmessage(282)}</a></span></span><span class=\"mailBoxRT\"></span><span class=\"fromDate\"><a href=\"javascript:showDetails('"+designId+"');\">"+mailTime+"</a></span></div>";
                      else  
                      tble=tble+"<div id=\"short_"+designId+"\" class=\"mailBoxTitle\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\" id=\"star_" +mailDetails[0]+ "\" >"+starField+"</span><span  class=\"fromName\" ><a href=\"javascript: hide('"+designId+"')\" >{cfn:getmessage(54)}:"+from+"</a></span> <span class=\"showDetailBtn\"><a href=\"javascript:showDetails('"+designId+"');\">{cfn:getmessage(282)}</a></span></span><span class=\"mailBoxRT\"></span><span class=\"fromDate\"><a href=\"javascript:showDetails('"+designId+"');\">"+mailTime+"</a></span></div>";
                      if(c_view=="3pane")
                      tble=tble+"<div  class=\"mailBoxTitle\" style=\"display: none;\" id=\"detail_"+designId+"\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\"  id=\"star_3pane_" +mailDetails[0]+ "\" >"+starField+"</span><span  class=\"fromName\" >{cfn:getmessage(54)}:"+from+"</span>	<span class=\"showDetailBtn\"> <a href=\"javascript:hideDetails('"+designId+"')\">{cfn:getmessage(283)}</a></span></span><span class=\"mailBoxRT\"></span>";
                      else    
                      tble=tble+"<div  class=\"mailBoxTitle\" style=\"display: none;\" id=\"detail_"+designId+"\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\"  id=\"star_" +mailDetails[0]+ "\" >"+starField+"</span><span  class=\"fromName\" >{cfn:getmessage(54)}:"+from+"</span>	<span class=\"showDetailBtn\"> <a href=\"javascript:hideDetails('"+designId+"')\">{cfn:getmessage(283)}</a></span></span><span class=\"mailBoxRT\"></span>";
                      tble=tble+"<span class=\"fromDate\">"+mailTime+"</span></div>";
                      tble=tble+"<div class=\"mailBoxM\"   ><div class=\"row\" id=\"detail1_"+designId+"\" style=\"display:none;\"><div class=\"detailedList\" >";
                      if(mailDetails[2]!="")
                      tble=tble+"<div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(31)}:</div><div class=\"row floatL\"><div>"+mailDetails[2]+"</div></div></div><div style=\"clear:both\"></div>";
                      if(mailDetails[3]!="")
                      tble=tble+"<div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(32)}:</div><div class=\"row floatL\"><div>"+mailDetails[3]+"</div></div></div><div style=\"clear:both\"></div>";
                      tble=tble+"<div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(34)}:</div><div class=\"row floatL\"><div>"+mailDetails[5]+"</div></div></div><div style=\"clear:both\"></div><div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(383)}:</div><div class=\"row floatL\"><div>"+mailDetails[9]+"</div></div></div></div></div><div style=\"clear:both\"></div>";
                      
                      if((mailDetails[14]!=0)&&(mailDetails[6]!=mailDetails[13]) && org_folder!="sent")
                      {
                             tble=tble+"<div class=\"row imageDisplay\"  align=\"center\" id=\"imagez_"+designId+"\"><span style=\"font-weight:700;\">{cfn:getmessage(216)}</span><a href=\"javascript:display_image('"+name+"','"+designId+"',"+mailDetails[0]+",'"+mailDetails[12]+"','"+img_url+"')\">{cfn:getmessage(217)}</a><span style=\"padding:2px;\">&nbsp;|&nbsp;</span><a href=\"javascript:display_imagealltime('"+name+"','"+designId+"',"+mailDetails[0]+",'"+mailDetails[12]+"','"+img_url_a+"')\">{cfn:getmessage(218)} "+from+"</a>";
                             //tble=tble+"</div><span class=\"mailContent\" id=\"contentmaildiv_"+designId+"\" >"+mailContent+"</span>";
                             tble=tble+"</div><iframe frameborder='0' scrolling='yes'  onload='javascript:resizeIframe(this);' id=\"mail_frame"+designId+"\" src='{url:(mail/mail_message_frame/"+designId+")}'></iframe>";
                          	 nesote_email_content_store=mailContent;
                      
                      
                      }
                      else
                      { tble=tble+"</div><iframe frameborder='0' scrolling='yes'  onload='javascript:resizeIframe(this);' id=\"mail_frame"+designId+"\" src='{url:(mail/mail_message_frame/"+designId+")}'></iframe>";
                   	 nesote_email_content_store=mailDetails[13];//tble=tble+"<span class=\"mailContent\" id=\"contentmaildiv_"+designId+"\" >"+mailDetails[13]+"</span>";
                      }tble=tble+"</div>";
                      
              
                      if((name!="draft")&&(mailDetails[12]!="draft"))
                      {
                          if(mailDetails[10]!="")
                          {
                              var ar=new Array(100);
                              ar=mailDetails[10].split(",");
                              for(var k=0;k<(ar.length);k++)
                              {
                                  var pathArray=ar[k].split("::");
                                  var path=pathArray[0];var attachName=pathArray[1];
                                  tble=tble+"<div class=\"row\" style=\"padding-left:10px;width:100%;\">";
                                      if(pathArray[5]==1)
                                      tble=tble+"<span  class=\"attachedImage\"><img width=\"100px\" height=\"150px\" src=\""+path+"\"></span><span class=\"attachments\">"+attachName+"</span><span class=\"attachments\" >";
                                      else
                                      tble=tble+"<span  class=\"attachedImage_nb\"><img  src=\""+path+"\"></span><span class=\"attachments\">"+attachName+"</span><span class=\"attachments\" >";
                                      if(pathArray[5]==1)
                                      tble=tble+"<a href=\"{url:(mail/showimage)}/"+pathArray[2]+"/"+pathArray[3]+"/"+pathArray[4]+"\" target=\"_blank\"> {cfn:getmessage(102)} </a></span><span class=\"attachments\" >";
                                      tble=tble+"<a href=\"{url:(mail/downloadattachment)}/"+pathArray[2]+"/"+pathArray[3]+"/"+pathArray[6]+"/"+pathArray[4]+"\"><i class=\"fa fa-download\"></i> {cfn:getmessage(101)} </a></span></div><div style=\"clear:both\"></div>";
                              }
                          }
                          var url_mail="{url:(mail/createdraft)}";var url_print="{url:(mail/printmail/)}"+mailDetails[12]+"/"+currentId;
                          tble=tble+"<div class=\"mailBoxFooter\" id=replyfooter1_"+designId+"><span class=\"mailBoxLF\"></span><span class=\"mailBoxBM\"><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-r\" alt=\" \"></span><a href=\"javascript:createDraft("+currentId+",'"+name+"',"+no+",'"+sep[0]+"',1,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(15)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-a\" alt=\" \"></span><a href=\"javascript:createDraft("+currentId+",'"+name+"',"+no+",'"+sep[0]+"',2,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(16)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" alt=\" \" class=\"iconsCornner reply-f\"></span><a href=\"javascript:createDraft("+currentId+",'"+name+"',"+no+",'"+sep[0]+"',3,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(17)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner print-btn\"></span><a href="+url_print+" target=\"_blank\">{cfn:getmessage(646)}</a></div></span><span class=\"mailBoxRF\"></span></div>";
                          tble=tble+"<div id=reply_"+designId+" style=\"display: none;\" class=\"replyWindow\">";
                          tble=tble+"<div class=\"row\" style=\"display: none;\"  id=replyfooter2_"+designId+" style=\"padding-top:5px;\"><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" alt=\" \" align=\"absmiddle\" class=\"iconsCornner reply-r\"></span><a href=\"javascript:createDraft("+currentId+",'"+name+"',"+no+",'"+sep[0]+"',1,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(15)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-a\"></span><a href=\"javascript:createDraft("+currentId+",'"+name+"',"+no+",'"+sep[0]+"',2,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(16)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-f\"></span><a href=\"javascript:createDraft("+currentId+",'"+name+"',"+no+",'"+sep[0]+"',3,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(17)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner print-btn\"></span><a href="+url_print+" target=\"_blank\">{cfn:getmessage(646)}</a></div></div>";
                          tble=tble+"</div>";
                      }
                      tble=tble+"</div>";
                      
                      
                      document.getElementById('mailDivshort_'+designId).style.display="none";
                      document.getElementById('mailDiv_'+designId).style.display="";
                      document.getElementById('mailDiv_'+designId).innerHTML=tble;
                  }
                  else if(no==1)
                  {
                  
                      fetchDetailResults(names,mailId,arry,1,pageNo,1,names,mailId,loopvariable,object,search_object);
                      
                  }
              
              
              no=no+1;
          
          }
          if(no==1)
          {
              fetchDetailResults(names,mailId,arry,1,pageNo,1,names,mailId,loopvariable,object,search_object);
          }
              
      }
      else
      {
          fetchDetailResults(names,mailId,arry,1,pageNo,1,names,mailId,loopvariable,object,search_object);
      }
  
  }
  
}



function resizeIframe(obj) {
    obj.style.height = obj.contentWindow.document.body.scrollHeight + 'px';
  }


function resizeIframesettings(obj,ah) {
	 if(ah=="")
     {
		obj.style.height = obj.contentWindow.document.body.scrollHeight + 'px';
     }
    else
	{
		    obj.style.height = obj.contentWindow.document.body.scrollHeight+ah+'px';
	}
  }


//Set Default  Theme
var chk_theme=getCookievalue("Current_Theme");
if(chk_theme!="100")
	{
	  document.body.className="bodyClass body_light";
	}
//End


setUnreadcount();
var currentTime=new Date();
var crntime=currentTime.toGMTString();
getCurrentSection();//Execution Starts here

function getCurrentSection(){
//Check Currentview
var current_view=getCookievalue('current_view');

if(current_view=="3pane")
	{
	document.getElementById("split_tootltip").title="{cfn:getmessage(78)}";

	}
else
	{
	document.getElementById("split_tootltip").title="{cfn:getmessage(77)}";

	}

flag_browser_back=0;
var url9=window.location.hash;
var arr9=new Array();
arr9=url9.split("#");
SetCookie("flag_browser_back",url9,1);
var arr=new Array();
arr=url9.split("#");
var arr1=new Array();
if(arr.length>1){
      if(arr[1].indexOf("/")>0)
      {   
          arr1=arr[1].split("/");
          var crntSection=arr1[0];
          
          var url_decode=decode64(arr1[1]);
          var decode_url=url_decode.split("/");
          var subSection=decode_url[0];
          var org_fldr=decode_url[1];
          var object=decode_url[1];
          var search_object=decode_url[2];
      }
      else{
          var subSection="";
          var crntSection=arr[1];
      }
      if(crntSection=='newmail'){
          newMail(0);
      }
      else if(crntSection=="inbox")
      {
          if(subSection=="")
          {
          var arry=new Array(13);
          arry[0]='id';arry[1]='from_list';arry[2]='to_list';arry[3]='cc';arry[4]='bcc';arry[5]='subject';arry[6]='body';arry[7]='readflag';arry[8]='starflag';arry[9]='time';arry[10]='status';arry[11]='time_int';arry[12]='back_folder';arry[13]='no_conversations';arry[14]='object';arry[15]='search_object';
          var ttl="{$totalInbox}";

              mainMenu1(1);
              mainWindow('inbox',1,mailsPerpage,totalInbox,2);
          }
          else if(subSection[0]=="p")
          {
              mainMenu1(1);
              var pgNo=subSection.replace("p","");
              mainWindow('inbox',pgNo,mailsPerpage,totalInbox,2);
          }
          else
          {	
              var org_folder=org_fldr.split("_");
              mainMenu1(1);
             /*Below Code makes sure that on page reload 3pane in gone*/
             if(current_view=="3pane")
              {
            	 window.location.hash="inbox";
            	 mainWindow('inbox',1,mailsPerpage,totalInbox,2);
              }
              else
              clickonDiv('inbox',subSection,1,0,-1,subSection,'inbox',0,org_folder[0],object,search_object);
          }
      }
      else if(crntSection=="sent")
      {
          if(subSection==""){
              mainMenu1(1);
              mainWindow('sent',1,mailsPerpage,totalSent,2);
          }
          else if(subSection[0]!="p"){
              var org_folder=org_fldr.split("_");
              mainMenu1(1);	
              /*Below Code makes sure that on page reload 3pane in gone*/
              if(current_view=="3pane")
               {
             	 window.location.hash="sent";
             	 mainWindow('sent',1,mailsPerpage,totalSent,2);
               }
              else
              clickonDiv('sent',subSection,1,0,-1,subSection,'sent',0,org_folder[0],object,search_object);
          }
          else{
              mainMenu1(1);
              var pgNo=subSection.replace("p","");
              mainWindow('sent',pgNo,mailsPerpage,totalSent,2);
          }
      }
      else if(crntSection=="draft")
      {
          if(subSection==""){
              mainMenu1(1);
              mainWindow('draft',1,mailsPerpage,totalDraft,2);
          }
          else if(subSection[0]!="p"){
              var org_folder=org_fldr.split("_");
              mainMenu1(1);
              clickonDiv('draft',subSection,1,0,-1,subSection,'draft',0,org_folder[0],object,search_object);
          }
          else{
              mainMenu1(1);
              var pgNo=subSection.replace("p","");
              mainWindow('draft',pgNo,mailsPerpage,totalDraft,2);
          }
      }
      else if(crntSection=="spam")
      {
          if(subSection==""){
              mainMenu1(1);
              mainWindow('spam',1,mailsPerpage,totalSpam,2);
          }
          else if(subSection[0]!="p"){
              var org_folder=org_fldr.split("_");
              mainMenu1(1);
              /*Below Code makes sure that on page reload 3pane in gone*/
              if(current_view=="3pane")
               {
             	 window.location.hash="spam";
             	 mainWindow('spam',1,mailsPerpage,totalSpam,2);
               }
              else
              clickonDiv('spam',subSection,1,0,-1,subSection,'spam',0,org_folder[0],object,search_object);
          }
          else{
              mainMenu1(1);
              var pgNo=subSection.replace("p","");
              mainWindow('spam',pgNo,mailsPerpage,totalSpam,2);
          }
      }
      else if(crntSection=="trash")
      {
          if(subSection==""){
              mainMenu1(1);
              mainWindow('trash',1,mailsPerpage,totalTrash,2);
          }
          else if(subSection[0]!="p"){
              var org_folder=org_fldr.split("_");
              mainMenu1(1);
              /*Below Code makes sure that on page reload 3pane in gone*/
              if(current_view=="3pane")
               {
             	 window.location.hash="trash";
             	 mainWindow('trash',1,mailsPerpage,totalTrash,2);
               }
              else
              clickonDiv('trash',subSection,1,0,-1,subSection,'trash',0,org_folder[0],object,search_object);
          }
          else{
              mainMenu1(1);
              var pgNo=subSection.replace("p","");
              mainWindow('trash',pgNo,mailsPerpage,totalTrash,2);
          }
      }
      else if(crntSection=="starred")
      {  
          if(subSection==""){
              mainMenu1(1);
              mainWindow('starred',1,mailsPerpage,totalStarred,2);
          }
          else if(subSection[0]!="p"){
             var orgnl_fldr=object.split(":");
             var orginl_foldr=orgnl_fldr[1].split("_");
             
              mainMenu1(1);
              
              clickonDiv('starred',subSection,1,0,-1,subSection,'starred',0,orginl_foldr[0],object,search_object);
          }
          else{
              mainMenu1(1);
              var pgNo=subSection.replace("p","");
              mainWindow('starred',pgNo,mailsPerpage,totalStarred,2);
          }
      }
      else if(crntSection=="chats")
      {
          var check="{$chat_enable}";
          if(check==1){
              if(subSection==""){
                  mainMenu1(1);
                  mainWindowChat('chats',1,mailsPerpage,totalchat,2);
              }
              else if(subSection[0]!="p")     {
              mainMenu1(1);
              /*Below Code makes sure that on page reload 3pane in gone*/
              if(current_view=="3pane")
               {
              	 window.location.hash="chats";
            	  mainWindowChat('chats',1,mailsPerpage,totalchat,2);

               }
              else
              clickonDivChat('chats',subSection,1,0,1,subSection,'chats',0);
              }
              else{
                  mainMenu1(1);
                  var pgNo=subSection.replace("p","");
                  mainWindowChat('chats',pgNo,mailsPerpage,totalchat,2);
                  }
              }
              else {
                  if(subSection==""){
                  mainMenu1(1);
                  mainWindow('inbox',1,mailsPerpage,totalInbox,2);
                  }
              else if(subSection[0]=="p")
              {
                  mainMenu1(1);
                  var pgNo=subSection.replace("p","");
                  mainWindow('inbox',pgNo,mailsPerpage,totalInbox,2);
                  }
              else{
                  mainMenu1(1);
                  clickonDiv('inbox',subSection,1,0,50,subSection,'inbox',0);
              }
          }
      }
      else if(crntSection=="contacts")
      {
          mainMenu1(2);	
      }
      else if(crntSection=="settings")
      {
          mainMenu1(3);
          if(subSection=="webmail")
          {
              settingswindow(1);
          }
          else if(subSection=="spam")
          {
              settingswindow(2);
          }
          else if(subSection=="filter")
          {
              settingswindow(3);
          }
          else if(subSection=="option")
          {
              settingswindow(4);
          }
          else if(subSection=="profile")
          {
              settingswindow(6);
          }
          else if(subSection=="password")
          {
              settingswindow(5);
          }
          else if(subSection=="chat")
          {
              settingswindow(7);
          }
          
      }
      else if(crntSection!="")
      {
          if(crntSection.substring(0,6)=="search")
           {
          
                  if(subSection=="")// Called on Search Refresh
                  {
                  
                      var aa=crntSection.substring(6).split("/");
                      var dtls=aa[0].split("_");
                      findnumbers(dtls[0],dtls[1],crntSection)
                  }
                  else
                  {
                	   
                  var org_folder=org_fldr.split(">");
                  var orgnl_folder=org_folder[1].split("_");
                  
                                
                   mainMenu1(1);
                   clickonDiv(crntSection,subSection,1,0,-1,subSection,'inbox',0,orgnl_folder[0],object,search_object);
                  
                  }
                      
              
          }
          else if(crntSection.substring(0,4)=="from")
          {
            
              if(subSection=="")
              {
                  var aa=crntSection.split("*");
                  var from=aa[0].split("?");
                  var to=aa[1].split("?");
                  var subject=aa[2].split("?");
                  var keywords=aa[3].split("?");
                  var folder=aa[4].split("?"); 
                  var attach=aa[5].split("?");
                  var ad_keyword=from[1]+"/"+to[1]+"/"+subject[1]+"/"+keywords[1]+"/"+folder[1];
                  var string_url="from?"+from[1]+"*to?"+to[1]+"*subject?"+subject[1]+"*keywords?"+keywords[1]+"*folderid?"+folder[1]+"*attach?"+attach[1];
                  findnumbers_ad(ad_keyword,string_url);
              }
              else
              {
               var org_folder=org_fldr.split(">");
               var orgnl_folder=org_folder[1].split("_");
               mainMenu1(1);
               clickonDiv(crntSection,subSection,1,0,-1,subSection,'inbox',0,orgnl_folder[0],object,search_object);
               
              
              }
          }
          else //Custom Folder
          {
              var folderid=crntSection.replace("custom","");
              {loopstart:customfolders:1000}
              if({$customfolders[0]}==folderid)
              var count={$customfolders[2]};
              {loopend:customfolders}
              
              getnoOfmails(folderid);
              var z=0;
              while(z<10000)
              {
                  z=z+1;
              }
              if(subSection=="")
              {
                  mainMenu1(1);
                  mainWindow(crntSection,1,mailsPerpage,count,2);
              }
              else if(subSection[0]!="p")
              {	var org_folder=org_fldr.split("_");
                  mainMenu1(1);
                  
                  /*Below Code makes sure that on page reload 3pane in gone*/
                  if(current_view=="3pane")
                   {
                 	 window.location.hash=crntSection;
                 	 mainWindow(crntSection,1,mailsPerpage,count,2);
                   }
                  else
                  clickonDiv(crntSection,subSection,1,0,-1,subSection,crntSection,0,org_folder[0],object,search_object);
              }
              else
              {
                  mainMenu1(1);
                  var pgNo=subSection.replace("p","");
                  mainWindow(crntSection,pgNo,mailsPerpage,count,2);
              }
          }			
      }
      else
      {
          if(subSection=="")
          {
              mainMenu1(1);
              mainWindow(crntSection,1,mailsPerpage,totalStarred,2);
          }
          else if(subSection[0]!="p")
          {
              mainMenu1(1);
              clickonDiv(crntSection,subSection,1,0,-1,subSection,crntSection,0,org_fldr);
          }
          else
          {
              mainMenu1(1);
              mainWindow(crntSection,1,mailsPerpage,totalStarred,2);
          }
      }
  }
  else
  {
  window.location.hash="#inbox";
  mainMenu1(1);
  mainWindow('inbox',1,mailsPerpage,totalInbox,2);
  }
}

/**The Below Function is called on
 * page refresh for each page to set the menu items .
 */
function mainMenu1(page){



  if(page==1)
  {
      document.getElementById("searchMain").style.display="";
      document.getElementById("mail").style.display="";	
      document.getElementById("contactsC").style.display="none";
      document.getElementById("settings").style.display="none";
      document.getElementById("mainMail1").style.display="";
      document.getElementById("mainContact1").style.display="none";
      document.getElementById("mainSetting1").style.display="none";
      document.getElementById("mainMail2").style.display="none";
      document.getElementById("mainContact2").style.display="";
      document.getElementById("mainSetting2").style.display="";
      document.getElementById("mailLeft").style.display="";
      document.getElementById("contactLeft").style.display="none";
      document.getElementById("settingLeft").style.display="none";
      document.getElementById("sddmbid").style.display="";
	  document.getElementById("right_mailsectionid").style.display="";
      document.getElementById("settings_left_section").style.display="none";
      document.getElementById("backmailbtnid").style.display="none";
	  document.getElementById("cotnct_lmenuid").style.display="none";
	 
	 
	 
      document.getElementById("contact_subheader").style.display="none";
      
   }
  else if(page==2)
  {
  
      document.getElementById("searchMain").style.display="none";
      
      document.getElementById("mail").style.display="none";
      document.getElementById("contactsC").style.display="";
      document.getElementById("settings").style.display="none";
      document.getElementById("mainMail1").style.display="none";
      document.getElementById("mainContact1").style.display="";
      document.getElementById("mainSetting1").style.display="none";
      document.getElementById("mainMail2").style.display="";
      document.getElementById("mainContact2").style.display="none";
      document.getElementById("mainSetting2").style.display="";
      document.getElementById("mailLeft").style.display="none";
      document.getElementById("contactLeft").style.display="";
      document.getElementById("settingLeft").style.display="none";
      document.getElementById("settings_left_section").style.display="none";
      document.getElementById("backmailbtnid").style.display="none";

	    document.getElementById("sddmbid").style.display="none";
	   document.getElementById("right_mailsectionid").style.display="none";
	   document.getElementById("cotnct_lmenuid").style.display="";
	   
      document.getElementById("contact_subheader").style.display="";
      var q=getCookievalue("currentcontact");
      if(q==0)
      {
       var contg_name='mycontacts';
       var contgr_name=q;
       var cnt_tot={$mycontact_total};
      }
      else if(q==-1)
      {
       var contg_name='global';
       var contgr_name=q;
       var cnt_tot={$g_contact};
      }
      else
      {
       var contg_name=q;
       var contgr_name="";
          {loopstart:groups:1000}
          if("{$groups[0]}"==q)
          {
          contgr_name="{$groups[1]}";
          var cnt_tot="{$groups[2]}";
          }
          {loopend:groups}
      
      }
      mainContactWindow(contg_name,1,cnt_tot,cnt_tot,2,contgr_name);
  
   }
  else
   {
      document.getElementById("backmailbtnid").style.display="none";
      document.getElementById("searchMain").style.display="none";
      document.getElementById("mail").style.display="none";
      document.getElementById("contactsC").style.display="none";
      document.getElementById("settings").style.display="";
      document.getElementById("mainMail1").style.display="none";
      document.getElementById("mainContact1").style.display="none";
      document.getElementById("mainSetting1").style.display="";
      document.getElementById("mainMail2").style.display="";
      document.getElementById("mainContact2").style.display="";
      document.getElementById("mainSetting2").style.display="none";
      document.getElementById("mailLeft").style.display="none";
      document.getElementById("contactLeft").style.display="none";
      document.getElementById("settingLeft").style.display="";
       document.getElementById("sddmbid").style.display="none";
	    document.getElementById("right_mailsectionid").style.display="";
 document.getElementById("cotnct_lmenuid").style.display="none";
      document.getElementById("contact_subheader").style.display="none";
      var sUrl="{url:(settings/webmailsettings)}";
      settingswindow(1);
  
   }
   return;

}
//MainMenu Function is called when each tabs are  clicked.
function mainMenu(page){


  if(page==1)//This satisfies for Inbox
  {
      document.getElementById("searchMain").style.display="";
      document.getElementById("mail").style.display="";	
      document.getElementById("contactsC").style.display="none";
      document.getElementById("settings").style.display="none";
      document.getElementById("mainMail1").style.display="";
      document.getElementById("mainContact1").style.display="none";
      document.getElementById("mainSetting1").style.display="none";
      document.getElementById("mainMail2").style.display="none";
      document.getElementById("mainContact2").style.display="";
      document.getElementById("mainSetting2").style.display="";
      document.getElementById("mailLeft").style.display="";
      document.getElementById("contactLeft").style.display="none";
      document.getElementById("settingLeft").style.display="none";
      document.getElementById("sddmbid").style.display="";
	  document.getElementById("cotnct_lmenuid").style.display="none";
	  document.getElementById("right_mailsectionid").style.display="";
	  document.getElementById("settings_left_section").style.display="none";
	  document.getElementById("backmailbtnid").style.display="none";

	   

      document.getElementById("contact_subheader").style.display="none";
      mainWindow('inbox',1,mailsPerpage,{$totalInbox},2);
   }
  else if(page==2)//This satisfies for Contacts
  {
  
      document.getElementById("searchMain").style.display="none";
      document.getElementById("backmailbtnid").style.display="none";

      document.getElementById("mail").style.display="none";
      document.getElementById("contactsC").style.display="";
      document.getElementById("settings").style.display="none";
      document.getElementById("mainMail1").style.display="none";
      document.getElementById("mainContact1").style.display="";
      document.getElementById("mainSetting1").style.display="none";
      document.getElementById("mainMail2").style.display="";
      document.getElementById("mainContact2").style.display="none";
      document.getElementById("mainSetting2").style.display="";
      document.getElementById("mailLeft").style.display="none";
      document.getElementById("contactLeft").style.display="";
      document.getElementById("settingLeft").style.display="none";
      document.getElementById("sddmbid").style.display="none";
	  document.getElementById("right_mailsectionid").style.display="none";
      document.getElementById("cotnct_lmenuid").style.display="";
      document.getElementById("contact_subheader").style.display="";
      document.getElementById('rightads_td').style.display="none";
      document.getElementById('mailPageOuterid').style.right="0px";
      mainContactWindow('mycontacts',1,{$mycontact_total},{$mycontact_total},2,0);
  
   }
  else
   {
      document.getElementById("backmailbtnid").style.display="none";
      document.getElementById("searchMain").style.display="none";
      document.getElementById("mail").style.display="none";
      document.getElementById("contactsC").style.display="none";
      document.getElementById("settings").style.display="";
      document.getElementById("mainMail1").style.display="none";
      document.getElementById("mainContact1").style.display="none";
      document.getElementById("mainSetting1").style.display="";
      document.getElementById("mainMail2").style.display="";
      document.getElementById("mainContact2").style.display="";
      document.getElementById("mainSetting2").style.display="none";
      document.getElementById("mailLeft").style.display="none";
      document.getElementById("contactLeft").style.display="none";
      document.getElementById("settingLeft").style.display="";
      document.getElementById("sddmbid").style.display="none";
	  document.getElementById("right_mailsectionid").style.display="none";
      document.getElementById("cotnct_lmenuid").style.display="none";
      document.getElementById("contact_subheader").style.display="none";

      document.getElementById('rightads_td').style.display="none";
      document.getElementById('mailPageOuterid').style.right="0px";
      var sUrl="{url:(settings/webmailsettings)}";
      settingswindow(1);
  
   }
   return;

}
function header(folder)
{
if(document.getElementById("preview").style.display=="")
document.getElementById("preview").style.display="none";

if(document.getElementById("five_5").style.display=="none")
document.getElementById("five_5").style.display="";

if(document.getElementById("seven_7").style.display=="")
document.getElementById("seven_7").style.display="none";

if(document.getElementById("six_6").style.display=="")
document.getElementById("six_6").style.display="none";

if(document.getElementById("one_1").style.display=="none")
document.getElementById("one_1").style.display="";

if(document.getElementById("movetoList").style.display=="none")
document.getElementById("movetoList").style.display="";

if(document.getElementById("moreList").style.display=="none")
document.getElementById("moreList").style.display="";

if(folder=="draft")
{
document.getElementById("one_1").style.display="none";
document.getElementById("five_5").style.display="none"
document.getElementById("seven_7").style.display="";
document.getElementById("movetoList").style.display="none";
}
else if(folder=="starred")
{
document.getElementById("one_1").style.display="none";
document.getElementById("five_5").style.display="none";
document.getElementById("movetoList").style.display="none";

}
else if(folder=="spam")
{
document.getElementById("five_5").style.display="none";
document.getElementById("six_6").style.display="";
document.getElementById("movetoList").style.display="none";
}
else if(folder=="newmail")
{
disableReplylinks();
disableReplylinksChat();
document.getElementById("one_1").style.display="none";
document.getElementById("five_5").style.display="none";
document.getElementById("six_6").style.display="none";
document.getElementById("seven_7").style.display="none";
document.getElementById("movetoList").style.display="none";
document.getElementById("moreList").style.display="none";
}
else if((folder.substring(0,6)=="search")||(folder.substring(0,4)=="from"))
{
document.getElementById("one_1").style.display="none";
document.getElementById("movetoList").style.display="none";
document.getElementById("five_5").style.display="none";
}

}

function mainWindow(nam,pageNo,size,ttl,insrt)
{
	reset_filefield();
	var cur_theme_id=getCookievalue("Current_Theme");
	//Themes Based Modifications for Transparency Effect
	if(cur_theme_id!="100")//Check for Default White Theme 
	{
		document.getElementById("second_scroll").style.background="";
	    document.getElementById("footer_txt_id").style.color="#FFFFFF";
	}
	//End
	// document.getElementById("mailPageOuterid").style.top="116px";
	document.getElementById("mailPageOuterid").style.zIndex="inherit";
	//document.getElementById("settingLeft").style.top="116px";
	//document.getElementById("settingLeft").style.zIndex="inherit";

	//remove_attach_divs();//Calling function to remove attach divs.
	
if(!isNaN(nam))
nam="custom"+nam;
header(nam);

reply_mail_id="";var v="";var q="";
q=getCookievalue("folder");
document.getElementById("mail_subheader").style.display="";
//document.getElementById("back_tootltip").title="";


if(document.getElementById("chat_subheader").style.display=="")
document.getElementById("chat_subheader").style.display="none";
if(q.substring(0,6)=="custom")
q=q.substring(6);
if(!isNaN(q))
if(document.getElementById("customFLI"+q))
document.getElementById("customFLI"+q).className="leftunSelected";
if(!isNaN(nam))
{
v=nam;
nam="custom"+nam
}
else if(nam.substring(0,6)=="custom")
v=nam.substring(6);
else
{
if(nam=="inbox")
{
	 if(document.getElementById("backmailbtnid").style.display=="")
	  {
	     document.getElementById("backmailbtnid").style.display="none";

	  }
document.getElementById("leftmenu_inbox").className="leftSelected";
document.getElementById("leftmenu_starred").className="leftunSelected";
if(chat_enable==1)
document.getElementById("leftmenu_chats").className="leftunSelected";
document.getElementById("leftmenu_draft").className="leftunSelected";
document.getElementById("leftmenu_sent").className="leftunSelected";
document.getElementById("leftmenu_spam").className="leftunSelected";
document.getElementById("leftmenu_trash").className="leftunSelected"; 
document.getElementById("advance_search").value="";
if(document.getElementById("emptytrash").style.display=="")
document.getElementById("emptytrash").style.display="none";
if(document.getElementById("emptyspam").style.display=="")
document.getElementById("emptyspam").style.display="none";
document.getElementById('mailPageOuterid').style.right="0px";
if(document.getElementById("msg_display").innerHTML)
{
document.getElementById("msg_display").innerHTML="<div class=\"warning_message_Txt\">{cfn:getmessage(776)}</div><div class='warning_message_Txt_sec'>{cfn:getmessage(777)}</div><div id='footer_txt_id1' class='footer_txt_new'>{$footer}{if($memoryusage_publicview_area==1)}<br><br>{$memorymsg}{endif}</div></div>";
}

if(document.getElementById("splitbuttonid").style.display=="none")
{
document.getElementById("splitbuttonid").style.display="";
}

}

if(nam=="starred")
{
	 if(document.getElementById("backmailbtnid").style.display=="")
	  {
	     document.getElementById("backmailbtnid").style.display="none";

	  }
	
document.getElementById("leftmenu_inbox").className="leftunSelected";
document.getElementById("leftmenu_starred").className="leftSelected";
if(chat_enable==1)
document.getElementById("leftmenu_chats").className="leftunSelected";
document.getElementById("leftmenu_draft").className="leftunSelected";
document.getElementById("leftmenu_sent").className="leftunSelected";
document.getElementById("leftmenu_spam").className="leftunSelected";
document.getElementById("leftmenu_trash").className="leftunSelected"; 
document.getElementById("advance_search").value="";
if(document.getElementById("emptytrash").style.display=="")
document.getElementById("emptytrash").style.display="none";
if(document.getElementById("emptyspam").style.display=="")
document.getElementById("emptyspam").style.display="none";
document.getElementById('mailPageOuterid').style.right="0px";
if(document.getElementById("msg_display").innerHTML)
{
document.getElementById("msg_display").innerHTML="<div class=\"warning_message_Txt\">{cfn:getmessage(776)}</div><div class='warning_message_Txt_sec'>{cfn:getmessage(777)}</div><div id='footer_txt_id1' class='footer_txt_new'>{$footer}{if($memoryusage_publicview_area==1)}<br><br>{$memorymsg}{endif}</div></div>";
}

if(document.getElementById("splitbuttonid").style.display=="")
{
document.getElementById("splitbuttonid").style.display="none";
}


}
if(nam=="chats")
{
	 if(document.getElementById("backmailbtnid").style.display=="")
	  {
	     document.getElementById("backmailbtnid").style.display="none";

	  }
	
document.getElementById("leftmenu_inbox").className="leftunSelected";
document.getElementById("leftmenu_starred").className="leftunSelected";
if(chat_enable==1)
document.getElementById("leftmenu_chats").className="leftSelected";
document.getElementById("leftmenu_draft").className="leftunSelected";
document.getElementById("leftmenu_sent").className="leftunSelected";
document.getElementById("leftmenu_spam").className="leftunSelected";
document.getElementById("leftmenu_trash").className="leftunSelected";
document.getElementById("mail_subheader").className="leftunSelected";
if(document.getElementById("chat_subheader").style.display=="none")
{  document.getElementById("chat_subheader").style.display="";
    document.getElementById("backchatbtnid").style.display="none";

}
document.getElementById("advance_search").value="";
if(document.getElementById("emptytrash").style.display=="")
document.getElementById("emptytrash").style.display="none";
if(document.getElementById("emptyspam").style.display=="")
document.getElementById("emptyspam").style.display="none";
document.getElementById('mailPageOuterid').style.right="0px";
if(document.getElementById("msg_display").innerHTML)
{
document.getElementById("msg_display").innerHTML="<div class=\"warning_message_Txt\">{cfn:getmessage(776)}</div><div class='warning_message_Txt_sec'>{cfn:getmessage(777)}</div><div id='footer_txt_id1' class='footer_txt_new'>{$footer}{if($memoryusage_publicview_area==1)}<br><br>{$memorymsg}{endif}</div></div>";
}

if(document.getElementById("splitbuttonid").style.display=="none")
{
document.getElementById("splitbuttonid").style.display="";
}


}
if(nam=="draft")
{
	 if(document.getElementById("backmailbtnid").style.display=="")
	  {
	     document.getElementById("backmailbtnid").style.display="none";
	  }
	
	
	 
document.getElementById("leftmenu_inbox").className="leftunSelected";
document.getElementById("leftmenu_starred").className="leftunSelected";
if(chat_enable==1)document.getElementById("leftmenu_chats").className="leftunSelected";
document.getElementById("leftmenu_draft").className="leftSelected";
document.getElementById("leftmenu_sent").className="leftunSelected";
document.getElementById("leftmenu_spam").className="leftunSelected";
document.getElementById("leftmenu_trash").className="leftunSelected"; 
document.getElementById("advance_search").value="";
if(document.getElementById("emptytrash").style.display=="")
document.getElementById("emptytrash").style.display="none";
if(document.getElementById("emptyspam").style.display=="")
document.getElementById("emptyspam").style.display="none";
document.getElementById('mailPageOuterid').style.right="0px";

if(document.getElementById("splitbuttonid").style.display=="")
{
document.getElementById("splitbuttonid").style.display="none";
}

}
if(nam=="sent")
{
	 if(document.getElementById("backmailbtnid").style.display=="")
	  {
	     document.getElementById("backmailbtnid").style.display="none";

	  }
	
document.getElementById("leftmenu_inbox").className="leftunSelected";
document.getElementById("leftmenu_starred").className="leftunSelected";
if(chat_enable==1)
document.getElementById("leftmenu_chats").className="leftunSelected";
document.getElementById("leftmenu_draft").className="leftunSelected";
document.getElementById("leftmenu_sent").className="leftSelected";
document.getElementById("leftmenu_spam").className="leftunSelected";
document.getElementById("leftmenu_trash").className="leftunSelected"; 
document.getElementById("advance_search").value="";
if(document.getElementById("emptytrash").style.display=="")
document.getElementById("emptytrash").style.display="none";
if(document.getElementById("emptyspam").style.display=="")
document.getElementById("emptyspam").style.display="none";
document.getElementById('mailPageOuterid').style.right="0px";

if(document.getElementById("msg_display").innerHTML)
{
document.getElementById("msg_display").innerHTML="<div class=\"warning_message_Txt\">{cfn:getmessage(776)}</div><div class='warning_message_Txt_sec'>{cfn:getmessage(777)}</div><div id='footer_txt_id1' class='footer_txt_new'>{$footer}{if($memoryusage_publicview_area==1)}<br><br>{$memorymsg}{endif}</div></div>";;
}

if(document.getElementById("splitbuttonid").style.display=="none")
{
document.getElementById("splitbuttonid").style.display="";
}


}
if(nam=="spam")
{
	 if(document.getElementById("backmailbtnid").style.display=="")
	  {
	     document.getElementById("backmailbtnid").style.display="none";

	  }
	
document.getElementById("leftmenu_inbox").className="leftunSelected";
document.getElementById("leftmenu_starred").className="leftunSelected";
if(chat_enable==1)
document.getElementById("leftmenu_chats").className="leftunSelected";
document.getElementById("leftmenu_draft").className="leftunSelected";
document.getElementById("leftmenu_sent").className="leftunSelected";
document.getElementById("leftmenu_spam").className="leftSelected";
document.getElementById("leftmenu_trash").className="leftunSelected"; 
document.getElementById("advance_search").value="";
if(document.getElementById("emptytrash").style.display=="")
document.getElementById("emptytrash").style.display="none";
document.getElementById("emptyspam").style.display="";
document.getElementById('mailPageOuterid').style.right="0px";
if(document.getElementById("msg_display").innerHTML)
{
document.getElementById("msg_display").innerHTML="<div class=\"warning_message_Txt\">{cfn:getmessage(776)}</div><div class='warning_message_Txt_sec'>{cfn:getmessage(777)}</div><div id='footer_txt_id1' class='footer_txt_new'>{$footer}{if($memoryusage_publicview_area==1)}<br><br>{$memorymsg}{endif}</div></div>";
}

if(document.getElementById("splitbuttonid").style.display=="none")
{
document.getElementById("splitbuttonid").style.display="";
}


}
if(nam=="trash"){
	
	 if(document.getElementById("backmailbtnid").style.display=="")
	  {
	     document.getElementById("backmailbtnid").style.display="none";

	  }
	
document.getElementById("leftmenu_inbox").className="leftunSelected";
document.getElementById("leftmenu_starred").className="leftunSelected";

if(chat_enable==1)
document.getElementById("leftmenu_chats").className="leftunSelected";
document.getElementById("leftmenu_draft").className="leftunSelected";
document.getElementById("leftmenu_sent").className="leftunSelected";
document.getElementById("leftmenu_spam").className="leftunSelected";
document.getElementById("leftmenu_trash").className="leftSelected";
document.getElementById("advance_search").value="";
document.getElementById("emptytrash").style.display="";
if(document.getElementById("emptyspam").style.display=="")
document.getElementById("emptyspam").style.display="none";
document.getElementById('mailPageOuterid').style.right="0px";
if(document.getElementById("msg_display").innerHTML)
{
document.getElementById("msg_display").innerHTML="<div class=\"warning_message_Txt\">{cfn:getmessage(776)}</div><div class='warning_message_Txt_sec'>{cfn:getmessage(777)}</div><div id='footer_txt_id1' class='footer_txt_new'>{$footer}{if($memoryusage_publicview_area==1)}<br><br>{$memorymsg}{endif}</div></div>";
}

if(document.getElementById("splitbuttonid").style.display=="none")
{
document.getElementById("splitbuttonid").style.display="";
}


}

}
if(v!="")
{
	 if(document.getElementById("backmailbtnid").style.display=="")
	  {
	     document.getElementById("backmailbtnid").style.display="none";

	  }
	
if(document.getElementById("customFLI"+v))
document.getElementById("customFLI"+v).className="leftSelected";
document.getElementById("leftmenu_inbox").className="leftunSelected";
document.getElementById("leftmenu_starred").className="leftunSelected";
if(chat_enable==1)
document.getElementById("leftmenu_chats").className="leftunSelected";
document.getElementById("leftmenu_draft").className="leftunSelected";
document.getElementById("leftmenu_sent").className="leftunSelected";
document.getElementById("leftmenu_spam").className="leftunSelected";
document.getElementById("leftmenu_trash").className="leftunSelected";
document.getElementById("advance_search").value="";
if(document.getElementById("emptytrash").style.display=="")
document.getElementById("emptytrash").style.display="none";
if(document.getElementById("emptyspam").style.display=="")
document.getElementById("emptyspam").style.display="none";
document.getElementById('mailPageOuterid').style.right="0px";
if(document.getElementById("msg_display").innerHTML)
{
document.getElementById("msg_display").innerHTML="<div class=\"warning_message_Txt\">{cfn:getmessage(776)}</div><div class='warning_message_Txt_sec'>{cfn:getmessage(777)}</div><div id='footer_txt_id1' class='footer_txt_new'>{$footer}{if($memoryusage_publicview_area==1)}<br><br>{$memorymsg}{endif}</div></div>";
}

if(document.getElementById("splitbuttonid").style.display=="none")
{
document.getElementById("splitbuttonid").style.display="";
}


}
disableReplylinks();
disableReplylinksChat();
if(document.getElementById("moveto2").style.display=="")
document.getElementById("moveto2").style.display="none";
if(document.getElementById("moreList2").style.display=="")
document.getElementById("moreList2").style.display="none";
moveflag=0;
var numbr=getCookievalue(nam);idString=":";idz="";pair="";
SetCookie("folder",nam,1);SetCookie("mail_page",pageNo,pageNo);
document.getElementById("newMail").style.display="none";

//Fixing issues with Three Pane on Search

var s_1=nam.search("search");// -1 if not search folder


var t_pattern2=/from?(.*)$/i;//Define test patern for advanced search

var chk2=t_pattern2.test(nam);

//Below code checks advanced search.
/*if(nam!="inbox"|| nam!="spam" || nam!="trash" || nam!="sent"||nam!="draft")
{   
    var s_11=nam.split("*");
    var s_22=s_11[4].split("?");
}*/
// For three pane View

var current_view=getCookievalue("current_view");
if(current_view=="3pane"&& nam!="draft" && s_1==-1&nam!="starred"&&(chk2!==true))
{	
   document.getElementById("mailContent").style.display="none";
   document.getElementById("mailContent11").style.display="";
   document.getElementById("splitdiv1").style.display="";
   document.getElementById("footer_table").style.display="none";

}
else
{//Ends
document.getElementById("mailContent").style.display="";
document.getElementById("mailContent11").style.display="none";
document.getElementById("splitdiv1").style.display="none";
document.getElementById("footer_table").style.display="table";
}

totl=numbr;fetchPage(nam,pageNo,size,insrt)};

function fetchPage(nam,pageNo,size,insrt)
{
	
	//Coded to reset msg_list div in 3pane
	 document.getElementById("mailContent11").innerHTML="<div class=\"warning_message_Txt\" >{cfn:getmessage(778)}</div>";
	
	
mail_open=0;///for starring
var current_url_w=window.location.hash;
SetCookie("flag_browser_back",current_url_w,1);
var name=nam;
var arry=new Array(13);
arry[0]="id";arry[1]="from_list";
arry[2]="to_list";arry[3]="cc";arry[4]="bcc";arry[5]="subject";arry[6]="body";
arry[7]="readflag";arry[8]="starflag";arry[9]="time";arry[10]="attach";
arry[11]="time_int";arry[12]="back_folder";arry[13]="no_conversations";
arry[14]="object";arry[15]="search_object";



if(Unread[0][2]==1)//Inbox
{

this[nam]=new Table(name,arry,totl,20);
fetchPageAjax(this[nam],pageNo,size,arry,totl,insrt,name);return;
}
else if(Unread[2][2]==1)//Sent
{
this[nam]=new Table(name,arry,totl,20);
fetchPageAjax(this[nam],pageNo,size,arry,totl,insrt,name);return;
}
else if(Unread[3][2]==1)//Spam
{
//totl=getCookievalue(name);
this[nam]=new Table(name,arry,totl,20);
fetchPageAjax(this[nam],pageNo,size,arry,totl,insrt,name);return;
}
else if(Unread[4][2]==1)//Trash
{this[nam]=new Table(name,arry,totl,20);
fetchPageAjax(this[nam],pageNo,size,arry,totl,insrt,name);return;
}
else if(Unread[5][2]==1)//Starred
{this[nam]=new Table(name,arry,totl,20);
fetchPageAjax(this[nam],pageNo,size,arry,totl,insrt,name);return;
}

for(var urdcnt=0;urdcnt<customFoldercount;urdcnt++)
{
if(Unread[urdcnt][2]==1)//Custom Folder
{
this[nam]=new Table(name,arry,totl,20);
fetchPageAjax(this[nam],pageNo,size,arry,totl,insrt,name);return;
}
}



var avail=isArrayAvailable(nam);
if(avail==1){
var avlble=this[nam].isPageAvailable(name,pageNo,size);
if(avlble==1){
var totl_Arry=getCookievalue(nam);
var no_pages=Math.floor(totl_Arry/size);
if(totl_Arry%size!=0)no_pages=no_pages+1;
var aa=this[nam].getResultPage(nam,pageNo,size);
var ss='<div id="additionalMail_1" style="display: none;";></div>';
var ss1='<div id="additionalMail_3pane" style="display: none;";></div>';
var itr=0;var id=2;
while(xx=this[nam].fetchRow(aa))
if(xx[0]!=""){var mailId=xx[0];
var subject=xx[5];
if(subject=="" || subject==false)
subject="{cfn:getmessage(472)}";
var from=xx[1];
var from1=from.substring(from.length-1);
if(from1==",")from=from.substring(0,from.length-1);
if(xx[2]!="")
var to=xx[2];else if(xx[3]!="")
var to=xx[3];else var to=xx[4];
var to1=to.substring(to.length-1);
if(to1==",")
to=to.substring(0,to.length-1);
if(xx[6]=="" || xx[6]==false)
var mailContentShort="";
else var mailContentShort=xx[6];
if(xx[13]>1)var mailCount="("+xx[13]+")";else var mailCount="";
if((name!="trash")&&(xx[15].substring(0,5)!="trash")&&(xx[15].substring(0,4)!="spam")&&name!="spam")//Exclude Spam Folder
{
if(xx[8]==0)
var starflag='<a href="javascript:markstar('+mailId+","+pageNo+",1,0,'"+xx[14]+"','"+xx[15]+'\')"><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner str-g" alt=\" \"></a>';
else var starflag='<a href="javascript:markstar('+mailId+","+pageNo+",0,0,'"+xx[14]+"','"+xx[15]+'\')"><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner str-y" alt=\" \"></a>';
}
else if(name=="spam" || (xx[15].substring(0,4)=="spam"))
	{
	starflag="<i class=\"fa fa-exclamation-triangle\"></i>";
	}
else
  var starflag="<i class=\"fa fa-trash-o\"></i>";
  
var time=xx[9];var attach=xx[10];
var readflag=xx[7];//alert(xx[7]);
if(readflag==1){
var readclass="readmail";
var readcontent="readContent";
var twopaneMail="twopaneMailRead";
var threepaneMail="threepaneMailRead";
}

else{var readclass="unreadmail";var readcontent="unreadContent";
var twopaneMail="twopaneMailUnRead";
var threepaneMail="threepaneMailUnRead";
}
var hash_mail=encode64(mailId+"/"+xx[14]+"/"+xx[15]);

var ss=ss+'<div class="'+twopaneMail+'" id="twopaneMail_'+xx[0]+'" onMouseOver="mouseoverMail('+mailId+",'"+name+"','"+nam+"','"+xx[14]+'\')" onMouseOut="mouseoutMail('+mailId+",'"+name+"','"+nam+"','"+xx[14]+'\')"><div id="shortDiv_mail_'+mailId+'" class=\"mail-list-in\"><table class=\"mail-list-tbl\" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout:fixed;border-collapse: collapse;height:40px;vertical-align:middle;"><tr><td width="24px" style=""><input type="checkbox" class="mailCheckBox"  id="cb_'+xx[0]+'" onClick="clickCheckbox('+mailId+",'"+name+"','"+nam+"',"+pageNo+",0,'"+xx[14]+"','"+xx[15]+'\')"></td><td width="22px" style=""><div class="star" id="star_'+xx[0]+'"  >'+starflag+'</div></td><td width="20%"  style="text-overflow:ellipsis;overflow:hidden;white-space:nowrap;line-height:25px;vertical-align:middle;padding-left:5px;cursor: pointer;padding-right:15px;"  onClick="clickonDiv(\''+name+"',"+mailId+","+itr+",0,"+xx[13]+","+mailId+","+pageNo+",0,'"+xx[12]+"','"+xx[14]+"','"+xx[15]+"')\" >";

var ss1=ss1+'<div onClick="clickonDiv(\''+name+"',"+mailId+","+itr+",0,"+xx[13]+","+mailId+","+pageNo+",0,'"+xx[12]+"','"+xx[14]+"','"+xx[15]+'\')" class="'+threepaneMail+'" id="threepaneMail_'+xx[0]+'"     onMouseOver="mouseoverMail('+mailId+",'"+name+"','"+nam+"','"+xx[14]+'\')" onMouseOut="mouseoutMail('+mailId+",'"+name+"','"+nam+"','"+xx[14]+'\')"><div id="shortDiv_mail_3pane_'+mailId+'" class=\"mail-list-in\"><table class=\"mail-list-tbl\" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout:fixed;border-collapse: collapse;height:40px;vertical-align:middle;"><tr><td width="10%" style=""><input type="checkbox" class="mailCheckBox"  id="cb1_'+xx[0]+'" onClick="clickCheckbox('+mailId+",'"+name+"','"+nam+"',"+pageNo+",0,'"+xx[14]+"','"+xx[15]+'\')"></td><td width="10%" style=""><div class="star" id="star_3pane_'+xx[0]+'"  >'+starflag+'</div></td><td width="60%"  style="text-overflow:ellipsis;overflow:hidden;white-space:nowrap;line-height:25px;vertical-align:middle;padding-left:5px;cursor: pointer;padding-right:15px;"  onClick="clickonDiv(\''+name+"',"+mailId+","+itr+",0,"+xx[13]+","+mailId+","+pageNo+",0,'"+xx[12]+"','"+xx[14]+"','"+xx[15]+"')\" >";



if(name=="draft"||name=="sent")
{	
  ss=ss+'<span class="readmail"><a href="#'+name+"/"+hash_mail+'" >{cfn:getmessage(31)}:'+to+mailCount+"</a></span>";
  ss1=ss1+'<span class="readmail"><a href="#'+name+"/"+hash_mail+'" >{cfn:getmessage(31)}:'+to+mailCount+"</a></span>";
}
else{ss=ss+'<span id="fromaddress_span'+xx[0]+'" ';
ss=ss+' class="'+readclass+'"><a href="#'+name+"/"+hash_mail+'" >'+from+mailCount+"</a></span>";
ss1=ss1+'<span id="fromaddress_span_3pane'+xx[0]+'" ';
ss1=ss1+' class="'+readclass+'"><a href="#'+name+"/"+hash_mail+'" >'+from+mailCount+"</a></span>";
}
ss=ss+"</td><td style=\"text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:55%;cursor:pointer;padding-left:10px;\"  onClick=\"clickonDiv('"+name+"',"+mailId+","+itr+",0,"+xx[13]+","+mailId+","+pageNo+",0,'"+xx[12]+"','"+xx[14]+"','"+xx[15]+"')\">";
ss=ss+'<span  class="mail_sub_cont"><span  id="mailsubject_span'+xx[0]+'"';
ss=ss+'class="'+readclass+'" ><a href="#'+name+"/"+hash_mail+'" >'+subject+"</a>";
ss=ss+'</span><span  id="mailcontent_span'+xx[0]+'" class="'+readcontent+'"><a href="#'+name+"/"+hash_mail+'" >';if(mailContentShort!=""&&subject!="")ss=ss+"&nbsp;";

//Three pane starts Here
ss1=ss1+'</td>';
ss1=ss1+"<td width='20%' onClick=\"clickonDiv('"+name+"',"+mailId+","+itr+",0,"+xx[13]+","+mailId+","+pageNo+",0,'"+xx[12]+"','"+xx[14]+"','"+xx[15]+'\')" style="cursor: pointer;"><span class="fromDate_short"><a href="#'+name+"/"+hash_mail+'" >'+time+"</a></span></td></tr>";
ss1=ss1+"<tr><td colspan='4' style='text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:55%;cursor: pointer;padding-left:10px;'  onClick=clickonDiv(\'"+name+"',"+mailId+","+itr+",0,"+xx[13]+","+mailId+","+pageNo+",0,'"+xx[12]+"','"+xx[14]+"','"+xx[15]+"')\>";
ss1=ss1+'<span  class="mail_sub_cont" onClick="clickonDiv(\''+name+"',"+mailId+","+itr+",0,"+xx[13]+","+mailId+","+pageNo+",0,'"+xx[12]+"','"+xx[14]+"','"+xx[15]+'\')"><span  id="mailsubject_span_3pane'+xx[0]+'" ';
ss1=ss1+' class="'+readclass+'"><a href="#'+name+"/"+hash_mail+'" >'+subject+"</a>";
ss1=ss1+' </span></td></tr><td colspan="4" style="text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:55%;cursor: pointer;padding-left:10px;" ><span id="mailcontent_span_3pane_'+xx[0]+'" class="'+readcontent+'" style="" onClick="clickonDiv(\''+name+"',"+mailId+","+itr+",0,"+xx[13]+","+mailId+","+pageNo+",0,'"+xx[12]+"','"+xx[14]+"','"+xx[15]+'\')"><a href="#'+name+"/"+hash_mail+'" >';if(mailContentShort!=""&&subject!="")ss=ss+"&nbsp;-&nbsp; ";

//Three  pane Ends Here 

var regex = new RegExp('<br>', 'g');
var mailShort = mailContentShort.replace(regex, '&nbsp;');
var regex = new RegExp('<div>', 'g');
mailShort = mailShort.replace(regex, '');
var regex = new RegExp('</div>', 'g');
mailShort = mailShort.replace(regex, '');
ss=ss+""+mailShort+"</a></span></span></td>";
ss=ss+'<td width="32px" style="padding-left:10px;cursor: pointer;" onClick="clickonDiv(\''+name+"',"+mailId+","+itr+",0,"+xx[13]+","+mailId+","+pageNo+",0,'"+xx[12]+"','"+xx[14]+"','"+xx[15]+'\')" ><div class="attachIcon">'+attach+"</div></td><td onClick=\"clickonDiv('"+name+"',"+mailId+","+itr+",0,"+xx[13]+","+mailId+","+pageNo+",0,'"+xx[12]+"','"+xx[14]+"','"+xx[15]+'\')" style="cursor: pointer;"><span class="fromDate_short"><a href="#'+name+"/"+hash_mail+'" >'+time+"</a></span></td></table></div></div>";

// Three Pane Starts here
ss1=ss1+""+mailShort+"</a></span></span></td></tr>";
ss1=ss1+'<tr><td colspan="4"   style="padding-left:10px;cursor: pointer;" onClick="clickonDiv(\''+name+"',"+mailId+","+itr+",0,"+xx[13]+","+mailId+","+pageNo+",0,'"+xx[12]+"','"+xx[14]+"','"+xx[15]+'\')" ><div class="attachIcon">'+attach+"</div></td></tr></table></div></div>";itr=itr+1}

//Three pane Ends Here
if(no_pages>1)
{
if(pageNo==1)
{
var hash_page1=encode64("p"+no_pages);
var hash_page2=encode64("p2");
ss=ss+'<div class="pageingDiv sddm"><a class=\"last_bvtn cntrl_btn\" href="#'+name+"/"+hash_page1+'" onClick="javascript:mainWindow(\''+name+"',"+no_pages+","+size+","+totl+',3)"><span>{cfn:getmessage(431)}</span></a><a  class=\"prv_bvtn cntrl_btn\" href="#'+name+"/"+hash_page2+'" onClick="javascript:mainWindow(\''+name+"',2,"+size+","+totl+',2)"><span>{cfn:getmessage(433)}</span></a></div>';

ss1=ss1+'<div class="pageingDiv sddm"><a class=\"last_bvtn cntrl_btn\" href="#'+name+"/"+hash_page1+'" onClick="javascript:mainWindow(\''+name+"',"+no_pages+","+size+","+totl+',3)"><span>{cfn:getmessage(431)}</span></a><a  class=\"prv_bvtn cntrl_btn\" href="#'+name+"/"+hash_page2+'" onClick="javascript:mainWindow(\''+name+"',2,"+size+","+totl+',2)"><span>{cfn:getmessage(433)}</span></a></div>';
}
else if(pageNo==no_pages)
{
prev=parseInt(no_pages)-parseInt(1);
var hash_page1=encode64("p"+prev);
var hash_page2=encode64("p1");
ss=ss+'<div class="pageingDiv sddm"><a class=\"last_bvtn cntrl_btn\" href="#'+name+"/"+hash_page1+'" onClick="javascript:mainWindow(\''+name+"',"+prev+","+size+","+totl+',3)"><span>{cfn:getmessage(432)}</span></a><a class=\"prv_bvtn cntrl_btn\" href="#'+name+"/"+hash_page2+'" onClick="javascript:mainWindow(\''+name+"',1,"+size+","+totl+',2)"><span>{cfn:getmessage(442)}</span></a></div>';

ss1=ss1+'<div class="pageingDiv sddm"><a class=\"last_bvtn cntrl_btn\" href="#'+name+"/"+hash_page1+'" onClick="javascript:mainWindow(\''+name+"',"+prev+","+size+","+totl+',3)"><span>{cfn:getmessage(432)}</span></a><a class=\"prv_bvtn cntrl_btn\" href="#'+name+"/"+hash_page2+'" onClick="javascript:mainWindow(\''+name+"',1,"+size+","+totl+',2)"><span>{cfn:getmessage(442)}</span></a></div>';
}
else{
prev=parseInt(pageNo)-parseInt(1);
next=parseInt(pageNo)+parseInt(1);
var hash_page1=encode64("p"+next);
var hash_page2=encode64("p"+prev);

ss=ss+'<div class="pageingDiv sddm"><a class=\"last_bvtn cntrl_btn\" href="#'+name+"/"+hash_page1+'" onClick="javascript:mainWindow(\''+name+"',"+next+","+size+","+totl+',2)"><span>{cfn:getmessage(433)}</span></a><a  class=\"prv_bvtn cntrl_btn\" href="#'+name+"/"+hash_page2+'" onClick="javascript:mainWindow(\''+name+"',"+prev+","+size+","+totl+',3)"><span>{cfn:getmessage(432)}</span></a></div>';

ss1=ss1+'<div class="pageingDiv sddm"><a class=\"last_bvtn cntrl_btn\" href="#'+name+"/"+hash_page1+'" onClick="javascript:mainWindow(\''+name+"',"+next+","+size+","+totl+',2)"><span>{cfn:getmessage(433)}</span></a><a  class=\"prv_bvtn cntrl_btn\" href="#'+name+"/"+hash_page2+'" onClick="javascript:mainWindow(\''+name+"',"+prev+","+size+","+totl+',3)"><span>{cfn:getmessage(432)}</span></a></div>';

}ss=ss+"";ss1=ss1+"";
}
getfolderName(name);
document.getElementById("short_detail").setAttribute("class","short");
if(itr==0)
{
document.getElementById("mailContent").innerHTML='<div class="warningTxt"><i class="fa fa-exclamation-circle"></i> {cfn:getmessage(30)}</div>';
document.getElementById("mail_subheader").style.display="none";}
else {
	document.getElementById("mailContent").innerHTML=ss;
	document.getElementById("mailContent11").innerHTML=ss1;}
document.getElementById("mailContent").style.width="100%";
if(document.getElementById("rightads_td").style.display=="")
document.getElementById("rightads_td").style.display="none"}
else fetchPageAjax(this[nam],pageNo,size,arry,totl,insrt,name)}

else{var no_pages=Math.floor(totl/size);
if(totl%size!=0)no_pages=no_pages+1;
this[nam]=new Table(name,arry,totl,20);
fetchPageAjax(this[nam],pageNo,size,arry,totl,insrt,name)}};

  //This function is called on Refresh Button Onclick. 
  function getmail1()
  {document.getElementById('loadingDiv').style.display="";
  document.getElementById('getmailbtnid').className="fa fa-refresh fa-spin position_tooltip";
  var inbxobj=this['inbox'];
  var spmobj=this['spam'];  	
  var trshobj=this['trash'];
  var currentTime=new Date();
  var crntime=currentTime.getTime();
  
  $.ajax({

type: "GET",cache: false,
ifModified: true,
url: "{url:(mime/getmail)}/"+crntime+"/"+1,

success: function(data) {//alert(data);
          var x=data;
     
          if(x!="")
          {
        	  document.getElementById('getmailbtnid').className="fa fa-repeat position_tooltip";
             var counts=x.split("/");
             
             var inbox=counts[0];
             var spam=counts[1];
             var trash=counts[2];
             if(counts[3]!="")
             {
                    var custom=new Array();
                     var cus_string1=counts[3].split("{**}");
                     for(var urdcnt=0;urdcnt<customFoldercount;urdcnt++)
                     {
                     
                    
                        for(var a=0;a<(cus_string1.length);a++)
                        {
                          var cus_string2=cus_string1[a].split("@@");
                     
                          var customname="custom"+cus_string2[0];
                        
                     
                             if(Unread[urdcnt][0]==customname)
                               {
                           
                                  if(cus_string2[1]!=0)
                                  {
                                     var cus_count=getCookievalue("custom"+cus_string2[0]);
                                     cus_count=parseInt(cus_count)+parseInt(cus_string2[1]);
                                     SetCookie("custom"+cus_string2[0],cus_count,1);
                                     Unread[urdcnt][1]=parseInt(Unread[urdcnt][1])+parseInt(cus_string2[1]);
                                   }
                                   Unread[urdcnt][2]=1;
                                }
                          }
                       }
              }
             
             var inbox_count=getCookievalue("inbox");
             
             var sent_count=getCookievalue("sent");
             var spam_count=getCookievalue("spam");
             var trash_count=getCookievalue("trash");
             
             
           var  total_in=parseInt(inbox)+parseInt(inbox_count);
      
            var total_sp=parseInt(spam)+parseInt(spam_count);
            var total_tr=parseInt(trash)+parseInt(trash_count);
              SetCookie("inbox",total_in,1);   SetCookie("spam",total_sp,1);   SetCookie("trash",total_tr,1);  
             if(inbox!=0)
             {
              Unread[0][2]=1;
              Unread[0][1]=parseInt(Unread[0][1])+parseInt(inbox);
              }
              if(spam!=0)
              {
               Unread[3][2]=1; 
                  Unread[3][1]=parseInt(Unread[3][1])+parseInt(spam);
              }
               if(trash!=0)
               {
               Unread[4][2]=1; 
                  Unread[4][1]=parseInt(Unread[4][1])+parseInt(trash);
              }
               setUnreadcount();
              
               
               
             var hashing=window.location.hash;
              
               if((hashing=='#inbox')||(hashing=='#inbox/cDE_'))
              {
                 if(Unread[0][2]==1)
                   mainWindow('inbox',1,mailsPerpage,total_in,2);
                  window.location.hash="#inbox";
              }
              else if((hashing=='#spam')||(hashing=='#spam/cDE_'))
              {
               if(Unread[3][2]==1)
              mainWindow('spam',1,mailsPerpage,total_sp,2);
                  window.location.hash="#spam";
              }
              else if((hashing=='#trash')||(hashing=='#trash/cDE_'))
              {
               if(Unread[4][2]==1)
               mainWindow('trash',1,mailsPerpage,total_tr,2);
               window.location.hash="#trash";
              }
              else if(hashing.substring(0,7)=='#custom')
              {
              for(var urdcnt=0;urdcnt<customFoldercount;urdcnt++)
             {
             if(hashing=='#'+Unread[urdcnt][0] &&  Unread[urdcnt][2]==1)
             {
                 var cus_count=getCookievalue(Unread[urdcnt][0]);
                 
                 mainWindow(Unread[urdcnt][2],1,mailsPerpage,cus_count,2);
               }
              }
              
              }
             
          }
          
          
          document.getElementById('loadingDiv').style.display="none";
          
          
      }
  });
}
//This Function is called Every 30 seconds for  checking for a  new mail arrival.
function getmail2()
{
var inbxobj=this['inbox'];
  var spmobj=this['spam'];  	
  var trshobj=this['trash'];
  var currentTime=new Date();
  var crntime=currentTime.getTime();
  $.ajax({

type: "GET",cache: false,
ifModified: true,
url: "{url:(mime/getmail)}/"+crntime+"/"+0,

success: function(data) {//alert(data);
          var x=data;
          if(x!="")
          {
        	  
           var counts=x.split("/");
             
             var inbox=counts[0];
             var spam=counts[1];
             var trash=counts[2];
             if(counts[3]!="")
             {
                 var custom=new Array();
                 var cus_string1=counts[3].split("{**}");
                 for(var urdcnt=0;urdcnt<customFoldercount;urdcnt++)
                 {
                 
                     for(var a=0;a<(cus_string1.length);a++)
                     {
                        var cus_string2=cus_string1[a].split("@@");
                        var customname="custom"+cus_string2[0];
                        
                     
                           if(Unread[urdcnt][0]==customname)
                           { 
                           
                              if(cus_string2[1]!=0)
                              {
                               var cus_count=getCookievalue("custom"+cus_string2[0]);
                               cus_count=parseInt(cus_count)+parseInt(cus_string2[1]);
                               SetCookie("custom"+cus_string2[0],cus_count,1);
                               Unread[urdcnt][1]=parseInt(Unread[urdcnt][1])+parseInt(cus_string2[1]);
                               }
                             Unread[urdcnt][2]=1;
                           
                            
                            }
                       }
                    
                  }
            }
             
             var inbox_count=getCookievalue("inbox");
             
             var sent_count=getCookievalue("sent");
             var spam_count=getCookievalue("spam");
             var trash_count=getCookievalue("trash");
             
             
           var  total_in=parseInt(inbox)+parseInt(inbox_count);        
            var total_sp=parseInt(spam)+parseInt(spam_count);
            var total_tr=parseInt(trash)+parseInt(trash_count);
              SetCookie("inbox",total_in,1);   SetCookie("spam",total_sp,1);   SetCookie("trash",total_tr,1);  
              if(inbox!=0)
             {
              Unread[0][2]=1;
              Unread[0][1]=parseInt(Unread[0][1])+parseInt(inbox);
              }
              if(spam!=0)
              {
               Unread[3][2]=1; 
                  Unread[3][1]=parseInt(Unread[3][1])+parseInt(spam);
              }
               if(trash!=0)
               {
               Unread[4][2]=1; 
                  Unread[4][1]=parseInt(Unread[4][1])+parseInt(trash);
              }
               setUnreadcount();
              
               
               
             var hashing=window.location.hash;
               if((hashing=='#inbox')||(hashing=='#inbox/cDE_'))
              {
                 if(Unread[0][2]==1)
                   mainWindow('inbox',1,mailsPerpage,total_in,2);
                  window.location.hash="#inbox";
              }
              else if((hashing=='#spam')||(hashing=='#spam/cDE_'))
              {
              if(Unread[3][2]==1)
              mainWindow('spam',1,mailsPerpage,total_sp,2);
                  window.location.hash="#spam";
              }
              else if((hashing=='#trash')||(hashing=='#trash/cDE_'))
              {
              if(Unread[4][2]==1)
               mainWindow('trash',1,mailsPerpage,total_tr,2);
               window.location.hash="#trash";
              }
              else if(hashing.substring(0,7)=='#custom')
              {
              for(var urdcnt=0;urdcnt<customFoldercount;urdcnt++)
              {
                 if(hashing=='#'+Unread[urdcnt][0] && Unread[urdcnt][2]==1)
                 {
                   var cus_count=getCookievalue(Unread[urdcnt][0]);
                   mainWindow(Unread[urdcnt][0],1,mailsPerpage,cus_count,2);
                 
                   }
              }
              
              }
          
             
          }
          
          
          
      }
     
  });
  }

function getfolderName(nam){ 

if(nam=="inbox")
document.getElementById("heading").innerHTML="<i class=\"fa fa-inbox\"></i> {cfn:getmessage(19)}";
else if(nam=="draft")document.getElementById("heading").innerHTML="<i class=\"fa fa-file-text\"></i> {cfn:getmessage(20)}";
else if(nam=="sent")document.getElementById("heading").innerHTML="<i class=\"fa fa-paper-plane\"></i> {cfn:getmessage(21)}";
else if(nam=="spam")document.getElementById("heading").innerHTML="<i class=\"fa fa-exclamation-triangle\"></i> {cfn:getmessage(12)}";
else if(nam=="starred")document.getElementById("heading").innerHTML="<i class=\"fa fa-star\"></i> {cfn:getmessage(205)}";
else if(nam=="trash")document.getElementById("heading").innerHTML="<i class=\"fa fa-trash\"></i> {cfn:getmessage(22)}";
else if(nam.substring(0,6)=="search")
{

 var keyword=nam.split("_");
 var folder=keyword[0].substring(6);
          var temp="<i class=\"fa fa-search\"></i> {cfn:getmessage(163)}";
          temp=temp.replace("{search}",keyword[1]);
          var fldrNam=fldrnm(folder);
          
          temp=temp.replace("{folder}",fldrNam);
          document.getElementById("heading").innerHTML=temp;
}
else if(nam.substring(0,4)=="from")
{
  var result="";
  var string=nam.split("*");
  var string_from=string[0].split("?");
  if(string_from[1]!="")
  result+="from:"+string_from[1];
  
  var string_to=string[1].split("?");
  if(string_to[1]!="")
  result+=" to:"+string_to[1];
  
  var string_subject=string[2].split("?");
  if(string_subject[1]!="")
  result+=" subject:"+string_subject[1];
  
  var string_keywords=string[3].split("?");
  if(string_keywords[1]!="")
  result+=" keywords:"+string_keywords[1];
  
  var string_folder=string[4].split("?");
  var foldername=fldrnm(string_folder[1]);
  
  var string_attach=string[5].split("?");
  if(string_attach[1]==1)
  result+=" has:"+"attachment";
  
  var temp="<i class=\"fa fa-search\"></i> {cfn:getmessage(163)}";
          temp=temp.replace("{search}",result);

          
          temp=temp.replace("{folder}",foldername);
          document.getElementById("heading").innerHTML=temp;
  
  

}
else getfolderNameajax(nam)};
function fetchDetails(name,mailId,objName,arry,status,pageNo,pageStatus,parentId,mainPage,org_folder,object,search_object)
{
var c_view=getCookievalue("current_view");//The current view is identified in 2 pane and 3 pane.

mail_open=1;
document.getElementById('loadingDiv').style.display="";
  var currentTime=new Date();
  var crntime=currentTime.getTime();
  var img_url="{url:(mail/adddisplaynow/)}";
var img_url_a="{url:(mail/adddisplay/)}";
  if(pageStatus==0)
  var names=object;
  else
  var names=object;
 // alert(names);
  objName=this[names];
  var avlAry1=isArrayAvailable(names);
  if(avlAry1!=0)
   var opjtforcnt=this[names];
   $.ajax({

type: "GET",cache: false,
url: "{url:(mail/getdetailedmails)}/"+name+"/"+mailId+"/"+arry+"/"+org_folder+"/"+crntime+"/"+object,

success: function(data) {
   
          var x=data;
          if(x!="")

           {
          var mails=new Array(100);
              var tble=" <div class=\"messageTab\" id=\"msg_div\"  style=\"display: none;\" >   <span class=\"messageTabL\"></span>   <span class=\"messageTabM\" id=\"message\"></span>      <span class=\"messageTabR\"></span>       </div>";
            
              
              
              
              mails=x.split("{nesote_///}");
              var a=1;var loopvariable=0;
              for(var j=0;j<(mails.length);j++)
              {
                  var values=new Array(100);
                  values=mails[j].split("{nesote_,}");
             // alert(avlAry1);
                  if(avlAry1!=0)
                  {
                      values[0]=values[0].replace(/^[\s]+/,'').replace(/[\s]+$/,'').replace(/[\s]{2,}/,' ');//for trimming 
                  
                      var readfl=new Array(1);
                      readfl[0]='readflag';
                      var readval=new Array(1);
                      readval[0]="1";
                      if(values[7]==0)
                      {
                          if((name!='sent')&&(name!='draft')&&(name!='trash')&&(name!='starred'))
                          {
                              for(var urdcnt=0;urdcnt<customFoldercount;urdcnt++)
                              {
                                  if(Unread[urdcnt][0]==name)
                                  Unread[urdcnt][1]=parseInt(Unread[urdcnt][1])-parseInt(1);
                              }
                          }
                      }
                      var idz1=new Array(1);
                      idz1[0]=values[0];
                      opjtforcnt.update(name,readfl,readval);
                      opjtforcnt.where('id=?',idz1);
                      opjtforcnt.action();
                      setUnreadcount();
                  }
                  
                  var from=values[1];
                  var subject=values[5];
                  if(j==0)
                      tble=tble+"<h2>"+subject+"</h2><div class=\"mailBox\">";

                  var readflag=values[7];
                  var mailTime=values[9];
                  var d = values[15];
          var mailTime1=values[18];
                  if(values[10]=="" || values[10]==false)
                  var attach="";
                  else
                  var attach="<img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner attach-a\" alt=\" \">";
                  var mailsId=values[0];
                  var designId=mailId+"_"+loopvariable;
                  var star_pageNo=getCookievalue("mail_page");
                  if((name!="trash")&&(search_object.substring(0,5)!="trash")&&(search_object.substring(0,4)!="spam")&&name!="spam")
                  {
                  if(values[8]==0)
                  var starField="<a href=\"javascript:markstar("+mailsId+","+star_pageNo+",1,"+mailId+",'"+names+"','"+search_object+"')\"><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner str-g\" alt=\" \"></a>";
                  else
                  var starField="<a href=\"javascript:markstar("+mailsId+","+star_pageNo+",0,"+mailId+",'"+names+"','"+search_object+"')\"><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner str-y\" alt=\" \"></a>";
                  }
                  else if(name=="spam"||(search_object.substring(0,4)=="spam"))
                       {var starField="<i class=\"fa fa-exclamation-triangle\"></i>";}
                   else
                   var starField="<i class=\"fa fa-trash-o\"></i>";
                   
                  if(values[6]=="")
                  var mailContentShort="";
                  else
                  
                  var mailContentShort=values[16];
                  var mailContent=values[6];
                  objName.insert(names,2,values,'time_int','desc');
                  var no=a;objName.totl2=parseInt(objName.totl2)+parseInt(1);
                  if((name=="draft")||(values[12]=="draft"))
                  {	
          if(filevar_a!=0)
          {
            for(var d=1;d<=filevar_a;d++)
            {
            if(document.getElementById("upload_target"+d))
             document.getElementById("upload_target"+d).style.display="none";
           }
          }



        if(document.getElementById("filedivcontainer_0_0_0").style.display=="")
          document.getElementById("filedivcontainer_0_0_0").style.display="none";
                      if(new_flag==0)
                          {
                          new_flag=1;
                          }
                          else if(new_flag==1)
                          {
                      
                        	  CKEDITOR.instances.mailBody_0_0.destroy();

                        	  //nicEditor1.removeInstance('mailBody_0_0');
                          }
                          document.getElementById("draftid_0_0").value=values[0];
                      document.getElementById("mailContent").style.display="none";
                      document.getElementById("newMail").style.display="";
                      document.getElementById("to_0_0").value=values[2];
                      if((trim(values[3])!="")&&(trim(values[4])!=""))
                      {
                          document.getElementById("cc_bcc_0").style.display="none";
                          document.getElementById("showcc_0").style.display="";
                          document.getElementById("cc_0_0").style.display="";
                          document.getElementById("cc_0_0").value=values[3];
                          document.getElementById("showbcc_0").style.display="";
                          document.getElementById("bcc_0_0").style.display="";
                          document.getElementById("bcc_0_0").value=values[4];
                      }
                      else if(trim(values[3])!="")
                      {	
                          document.getElementById("cc_bcc_0").style.display="none";
                          document.getElementById("showcc_0").style.display="";
                          document.getElementById("bcc_only_0").style.display="";
                          document.getElementById("cc_0_0").style.display="";
                          document.getElementById("cc_0_0").value=values[3];
                      }
                      else if(trim(values[4])!="")
                      {
                          document.getElementById("cc_bcc_0").style.display="none";
                          document.getElementById("showbcc_0").style.display="";
                          document.getElementById("cc_only_0").style.display="";
                          document.getElementById("bcc_0_0").style.display="";
                          document.getElementById("bcc_0_0").value=values[4];
                      }
                      else
                      {
                          if(document.getElementById("cc_bcc_0").style.display=="none")
                          document.getElementById("cc_bcc_0").style.display="";
                          if(document.getElementById("showbcc_0").style.display=="")
                          document.getElementById("showbcc_0").style.display="none";
                          if(document.getElementById("cc_only_0").style.display=="")
                          document.getElementById("cc_only_0").style.display="none";
                          if(document.getElementById("bcc_only_0").style.display=="")
                          document.getElementById("bcc_only_0").style.display="none";
                          if(document.getElementById("showcc_0").style.display=="")
                          document.getElementById("showcc_0").style.display="none";
                          if(document.getElementById("cc_0_0").style.display=="")
                          document.getElementById("cc_0_0").style.display="none";
                          if(document.getElementById("bcc_0_0").style.display=="")
                          document.getElementById("bcc_0_0").style.display="none";
                      }
                      if(values[10]!="")
                      {
                          if(document.getElementById("additionalattach_0_0").style.display=="none")
                          document.getElementById("additionalattach_0_0").style.display="";
                          if(document.getElementById('attachlink_0_0').style.display=="")
                          document.getElementById('attachlink_0_0').style.display="none";
                          if(document.getElementById("forwardz").style.display=="none")
                          document.getElementById("forwardz").style.display="";
                          document.getElementById("forwardz").innerHTML="";
                          createAttachmentdiv(values[12],values[0]);
                      }
                      else
                      {
                          filevar_a=0;
                          filevar_count=0;
                          if(document.getElementById("additionalattach_0_0").style.display=="")
                          document.getElementById("additionalattach_0_0").style.display="none";
                          if(document.getElementById('attachlink_0_0').style.display=="none")
                          document.getElementById('attachlink_0_0').style.display="";
                          if(document.getElementById("filedivcontainer_0_0_0").style.display=="")
                          document.getElementById("filedivcontainer_0_0_0").style.display="none";
                          if(document.getElementById("forwardz").style.display=="")
                          document.getElementById("forwardz").style.display="none";
                      }
                      if(values[5]!="")
                      document.getElementById("subject_0_0").value=values[5];
                       //nicEditor1= new nicEditor({fullPanel : true}).panelInstance("mailBody_0_0");
          
                      //nicEditors.findEditor("mailBody_0_0").setContent(values[6]);
                      CKEDITOR.replace('mailBody_0_0');
                      
                      var editor= CKEDITOR.instances.mailBody_0_0;
                      editor.setData(values[6]);
                      
                  }
                  else
                  {
                      if((readflag==1)&&(a<mails.length))
                      {
                          values[11]=0;
                          if(values[6]=="")
                          values[6]="";
                          else
                          values[6]=reduceChar(values[6]);
                          if(c_view=="3pane")
                          tble=tble+"<div  id=\"mailDivshort_"+designId+"\" class=\"mailBoxTitle\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\" id=\"star_3pane_" + values[0] + "\" >"+starField+"</span><span  class=\"fromName\" ><a href=\"javascript:clickonDiv1('"+names+"','"+designId+"','"+values[12]+"',"+values[0]+","+pageNo+",'"+object+"','"+search_object+"');\">"+from+"</a></span><span class=\"titleContent\"><a href=\"javascript:clickonDiv1('"+names+"','"+designId+"','"+values[12]+"',"+values[0]+","+pageNo+",'"+object+"','"+search_object+"')\" class=\"titleContent-Link\">"+mailContentShort+"</a></span></span><span class=\"mailBoxRT\"></span><span class=\"fromDate\"><a href=\"javascript:clickonDiv1('"+names+"','"+designId+"','"+values[12]+"',"+values[0]+","+pageNo+",'"+object+"','"+search_object+"')\">"+attach+" "+mailTime+"</a></span></div>";
                          else
                          tble=tble+"<div  id=\"mailDivshort_"+designId+"\" class=\"mailBoxTitle\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\" id=\"star_" + values[0] + "\" >"+starField+"</span><span  class=\"fromName\" ><a href=\"javascript:clickonDiv1('"+names+"','"+designId+"','"+values[12]+"',"+values[0]+","+pageNo+",'"+object+"','"+search_object+"');\">"+from+"</a></span><span class=\"titleContent\"><a href=\"javascript:clickonDiv1('"+names+"','"+designId+"','"+values[12]+"',"+values[0]+","+pageNo+",'"+object+"','"+search_object+"')\" class=\"titleContent-Link\">"+mailContentShort+"</a></span></span><span class=\"mailBoxRT\"></span><span class=\"fromDate\"><a href=\"javascript:clickonDiv1('"+names+"','"+designId+"','"+values[12]+"',"+values[0]+","+pageNo+",'"+object+"','"+search_object+"')\">"+attach+" "+mailTime+"</a></span></div>";
                          tble=tble+"<div id=\"mailDiv_"+designId+"\" class=\"mailBoxOpened\" style=\"display: none;\"></div>";
                          
                      }
                      else if(a<mails.length)
                      {
                          values[11]=1;
                          if(c_view=="3pane")
                          tble=tble+"<div  id=\"mailDivshort_"+designId+"\" class=\"mailBoxTitle\"  style=\"display:none;\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\" id=\"star_3pane_" + names + "\" >"+starField+"</span><span  class=\"fromName\" ><a href=\"javascript:clickonDiv('"+name+"',"+mailId+","+no+",1,"+mails.length+","+mailsId+","+pageNo+","+loopvariable+",'"+org_folder+"','"+object+"','"+search_object+"');\">"+from+"</a></span><span class=\"titleContent\"><a href=\"javascript:clickonDiv('"+name+"',"+mailId+","+no+",1,"+mails.length+","+mailsId+","+pageNo+","+loopvariable+",'"+org_folder+"','"+object+"','"+search_object+"')\">"+mailContentShort+"</a></span></span><span class=\"mailBoxRT\"></span><span class=\"fromDate\"><a href=\"javascript:clickonDiv('"+name+"',"+mailId+","+no+",1,"+mails.length+","+mailsId+","+pageNo+","+loopvariable+",'"+org_folder+"','"+object+"','"+search_object+"')\">"+attach+" "+mailTime+"</a></span></div>";
                          else  
                          tble=tble+"<div  id=\"mailDivshort_"+designId+"\" class=\"mailBoxTitle\"  style=\"display:none;\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\" id=\"star_" + names + "\" >"+starField+"</span><span  class=\"fromName\" ><a href=\"javascript:clickonDiv('"+name+"',"+mailId+","+no+",1,"+mails.length+","+mailsId+","+pageNo+","+loopvariable+",'"+org_folder+"','"+object+"','"+search_object+"');\">"+from+"</a></span><span class=\"titleContent\"><a href=\"javascript:clickonDiv('"+name+"',"+mailId+","+no+",1,"+mails.length+","+mailsId+","+pageNo+","+loopvariable+",'"+org_folder+"','"+object+"','"+search_object+"')\">"+mailContentShort+"</a></span></span><span class=\"mailBoxRT\"></span><span class=\"fromDate\"><a href=\"javascript:clickonDiv('"+name+"',"+mailId+","+no+",1,"+mails.length+","+mailsId+","+pageNo+","+loopvariable+",'"+org_folder+"','"+object+"','"+search_object+"')\">"+attach+" "+mailTime+"</a></span></div>";
                          tble=tble+"<div id=\"mailDiv_"+designId+"\" class=\"mailBoxOpened\" >";
                          if(c_view=="3pane")
                          tble=tble+"<div id=\"short_"+designId+"\" class=\"mailBoxTitle\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\" id=\"star_3pane_" + values[0] + "\" >"+starField+"</span><span  class=\"fromName\" ><a href=\"javascript: hide('"+designId+"')\" >{cfn:getmessage(54)}:"+from+"</a></span> <span class=\"showDetailBtn\"><a href=\"javascript:showDetails('"+designId+"');\">{cfn:getmessage(282)}</a></span></span><span class=\"mailBoxRT\"></span><span class=\"fromDate\"><a href=\"javascript:showDetails('"+designId+"');\">"+mailTime+"</a></span></div>";
                          else
                          tble=tble+"<div id=\"short_"+designId+"\" class=\"mailBoxTitle\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\" id=\"star_" + values[0] + "\" >"+starField+"</span><span  class=\"fromName\" ><a href=\"javascript: hide('"+designId+"')\" >{cfn:getmessage(54)}:"+from+"</a></span> <span class=\"showDetailBtn\"><a href=\"javascript:showDetails('"+designId+"');\">{cfn:getmessage(282)}</a></span></span><span class=\"mailBoxRT\"></span><span class=\"fromDate\"><a href=\"javascript:showDetails('"+designId+"');\">"+mailTime+"</a></span></div>";
                          tble=tble+"<div  class=\"mailBoxTitle\" style=\"display: none;\" id=\"detail_"+designId+"\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\"  id=\"star_" + values[0] + "\" >"+starField+"</span><span  class=\"fromName\" >{cfn:getmessage(54)}:"+from+"</span>	<span class=\"showDetailBtn\"> <a href=\"javascript:hideDetails('"+designId+"')\">{cfn:getmessage(283)}</a></span></span><span class=\"mailBoxRT\"></span>";
                          tble=tble+"<span class=\"fromDate noArrow\"><div class=\"in\">"+mailTime+"</div></span></div>";
                          tble=tble+"<div class=\"mailBoxM\"   ><div class=\"row\" id=\"detail1_"+designId+"\" style=\"display:none;\"><div class=\"detailedList\" >";
                          if(values[2]!="")
                          tble=tble+"<div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(31)}:</div><div class=\"row floatL\"><div>"+values[2]+"</div></div></div><div style=\"clear:both\"></div>";
                          if(values[3]!="")
                          tble=tble+"<div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(32)}:</div><div class=\"row floatL\"><div>"+values[3]+"</div></div></div><div style=\"clear:both\"></div>";
                          tble=tble+"<div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(34)}:</div><div class=\"row floatL\"><div>"+values[5]+"</div></div></div><div style=\"clear:both\"></div><div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(383)}:</div><div class=\"row floatL\"><div>"+mailTime1+"</div></div></div></div></div><div style=\"clear:both\"></div>";
                          
                          if((values[14]!=0)&&(values[6]!=values[13]) && org_folder!="sent")
                          {
                              tble=tble+"<div class=\"row imageDisplay\"  align=\"center\" id=\"imagez_"+designId+"\"><span style=\"font-weight:700;\">{cfn:getmessage(216)}</span><a href=\"javascript:display_image('"+names+"','"+designId+"',"+values[0]+",'"+values[12]+"','"+img_url+"')\">{cfn:getmessage(217)}</a><span style=\"padding:2px;\">&nbsp;|&nbsp;</span><a href=\"javascript:display_imagealltime('"+names+"','"+designId+"',"+values[0]+",'"+values[12]+"','"+img_url_a+"')\">{cfn:getmessage(218)} "+from+"</a>";
                              //tble=tble+"</div><span class=\"mailContent\" id=\"contentmaildiv_"+designId+"\" >"+mailContent+"</span>";
                              tble=tble+"</div><iframe name='mail_frame' frameborder='0' scrolling='yes'  onload='javascript:resizeIframe(this);' id=\"mail_frame"+designId+"\" src='{url:(mail/mail_message_frame/"+designId+")}'></iframe>";
                           	 nesote_email_content_store=mailContent;
                          }
                          else
                          { tble=tble+"</div><iframe name='mail_frame' frameborder='0' scrolling='yes'  onload='javascript:resizeIframe(this);' id=\"mail_frame"+designId+"\" src='{url:(mail/mail_message_frame/"+designId+")}'></iframe>";
                       	     nesote_email_content_store=values[13];  // tble=tble+"<span class=\"mailContent\" id=\"contentmaildiv_"+designId+"\" >"+values[13]+"</span>";
                          }
                          
                          if(name!="draft")
                          {
                              if(values[10]!="")
                              {
                                  var ar=new Array(100);
                                  ar=values[10].split(",");
                                  for(var k=0;k<(ar.length);k++)
                                  {
                                      var pathArray=ar[k].split("::");
                                      var path=pathArray[0];var attachName=pathArray[1];
                                      tble=tble+"<div class=\"row\" style=\"padding-left:10px;width:100%;\">";
                                      if(pathArray[5]==1)
                                      tble=tble+"<span  class=\"attachedImage\"><img width=\"100px\" height=\"150px\" src=\""+path+"\"></span><span class=\"attachments\">"+attachName+"</span><span class=\"attachments\" >";
                                      else
                                      tble=tble+"<span  class=\"attachedImage\"><img  src=\""+path+"\"></span><span class=\"attachments\">"+attachName+"</span><span class=\"attachments\" >";
                                      if(pathArray[5]==1)
                                      tble=tble+"<a href=\"{url:(mail/showimage)}/"+pathArray[2]+"/"+pathArray[3]+"/"+pathArray[4]+"\" target=\"_blank\"> {cfn:getmessage(102)} </a></span><span class=\"attachments\" >";
                                      tble=tble+"<a href=\"{url:(mail/downloadattachment)}/"+pathArray[2]+"/"+pathArray[3]+"/"+pathArray[6]+"/"+pathArray[4]+"\"><i class=\"fa fa-download\"></i> {cfn:getmessage(101)} </a></span></div><div style=\"clear:both\"></div>";
                                  }
                              }
                              tble=tble+"</div>";
                              var url_mail="{url:(mail/createdraft)}";var url_print="{url:(mail/printmail/)}"+values[12]+"/"+mailsId;
                              tble=tble+"<div class=\"mailBoxFooter\" id=replyfooter1_"+designId+"><span class=\"mailBoxLF\"></span><span class=\"mailBoxBM\"><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-r\" alt=\" \"></span><a href=\"javascript:createDraft("+mailsId+",'"+names+"',"+no+",'"+name+"',1,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(15)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-a\" alt=\" \"></span><a href=\"javascript:createDraft("+mailsId+",'"+names+"',"+no+",'"+name+"',2,'"+designId+"','"+url_mail+"')\"> {cfn:getmessage(16)} </a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" alt=\" \" class=\"iconsCornner reply-f\"></span><a href=\"javascript:createDraft("+mailsId+",'"+names+"',"+no+",'"+name+"',3,'"+designId+"','"+url_mail+"')\"> {cfn:getmessage(17)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner print-btn\"></span><a href="+url_print+" target=\"_blank\">{cfn:getmessage(646)}</a></div></span><span class=\"mailBoxRF\"></span></div>";
                              tble=tble+"<div id=reply_"+designId+" style=\"display: none;\" class=\"replyWindow\">";
                              tble=tble+"<div class=\"row\" style=\"display: none;\"  id=replyfooter2_"+designId+" style=\"padding-top:5px;\"><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" alt=\" \" align=\"absmiddle\" class=\"iconsCornner reply-r\"></span><a href=\"javascript:createDraft("+mailsId+",'"+names+"',"+no+",'"+name+"',1,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(15)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-a\"></span><a href=\"javascript:createDraft("+mailsId+",'"+names+"',"+no+",'"+name+"',2,'"+designId+"','"+url_mail+"')\"> {cfn:getmessage(16)} </a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-f\"></span><a href=\"javascript:createDraft("+mailsId+",'"+names+"',"+no+",'"+name+"',3,'"+designId+"','"+url_mail+"')\"> {cfn:getmessage(17)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner print-btn\"></span><a href="+url_print+" target=\"_blank\">{cfn:getmessage(646)}</a></div></div>";
                              tble=tble+"</div>";
                          }
                          tble=tble+"</div>";
                      }
                      else
                      {//alert(values[17]);
                          values[11]=1;
                          var url_mail="{url:(mail/createdraft)}";var url_print="{url:(mail/printmail/)}"+values[12]+"/"+mailsId;
                          
                          tble=tble+"<div id=\"mailDiv_"+designId+"\" class=\"mailBoxOpened\">";
                          tble=tble+"<div id=\"short_"+designId+"\" class=\"mailBoxTitle\" ><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\"  id=\"star_"+values[0]+"\" >"+starField+"</span>";
                          tble=tble+"<span  class=\"fromName\" >{cfn:getmessage(54)}:"+from+"</span> <span class=\"showDetailBtn\"><a href=\"javascript:showDetails('"+designId+"');\">{cfn:getmessage(282)}</a></span></span><span class=\"mailBoxRT\"></span><!-- <span class=\"fromDate noArrow\" id=\"mailactionsdrop\"><div class=\"popup\"><a class=\"fromDate noArrow\" href=\"javascript:createDraft("+mailsId+",'"+names+"',"+no+",'"+name+"',1,'"+designId+"','"+url_mail+"')\"><div class=\"in\">{cfn:getmessage(15)}</div></a><a class=\"fromDate noArrow\" href=\"javascript:createDraft("+mailsId+",'"+names+"',"+no+",'"+name+"',2,'"+designId+"','"+url_mail+"')\"><div class=\"in\">{cfn:getmessage(16)}</div></a><a class=\"fromDate noArrow\" href=\"javascript:createDraft("+mailsId+",'"+names+"',"+no+",'"+name+"',3,'"+designId+"','"+url_mail+"')\"><div class=\"in\">{cfn:getmessage(17)}</div></a><a class=\"fromDate noArrow\" href="+url_print+" target=\"_blank\"><div class=\"in\">{cfn:getmessage(646)}</div></a></div><div class=\"in\"><img src=\"images/filler.gif\" alt=\"\" class=\"iconsCornner arLt\"/></div></span> --><span class=\"fromDate noArrow\"><div class=\"in\"> "+attach+" "+mailTime+"</div></span></div>";
                          tble=tble+"<div  class=\"mailBoxTitle\" style=\"display: none;\" id=\"detail_"+designId+"\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\"  id=\"star_" + values[0] + "\" >"+starField+"</span><span  class=\"fromName\" >{cfn:getmessage(54)}:"+from+"</span>	<span class=\"showDetailBtn\"> <a href=\"javascript:hideDetails('"+designId+"')\">{cfn:getmessage(283)}</a></span></span><span class=\"mailBoxRT\"></span>";
                          tble=tble+"<span class=\"fromDate noArrow\"><div class=\"in\">"+mailTime+"</div></span></div>";
                          tble=tble+"<div class=\"mailBoxM\"><div class=\"row\" id=\"detail1_"+designId+"\" style=\"display:none;\"><div class=\"detailedList\" >";
                          if(values[2]!="")
                          tble=tble+"<div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(31)}:</div><div class=\"row floatL\"><div>"+values[2]+"</div></div></div><div style=\"clear:both\"></div>";
                          if(values[3]!="")
                          tble=tble+"<div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(32)}:</div><div class=\"row floatL\"><div>"+values[3]+"</div></div></div><div style=\"clear:both\"></div>";
                          tble=tble+"<div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(34)}:</div><div class=\"row floatL\"><div>"+values[5]+"</div></div></div><div style=\"clear:both\"></div><div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(383)}:</div><div class=\"row floatL\"><div>"+mailTime1+"</div></div></div></div></div><div style=\"clear:both\"></div>";
                          
                          if((values[14]!=0)&&(values[6]!=values[13]) && org_folder!="sent")
                          {
                              tble=tble+"<div class=\"row imageDisplay\"  align=\"center\" id=\"imagez_"+designId+"\"><span style=\"font-weight:700;\">{cfn:getmessage(216)}</span><br><a href=\"javascript:display_image('"+names+"','"+designId+"',"+values[0]+",'"+values[12]+"','"+img_url+"')\">{cfn:getmessage(217)}</a><span style=\"padding:2px;\">&nbsp;|&nbsp;</span><a href=\"javascript:display_imagealltime('"+names+"','"+designId+"',"+values[0]+",'"+values[12]+"','"+img_url_a+"')\">{cfn:getmessage(218)}"+from+"</a>";
                             // tble=tble+"</div><span class=\"mailContent\" id=\"contentmaildiv_"+designId+"\" >"+mailContent+"</span>";
                          
                              tble=tble+"</div><iframe name=\"mail_frame\" frameborder='0' scrolling='yes'  onload='javascript:resizeIframe(this);' id=\"mail_frame"+designId+"\" src='{url:(mail/mail_message_frame/"+designId+")}'></iframe>";
                           	 nesote_email_content_store=mailContent;
                          }
                          else
                          {  tble=tble+"</div><iframe  name='mail_frame' frameborder='0' scrolling='yes'  onload='javascript:resizeIframe(this);' id=\"mail_frame"+designId+"\" src='{url:(mail/mail_message_frame/"+designId+")}'></iframe>";
                       	      nesote_email_content_store=values[13];//tble=tble+"<span class=\"mailContent\" id=\"contentmaildiv_"+designId+"\" >"+values[13]+"</span>";
                          }
                          
                          if(name!="draft")
                          {
                              if(values[10]!="")
                              {
                                  var ar=new Array(100);
                                  ar=values[10].split(",");
                                  for(var k=0;k<(ar.length);k++)
                                  {
                                      var pathArray=ar[k].split("::");
                                      var path=pathArray[0];var attachName=pathArray[1];
                                  tble=tble+"<div class=\"row\" style=\"padding-left:10px;width:100%;\">";
                                      if(pathArray[5]==1)
                                      tble=tble+"<span  class=\"attachedImage\"><img width=\"100px\" height=\"150px\" src=\""+path+"\"></span><span class=\"attachments\">"+attachName+"</span><span class=\"attachments\" >";
                                      else
                                      tble=tble+"<span  class=\"attachedImage_nb\"><img  src=\""+path+"\"></span><span class=\"attachments\">"+attachName+"</span><span class=\"attachments\" >";
                                      if(pathArray[5]==1)
                                      tble=tble+"<a href=\"{url:(mail/showimage)}/"+pathArray[2]+"/"+pathArray[3]+"/"+pathArray[4]+"\" target=\"_blank\"> {cfn:getmessage(102)} </a></span><span class=\"attachments\" >";
                                      tble=tble+"<a href=\"{url:(mail/downloadattachment)}/"+pathArray[2]+"/"+pathArray[3]+"/"+pathArray[6]+"/"+pathArray[4]+"\"><i class=\"fa fa-download\"></i>{cfn:getmessage(101)} </a></span></div><div style=\"clear:both\"></div>";
                                  }
                              }
                              tble=tble+"</div>";
                              var url_mail="{url:(mail/createdraft)}";var url_print="{url:(mail/printmail/)}"+values[12]+"/"+mailsId;
                              tble=tble+"<div class=\"mailBoxFooter\" id=replyfooter1_"+designId+"  style=\"width:100%;\"><span class=\"mailBoxLF\"></span><span class=\"mailBoxBM\"><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" alt=\" \" align=\"absmiddle\" class=\"iconsCornner reply-r\"></span><a href=\"javascript:createDraft("+mailsId+",'"+names+"',"+no+",'"+name+"',1,'"+designId+"','"+url_mail+"')\"  >{cfn:getmessage(15)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-a\"></span><a href=\"javascript:createDraft("+mailsId+",'"+names+"',"+no+",'"+name+"',2,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(16)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-f\"></span><a href=\"javascript:createDraft("+mailsId+",'"+names+"',"+no+",'"+name+"',3,'"+designId+"','"+url_mail+"')\"> {cfn:getmessage(17)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner print-btn\"></span><a href="+url_print+" target=\"_blank\">{cfn:getmessage(646)}</a></div></span><span class=\"mailBoxRF\"></span></div>";
                              tble=tble+"<div id=reply_"+designId+" style=\"display: none;\" class=\"replyWindow\">";
                              tble=tble+"<div class=\"row\" style=\"display: none;\"  id=replyfooter2_"+designId+" style=\"padding-top:5px;\"><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-r\"></span><a href=\"javascript:createDraft("+mailsId+",'"+names+"',"+no+",'"+name+"',1,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(15)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-a\"></span><a href=\"javascript:createDraft("+mailsId+",'"+names+"',"+no+",'"+name+"',2,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(16)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-f\"></span><a href=\"javascript:createDraft("+mailsId+",'"+names+"',"+no+",'"+name+"',3,'"+designId+"','"+url_mail+"')\"> {cfn:getmessage(17)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner print-btn\"></span><a href="+url_print+" target=\"_blank\">{cfn:getmessage(646)}</a></div></div>";
                              tble=tble+"</div></div>";
                          }
                          
                      }
                  }
                  tble=tble+"";
                  a++;loopvariable++;
              }

tble=tble+"</div>";
document.getElementById('loadingDiv').style.display="none";
              document.getElementById('preloaddiv').style.display="";
              document.getElementById('preloadimage').style.display="none";
              document.getElementById("short_detail").setAttribute("class", "detailmail");
              document.getElementById('mailContent').style.width="100%";
              if(name!="draft")
              {
                  if(right_ads_status!=0)//Check Global Ad display Status.
				{
              if(document.getElementById('rightads_td').style.display=="none")
                  document.getElementById('rightads_td').style.display="";
                  document.getElementById('mailPageOuterid').style.right="201px";
				}
                  
              }
              else
              {
                  document.getElementById('rightads_td').style.display="none";
                  document.getElementById('mailPageOuterid').style.right="0px";

              }
              
              document.getElementById('mailContent').innerHTML=tble;
              if(name!="draft")
              writeToFrame(nesote_email_content_store,designId);
              document.getElementById("loadingDiv").style.display="none";
      }
      else
       {
                             if(isArrayAvailable(name))
                             var totalz=parseInt(this[name].totl2)-parseInt(this[name].fbuff);
                             else
                             var totalz=50;
                             mainWindow(name,pageNo,mailsPerpage,totalz,2);
                             window.location.hash=name;
        }
      }
  });
}
function printmail(name,mailid)
{
$.ajax({

type: "GET",cache: false,
url: "{url:(mail/test1)}/"+name+"/"+mailid,

success: function(data) {}

});
}

//Function is called for Coversation mails . when opened
function clickonDiv1(toobj,designId,fldrName,mailid,pageNo,object,search_object)
{
var star_id=object.split("_");
//alert(toobj);
  var names=toobj.split("_");
  var name=names[0];
  var img_url="{url:(mail/adddisplaynow/)}";
  var img_url_a="{url:(mail/adddisplay/)}";  
  if(isArrayAvailable(toobj)!=0)
  {
      var postn=this[toobj].isItemAvailable(toobj,mailid);
      if(postn>0)
      {
  
          var values=this[toobj].getResultItembyIndex(toobj,postn);
          if(values[11]!=0)
          { 
          
              var tble="";
              var from=values[1];
              var subject=values[5];
              var mailTime=values[9];
              var d = values[15];
              var mailTime1=values[18];
              var readflag=values[7];
              var attach=values[10];
              var mailsId=values[0];
              var star_pageNo=getCookievalue("mail_page");
              if((fldrName!="trash")&&(search_object.substring(0,5)!="trash")&&(search_object.substring(0,4)!="spam")&&fldrName!="spam")
              {
              if(values[8]==0)
              var starField="<a href=\"javascript:markstar("+mailsId+","+star_pageNo+",1,"+star_id[1]+",'"+object+"','"+search_object+"')\"><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner str-g\"></a>";
              else
              var starField="<a href=\"javascript:markstar("+mailsId+","+star_pageNo+",0,"+star_id[1]+",'"+object+"','"+search_object+"')\"><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner str-y\"></a>";
              }
              else if(fldrName=="spam"||(search_object.substring(0,4)=="spam"))
                 {var starField="<i class=\"fa fa-exclamation-triangle\"></i>";}
              else
              var starField="<i class=\"fa fa-trash-o\"></i>";
              
              var mailContent=values[6];
              var no=pageNo;
              if(fldrName=="draft")
              {
                  document.getElementById("mailContent").style.display="none";
                  document.getElementById("newMail").style.display="";
                  
                  
              }
              else
              {
                      
                      var url_mail="{url:(mail/createdraft)}";var url_print="{url:(mail/printmail/)}"+values[12]+"/"+mailsId;			
                  tble=tble+"<div id=\"short_"+designId+"\" class=\"mailBoxTitle\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\"  id=\"star_" + values[0] + "\" >"+starField+"</span>";
                  tble=tble+"<span  class=\"fromName\" ><a href=\"javascript:hide('"+designId+"');\">"+from+"</a></span> <span class=\"showDetailBtn\"><a href=\"javascript:showDetails('"+designId+"')\">{cfn:getmessage(282)}</a></span></span><span class=\"mailBoxRT\"></span><!-- <span id=\"mailactionsdrop\" class=\"fromDate noArrow\"><div class=\"popup\"><a class=\"fromDate noArrow\" href=\"javascript:createDraft("+mailsId+",'"+toobj+"',"+pageNo+",'"+name+"',1,'"+designId+"','"+url_mail+"')\"><div class=\"in\">{cfn:getmessage(15)}</div></a><a class=\"fromDate noArrow\" href=\"javascript:createDraft("+mailsId+",'"+toobj+"',"+pageNo+",'"+name+"',2,'"+designId+"','"+url_mail+"')\"><div class=\"in\">{cfn:getmessage(16)}</div></a><a class=\"fromDate noArrow\" href=\"javascript:createDraft("+mailsId+",'"+toobj+"',"+pageNo+",'"+name+"',3,'"+designId+"','"+url_mail+"')\"><div class=\"in\">{cfn:getmessage(17)}</div></a><a class=\"fromDate noArrow\" href="+url_print+" target=\"_blank\"><div class=\"in\">{cfn:getmessage(646)}</div></a></div><div class=\"in\"><img class=\"iconsCornner arLt\" alt=\"\" src=\"images/filler.gif\"></div></span> --><span class=\"fromDate active\"><a href=\"javascript:hide('"+designId+"')\">"+mailTime+"</a></span></div>";
                  tble=tble+"<div  class=\"mailBoxTitle\"  style=\"display: none;\" id=\"detail_"+designId+"\" ><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\"  id=\"star_" + values[0] + "\" >"+starField+"</span><span  class=\"fromName\" >{cfn:getmessage(54)}:"+from+"</span><span class=\"showDetailBtn\"> <a href=\"javascript:hideDetails('"+designId+"')\">{cfn:getmessage(283)}</a></span></span><span class=\"mailBoxRT\"></span>";
                  tble=tble+"<span class=\"fromDate noArrow\"><div class=\"in\">"+mailTime+"</div></span></div>";
                  tble=tble+"<div class=\"mailBoxM\"   ><div class=\"row\" id=\"detail1_"+designId+"\" style=\"display:none;\"><div class=\"detailedList\" >";
                  if(values[2]!="")
                  tble=tble+"<div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(31)}:</div><div class=\"row floatL\"><div>"+values[2]+"</div></div></div><div style=\"clear:both\"></div>";
                  if(values[3]!="")
                  tble=tble+"<div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(32)}:</div><div class=\"row floatL\"><div>"+values[3]+"</div></div></div><div style=\"clear:both\"></div>";
                  tble=tble+"<div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(34)}:</div><div class=\"row floatL\"><div>"+values[5]+"</div></div></div><div style=\"clear:both\"></div><div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(383)}:</div><div class=\"row floatL\"><div>"+mailTime1+"</div></div></div></div></div><div style=\"clear:both\"></div>";
                  
                  if((values[14]!=0)&&(values[6]!=values[13]) && values[12]!="sent")
                  {
                      tble=tble+"<div class=\"row imageDisplay\"  align=\"center\" id=\"imagez_"+designId+"\"><span style=\"font-weight:700;\">{cfn:getmessage(216)}</span><br><a href=\"javascript:display_image('"+toobj+"','"+designId+"',"+values[0]+",'"+values[12]+"','"+img_url+"')\">{cfn:getmessage(217)}</a><span style=\"padding:2px;\">&nbsp;|&nbsp;</span><a href=\"javascript:display_imagealltime('"+toobj+"','"+designId+"',"+values[0]+",'"+values[12]+"','"+img_url+"')\">{cfn:getmessage(218)} "+from+"</a>";
                     // tble=tble+"</div><span class=\"mailContent\" id=\"contentmaildiv_"+designId+"\" >"+mailContent+"</span>";
                      tble=tble+"</div><iframe name=\"mail_frame\" frameborder='0' scrolling='yes'  onload='javascript:resizeIframe(this);' id=\"mail_frame"+designId+"\" src='{url:(mail/mail_message_frame/"+designId+")}'></iframe>";
                   	 email_content_store=mailContent;
                  }
                  else
                  { 
                	 tble=tble+"</div><iframe name=\"mail_frame\" frameborder='0' scrolling='yes'  onload='javascript:resizeIframe(this);' id=\"mail_frame"+designId+"\" src='{url:(mail/mail_message_frame/"+designId+")}'></iframe>";
               	     email_content_store=values[13];//tble=tble+"<span class=\"mailContent\" id=\"contentmaildiv_"+designId+"\" >"+values[13]+"</span>";
                  }
                      
                          
                          
                          
                  if(fldrName!="draft")
                  {
                  if(values[10]!="")
                              {
                                  var ar=new Array(100);
                                  ar=values[10].split(",");
                                  for(var k=0;k<(ar.length);k++)
                                  {
                                      var pathArray=ar[k].split("::");
                                      var path=pathArray[0];var attachName=pathArray[1];
                                      tble=tble+"<div class=\"row\" style=\"padding-left:10px;width:100%;\">";
                                      if(pathArray[5]==1)
                                      tble=tble+"<span  class=\"attachedImage\"><img width=\"100px\" height=\"150px\" src=\""+path+"\"></span><span class=\"attachments\">"+attachName+"</span><span class=\"attachments\" >";
                                      else
                                      tble=tble+"<span  class=\"attachedImage_nb\"><img  src=\""+path+"\"></span><span class=\"attachments\">"+attachName+"</span><span class=\"attachments\" >";
                                      if(pathArray[5]==1)
                                      tble=tble+"<a href=\"{url:(mail/showimage)}/"+pathArray[2]+"/"+pathArray[3]+"/"+pathArray[4]+"\" target=\"_blank\"> {cfn:getmessage(102)} </a></span><span class=\"attachments\" >";
                                      tble=tble+"<a href=\"{url:(mail/downloadattachment)}/"+pathArray[2]+"/"+pathArray[3]+"/"+pathArray[6]+"/"+pathArray[4]+"\"><i class=\"fa fa-download\"></i> {cfn:getmessage(101)} </a></span></div><div style=\"clear:both\"></div>";
                                      
                                      
                                      
                                  }
                              }
                              var url_mail="{url:(mail/createdraft)}";var url_print="{url:(mail/printmail/)}"+values[12]+"/"+mailsId;
                                  tble=tble+"</div>";
                      tble=tble+"<div class=\"mailBoxFooter\" id=replyfooter1_"+designId+"><span class=\"mailBoxLF\"></span><span class=\"mailBoxBM\"><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-r\"></span><a href=\"javascript:createDraft("+mailsId+",'"+toobj+"',"+pageNo+",'"+name+"',1,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(15)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-a\"></span><a href=\"javascript:createDraft("+mailsId+",'"+toobj+"',"+pageNo+",'"+name+"',2,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(16)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-f\"></span><a href=\"javascript:createDraft("+mailsId+",'"+toobj+"',"+pageNo+",'"+name+"',3,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(17)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner print-btn\"></span><a href="+url_print+" target=\"_blank\">{cfn:getmessage(646)}</a></div></span><span class=\"mailBoxRF\"></span></div>";
                      tble=tble+"<div id=reply_"+designId+" style=\"display: none;\" class=\"replyWindow\">";
                      tble=tble+"<div class=\"row\" style=\"display: none;\"  id=replyfooter2_"+designId+" style=\"padding-top:5px;\"><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-r\"></span><a href=\"javascript:createDraft("+mailsId+",'"+toobj+"',"+pageNo+",'"+name+"',1,'"+designId+",'"+url_mail+"')\">{cfn:getmessage(15)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-a\"></span><a href=\"javascript:createDraft("+mailsId+",'"+toobj+"',"+pageNo+",'"+name+"',2,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(16)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-f\"></span><a href=\"javascript:createDraft("+mailsId+",'"+toobj+"',"+pageNo+",'"+name+"',3,'"+designId+"','"+url_mail+"')\"> {cfn:getmessage(17)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner print-btn\"></span><a href="+url_print+" target=\"_blank\">{cfn:getmessage(646)}</a></div></div>";
                      tble=tble+"</div>";	
                  }
                              
                      
                  
              }
              
              tble=tble+"";
              document.getElementById('mailDivshort_'+designId).style.display="none";
              document.getElementById('mailDiv_'+designId).style.display="";
              document.getElementById('mailDiv_'+designId).innerHTML=tble;
              if(fldrName!="draft")
              writeToFrame(email_content_store,designId);
          }
          else
          clickonDiv2(toobj,designId,fldrName,mailid,pageNo,object,search_object);
      }
      else
      clickonDiv2(toobj,designId,fldrName,mailid,pageNo,object,search_object);
  }
  else
  clickonDiv2(toobj,designId,fldrName,mailid,pageNo,object,search_object);
}

function clickonDiv2(toobj,designId,fldrName,mailid,pageNo,object,search_object)
{
var c_view=getCookievalue("current_view");//To get current view of user 2 pane/3 pane.

var img_url="{url:(mail/adddisplaynow/)}";
var img_url_a="{url:(mail/adddisplay/)}";   

document.getElementById('loadingDiv').style.display="";
  pageNo=parseInt(pageNo)+parseInt(1);
  var arry=new Array(16);
  arry[0]='id';
  arry[1]='from_list';
  arry[2]='to_list';
  arry[3]='cc';
  arry[4]='bcc';
  arry[5]='subject';
  arry[6]='body';
  arry[7]='readflag';
  arry[8]='starflag';
  arry[9]='time';
  arry[10]='status';
  arry[11]='mail_references';
  arry[12]='original_folder';
  arry[13]='original_body';
  arry[14]='cntnt_display';
  arry[15]='time_int';
  arry[16]='short_cntnt';
  arry[17]='object';
  arry[18]='date';
  arry[19]='search_object';
  
  var objName=this[toobj];
  var namez=toobj.split("_");
  var name=getCookievalue("folder");
  var star_id=object.split("_");
  
      var currentTime=new Date();
      var crntime=currentTime.getTime();
      $.ajax({

type: "GET",cache: false,
url: "{url:(mail/getorginalmail)}/"+fldrName+"/"+mailid+"/"+crntime+"/"+toobj+"/"+search_object,

success: function(data) {
              var x=data;
              var mails=new Array(100);
              var tble="";
              
                  var values=new Array(100);
                  values=x.split("{nesote_,}");
                  var from=values[1];
                  var subject=values[5];
                  var mailTime=values[9];
                  var d = values[15];
              var mailTime1=values[18];
                  var readflag=values[7];
                  if(values[10]=="")
                  var attach="";
                  else
                  var attach="<img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner attach-a\" alt=\" \">";
                  
                      values[0]=values[0].replace(/^[\s]+/,'').replace(/[\s]+$/,'').replace(/[\s]{2,}/,' ');//for trimming 
                  var mailsId=values[0];
                  var star_pageNo=getCookievalue("mail_page");
                  if((fldrName!="trash")&&(search_object.substring(0,5)!="trash")&&(search_object.substring(0,4)!="spam")&&fldrName!="spam")
                  {
                  if(values[8]==0)
                  var starField="<a href=\"javascript:markstar("+mailsId+","+star_pageNo+",1,"+star_id[1]+",'"+toobj+"','"+search_object+"')\"><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner str-g\"></a>";
                  else
                  var starField="<a href=\"javascript:markstar("+mailsId+","+star_pageNo+",0,"+star_id[1]+",'"+toobj+"','"+search_object+"')\"><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner str-y\"></a>";
                  }
                else if(fldrName=="spam" || (search_object.substring(0,4)=="spam")){var starField="<i class=\"fa fa-exclamation-triangle\"></i>";}
                else
                  var starField="<i class=\"fa fa-trash-o\"></i>";
                  var mailContent=values[6];
                  var no=pageNo;
                  var idz1=new Array(1);
                  idz1[0]=values[0];
                  if(objName.isItemAvailable(toobj,values[0])>0)
                  {
          
                      objName.update(toobj,arry,values);
                      objName.where('id=?',idz1);
                      objName.action();
                  }
                  
                  else
                  {
              
                      objName.insert(toobj,2,values,'time_int','desc');
                  }
                  if(name=="draft")
                  {
                      document.getElementById("mailContent").style.display="none";
                      document.getElementById("newMail").style.display="";
                      

                  }
                  else
                  {
                      
                          var url_mail="{url:(mail/createdraft)}";var url_print="{url:(mail/printmail/)}"+values[12]+"/"+mailsId;		
                          if(c_view=="3pane")
                          tble=tble+"<div id=\"short_"+designId+"\" class=\"mailBoxTitle\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\"  id=\"star_3pane_" + values[0] + "\" >"+starField+"</span>";
                          else 
                          tble=tble+"<div id=\"short_"+designId+"\" class=\"mailBoxTitle\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\"  id=\"star_" + values[0] + "\" >"+starField+"</span>";
                          tble=tble+"<span  class=\"fromName\" ><a href=\"javascript:hide('"+designId+"');\">"+from+"</a></span> <span class=\"showDetailBtn\"><a href=\"javascript:showDetails('"+designId+"')\">{cfn:getmessage(282)}</a></span></span><span class=\"mailBoxRT\"></span><!--<!-- <span id=\"mailactionsdrop\" class=\"fromDate noArrow\"><div class=\"popup\"><a class=\"fromDate noArrow\" href=\"javascript:createDraft("+mailsId+",'"+toobj+"',"+pageNo+",'"+name+"',1,'"+designId+"','"+url_mail+"')\"><div class=\"in\">{cfn:getmessage(15)}</div></a><a class=\"fromDate noArrow\" href=\"javascript:createDraft("+mailsId+",'"+toobj+"',"+pageNo+",'"+name+"',2,'"+designId+"','"+url_mail+"')\"><div class=\"in\">{cfn:getmessage(16)}</div></a><a class=\"fromDate noArrow\" href=\"javascript:createDraft("+mailsId+",'"+toobj+"',"+pageNo+",'"+name+"',3,'"+designId+"','"+url_mail+"')\"><div class=\"in\">{cfn:getmessage(17)}</div></a><a class=\"fromDate noArrow\" href="+url_print+" target=\"_blank\"><div class=\"in\">{cfn:getmessage(646)}</div></a></div><div class=\"in\"><img class=\"iconsCornner arLt\" alt=\"\" src=\"images/filler.gif\"></div></span> --><span class=\"fromDate active\"><a href=\"javascript:hide('"+designId+"')\">"+attach+" "+mailTime+"</a></span></div>";
                          if(c_view=="3pane")
                          tble=tble+"<div  class=\"mailBoxTitle\"  style=\"display: none;\" id=\"detail_"+designId+"\" ><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\"  id=\"star_3pane_" + values[0] + "\" >"+starField+"</span><span  class=\"fromName\" >{cfn:getmessage(54)}:"+from+"</span>	<span class=\"showDetailBtn\"> <a href=\"javascript:hideDetails('"+designId+"')\">{cfn:getmessage(283)}</a></span></span><span class=\"mailBoxRT\"></span>";
                          else
                          tble=tble+"<div  class=\"mailBoxTitle\"  style=\"display: none;\" id=\"detail_"+designId+"\" ><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\"  id=\"star_" + values[0] + "\" >"+starField+"</span><span  class=\"fromName\" >{cfn:getmessage(54)}:"+from+"</span>	<span class=\"showDetailBtn\"> <a href=\"javascript:hideDetails('"+designId+"')\">{cfn:getmessage(283)}</a></span></span><span class=\"mailBoxRT\"></span>";
                          tble=tble+"<span class=\"fromDate noArrow\"><div class=\"in\">"+mailTime+"</div></span></div>";
                          tble=tble+"<div class=\"mailBoxM\"   ><div class=\"row\" id=\"detail1_"+designId+"\" style=\"display:none;\"><div class=\"detailedList\" >";
                          if(values[2]!="")
                          tble=tble+"<div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(31)}:</div><div class=\"row floatL\"><div>"+values[2]+"</div></div></div><div style=\"clear:both\"></div>";
                          if(values[3]!="")
                          tble=tble+"<div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(32)}:</div><div class=\"row floatL\"><div>"+values[3]+"</div></div></div><div style=\"clear:both\"></div>";
                          tble=tble+"<div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(34)}:</div><div class=\"row floatL\"><div>"+values[5]+"</div></div></div><div style=\"clear:both\"></div><div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(383)}:</div><div class=\"row floatL\"><div>"+mailTime1+"</div></div></div></div></div><div style=\"clear:both\"></div>";
                          
                          if((values[14]!=0)&&(values[6]!=values[13]) && values[12]!="sent")
                          {
                              tble=tble+"<div class=\"row imageDisplay\"  align=\"center\" id=\"imagez_"+designId+"\"><span style=\"font-weight:700;\">{cfn:getmessage(216)}</span><br><a href=\"javascript:display_image('"+toobj+"','"+designId+"',"+values[0]+",'"+values[12]+"','"+img_url+"')\">{cfn:getmessage(217)}</a><span style=\"padding:2px;\">&nbsp;|&nbsp;</span><a href=\"javascript:display_imagealltime('"+toobj+"','"+designId+"',"+values[0]+",'"+values[12]+"','"+img_url_a+"')\">{cfn:getmessage(218)} "+from+"</a>";
                              //tble=tble+"</div><span class=\"mailContent\" id=\"contentmaildiv_"+designId+"\" >"+mailContent+"</span>";
                             tble=tble+"</div><iframe name=\"mail_frame\" frameborder='0' scrolling='yes'  onload='javascript:resizeIframe(this);' id=\"mail_frame"+designId+"\" src='{url:(mail/mail_message_frame/"+designId+")}'></iframe>";
                           	 nesote_email_content_store=mailContent;
                          }
                          else
                          {
                        	  //tble=tble+"<span class=\"mailContent\" id=\"contentmaildiv_"+designId+"\" >"+values[13]+"</span>";
                        	  tble=tble+"</div><iframe name=\"mail_frame\" frameborder='0' scrolling='yes'  onload='javascript:resizeIframe(this);' id=\"mail_frame"+designId+"\" src='{url:(mail/mail_message_frame/"+designId+")}'></iframe>";
                           	 nesote_email_content_store=values[13];
                          }
                          
                          
                          
                          
                      if(name!="draft")
                          {
                              if(values[10]!="")
                              {
                                  var ar=new Array(100);
                                  ar=values[10].split(",");
                                  for(var k=0;k<(ar.length);k++)
                                  {
                                      var pathArray=ar[k].split("::");
                                      var path=pathArray[0];var attachName=pathArray[1];
                                      tble=tble+"<div class=\"row\" style=\"padding-left:10px;width:100%;\">";
                                      if(pathArray[5]==1)
                                      tble=tble+"<span  class=\"attachedImage\"><img width=\"100px\" height=\"150px\" src=\""+path+"\"></span><span class=\"attachments\">"+attachName+"</span><span class=\"attachments\" >";
                                      else
                                      tble=tble+"<span  class=\"attachedImage_nb\"><img  src=\""+path+"\"></span><span class=\"attachments\">"+attachName+"</span><span class=\"attachments\" >";
                                      if(pathArray[5]==1)
                                      tble=tble+"<a href=\"{url:(mail/showimage)}/"+pathArray[2]+"/"+pathArray[3]+"/"+pathArray[4]+"\" target=\"_blank\"> {cfn:getmessage(102)} </a></span><span class=\"attachments\" >";
                                      tble=tble+"<a href=\"{url:(mail/downloadattachment)}/"+pathArray[2]+"/"+pathArray[3]+"/"+pathArray[6]+"/"+pathArray[4]+"\"> <i class=\"fa fa-download\"></i>{cfn:getmessage(101)} </a></span></div><div style=\"clear:both\"></div>";
                                  }
                              }
                              tble=tble+"</div>";
                              var url_mail="{url:(mail/createdraft)}";var url_print="{url:(mail/printmail/)}"+values[12]+"/"+mailsId;
                          tble=tble+"<div class=\"mailBoxFooter\" id=replyfooter1_"+designId+"><span class=\"mailBoxLF\"></span><span class=\"mailBoxBM\"><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-r\"></span><a href=\"javascript:createDraft("+mailsId+",'"+toobj+"',"+pageNo+",'"+name+"',1,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(15)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-a\"></span><a href=\"javascript:createDraft("+mailsId+",'"+toobj+"',"+pageNo+",'"+name+"',2,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(16)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-f\"></span><a href=\"javascript:createDraft("+mailsId+",'"+toobj+"',"+pageNo+",'"+name+"',3,'"+designId+"','"+url_mail+"')\"> {cfn:getmessage(17)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner print-btn\"></span><a href="+url_print+" target=\"_blank\">{cfn:getmessage(646)}</a></div></span><span class=\"mailBoxRF\"></span></div>";
                          tble=tble+"<div id=reply_"+designId+" style=\"display: none;\" class=\"replyWindow\">";
                          tble=tble+"<div class=\"row\" style=\"display: none;\"  id=replyfooter2_"+designId+" style=\"padding-top:5px;\"><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-r\"></span><a href=\"javascript:createDraft("+mailsId+",'"+toobj+"',"+pageNo+",'"+name+"',1,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(15)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-a\"></span><a href=\"javascript:createDraft("+mailsId+",'"+toobj+"',"+pageNo+",'"+name+"',2,'"+designId+"','"+url_mail+"')\">{cfn:getmessage(16)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-f\"></span><a href=\"javascript:createDraft("+mailsId+",'"+toobj+"',"+pageNo+",'"+name+"',3,'"+designId+"','"+url_mail+"')\"> {cfn:getmessage(17)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner print-btn\"></span><a href="+url_print+" target=\"_blank\">{cfn:getmessage(646)}</a></div></div></div>";
                      
                          }
                              
                      
                  
                  }
          
              tble=tble+"";
              document.getElementById('loadingDiv').style.display="none";
              document.getElementById('mailDivshort_'+designId).style.display="none";
              document.getElementById('mailDiv_'+designId).style.display="";
              document.getElementById('mailDiv_'+designId).innerHTML=tble;//alert(tble);
              if(name!="draft")
              writeToFrame(nesote_email_content_store,designId); 

          }
      });
}


function newMail(vt1)
{
	var c_theme=getCookievalue("Current_Theme");
	if(c_theme!="100")
		{
		//Fix Transparency for themes.
		document.getElementById("second_scroll").style.background="#FFFFFF";
		document.getElementById("footer_txt_id").style.color="#000000";
		document.getElementById("footer_txt_id").style.textShadow="none";
		//
		}
	//Hide Back Button
	document.getElementById('backmailbtnid').style.display="none";
document.getElementById("splitbuttonid").style.display="none";	
if(document.getElementById("footer_table").style.display=="none")
	{
	document.getElementById("footer_table").style.display="";
	}


header("newmail");
idString=":";idz="";
document.getElementById("cotnct_lmenuid").style.display="none";
document.getElementById("contact_subheader").style.display="none";
document.getElementById("preloaddiv").style.display="";
document.getElementById("preloadimage").style.display="none";
if(document.getElementById("rightads_td").style.display=="")document.getElementById("rightads_td").style.display="none";
filevar_a=0;filevar_count=0;
if(document.getElementById("additionalattach_0_0").style.display=="")
document.getElementById("additionalattach_0_0").style.display="none";
if(document.getElementById("attachlink_0_0").style.display=="none")
document.getElementById("attachlink_0_0").style.display="";
if(document.getElementById("filedivcontainer_0_0_0").style.display=="")
document.getElementById("filedivcontainer_0_0_0").style.display="none";
if(document.getElementById("forwardz").style.display=="")
document.getElementById("forwardz").style.display="none";
if(new_flag==0)
new_flag=1;
else if(new_flag==1){
/*nicEditor1.removeInstance("mailBody_0_0");*/
 //console.log(CKEDITOR.instances.mailBody_0_0);
 if (CKEDITOR.instances.mailBody_0_0)
CKEDITOR.instances.mailBody_0_0.destroy(true);
 drafTcount=0;var url_mail="{url:(mail/createdraft)}";
 }
createDraft(0,0,0,0,0,0,url_mail);
document.getElementById("heading").innerHTML="<i class='fa fa-pencil-square-o position_tooltip'></i> {cfn:getmessage(470)}";
document.getElementById("mailContent").style.display="none";
/**
 *Used For three pane 
 */
document.getElementById("mailContent11").style.display="none";
document.getElementById("splitdiv1").style.display="none";
/**
 * Three pane Ends Here
 */
document.getElementById("newMail").style.display="";
document.getElementById("bcc_only_0").style.display="none";
document.getElementById("cc_only_0").style.display="none";
document.getElementById("showcc_0").style.display="none";
document.getElementById("showbcc_0").style.display="none";
document.getElementById("cc_bcc_0").style.display="";
document.getElementById("to_0_0").value="";
if(document.getElementById("cc_0_0"))
document.getElementById("cc_0_0").value="";
if(document.getElementById("bcc_0_0"))
document.getElementById("bcc_0_0").value="";
document.getElementById("subject_0_0").value="";


//nicEditor1=(new nicEditor({fullPanel:true})).panelInstance("mailBody_0_0");
//nicEditors.findEditor("mailBody_0_0").setContent("");

CKEDITOR.replace("mailBody_0_0");
             
var editor = CKEDITOR.instances.mailBody_0_0;
                   //Implement autosave
editor.on('change', function() {
	   autoSave(0);
});

if(vt1==0)
{//console.log(signature);
if(signature<2)
{if(signature==0){var sign="<br><br>{noescape:$signature}";

editor.setData(sign);
//nicEditors.findEditor("mailBody_0_0").setContent(sign)



}
else getNewSignature("mailBody_0_0","",0,"");}
}
var current_url_w=window.location.hash;
SetCookie("flag_browser_back",current_url_w,1)};

function showResult(string,no,target,target1,target5)

{
var strng=string.split(",");
var lngth=strng.length;

var str=strng[lngth-1];
var strings="";
var i=0;for(i=0;i<(lngth-1);i++)
{
strings=strings+strng[i]+",";
}

if (str.length==0)

{

document.getElementById(target5+no).style.display="";

document.getElementById(target5+no).innerHTML="";

document.getElementById(target5+no).style.border="0px";

return;

}


var url="{url:(mail/livesearch"+target1+"/)}"+strings+"/"+no;

url=url+"&q="+str;


url=url+"&sid="+Math.random();

  $.ajax({

type: "GET",cache: true,
url: url,

success: function(data) {


var x=data;
var q=new Array();
q=x.split("}");
q[0]=q[0].replace(/^[\s]+/,'').replace(/[\s]+$/,'').replace(/[\s]{2,}/,' ');//for trimming 
var no=q[0]; 	
 document.getElementById(target5+no).style.display="";

document.getElementById(target5+no).innerHTML=q[1];

document.getElementById(target5+no).style.border="1px solid #A5ACB2";
}
});

}

function senDmail(tO,cC,bcC,subjecT,contenT,mailid,designId){

//document.getElementById("messages").style.display="";
//document.getElementById("message_mail").innerHTML="Sending";
//toastr.info("Sending");
var current_view=getCookievalue("current_view");
notify_display("{cfn:getmessage(781)}","info");



if((parseInt(last_send_timer)<parseInt(mail_sending_delay))&&parseInt(last_send_timer)!=parseInt(0))
{   var last_send_temp=parseInt(mail_sending_delay)-parseInt(last_send_timer); 
var last_tmp=setInterval(function(){ last_send_temp=parseInt(last_send_temp)-parseInt(1);if(last_send_temp==0){last_send_timer=0;clearInterval(last_tmp);senDmail(tO,cC,bcC,subjecT,contenT,mailid,designId);};notify_display("{cfn:getmessage(781)}"+" <span id='timer_send'> Please wait "+last_send_temp+" seconds</span>","info"); }, 1000);//Starts the timer
}

if(last_send_timer==0){
last_send_timer="";clear_send_timer();

var arry=new Array(17);
arry[0]="id";arry[1]="from_list";arry[2]="to_list";arry[3]="cc";
arry[4]="bcc";arry[5]="subject";arry[6]="body";arry[7]="readflag";arry[8]="starflag";
arry[9]="time";arry[10]="status";arry[11]="mail_references";arry[12]="original_folder";arry[13]="original_body";arry[14]="cntnt_display";arry[15]="time_int";
arry[16]="short_cntnt";arry[17]="object";arry[18]="date";arry[19]="search_objects";
var folder=getCookievalue("folder");
var mailz=designId.split("_");
var	inr_objct=folder+"_"+mailz[0];

var T_folder=folder;
if(isArrayAvailable(inr_objct))
{
var asd=this[inr_objct].isItemAvailable(inr_objct,mailid);

var itemDtls=new Array(15);
if(asd==0)
itemDtls[12]=folder;
else
{
  
  itemDtls=this[inr_objct].getResultItem(inr_objct,mailid);
  var org_fldr=this[inr_objct].fetchRow(itemDtls);
  T_folder=org_fldr[12];
}
}
if(isArrayAvailable("sent")!=0)
var outerObj=this["sent"];
var draft_obj=this["draft"];
var draftid=document.getElementById("draftid_"+designId).value;var currentTime=new Date;var crntime=currentTime.getTime();
contenT=encodeURIComponent(contenT);
subjecT=encodeURIComponent(subjecT);
$.ajax({type:"POST",cache:false,url:"{url:(mail/sendmail)}",
data:"to="+tO+"&cc="+cC+"&bcc="+bcC+"&subject="+subjecT+"&content="+contenT+"&time="+crntime+"&draftid="+draftid+"&mailid="+mailid+"&folder="+T_folder,
success:function(data)
{
var x=data;
if(x=="limitreached"){
notify_display("{cfn:getmessage(782)}","warning");return false;
}
if(x=="invalidadr"){
	// Clears the current list of toasts
	//toastr.clear()
//toastr.warning("{cfn:getmessage(486)}");//alert("{cfn:getmessage(486)}");
notify_display("{cfn:getmessage(340)}","warning");
document.getElementById("messages").style.display="none";}
else
{


if(last_send_timer=="")//If Last send timer is not defined.
{
last_send_object=setInterval(function(){ update_send_timer();},1000);//Starts the timer
}



              var xx=data;
              var x=xx.split("****");
              
              
              
              

var errorPos=x[0].split("<strong>");
if(errorPos.length<2)
{
if(isArrayAvailable("draft")!=0)
{

var itemavld=draft_obj.isItemAvailable("draft",draftid);
if(itemavld!=0)
{
var drftCnt=parseInt(Unread[1][1])-parseInt(1);
Unread[1][1]=drftCnt; 
SetCookie("draft",drftCnt,1);
setUnreadcount();
}
}
if(mailid==0)
{

var x1=x[1].split("{nesote_count}");
              var x2=x1[0].split("{nesote_separator}");
          var values=new Array(100);
          for(var i=0;i<x1[1];i++)
          { 
              var x4=x2[i].split("{nesote_:}");
              x4[0]=x4[0].replace(/^[\s]+/,'').replace(/[\s]+$/,'').replace(/[\s]{2,}/,' ');//for trimming 
              var arry=new Array(14);
              for(var j=0;j<16;j++)
              {
                  var x3=x4[0].split("{nesote_,}");
                  arry[j]=x3[j];
              }
              
              if(isArrayAvailable("sent")!=0)	
              outerObj.insert("sent",2,arry,"time_int","desc");
              var x5=x4[1].split("{nesote_ref}");
              
          
              for(var i1=0;i1<x3[13];i1++)
              {
                  for(var i2=0;i2<19;i2++)
                  {
                      var x6=x5[i1].split("{nesote_,}");
                      x6[i2]=x6[i2];
                  
                      
                  }
                  
                  var namez=x6[17];
                  insertArray(namez,x6,x3[13]);
              
              }
              
              
          }
Unread[0][2]=1;
Unread[2][2]=1;	
var total=getCookievalue("sent");
var total_sent=parseInt(1)+parseInt(total);
SetCookie("sent",total_sent,1);
//document.getElementById("message_mail").innerHTML="{cfn:getmessage(768)}";
//setTimeout("hidemailmessage()",5000);
// Clears the current list of toasts
///toastr.clear()
//toastr.success("{cfn:getmessage(768)}");
notify_display("{cfn:getmessage(768)}","success");






getfolderName("inbox");
window.location.hash="inbox";
mainWindow("inbox",1,mailsPerpage,totalInbox,2);
}
else
{ 
if(folder=="inbox")
{
Unread[0][2]=1;
Unread[2][2]=1;
var total=getCookievalue("inbox");  
mainWindow("inbox",1,mailsPerpage,total,2);
}
else if(folder=="sent")
{
Unread[2][2]=1;
var total=getCookievalue("sent"); 

mainWindow("sent",1,mailsPerpage,total,2);
}
else if(folder=="spam")
{
Unread[3][2]=1;

var total=getCookievalue("spam"); 

mainWindow("spam",1,mailsPerpage,total,2);
}
else if(folder=="trash")
{
Unread[4][2]=1;
var total=getCookievalue("trash"); 

mainWindow("trash",1,mailsPerpage,total,2);
}
else if(folder.substring(0,6)=="custom")
{var cstfolcnt=customFoldercount-1;
  for(var w=cstfolcnt;w>5;w--)
   {
           
      if(folder==Unread[w][0])
        {
         for(var urdcnt=0;urdcnt<customFoldercount;urdcnt++)
          {
          if((Unread[urdcnt][0]==Unread[w][0]))
              {
                  Unread[urdcnt][2]=1;
                  Unread[2][2]=1;
                  var total=getCookievalue(folder);
                 // current_view
                  window.location.hash="trash";
                  mainWindow("folder",1,mailsPerpage,total,2);
              }
          }
      }
  }
}
document.getElementById("loadingDiv").style.display="none";
//document.getElementById("message_mail").innerHTML="{cfn:getmessage(768)}";
//setTimeout("hidemailmessage()",5000);
// Clears the current list of toasts
//toastr.clear()
//toastr.success("{cfn:getmessage(768)}");
notify_display("{cfn:getmessage(768)}","success");
}
}
else{var msgz=errorPos[1].split("</strong>");
var mzg=msgz[0].substring(0,msgz[0].length);
//Clears the current list of toasts
//toastr.clear()
//toastr.error(mzg);//alert(mzg);
notify_display(mzg,"error");
}}}})

}
};


/*function savEmail(tO,cC,bcC,subjecT,contenT,mailid,designId)
{
    //alert("ddd");return false;
var zz=idz.split(":");// idz null(new mail)
if(zz!="")
var zzz=zz[1].split("&");
if(zz=="")
var draftid=document.getElementById("draftid_"+designId).value;
else 
//var draftid=zzz[0];
var draftid=document.getElementById("draftid_"+designId).value;
var attachNo=document.getElementById("attachcount_"+designId).value;
if(attachNo==0||attachNo=="")
var icon="";else var icon='<img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner attach-a">';
var currentTime=new Date;var crntime=currentTime.getTime();var objName=this["draft"];
var fieldz=new Array(14);fieldz[0]="id";fieldz[1]="from_list";
fieldz[2]="to_list";
fieldz[3]="cc";
fieldz[4]="bcc";
fieldz[5]="subject";
fieldz[6]="body";
fieldz[7]="readflag";
fieldz[8]="starflag";
fieldz[9]="time";fieldz[10]="status";fieldz[11]="time_int";fieldz[12]="back_folder";fieldz[13]="no_conversations";fieldz[14]="object";fieldz[15]="search_object";


var fieldz1=new Array(17);fieldz1[0]="id";fieldz1[1]="from_list";fieldz1[2]="to_list";fieldz1[3]="cc";fieldz1[4]="bcc";fieldz1[5]="subject";fieldz1[6]="body";fieldz1[7]="readflag";fieldz1[8]="starflag";
fieldz1[9]="time";fieldz1[10]="status";
fieldz1[11]="mail_references";fieldz1[12]="original_folder";fieldz1[13]="original_body";fieldz1[14]="cntnt_display";
fieldz1[15]="time_int";fieldz1[16]="short_cntnt";fieldz1[17]='object';
  fieldz1[18]='date';
  fieldz1[19]='search_object';
  

var avlbl=isArrayAvailable("draft");var toobj1="draft_"+draftid;
if(avlbl==1)var objName1=this["draft"];var objName2=this[toobj1];
tO=tO.replace("<","< ");
cC=cC.replace("<","< ");
bcC=bcC.replace("<","< ");
tO=encodeURIComponent(tO);
cC=encodeURIComponent(cC);
bcC=encodeURIComponent(bcC);
subjecT=encodeURIComponent(subjecT);
contenT=encodeURIComponent(contenT);
$.ajax({type:"POST",cache:false,url:"{url:(mail/savemail)}",
data:"to="+tO+"&cc="+cC+"&bcc="+bcC+"&subject="+subjecT+"&content="+contenT+"&time="+crntime+"&draftid="+draftid,
success:function(data){alert(data);
tO=decodeURIComponent(tO);
cC=decodeURIComponent(cC);
bcC=decodeURIComponent(bcC);
subjecT=decodeURIComponent(subjecT);contenT=decodeURIComponent(contenT);
var x1=data;var x2=new Array(2);
x2=x1.split("{nesote_;}");x=x2[0];short_content=x2[3];
if(x==1){
var drftCnt=parseInt(Unread[1][1])+parseInt(1);
Unread[1][1]=drftCnt; 
SetCookie("draft",drftCnt,1);
setUnreadcount()}
var values1=new Array(17);
values1[0]=draftid;values1[1]="{$username}";
values1[2]=tO;values1[3]=cC;values1[4]=bcC;values1[5]=subjecT;
values1[6]=contenT;values1[7]=1;values1[8]=0;
values1[9]=x2[2];values1[10]=x2[1];values1[11]=1;values1[12]="draft";
values1[13]=contenT;values1[14]=0;
values1[15]=crntime;values1[16]=contenT;
values1[17]='draft_'+draftid;	values1[18]='date';	values1[19]='draft_'+draftid;

var values=new Array(14);values[0]=draftid;values[1]="{$username}";values[2]=tO;values[3]=cC;values[4]=bcC;values[5]=subjecT;values[6]=short_content;values[7]=1;values[8]=0;values[9]=x2[2];values[10]=icon;values[11]=
crntime;values[12]="draft";values[13]=1;values[14]='draft_'+draftid;;values[15]='draft_'+draftid;;
if(avlbl!=0)
{var av=objName.isItemAvailable("draft",draftid);
if(av==0){
objName.insert("draft",2,values,"time_int","desc");
objName.totl2=parseInt(objName.totl2)+parseInt(1)}
else{
var idz1=new Array(1);
idz1[0]=draftid;
objName.update("draft",fieldz,values);
objName.where("id=?",idz1);
objName.action()}}
var avlbl1=isArrayAvailable(toobj1);
if(avlbl1!=0)
{var idz2=new Array(1);idz2[0]=draftid;
objName2.update(toobj1,fieldz1,values1);
objName2.where("id=?",idz2);
objName2.action()}
else;
var message="{cfn:getmessage(449)}";
notify_display(message,"info");
//toastr.info(message);//Using toaster to display messages
//document.getElementById("messages").style.display="";//document.getElementById("message_mail").innerHTML=message;setTimeout("hidemailmessage()",5E3)
}})};*/
function savEmail(tO,cC,bcC,subjecT,contenT,mailid,designId)
{
var zz=idz.split(":");// idz null(new mail)
if(zz!="")
var zzz=zz[1].split("&");
if(zz=="")
var draftid=document.getElementById("draftid_"+designId).value;
else 
//var draftid=zzz[0];
var draftid=document.getElementById("draftid_"+designId).value;
var attachNo=document.getElementById("attachcount_"+designId).value;
if(attachNo==0||attachNo=="")
var icon="";else var icon='<img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner attach-a">';
var currentTime=new Date;var crntime=currentTime.getTime();var objName=this["draft"];
var fieldz=new Array(14);fieldz[0]="id";fieldz[1]="from_list";
fieldz[2]="to_list";
fieldz[3]="cc";
fieldz[4]="bcc";
fieldz[5]="subject";
fieldz[6]="body";
fieldz[7]="readflag";
fieldz[8]="starflag";
fieldz[9]="time";fieldz[10]="status";fieldz[11]="time_int";fieldz[12]="back_folder";fieldz[13]="no_conversations";fieldz[14]="object";fieldz[15]="search_object";


var fieldz1=new Array(17);fieldz1[0]="id";fieldz1[1]="from_list";fieldz1[2]="to_list";fieldz1[3]="cc";fieldz1[4]="bcc";fieldz1[5]="subject";fieldz1[6]="body";fieldz1[7]="readflag";fieldz1[8]="starflag";
fieldz1[9]="time";fieldz1[10]="status";
fieldz1[11]="mail_references";fieldz1[12]="original_folder";fieldz1[13]="original_body";fieldz1[14]="cntnt_display";
fieldz1[15]="time_int";fieldz1[16]="short_cntnt";fieldz1[17]='object';
  fieldz1[18]='date';
  fieldz1[19]='search_object';
  

var avlbl=isArrayAvailable("draft");var toobj1="draft_"+draftid;
if(avlbl==1)var objName1=this["draft"];var objName2=this[toobj1];
tO=tO.replace("<","< ");
cC=cC.replace("<","< ");
bcC=bcC.replace("<","< ");
tO=encodeURIComponent(tO);
cC=encodeURIComponent(cC);
bcC=encodeURIComponent(bcC);
subjecT=encodeURIComponent(subjecT);
contenT=encodeURIComponent(contenT);
$.ajax({type:"POST",cache:false,url:"{url:(mail/savemail)}",
data:"to="+tO+"&cc="+cC+"&bcc="+bcC+"&subject="+subjecT+"&content="+contenT+"&time="+crntime+"&draftid="+draftid,
success:function(data){//alert(data);
tO=decodeURIComponent(tO);
cC=decodeURIComponent(cC);
bcC=decodeURIComponent(bcC);
subjecT=decodeURIComponent(subjecT);contenT=decodeURIComponent(contenT);
var x1=data;var x2=new Array(2);
x2=x1.split("{nesote_;}");x=x2[0];short_content=x2[3];
if(x==1){
var drftCnt=parseInt(Unread[1][1])+parseInt(1);
Unread[1][1]=drftCnt; 
SetCookie("draft",drftCnt,1);
setUnreadcount()}
var values1=new Array(17);
values1[0]=draftid;values1[1]="{$username}";
values1[2]=tO;values1[3]=cC;values1[4]=bcC;values1[5]=subjecT;
values1[6]=contenT;values1[7]=1;values1[8]=0;
values1[9]=x2[2];values1[10]=x2[1];values1[11]=1;values1[12]="draft";
values1[13]=contenT;values1[14]=0;
values1[15]=crntime;values1[16]=contenT;
values1[17]='draft_'+draftid;	values1[18]='date';	values1[19]='draft_'+draftid;

var values=new Array(14);values[0]=draftid;values[1]="{$username}";values[2]=tO;values[3]=cC;values[4]=bcC;values[5]=subjecT;values[6]=short_content;values[7]=1;values[8]=0;values[9]=x2[2];values[10]=icon;values[11]=
crntime;values[12]="draft";values[13]=1;values[14]='draft_'+draftid;;values[15]='draft_'+draftid;;
if(avlbl!=0)
{var av=objName.isItemAvailable("draft",draftid);
if(av==0){
objName.insert("draft",2,values,"time_int","desc");
objName.totl2=parseInt(objName.totl2)+parseInt(1)}
else{
var idz1=new Array(1);
idz1[0]=draftid;
objName.update("draft",fieldz,values);
objName.where("id=?",idz1);
objName.action()}}
var avlbl1=isArrayAvailable(toobj1);
if(avlbl1!=0)
{var idz2=new Array(1);idz2[0]=draftid;
objName2.update(toobj1,fieldz1,values1);
objName2.where("id=?",idz2);
objName2.action()}
else;
var message="{cfn:getmessage(449)}";
notify_display(message,"info");
//toastr.info(message);//Using toaster to display messages
//document.getElementById("messages").style.display="";//document.getElementById("message_mail").innerHTML=message;setTimeout("hidemailmessage()",5E3)
}})};
function markstar(maiLid,page,type,f,object,search_object)
{
	
 
var current_view=getCookievalue("current_view");
var fieldz=new Array(1);
fieldz[0]="starflag";
aValues=new Array(1);
aValues[0]=type;
var starred_folder=0;
var page=getCookievalue("mail_page");
if(mail_open==0)////outer starring
{    
	
          var folder=getCookievalue("folder");
          var currentTime=new Date();
          var crntime=currentTime.getTime();
          if(isArrayAvailable(folder))
          {
          
            var objct=this[folder];
            var aa=objct.getResultPage(folder,page,mailsPerpage);
            while(xx=objct.fetchRow(aa))
            {
            	//console.log(xx);
            	
              if(maiLid==xx[0])
                  { 
                  
                        var idz1=new Array(1);
                        idz1[0]=maiLid;
                        objct.update(folder,fieldz,aValues);
                        objct.where('id=?',idz1);
                        objct.action();
                    
                                                       
                      var search_objects=search_object.substr(0,search_object.length-1);
                      var folder_search=search_objects.split(".");
                  
                      for(var k=0;k<folder_search.length;k++)
                      {
                          var folders=folder_search[k].split("_");
                          var objct1=this[folders[0]];	
                          var inner_obj=this[folder_search[k]];       
                     
                          var idz1=new Array(1);
                          idz1[0]=folders[1];
                      
                      
                          if(isArrayAvailable(folders[0]))
                          {
                              var itemavail=objct1.isItemAvailable(folders[0],folders[1]);
                              if(itemavail!=0)
                              {			
                                                           
                                  objct1.update(folders[0],fieldz,aValues);
                                  objct1.where('id=?',idz1);
                                  objct1.action();
                                                   
                                  
                              }
                          }
                          if(isArrayAvailable(folder_search[k]))
                          { 
                         
                              if(type==0)//// for updating inner starring
                               {		  						       
                                      
                                        var cc=inner_obj.getResultPage(folder_search[k],1,50);
                                        while(xxx=inner_obj.fetchRow(cc))
                                        {
                                           var idz1=new Array(1);
                                           idz1[0]=xxx[0];
                                           inner_obj.update(folder_search[k],fieldz,aValues);
                                           inner_obj.where('id=?',idz1);
                                           inner_obj.action();   									    
                                        }							       
                                         
                                }
                                else ////starring
                                {
                                      var itemavails=inner_obj.isItemAvailable(folder_search[k],maiLid);
                                      if(itemavails!=0)
                                      {
                                          var idz1=new Array(1);
                                          idz1[0]=xx[0];
                                          inner_obj.update(folder_search[k],fieldz,aValues);
                                          inner_obj.where('id=?',idz1);
                                          inner_obj.action();
                                      }
                               }
                          
                           }										
                                          
                      
                      if(type==1)
                      {  if(folder!="spam")
                         {
                           var aryAvail=isArrayAvailable('starred'); 
                           if(aryAvail==1)
                           {  
                              var opject=this['starred'];
                              var isStar=opject.isItemAvailable('starred',xx[0]);
                              
                              
                              
                              
                              if(isStar==0)
                                  {
                                      var rset=objct.getResultItem(folder,xx[0]);
                                      var values=objct.fetchRow(rset);
                                      opject.insert('starred',2,values,'time_int','desc');			
                                      opject.totl2=parseInt(opject.totl2)+parseInt(1);
                                  }	    
                              
                           }
                           
                          }
                      //Additional Coding for  3pane Mail Viewing
                      document.getElementById("star_3pane_"+xx[0]).innerHTML="<a href=\"javascript:markstar("+xx[0]+","+page+",0,"+maiLid+",'"+object+"','"+search_object+"')\"><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner str-y\"></a>";
                      document.getElementById("star_"+xx[0]).innerHTML="<a href=\"javascript:markstar("+xx[0]+","+page+",0,"+maiLid+",'"+object+"','"+search_object+"')\"><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner str-y\"></a>";
                      }
                      else
                      {
                       
                         var aryAvail=isArrayAvailable('starred');
                         
                          if(aryAvail==1)
                          {   
                              var opject=this['starred'];
                              var isStar=opject.isItemAvailable('starred',xx[0]);
                        
                              if(isStar!=0)
                              {  // var idz1=new Array(1);
                                 // idz1[0]=folders[1];
                                  var idz1=new Array(1);
                                  idz1[0]=xx[0];
                                  opject.deleteEntry('starred');
                                  opject.where('id=?',idz1);
                                  opject.action();//alert(xx[0]);
                                  if(folder=='starred')
                                  {   //if(current_view=="2pane")                
                                      document.getElementById('twopaneMail_'+xx[0]).style.display="none";        					
                                     // else
                                     // document.getElementById('threepaneMail_'+xx[0]).style.display="none";        					
                                     // console.log("\n After Remove Now Array:\n");
                                     // console.log(xx);
                                              
                                  }
                              }
                          }
                        //Additional Coding for  3pane Mail Viewing
                          document.getElementById("star_3pane_"+xx[0]).innerHTML="<a href=\"javascript:markstar("+xx[0]+","+page+",1,"+maiLid+",'"+object+"','"+search_object+"')\"><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner str-g\"></a>";
                          document.getElementById("star_"+xx[0]).innerHTML="<a href=\"javascript:markstar("+xx[0]+","+page+",1,"+maiLid+",'"+object+"','"+search_object+"')\"><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner str-g\"></a>";
                      }
                  }
                      
               }
              } 
            }
            var flag=1;
            
  }		
  else ///mail_open=1
  {

      var folder=getCookievalue("folder");var notavlble_flag=1;
      if(isArrayAvailable(folder))
      {
       notavlble_flag=0;
       var objct=this[folder];
       var aa=objct.getResultPage(folder,page,mailsPerpage);
       while(xx=objct.fetchRow(aa))
       {
    	   if(maiLid==xx[0])//Coded For Fixing Some issues 
                 {    	   
         var search_objects=search_object.substr(0,search_object.length-1);
         var folder_search=search_objects.split(".");
         for(var k=0;k<folder_search.length;k++)
         {
             var folders=folder_search[k].split("_");			  
             
     
           if(isArrayAvailable(folder_search[k]))
           {
              var inner_obj=this[folder_search[k]];
              var isitem=inner_obj.isItemAvailable(folder_search[k],maiLid);
              if(isitem!=0)
              { 
                 var idz1=new Array(1);
                 idz1[0]=maiLid;
                 inner_obj.update(folder_search[k],fieldz,aValues);
                 inner_obj.where('id=?',idz1);
                 inner_obj.action(); 	   
         
             }
          }
         
         if(isArrayAvailable(folders[0]))
         {
           var objct1=this[folders[0]];	
           var isItem=objct1.isItemAvailable(folders[0],folders[1]);var star_flag=0;
           if(isItem!=0)
           {
           
               if(type==1)
               {
                     var idz1=new Array(1);
                     idz1[0]=folders[1];
                     objct1.update(folders[0],fieldz,aValues);
                     objct1.where('id=?',idz1);
                     objct1.action(); 
               
               }
               else
               {	
                            
                     var star_outer_flag=0;
                     var dd=inner_obj.getResultPage(folder_search[k],1,50);
                     while(ss=inner_obj.fetchRow(dd))
                     {
                     
                      if(ss[8]==1)
                      star_outer_flag=1;
                     }
                     if(star_outer_flag==0)
                     {
                     var idz1=new Array(1);
                     idz1[0]=folders[1];
                     objct1.update(folders[0],fieldz,aValues);
                     objct1.where('id=?',idz1);
                     objct1.action(); 
                     }
              
                
               }
                 
                     
          }
        }
        
        
        if(type==1)
        {     if(folder!="spam")
              {
                  var aryAvail=isArrayAvailable('starred'); 
                  if(aryAvail==1)
                   {
                         var opject=this['starred'];  var chk_insrt_star=0;
                        for(var n=0;n<folder_search.length;n++)
                        {
                           var chk_folder=folder_search[n].split("_");
                           var chk_item=opject.isItemAvailable('starred',chk_folder[1]);
                           if(chk_item!=0)
                           {
                            chk_insrt_star=1;
                           }
                             
                          
                        } 				
                                  if(chk_insrt_star==0)
                                  {						 
                                      var rset=objct.getResultItem(folder,folders[1]); 
                                      var values=objct.fetchRow(rset);
                                      
                                      
                                      opject.insert('starred',2,values,'time_int','desc');			
                                      opject.totl2=parseInt(opject.totl2)+parseInt(1);
                                   }
                                   else
                                   {
                                   
                                     var inner_star_folder="starred:"+folder_search[k];
                                     var aryAvl_inner=isArrayAvailable(inner_star_folder);
                                     if(aryAvl_inner==1)
                                     {
                                          var inner_star=this[inner_star_folder];
                                        
                                            var idz1=new Array(1);
                                             idz1[0]=maiLid;
                                             inner_star.update(inner_star_folder,fieldz,aValues);
                                             inner_star.where('id=?',idz1);  
                                             inner_star.action(); 
                                       }
                                      }
                           }
                      }	 
      //Additional Coding for  3pane Mail Viewing
        document.getElementById("star_3pane_"+xx[0]).innerHTML="<a href=\"javascript:markstar("+xx[0]+","+page+",0,"+maiLid+",'"+object+"','"+search_object+"')\"><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner str-y\"></a>";
        document.getElementById("star_"+maiLid).innerHTML="<a href=\"javascript:markstar("+maiLid+","+page+",0,"+maiLid+",'"+object+"','"+search_object+"')\"><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner str-y\"></a>";
          }
          else
          {//alert("Star issues");
                       
                         var aryAvail=isArrayAvailable('starred');
                          if(aryAvail==1)
                          {
                              var opject=this['starred'];
                              var isStar=opject.isItemAvailable('starred',folders[1]);
                              if(isStar!=0)
                              { 
                                  if(star_outer_flag==0)
                                  {
                                  var idz1=new Array(1);
                                  idz1[0]=folders[1];
                                  opject.deleteEntry('starred');
                                  opject.where('id=?',idz1);
                                  opject.action();
                                  }
                                  else
                                  {
                                   
                                     var inner_star_folder="starred:"+folder_search[k];
                                     var aryAvl_inner=isArrayAvailable(inner_star_folder);
                                     if(aryAvl_inner==1)
                                     {
                                          var inner_star=this[inner_star_folder];
                                        
                                            var idz1=new Array(1);
                                             idz1[0]=maiLid;
                                             inner_star.update(inner_star_folder,fieldz,aValues);
                                             inner_star.where('id=?',idz1); 
                                             inner_star.action(); 
                                       }
                                  
                                  }
                                  
                                 
                                  if(folder=='starred')
                                  {					       								    				 	    
                                     if(star_outer_flag==0)
                                      starred_folder=1;     	
                                                                                
                                                          
                                              
                                  }
                               }
                          }
                        //Additional Coding for  3pane Mail Viewing
                          document.getElementById("star_3pane_"+xx[0]).innerHTML="<a href=\"javascript:markstar("+xx[0]+","+page+",1,"+maiLid+",'"+object+"','"+search_object+"')\"><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner str-g\"></a>";
                          document.getElementById("star_"+maiLid).innerHTML="<a href=\"javascript:markstar("+maiLid+","+page+",1,"+maiLid+",'"+object+"','"+search_object+"')\"><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner str-g\"></a>";
                       
                       
                      }	  
        
      
      
     }
      
      }
       
      }//If end
       
  }
  
  if(notavlble_flag==1)
  {
     
      
         var search_objects=search_object.substr(0,search_object.length-1);
         var folder_search=search_objects.split(".");
         for(var k=0;k<folder_search.length;k++)
         {
             var folders=folder_search[k].split("_");			  
             
     
           if(isArrayAvailable(folder_search[k]))
           {
              var inner_obj=this[folder_search[k]];
              var isitem=inner_obj.isItemAvailable(folder_search[k],maiLid);
              if(isitem!=0)
              { 
                 var idz1=new Array(1);
                 idz1[0]=maiLid;
                 inner_obj.update(folder_search[k],fieldz,aValues);
                 inner_obj.where('id=?',idz1);
                 inner_obj.action(); 	   
         
             }
          }
        
         if(isArrayAvailable(folders[0]))
         { 
           var objct1=this[folders[0]];	
           var isItem=objct1.isItemAvailable(folders[0],folders[1]);var star_flag=0;
           if(isItem!=0)
           {
           
               if(type==1)
               {
                     var idz1=new Array(1);
                     idz1[0]=folders[1];
                     objct1.update(folders[0],fieldz,aValues);
                     objct1.where('id=?',idz1);
                     objct1.action(); 
               
               }
               else
               {	
                            
                     var star_outer_flag=0;
                     var dd=inner_obj.getResultPage(folder_search[k],1,50);
                     while(ss=inner_obj.fetchRow(dd))
                     {
                     
                      if(ss[8]==1)
                      star_outer_flag=1;
                     }
                     if(star_outer_flag==0)
                     {
                     var idz1=new Array(1);
                     idz1[0]=folders[1];
                     objct1.update(folders[0],fieldz,aValues);
                     objct1.where('id=?',idz1);
                     objct1.action(); 
                     }
              
                
               }
                 
                     
          }
        }
        
        
        if(type==1)
        {     if(folder!="spam")
               {
                  var aryAvail=isArrayAvailable('starred'); 
                  if(aryAvail==1)
                   {
                         var opject=this['starred'];  var chk_insrt_star=0;
                        for(var n=0;n<folder_search.length;n++)
                        {
                           var chk_folder=folder_search[n].split("_");
                           var chk_item=opject.isItemAvailable('starred',chk_folder[1]);
                           if(chk_item!=0)
                           {
                            chk_insrt_star=1;
                           }
                             
                          
                        } 				
                                  if(chk_insrt_star==0)
                                  {						 
                                      var rset=objct.getResultItem(folder,folders[1]); 
                                      var values=objct.fetchRow(rset);
                                      
                                      
                                      opject.insert('starred',2,values,'time_int','desc');			
                                      opject.totl2=parseInt(opject.totl2)+parseInt(1);
                                   }
                                   else
                                   {
                                   
                                     var inner_star_folder="starred:"+folder_search[k];
                                     var aryAvl_inner=isArrayAvailable(inner_star_folder);
                                     if(aryAvl_inner==1)
                                     {
                                          var inner_star=this[inner_star_folder];
                                        
                                            var idz1=new Array(1);
                                             idz1[0]=maiLid;
                                             inner_star.update(inner_star_folder,fieldz,aValues);
                                             inner_star.where('id=?',idz1);  
                                             inner_star.action(); 
                                       }
                                      }
                              
                           }
                      }	 
      //Additional Coding for  3pane Mail Viewing
      if(current_view=="3pane")
        document.getElementById("star_3pane_"+xx[0]).innerHTML="<a href=\"javascript:markstar("+xx[0]+","+page+",0,"+maiLid+",'"+object+"','"+search_object+"')\"><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner str-y\"></a>";
        document.getElementById("star_"+maiLid).innerHTML="<a href=\"javascript:markstar("+maiLid+","+page+",0,"+maiLid+",'"+object+"','"+search_object+"')\"><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner str-y\"></a>";
          }
          else
          {
                       //alert("Here");
                         var aryAvail=isArrayAvailable('starred');
                          if(aryAvail==1)
                          {
                              var opject=this['starred'];
                              var isStar=opject.isItemAvailable('starred',folders[1]);
                              if(isStar!=0)
                              {
                                
                                
                                  if(star_outer_flag==0)
                                  {
                                  var idz1=new Array(1);
                                  idz1[0]=folders[1];
                                  opject.deleteEntry('starred');
                                  opject.where('id=?',idz1);
                                  opject.action();
                                  }
                                  else
                                  {
                                   
                                     var inner_star_folder="starred:"+folder_search[k];
                                     var aryAvl_inner=isArrayAvailable(inner_star_folder);
                                     if(aryAvl_inner==1)
                                     {
                                          var inner_star=this[inner_star_folder];
                                        
                                            var idz1=new Array(1);
                                             idz1[0]=maiLid;
                                             inner_star.update(inner_star_folder,fieldz,aValues);
                                             inner_star.where('id=?',idz1);  
                                             inner_star.action(); 
                                       }
                                  
                                  }
                                  
                                 
                                  if(folder=='starred')
                                  {					       								    				 	    
                                     if(star_outer_flag==0)
                                      starred_folder=1;     	
                                                                                
                                                          
                                              
                                  }
                               }
                          }
                        //Additional Coding for  3pane Mail Viewing
                          document.getElementById("star_3pane_"+xx[0]).innerHTML="<a href=\"javascript:markstar("+xx[0]+","+page+",1,"+maiLid+",'"+object+"','"+search_object+"')\"><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner str-g\"></a>";
                          document.getElementById("star_"+maiLid).innerHTML="<a href=\"javascript:markstar("+maiLid+","+page+",1,"+maiLid+",'"+object+"','"+search_object+"')\"><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner str-g\"></a>";
                       
                       
                      }	  
        
      
      
     }
  
  }
  
    var flag=2; 
    
  }
 

 
 
 
 
  var object=object+",";	
      $.ajax({

type: "POST",cache: false,
url: "{url:(mail/star/)}",
data: "type="+type+"&foldernane="+folder+"&mailid="+maiLid+"&object="+object+"&flag="+flag,
success: function(data) {
          var x=data;//console.log('\nStar Data:\n'+data);console.log('\nStarred Folder:\n'+starred_folder);
          if(starred_folder==1)
          {
          Unread[5][2]=1;
          var page=getCookievalue("mail_page");
          mainWindow(folder,page,mailsPerpage,x,2);	
          }
          
          document.getElementById("moreList2").style.display="none";
      }
              
  });
      
  
}

function reply(mailid,flderName,pageNo,name,draftid,designId)
{
var hash=window.location.hash;

var hashing=hash.split("/");
var decode_hash=decode64(hashing[1]);
var decode_object=decode_hash.split("/");
reply_mail_id=reply_mail_id+designId+",";
var design=designId.split("_");
if((name.substring(0,6)=="search")||(name.substring(0,4)=="from")||(name.substring(0,7)=="starred"))
{
var namez=decode_object[1];
var flderName=this[namez];
}
else
{
var namez=name+"_"+design[0];
var flderName=this[namez];
}
drafTcount=0;
if(document.getElementById("reply_"+designId).style.display=="none")
document.getElementById("reply_"+designId).style.display="";
if(document.getElementById("replyfooter1_"+designId).style.display=="")
document.getElementById("replyfooter1_"+designId).style.display="none";
var url_mail="{url:(mail/createdraft)}";
if((name.substring(0,6)=="search")||(name.substring(0,4)=="from"))
var nameF=this[namez];
else
var nameF=this[name+"_"+design[0]];
var content='<div class="row"   id="replyfooter2_'+designId+'" style="padding-top:5px;display:none"><div class="replyLink commonBtngc floatL"><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner reply-r"><a href="javascript:createDraft('+mailid+",'"+nameF+"',"+pageNo+",'"+name+"',1,'"+designId+"','"+url_mail+'\')">{cfn:getmessage(15)}</a></div><div class="replyLink commonBtngc floatL"><span><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner reply-a"></span><a href="javascript:createDraft('+mailid+",'"+nameF+"',"+pageNo+",'"+name+"',2,'"+designId+"','"+url_mail+'\')">{cfn:getmessage(16)}</a></div><div class="replyLink commonBtngc floatL"><span><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner reply-f"></span><a href="javascript:createDraft('+mailid+",'"+nameF+"',"+pageNo+",'"+name+"',3,'"+designId+"','"+url_mail+'\')">{cfn:getmessage(17)}</a></div></div><div style="clear:both"></div>';
var aaa=flderName.isItemAvailable(namez,mailid);
if(xx=flderName.getResultItembyIndex(namez,aaa))
{
var repfrom=new Array();repfrom[0]="";repfrom[1]="";
if(xx[1].indexOf("<")>=0)
{
repfrom=xx[1].split("<");
}
if(repfrom[1]!="")
repfrom[1]=repfrom[1].replace(">","");
else 
repfrom[1]=xx[1];
if(repfrom[0]!="")
repfrom[0]=" "+repfrom[0]+" ";
var replymsg="<div style=\"font:small arial;\" > On "+xx[18]+", <span><b>"+repfrom[0]+"</b> <<a target=\"_blank\" href=\"mailto:"+repfrom[1]+"\">"+repfrom[1]+"</a>> wrote:</span><br/></div>";
if((name=="sent")||(xx[12]=="sent"))
var to_field=xx[2];else var to_field=xx[1];
var subject="{$reply_pre}:"+xx[5];content=content+'<div id="sendFooter2_0" class="row marginT10" ><span class="sendBtn"><a href="javascript:mailFurther(1,'+mailid+",'"+designId+'\')">{cfn:getmessage(37)}</a></span><span class="commonBtn commonBtngc floatL">\t<a href="javascript:mailFurther(2,'+mailid+",'"+designId+'\')" class="position_tooltip"  title="{cfn:getmessage(36)}"><i class="fa fa-file-text"></i></a>\t</span>\t<span class="commonBtn commonBtngc floatL"><a class="position_tooltip" href="javascript:mailFurther(3,'+mailid+",'"+designId+"')\" title='{cfn:getmessage(59)}'><i class='fa fa-trash'></i></a></span></div>";
content=content+'<div class="row marginT10"><div class="row"><div class="coloum70 floatL"><span class="boldTxt">{cfn:getmessage(31)}:</span></div><div class="coloum floatL" style="width:89%;float: left;"><input autocomplete="off" type="text" name="to_'+designId+'" id="to_'+designId+'" value="'+to_field+'"\tonKeyUp="javascript:keymovement(event,this.value,\''+designId+'\',1);" style="width: 99%; height: 30px;position:relative;" ><input type="hidden" name="search_'+designId+'" id="search_'+designId+'" value="" ></div><div style="clear: both;" ></div><div id="livesearch_'+designId+'" class="livesearch" style="position:static;margin-left:74px;"></div></div></div>';content=content+'<div class="row marginT10"><div class="coloum70 floatL" ><span class="boldTxt">{cfn:getmessage(34)}:</span></div><div class="coloum floatL" style="width:89%;"><input type="text" name="subject_'+designId+'" id="subject_'+designId+'" value="'+subject+'" style="width: 99%; height: 30px;"></div></div><div style="clear: both;"></div>';
content=content+'<div class="row marginT10" id="cc_bcc_'+designId+'"><div class="coloum70 floatL" ></div><span id="spancc_'+designId+'" class="commonLink"><a href="javascript:showccfun(\''+designId+'\')" >{cfn:getmessage(201)}</a></span><span\tclass="normalTxt floatL">|</span><span id="spanbcc_'+designId+'" class="commonLink"><a href="javascript:showbccfun(\''+designId+"')\">{cfn:getmessage(202)}</a></span></div>";content=content+'<div id="showcc_'+designId+'" style="display: none;" class="row marginT10"><div class="coloum70 floatL" ><span class="boldTxt">{cfn:getmessage(32)}:</span></div><div class="coloum floatL" style="width:89%;float: left;"><input autocomplete="off" type="text" name="cc_'+designId+'" id="cc_'+designId+'" value=""\tonKeyUp="javascript:keymovement(event,this.value,\''+designId+'\',2);" style="width: 99%; height: 30px;position:relative;"><input type="hidden" name="searchcc_'+designId+'" id="searchcc_'+designId+'" value="" ></div><div style="clear: both;"  ></div><div id="livesearchcc_'+designId+'" class="livesearch" style="position:static;margin-left:74px;"></div></div></div>';content=content+'<div id="showbcc_'+designId+'" style="display: none;" class="row marginT10"><div class="coloum70 floatL" ><span class="boldTxt">{cfn:getmessage(33)}:</span></div><div class="coloum floatL" style="width:89%;float: left;"><input autocomplete="off" type="text" name="bcc_'+designId+'" id="bcc_'+designId+'" value=""\tonKeyUp="javascript:keymovement(event,this.value,\''+designId+'\',3);" style="width: 99%; height: 30px;position:relative;"><input type="hidden" name="searchbcc_'+designId+'" id="searchbcc_'+designId+'" value="" ></div><div style="clear: both;"  ></div><div id="livesearchbcc_'+designId+'" class="livesearch" style="position:static;margin-left:74px;"></div></div></div>';content=content+'<div class="row marginT10" id="cc_only_'+designId+'" style="display: none;"><div class="coloum70 floatL" ></div><span id="spancc_'+designId+'" class="commonLink"><a href="javascript:showccfun2(\''+designId+'\')">{cfn:getmessage(201)}</a></span></div><div class="row marginT10" id="bcc_only_'+designId+'" style="display: none;"><div class="coloum70 floatL" ></div><span id="spanbcc_'+designId+'" class="commonLink"><a href="javascript:showbccfun2(\''+designId+'\')">{cfn:getmessage(202)}</a></span></div><div style="clear: both;"></div>';content=content+'<span  class="attachLink"><a href="javascript:addfilefield(\''+designId+'\')"><div id="attachlink_'+designId+'"><span><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner attach-a"></span><span class="boldTxt">{cfn:getmessage(35)}</span></div></a></span><input type="hidden" value="" id="attachcount_'+designId+'" name="attachcount_'+designId+'"><div style="clear: both;"></div><div class="attachwrap"><div id="filedivcontainer_'+designId+'_0"  class="attachBox"></div></div><div style="clear: both;"></div><div id="additionalattach_'+designId+'" class="attachLink" style="display: none"><a href="javascript:addfilefield(\''+designId+'\')"><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner attach-a">{cfn:getmessage(60)} </a></div><div style="clear: both;"></div>';content=content+'<div class="row marginT10" style=" width:100%;"><div onkeyup="autoSave(\''+designId+'\')" class="nicedit_div" ><textarea  name="mailBody_'+designId+'"   class="nicedit_textarea" id="mailBody_'+designId+'"><br /><br />'+replymsg+'<blockquote  style="border-left: 1px solid rgb(204, 204, 204); margin: 0px 12px 12px 5px; padding-left: 1ex;">'+xx[6]+"</blockquote></textarea></div></div>";content=content+'<div id="sendFooter2_0" class="row marginT10" ><span class="sendBtn"><a href="javascript:mailFurther(1,'+mailid+",'"+designId+'\')">{cfn:getmessage(37)}</a></span><span class="commonBtn commonBtngc floatL">\t<a class="position_tooltip"  href="javascript:mailFurther(2,'+mailid+",'"+designId+'\')" title="{cfn:getmessage(36)}"><i class="fa fa-file-text"></i></a>\t</span>\t<span class="commonBtn commonBtngc floatL"><a class="position_tooltip"  href="javascript:mailFurther(3,'+mailid+",'"+designId+"')\" title='{cfn:getmessage(59)}'><i class='fa fa-trash'></i></a></span></div>";content=content+'<input type="hidden" id="draftid_'+designId+'" value="'+draftid+'">';
content=content+"</div>";
document.getElementById("reply_"+designId).innerHTML=content;
//(new nicEditor({fullPanel:true})).panelInstance("mailBody_"+designId);

CKEDITOR.replace("mailBody_"+designId);

if(signature<2){if(signature==0){var sign="{noescape:$signature}";
sign=replymsg+xx[6]+"<br><br>"+sign;//nicEditors.findEditor("mailBody_"+designId).setContent(sign)

var editor1="mailBody_"+designId;

var editor=CKEDITOR.instances[editor1];
editor.setData(sign);


}
else{var textId="mailBody_"+designId;getNewSignature(textId,xx[6],1,replymsg)}}
if(document.getElementById("nic_edit_nesote_webmail")){document.getElementById("nic_edit_nesote_webmail").focus();}}};

function replyAll(mailid,flderName,pageNo,name,draftid,designId)
{
var hash=window.location.hash;
var hashing=hash.split("/");
var decode_hash=decode64(hashing[1]);
var decode_object=decode_hash.split("/");
reply_mail_id=reply_mail_id+designId+",";
var design=designId.split("_");

if((name.substring(0,6)=="search")||(name.substring(0,4)=="from")||(name.substring(0,7)=="starred"))
{
var namez=decode_object[1];
var flderName=this[namez];
}
else
{
var namez=name+"_"+design[0];
var flderName=this[namez];
}

var p=0;while(p<1E5)p=p+1;
drafTcount=0;var url_mail="{url:(mail/createdraft)}";
if(document.getElementById("reply_"+designId).style.display=="none")document.getElementById("reply_"+designId).style.display="";
if((name.substring(0,6)=="search")||(name.substring(0,4)=="from"))
var nameF=this[namez];
else
var nameF=this[name+"_"+design[0]];
var content='<div class="row"   id=replyfooter2_'+designId+' style="padding-top:5px;display:none"><div class="replyLink commonBtngc floatL"><span><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner reply-r"></span><a href="javascript:createDraft('+mailid+",'"+nameF+"',"+pageNo+",'"+name+"',1,'"+designId+"','"+url_mail+'\')">{cfn:getmessage(15)}</a></div><div class="replyLink commonBtngc floatL"><span><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner reply-a"></span><a href="javascript:createDraft('+mailid+",'"+nameF+"',"+pageNo+",'"+name+"',2,'"+designId+"','"+url_mail+'\')">{cfn:getmessage(16)}</a></div><div class="replyLink commonBtngc floatL"><span><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner reply-f"></span><a href="javascript:createDraft('+mailid+",'"+nameF+"',"+pageNo+",'"+name+"',3,'"+designId+"','"+url_mail+'\')">{cfn:getmessage(17)}</a></div></div><div style="clear:both"></div>';document.getElementById("replyfooter1_"+designId).style.display="none";
var aaa=flderName.isItemAvailable(namez,mailid);
if(xx=flderName.getResultItembyIndex(namez,aaa))
{
var repfrom=new Array();repfrom[0]="";repfrom[1]="";
if(xx[1].indexOf("<")>=0)
{
repfrom=xx[1].split("<");
}
if(repfrom[1]!="")
repfrom[1]=repfrom[1].replace(">","");
else 
repfrom[1]=xx[1];
if(repfrom[0]!="")
repfrom[0]=" "+repfrom[0]+" ";
var replymsg="<div style=\"font:small arial;\" > On "+xx[18]+", <span><b>"+repfrom[0]+"</b> <<a target=\"_blank\" href=\"mailto:"+repfrom[1]+"\">"+repfrom[1]+"</a>> wrote:</span><br/></div>";
if((name=="sent")||(xx[12]=="sent"))
var to_field=xx[2];
else var to_field=xx[1];
var subject="{$reply_pre}:"+xx[5];var cc=xx[3];if(name!="sent"){var address="{$username}";
var new_adres=xx[2].split(",");var new_adres1="";
for(var i=0;i<new_adres.length;i++)
{
if(new_adres[i].indexOf(address)<0)
new_adres1+=new_adres[i]+",";
}

if(new_adres1!=""&&cc!="")
cc=cc+","+new_adres1;
else if(new_adres1!="")cc=new_adres1}
var bcc=xx[4];content=content+'<div id="sendFooter2_0" class="row marginT10" ><span class="sendBtn"><a href="javascript:mailFurther(1,'+mailid+",'"+designId+'\')">{cfn:getmessage(37)}</a></span><span class="commonBtn commonBtngc floatL"><a class="position_tooltip"  href="javascript:mailFurther(2,'+mailid+",'"+designId+'\')" title="{cfn:getmessage(36)}"><i class="fa fa-file-text"></i></a>\t</span>\t<span class="commonBtn commonBtngc floatL"><a class="position_tooltip" title="{cfn:getmessage(59)}" href="javascript:mailFurther(3,'+mailid+",'"+designId+"')\"><i class='fa fa-trash'></i></a></span></div>";content=content+'<div class="row marginT10" ><div class="row"><div class="coloum70 floatL"><span class="boldTxt">{cfn:getmessage(31)}:</span></div><div class="coloum floatL" style="width:89%;float:left;"><input autocomplete="off" type="text" name="to_'+designId+'" id="to_'+designId+'" value="'+to_field+'"\tonKeyUp="javascript:keymovement(event,this.value,\''+designId+'\',1);" style="width: 99%; height: 30px;position:relative;"><input type="hidden" name="search_'+designId+'" id="search_'+designId+'" value="" ></div><div style="clear: both;" ></div><div id="livesearch_'+designId+'" class="livesearch" style="position:static;margin-left:74px;"></div></div></div>';content=content+'<div class="row marginT10"><div class="coloum70 floatL" ><span class="boldTxt">{cfn:getmessage(34)}:</span></div><div class="coloum floatL" style="width:89%;"><input type="text" name="subject_'+designId+'" id="subject_'+designId+'" value="'+subject+'" style="width: 99%; height: 30px;"></div></div>';if(cc==""&&bcc==""){content=content+'<div class="row marginT10" id="cc_bcc_'+designId+'"><div class="coloum70 floatL" ></div><span id="spancc_'+designId+'" class="commonLink"><a href="javascript:showccfun(\''+designId+'\')">{cfn:getmessage(201)}</a></span><span\tclass="normalTxt floatL">|</span><span id="spanbcc_'+designId+'" class="commonLink"><a href="javascript:showbccfun(\''+designId+'\')">{cfn:getmessage(202)}</a></span></div><div style="clear: both;" ></div>';
content=content+'<div id="showcc_'+designId+'" style="display: none;"  class="row marginT10"><div class="coloum70 floatL" ><span class="boldTxt">{cfn:getmessage(32)}:</span></div><div class="coloum floatL" style="width:89%;float:left;"><input autocomplete="off" type="text" name="cc_'+designId+'" id="cc_'+designId+'" value="" onKeyUp="javascript:keymovement(event,this.value,\''+designId+'\',2);" style="width: 99%; height: 30px;position:relative;"><input type="hidden" name="searchcc_'+designId+'" id="searchcc_'+designId+'" value="" ></div><div style="clear: both;" ></div><div id="livesearchcc_'+designId+'" class="livesearch" style=position:static;margin-left:74px;"></div></div></div>';content=content+'<div id="showbcc_'+designId+'" style="display: none;" class="row marginT10"><div class="coloum70 floatL" ><span class="boldTxt">{cfn:getmessage(33)}:</span></div><div class="coloum floatL" style="width:89%;float:left;"><input autocomplete="off" type="text" name="bcc_'+designId+'" id="bcc_'+designId+'" value="" onKeyUp="javascript:keymovement(event,this.value,\''+designId+'\',3);" style="width: 99%; height: 30px;position:relative;"><input type="hidden" name="searchbcc_'+designId+'" id="searchbcc_'+designId+'" value="" ></div><div style="clear: both;" ></div><div id="livesearchbcc_'+designId+'" class="livesearch" style="position:static;margin-left:74px;"></div></div></div>';content=content+'<div class="row marginT10" id="cc_only_'+designId+'" style="display: none;"><div class="coloum70 floatL" ></div><span id="spancc_'+designId+'" class="commonLink"><a href="javascript:showccfun2(\''+designId+'\')">{cfn:getmessage(201)}</a></span></div><div class="row marginT10" id="bcc_only_'+designId+'" style="display: none;"><div class="coloum70 floatL" ></div><span id="spanbcc_'+designId+'" class="commonLink"><a href="javascript:showbccfun2(\''+designId+'\')">{cfn:getmessage(202)}</a></span></div><div style="clear: both;" ></div>'}else if(bcc==""){content=content+'<div class="row marginT10" id="cc_bcc_'+designId+'" style="display: none;"><span id="spancc_'+designId+'" class="commonLink"><a href="javascript:showccfun(\''+designId+'\')">{cfn:getmessage(201)}</a></span><span\tclass="normalTxt floatL">|</span><span id="spanbcc_'+designId+'" class="commonLink"><a href="javascript:showbccfun(\''+designId+'\')">{cfn:getmessage(202)}</a></span></div><div style="clear: both;" ></div>';content=content+'<div id="showcc_'+designId+'" class="row marginT10"><div class="coloum70 floatL" ><span class="boldTxt">{cfn:getmessage(32)}:</span></div><div class="coloum floatL" style="width:89%;float:left;"><input autocomplete="off" type="text" name="cc_'+designId+'" id="cc_'+designId+'" value="'+cc+'" onKeyUp="javascript:keymovement(event,this.value,\''+designId+'\',2);" style="width: 99%; height: 30px;"><input type="hidden" name="searchcc_'+designId+'" id="searchcc_'+designId+'" value="" ></div><div style="clear: both;" ></div><div id="livesearchcc_'+designId+'" class="livesearch" style=position:static;margin-left:74px;"></div></div></div>';content=content+'<div id="showbcc_'+designId+'" style="display: none;" class="row marginT10"><div class="coloum70 floatL" ><span class="boldTxt">{cfn:getmessage(33)}:</span></div><div class="coloum floatL" style="width:89%;float:left;"><input autocomplete="off" type="text" name="bcc_'+designId+'" id="bcc_'+designId+'" value="" onKeyUp="javascript:keymovement(event,this.value,\''+designId+'\',3);" style="width: 99%; height: 30px;"><input type="hidden" name="searchbcc_'+designId+'" id="searchbcc_'+designId+'" value="" ></div><div style="clear: both;" ></div><div id="livesearchbcc_'+designId+'" class="livesearch" style="position:static;margin-left:74px;"></div></div></div>';content=content+'<div class="row marginT10" id="cc_only_'+designId+'" style="display: none;"><div class="coloum70 floatL" ></div><span id="spancc_'+designId+'" class="commonLink"><a href="javascript:showccfun2(\''+designId+'\')">{cfn:getmessage(201)}</a></span></div><div class="row marginT10" id="bcc_only_'+designId+'"><div class="coloum70 floatL" ></div><span id="spanbcc_'+designId+'" class="commonLink"><a href="javascript:showbccfun2(\''+designId+'\')">{cfn:getmessage(202)}</a></span></div><div style="clear: both;" ></div>'}else if(cc==""){content=content+'<div class="row marginT10" id="cc_bcc_'+designId+'" style="display: none;" ><span id="spancc_'+designId+'" class="commonLink"><a href="javascript:showccfun(\''+designId+'\')">{cfn:getmessage(201)}</a></span><span\tclass="normalTxt floatL">|</span><span id="spanbcc_'+designId+'" class="commonLink"><a href="javascript:showbccfun(\''+designId+'\')">{cfn:getmessage(202)}</a></span></div><div style="clear: both;" ></div>';content=content+'<div id="showcc_'+designId+'" style="display: none;" class="row marginT10"><div class="coloum70 floatL" ><span class="boldTxt">{cfn:getmessage(32)}:</span></div><div class="coloum floatL" style="width:89%;float:left;"><input autocomplete="off" type="text" name="cc_'+designId+'" id="cc_'+designId+'" value="" onKeyUp="javascript:keymovement(event,this.value,\''+designId+'\',2);" style="width: 99%; height: 30px;"><input type="hidden" name="searchcc_'+designId+'" id="searchcc_'+designId+'" value="" ></div><div style="clear: both;" ></div><div id="livesearchcc_'+designId+'" class="livesearch" style="position:static;margin-left:74px;"></div></div></div>';content=content+'<div id="showbcc_'+designId+'" class="row marginT10"><div class="coloum70 floatL" ><span class="boldTxt">{cfn:getmessage(33)}:</span></div><div class="coloum floatL" style="width:89%;float:left;"><input autocomplete="off" type="text" name="bcc_'+designId+'" id="bcc_'+designId+'" value="'+bcc+'" onKeyUp="javascript:keymovement(event,this.value,\''+designId+'\',3);" style="width: 99%; height: 30px;"><input type="hidden" name="searchbcc_'+designId+'" id="searchbcc_'+designId+'" value="" ></div><div style="clear: both;" ></div><div id="livesearchbcc_'+designId+'" class="livesearch" style=position:static;margin-left:74px;"></div></div></div>';content=content+'<div class="row marginT10" id="cc_only_'+designId+'"><div class="coloum70 floatL" ></div><span id="spancc_'+designId+'" class="commonLink"><a href="javascript:showccfun2(\''+designId+'\')">{cfn:getmessage(201)}</a></span></div><div class="row marginT10" id="bcc_only_'+designId+'" style="display: none;"><div class="coloum70 floatL" ></div><span id="spanbcc_'+designId+'" class="commonLink"><a href="javascript:showbccfun2(\''+designId+'\')">{cfn:getmessage(202)}</a></span></div><div style="clear: both;" ></div>'}else{content=content+'<div id="showcc_'+designId+'"><div class="coloum70 floatL" ><span class="boldTxt">{cfn:getmessage(32)}:</span></div><div class="coloum floatL" style="width:89%;float:left;"><input autocomplete="off" type="text" name="cc_'+designId+'" id="cc_'+designId+'" value="'+cc+'" onKeyUp="javascript:keymovement(event,this.value,\''+designId+'\',2);" style="width: 99%; height: 30px;"><input type="hidden" name="searchcc_'+designId+'" id="searchcc_'+designId+'" value="" ></div><div style="clear: both;" ></div><div id="livesearchcc_'+designId+'" class="livesearch" style="position:static;margin-left:74px;"></div></div></div>';content=content+'<div id="showbcc_'+designId+'"><div class="coloum70 floatL" ><span class="boldTxt">{cfn:getmessage(33)}:</span></div><div class="coloum floatL" style="width:89%;float:left;"><input autocomplete="off" type="text" name="bcc_'+designId+'" id="bcc_'+designId+'" value="'+bcc+'" onKeyUp="javascript:keymovement(event,this.value,\''+designId+'\',3);" style="width: 99%; height: 30px;"><input type="hidden" name="searchbcc_'+designId+'" id="searchbcc_'+designId+'" value="" ></div><div style="clear: both;" ></div><div id="livesearchbcc_'+designId+'" class="livesearch" style="position:static;margin-left:74px;"></div></div></div>'}content=content+'<span  class="attachLink"><a href="javascript:addfilefield(\''+designId+'\')"><div id="attachlink_'+designId+'"><span><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner attach-a"></span><span class="boldTxt">{cfn:getmessage(35)}</span></div></a></span><input type="hidden" value="" id="attachcount_'+designId+'" name="attachcount_'+designId+'"><div style="clear: both;"></div><div class="attachwrap"><div id="filedivcontainer_'+designId+'_0"  class="attachBox"></div></div><div style="clear: both;"></div><div id="additionalattach_'+designId+'" class="attachLink" style="display: none"><a href="javascript:addfilefield(\''+designId+'\')"><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner attach-a">{cfn:getmessage(60)} </a></div><div style="clear: both;"></div>';content=content+'<div class="row marginT10" style=" width:100%;"><div onkeyup="autoSave(\''+designId+'\')" class="nicedit_div"><textarea  name="mailBody_'+designId+'" class="nicedit_textarea" id="mailBody_'+designId+'"><br /><br />'+replymsg+'<blockquote  style="border-left: 1px solid rgb(204, 204, 204); margin: 0px 12px 12px 5px; padding-left: 1ex;">'+xx[6]+"</blockquote></textarea></div></div>";content=content+'<div id="sendFooter2_0" class="row marginT10" ><span class="sendBtn"><a href="javascript:mailFurther(1,'+mailid+",'"+designId+'\')">{cfn:getmessage(37)}</a></span><span class="commonBtn commonBtngc floatL">\t<a class="position_tooltip"  href="javascript:mailFurther(2,'+mailid+",'"+designId+'\')" title="{cfn:getmessage(36)}"><i class="fa fa-file-text"></i></a>\t</span>\t<span class="commonBtn commonBtngc floatL"><a class="position_tooltip"  href="javascript:mailFurther(3,'+mailid+",'"+designId+"')\" title='{cfn:getmessage(59)}'><i class=\"fa fa-trash\"></i></a>\t</span></div>";content=content+'<input type="hidden" id="draftid_'+designId+'" value="'+draftid+'">';content=content+"</div>";document.getElementById("reply_"+designId).innerHTML=content;
//(new nicEditor({fullPanel:true})).panelInstance("mailBody_"+designId);
CKEDITOR.replace("mailBody_"+designId);
var editorid="mailBody_"+designId;
//
if(signature<2)
{
	if(signature==0)
	{
		var sign="{noescape:$signature}";
		sign=replymsg+xx[6]+"<br><br>"+sign;
		//nicEditors.findEditor("mailBody_"+designId).setContent(sign)
	    
		var editor=CKEDITOR.instances[editorid];
		editor.setData(sign);
		
	} 
	 else
	 { 
		 var textId="mailBody_"+designId;
		 getNewSignature(textId,xx[6],1,replymsg)
		 }
	}
	if(document.getElementById("nic_edit_nesote_webmail"))
	{
		document.getElementById("nic_edit_nesote_webmail").focus();
		}
	}
	};

function forward(mailid,flderName,pageNo,name,draftid,designId)
{
var hash=window.location.hash;
var hashing=hash.split("/");
var decode_hash=decode64(hashing[1]);
var decode_object=decode_hash.split("/");
reply_mail_id=reply_mail_id+designId+",";
var design=designId.split("_");

if((name.substring(0,6)=="search")||(name.substring(0,4)=="from")||(name.substring(0,7)=="starred"))
{
var namez=decode_object[1];
var flderName=this[namez];
}
else
{
var namez=name+"_"+design[0];
var flderName=this[namez];
}


var p=0;while(p<1E5)p=p+1;
drafTcount=0;var url_mail="{url:(mail/createdraft)}";
if(document.getElementById("reply_"+designId).style.display=="none")
document.getElementById("reply_"+designId).style.display="";
if((name.substring(0,6)=="search")||(name.substring(0,4)=="from"))
var nameF=this[namez];
else
var nameF=this[name+"_"+design[0]];
var content='<div class="row"   id=replyfooter2_'+designId+' style="padding-top:5px;display:none"><div class="replyLink commonBtngc floatL"><span><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner reply-r"></span><a href="javascript:createDraft('+mailid+",'"+nameF+"',"+pageNo+",'"+name+"',1,'"+designId+"','"+url_mail+'\')">{cfn:getmessage(15)}</a></div><div class="replyLink commonBtngc floatL"><span><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner reply-a"></span><a href="javascript:createDraft('+mailid+",'"+nameF+"',"+pageNo+",'"+name+"',2,'"+designId+"','"+url_mail+'\')">{cfn:getmessage(16)}</a></div><div class="replyLink commonBtngc floatL"><span><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner reply-f"></span><a href="javascript:createDraft('+mailid+",'"+nameF+"',"+pageNo+",'"+name+"',3,'"+designId+",'"+url_mail+'\'\')">{cfn:getmessage(17)}</a></div></div><div style="clear:both"></div>';document.getElementById("replyfooter1_"+designId).style.display="none";var aaa=flderName.isItemAvailable(namez,mailid);if(xx=flderName.getResultItembyIndex(namez,aaa)){
var repfrom=new Array();repfrom[0]="";repfrom[1]="";
if(xx[1].indexOf("<")>=0)
{
repfrom=xx[1].split("<");
}
if(repfrom[1]!="")
repfrom[1]=repfrom[1].replace(">","");
else 
repfrom[1]=xx[1];

var repto=new Array();var tolist="";
if(xx[2]!="")
{
  if(xx[2].substring(xx[2].length-1,xx[2].length)==",")
  var newx2=xx[2].substring(0,xx[2].length-1);
  else
  var newx2=xx[2];
  var x2=newx2.split(",");
  for(var i=0;i<x2.length;i++)
  {
  repto[0]="";repto[1]="";
  if(x2[i].indexOf("<")>=0)
  {
  repto=x2[i].split("<");
  }
  if(repto[1]!="")
  repto[1]=repto[1].replace(">","");
  else 
  repto[1]=x2[i];
  
  tolist+=" <span><b>"+repto[0]+"</b> < "+repto[1]+"></span>,";
  }
  if(tolist.substring(tolist.length-1,tolist.length)==",")
  tolist=tolist.substring(0,tolist.length-1);
}
//alert(tolist);
var repcc=new Array();
var cclist="";
if(xx[3]!="")
{
  if(xx[3].substring(xx[3].length-1,xx[3].length)==",")
  var newx3=xx[3].substring(0,xx[3].length-1);
  else
  var newx3=xx[3];
  var x3=newx3.split(",");
  for(var i=0;i<x3.length;i++)
  {
  repcc[0]="";repcc[1]="";
  if(x3[i].indexOf("<")>=0)
  {
  repcc=x3[i].split("<");
  }
  if(repcc[1]!="")
  repcc[1]=repcc[1].replace(">","");
  else 
  repcc[1]=x3[i];
  
  cclist+=" <span><b>"+repcc[0]+"</b> < "+repcc[1]+"></span>,";
  }
  if(cclist.substring(cclist.length-1,cclist.length)==",")
  cclist=cclist.substring(0,cclist.length-1);
}

var fwdmsg="<div style=\"font:small arial;\">---------- Forwarded message ----------<br>From: <span><b>"+repfrom[0]+"</b> < "+repfrom[1]+"></span><br>Date: "+xx[18]+"<br>Subject: "+xx[5]+"<br>To:"+tolist;if(xx[3]!="")fwdmsg=fwdmsg+"<br>Cc:"+cclist;fwdmsg=fwdmsg+"<br /><br /><br /></div>";

var subject="{$forward_pre}:"+xx[5];content=content+'<div id="sendFooter2_0" class="row marginT10" ><span class="sendBtn"><a href="javascript:mailFurther(1,'+mailid+",'"+designId+'\')">{cfn:getmessage(37)}</a></span><span class="commonBtn commonBtngc floatL">\t<a class="position_tooltip"   href="javascript:mailFurther(2,'+mailid+",'"+designId+'\')" title="{cfn:getmessage(36)}"><i class="fa fa-file-text"></i></a>\t</span>\t<span class="commonBtn commonBtngc floatL"><a class="position_tooltip"  href="javascript:mailFurther(3,'+mailid+",'"+designId+"')\" title=\"{cfn:getmessage(59)}\"><i class=\"fa fa-trash\"></i></a></span></div>";content=content+'<div class="row marginT10" ><div class="row"><div class="coloum70 floatL"><span class="boldTxt">{cfn:getmessage(31)}:</span></div><div class="coloum floatL" style="width:89%;float:left;"><input autocomplete="off" type="text" name="to_'+designId+'" id="to_'+designId+'" value=""\tonKeyUp="javascript:keymovement(event,this.value,\''+designId+'\',1);" style="width: 99%; height: 30px;position:relative;"><input type="hidden" name="search_'+designId+'" id="search_'+designId+'" value="" ></div><div style="clear: both;" ></div><div id="livesearch_'+designId+'" class="livesearch" style="position:static;margin-left:74px;"></div></div></div>';content=content+'<div class="row marginT10"><div class="coloum70 floatL" ><span class="boldTxt">{cfn:getmessage(34)}:</span></div><div class="coloum floatL" style="width:89%;"><input type="text" name="subject_'+designId+'" id="subject_'+designId+'" value="'+subject+'" style="width: 99%; height: 30px;"></div></div><div style="clear: both;" ></div>';content=content+'<div class="row marginT10" id="cc_bcc_'+designId+'"><span id="spancc_'+designId+'" class="commonLink"><a href="javascript:showccfun(\''+designId+'\')" >{cfn:getmessage(201)}</a></span><span\tclass="normalTxt floatL">|</span><span id="spanbcc_'+designId+'" class="commonLink"><a href="javascript:showbccfun(\''+designId+'\')">{cfn:getmessage(202)}</a></span></div><div style="clear: both;" ></div>';
content=content+'<div id="showcc_'+designId+'" style="display: none;" class="row marginT10"><div class="coloum70 floatL" ><span class="boldTxt">{cfn:getmessage(32)}:</span></div><div class="coloum floatL" style="width:89%;float:left;"><input autocomplete="off" type="text" name="cc_'+designId+'" id="cc_'+designId+'" value=""\tonKeyUp="javascript:keymovement(event,this.value,\''+designId+'\',2);" style="width: 99%; height: 30px;position:relative;"><input type="hidden" name="searchcc_'+designId+'" id="searchcc_'+designId+'" value="" ></div><div style="clear: both;" ></div><div id="livesearchcc_'+designId+'" class="livesearch" style="position:static;margin-left:74px;"></div></div>';content=content+'<div id="showbcc_'+designId+'" style="display: none;" class="row marginT10"><div class="coloum70 floatL" ><span class="boldTxt">{cfn:getmessage(33)}:</span></div><div class="coloum floatL" style="width:89%;float:left;"><input autocomplete="off" type="text" name="bcc_'+designId+'" id="bcc_'+designId+'" value=""\tonKeyUp="javascript:keymovement(event,this.value,\''+designId+'\',3);" style="width: 99%; height: 30px;position:relative;"><input type="hidden" name="searchbcc_'+designId+'" id="searchbcc_'+designId+'" value="" ></div><div style="clear: both;" ></div><div id="livesearchbcc_'+designId+'" class="livesearch" style="position:static;margin-left:74px;"></div></div>';content=content+'<div class="row marginT10" id="cc_only_'+designId+'" style="display: none;"><div class="coloum70 floatL" ></div><span id="spancc_'+designId+'" class="commonLink"><a href="javascript:showccfun2(\''+designId+'\')">{cfn:getmessage(201)}</a></span></div><div class="row marginT10" id="bcc_only_'+designId+'" style="display: none;"><div class="coloum70 floatL" ></div><span id="spanbcc_'+designId+'" class="commonLink"><a href="javascript:showbccfun2(\''+designId+'\')">{cfn:getmessage(202)}</a></span></div><div style="clear: both;" ></div>';content=content+'<span  class="attachLink"><a href="javascript:addfilefield(\''+designId+'\')"><div id="attachlink_'+designId+'"><span><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner attach-a"></span><span class="boldTxt">{cfn:getmessage(35)}</span></div></a></span><input type="hidden" value="" id="attachcount_'+designId+'" name="attachcount_'+designId+'"><div style="clear: both;"></div><div class="attachwrap"><div id="filedivcontainer_'+designId+'_0"  class="attachBox"></div></div><div style="clear: both;"></div><div id="additionalattach_'+designId+'" class="attachLink" style="display: none"><a href="javascript:addfilefield(\''+designId+'\')"><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner attach-a">{cfn:getmessage(60)} </a></div><div style="clear: both;"></div>';content=content+'<div class="row marginT10" style=" width:100%;"><div onkeyup="autoSave(\''+designId+'\')" class="nicedit_div"><textarea  name="mailBody_'+designId+'" class="nicedit_textarea" id="mailBody_'+designId+'"><br /><br />'+fwdmsg+xx[6]+"</textarea></div></div>";content=content+'<div id="sendFooter2_0" class="row marginT10" ><span class="sendBtn"><a href="javascript:mailFurther(1,'+mailid+",'"+designId+'\')">{cfn:getmessage(37)}</a></span><span class="commonBtn commonBtngc floatL">\t<a class="position_tooltip"  href="javascript:mailFurther(2,'+mailid+",'"+designId+'\')" title="{cfn:getmessage(36)}"><i class="fa fa-file-text"></i></a>\t</span>\t<span class="commonBtn commonBtngc floatL"><a class="position_tooltip"  href="javascript:mailFurther(3,'+mailid+",'"+designId+"')\" title='{cfn:getmessage(59)}'><i class=\"fa fa-trash\"></i></a>\t</span></div>";content=content+'<input type="hidden" id="draftid_'+designId+'" value="'+draftid+'">';content=content+"</div>";document.getElementById("reply_"+designId).innerHTML=content;
//(new nicEditor({fullPanel:true})).panelInstance("mailBody_"+designId);
//CKEditor
   CKEDITOR.replace("mailBody_"+designId);
   var editorid="mailBody_"+designId;
   


//
if(signature<2){
	if(signature==0){
		var sign="{noescape:$signature}";
		sign=fwdmsg+xx[6]+"<br><br>"+sign;
		//nicEditors.findEditor("mailBody_"+designId).setContent(sign)
	     var editor=CKEDITOR.instances[editorid];
		editor.setData(sign);
	}
	else{
		var textId="mailBody_"+designId;
		getNewSignature(textId,xx[6],0,fwdmsg)
		}
	}
	document.getElementById("to_"+designId).focus();
	getAttachmentlist(mailid,flderName,designId)
	}
	};
function getAttachmentlist(mailid,flderName,designId){var flderName=getCookievalue("folder");var draftid=document.getElementById("draftid_"+designId).value;var currentTime=new Date;var crntime=currentTime.getTime();$.ajax({type:"GET",cache:false,url:"{url:(mail/getattachlist)}/"+flderName+"/"+mailid+"/"+draftid+"/"+crntime,success:function(data){var x=data;var azq=new Array(2);azq=x.split("{nesote_:}");if(azq[0]!=0){var tot_height=30*azq[0];filestringz='<iframe id="upload_forward_'+designId+'" name="upload_forward_'+designId+'" src="{url:(mail/upload_forward)}/'+draftid+"/"+designId+'/0"  style="width:100%;height:'+tot_height+'px;border:0px solid #fff;" scrolling="no"></iframe>';var filevartemp=azq[0]-1;filevar=azq[0];document.getElementById("filedivcontainer_"+designId+"_0").innerHTML=filestringz;document.getElementById("attachlink_"+designId).style.display="none";document.getElementById("additionalattach_"+designId).style.display=""}}})};
var filevar_m=0;
var deletevar_m=0;

function addcustomfolder(){
document.getElementById("addf").value=1;
var rrt1="{cfn:getmessage(455)}";
filevar_m=filevar_m+1;
filevartemp=filevar_m-1;
document.getElementById("execute1").value=2;
filestring='<span id="tablefiledivcontainer'+filevar_m+'" style="padding-left:0px;" class="newFolder"><input type="text" name="newcustomFolder'+filevar_m+'" id="newcustomFolder'+filevar_m+'" value="New Folder'+'"  onKeyUp="addgroupfn(event,this.value)"  onblur="blurfn()"   maxlength="12" size="15"></span>';
document.getElementById("custom_divcontainer"+filevartemp).innerHTML=filestring;
var FID1="custom_divcontainer"+filevar_m;
var newdiv=document.createElement("div");
newdiv.setAttribute("id",FID1);
document.getElementById("div_custm").appendChild(newdiv);
var s1="newcustomFolder"+filevar_m;
document.getElementById(s1).focus();
document.getElementById("attachcount").value=filevar_m;
};

//This is called when custom folder is created.
function addgroupfn(evt,value,id)
{

var executevalue=document.getElementById("execute1").value;
var charcode= (evt.which) ? evt.which : event.keyCode;
          if(charcode==13)
          {
            if(executevalue==1)
            {
                         
               var url1="{url:(layout/editfolder/)}"+id+"/"+value;
              
            }
            else
            {
                 var url1="{url:(layout/addfolder/)}"+value;
            }
$.ajax({

type: "GET",cache: false,
url: url1,

success: function(data) {folderCreated=1;
                var t=data;
                var q=t.split("/");
                  q[0]=q[0].replace(/^[\s]+/,'').replace(/[\s]+$/,'').replace(/[\s]{2,}/,' ');//for trimming 
               if(q[0]==0)
               {
               // document.getElementById("messages").style.display="";
               //document.getElementById("message_mail").innerHTML=q[1];
               
               //setTimeout("hidemailmessage()",5000);
               notify_display(q[1],"info");  
               //toastr.info(q[1]);
               }
               else
               {
                if(executevalue==2)
                {
                      var FID="customFLI"+q[0];
                      var cid=q[0];
                  
                      var container = document.getElementById('leftMenu');
                      var new_element = document.createElement('li');
                      new_element.setAttribute('id', FID);
                       
                       
                       var newFolderid="custom"+q[0];
                       SetCookie(newFolderid,0,1);
                       
                          
              
                  
                      var contentDiv="<div style=\"clear:both\"></div><div id=\""+cid+"\" style=\"width:100%; height:26px;\"><a href=\"#custom"+cid+"\" onclick=\"javascript:mainWindow('"+newFolderid+"',1,"+mailsPerpage+",0,2)\" onMouseOver=\"showeditImage("+cid+")\" onMouseOut=\"hideeditImage("+cid+")\" >	<span   class=\"abc\" id=\"custom"+cid+"_name\"><i class=\"fa fa-folder\"></i>"+value+"<span id=\"custom"+cid+"_count\"> </span></span>";
                      
                      contentDiv=contentDiv+"<span  style=\"display:none;\"  id=\"editimage"+cid+"\" onClick=\"editfolderfn("+cid+")\" class=\"editBtn\"><img     src=\"images/filler.gif\" alt=\" \"  class=\"iconsCornner arrow-d\" title=\"{cfn:getmessage(26)}\" border=\"0\" align=\"absmiddle\"> </span> </a> </div>";
                      
                      contentDiv=contentDiv+"<div id=\"edit"+cid+"\"  style=\"display: none;float:left;padding-left:25px;padding-right:0px;width:100%; height:26px;\"><input    type=\"text\" id=\"editgroupname"+cid+"\"  name=\"editgroupname"+cid+"\"   value=\""+value+"\"  onKeyUp=\"addgroupfn(event,this.value,"+cid+")\" onBlur=\"blurfn1("+cid+")\"  size=\"15\" align=\"absmiddle\" style=\"height:26px;\"></div> ";
                       
                      
                      new_element.innerHTML = contentDiv;
                      var pos1=parseInt(m_cpcount)+parseInt(6);
                      container.appendChild(new_element);
                      m_cpcount++;
                      notify_display(q[2],"info");
                      //toastr.info(q[2]);  

                      //document.getElementById("messages").style.display="";
               //document.getElementById("message_mail").innerHTML=q[2];
             // blurfn();
              //setTimeout("hidemailmessage()",5000);
              mainWindow(cid,1,mailsPerpage,0,2);
              }
                  
               
                else
                 {
           
                  document.getElementById('custom'+id+'_name').innerHTML="<i class='fa fa-folder'></i>"+value;
                  document.getElementById('heading').innerHTML=value;
                     var t='edit'+id;

// document.getElementById("messages").style.display="";
  //             document.getElementById("message_mail").innerHTML=q[2];
    //           setTimeout("hidemailmessage()",5000);
    //toastr.info(q[2]);
notify_display(q[2],"info");
 document.getElementById(t).style.display="none"; document.getElementById('customFLI'+id).style.display="";
             // blurfn1(id);
                 }
              }
              }
              
           
      });
          }
  }

function getnoOfmails(a){$.ajax({type:"GET",cache:!1,url:"{url:(mail/noofmails/)}"+a,success:function(a){document.getElementById("crntfolderMailcount").value=a}})};
function getfolderNameajax(nam)
{
 var id=nam.replace("custom","");
  var currentTime=new Date();
  var crntime=currentTime.getTime();
  $.ajax({

type: "GET",cache: false,
url: "{url:(mail/getfoldername)}/"+id+"/"+crntime,

success: function(data) {
              var x=data;
              if(x!="")
              document.getElementById('heading').innerHTML='<i class="fa fa-folder"></i> '+x;
          }
      });
}
function deletecustomFolder()
{if(filevar!=0)
var c="newcustomFolder"+filevar_m,d=document.getElementById(c).value;
if(d=="{cfn:getmessage(455)}"&&filevar_m!=0)document.getElementById(c).style.display="none";
else{var a=getCookievalue("folder"),a=a.replace("custom","");
if(a>=10){var e=this["custom"+a];
confirm("{cfn:getmessage(197)} ")&&$.ajax({type:"GET",cache:!1,url:"{url:(layout/deletefolder/)}"+a,
success:function(b)
{var n=b.split("/");
e.truncate();
b=document.getElementById("customFLI"+a);
b.parentNode.removeChild(b);
m_cpcount--;SetCookie("folder","inbox",1);
//document.getElementById("messages").style.display="";
//document.getElementById("message_mail").innerHTML=n[1];		 
var msg_fldr_status="{cfn:getmessage(222)}";
//toastr.info(msg_fldr_status);
notify_display(msg_fldr_status,"info");
setTimeout("hideconatctmessage()",5000);
window.location.hash="#inbox";mainMenu(1);
mainWindow("inbox",1,mailsPerpage,totalInbox,2)}})}}};

var searchtext0 = new Array();
var counter0 = new Array();
var old_char_count0 = new Array();
var total_result_count0 = new Array();
var p = "0";
for (var l = 0; l <= p; l++) {
  searchtext0[l] = "";
  counter0[l] = 0;
  old_char_count0[l] = 0;
  total_result_count0[l] = 10;
}

function keymovement(evt, textval, no, target) {
  if (target == 1) {
      var target = "livesearch_";
      var target1 = "";
      var target2 = "livesearch_a_";
      var target3 = "livesearch_h_";
      var target4 = "to_";
      var target5 = "livesearch_";
      var search1 = "search_";
  } else if (target == 2) {
      var target = "livesearch_cc_";
      var target1 = "cc";
      var target2 = "livesearchcc_a_";
      var target3 = "livesearchcc_h_";
      var target4 = "cc_";
      var target5 = "livesearchcc_";
      var search1 = "searchcc_";
  } else {
      var target = "livesearch_bcc_";
      var target1 = "bcc";
      var target2 = "livesearchbcc_a_";
      var target3 = "livesearchbcc_h_";
      var target4 = "bcc_";
      var target5 = "livesearchbcc_";
      var search1 = "searchbcc_";
  }
  if (document.getElementById('total_' + no)) {
      var o = document.getElementById('total_' + no).value;
  } else var o = 0;
  total_result_count0[no] = o;
  var charCode = (evt.which) ? evt.which : event.keyCode
  if (charCode == 40) {
      document.getElementById(target + no).style.display = "";
      document.getElementById(target + no).style.border = "1px solid #A5ACB2";
      document.getElementById(target + no).style.padding = "0px";
      counter0 = counter0 + 1;
      if (!document.getElementById(target2 + no + '_' + counter0)) {
          counter0 = 0;
      }
      for (i = 0; i < total_result_count0[no]; i++) {
          if (document.getElementById(target2 + no + '_' + i)) {
              document.getElementById(target2 + no + '_' + i).style.background = "#fff";
          }
      }
      if (document.getElementById(target2 + no + '_' + counter0)) {
          document.getElementById(target2 + no + '_' + counter0).style.background = "#ccc";
          document.getElementById(search1 + no).value = document.getElementById(target3 + no + '_' + counter0).value;
      } else {
          document.getElementById(search1 + no).value = searchtext0[no];
      }
  } else if (charCode == 38) {
      document.getElementById(target + no).style.display = "";
      document.getElementById(target + no).style.border = "1px solid #A5ACB2";
      document.getElementById(target + no).style.padding = "0px";
      counter0 = counter0 - 1;
      if (!document.getElementById(target2 + no + '_' + counter0) && counter0 != 0) {
          for (i = total_result_count0[no]; i >= 0; i--) {
              if (document.getElementById(target2 + no + '_' + i)) {
                  counter0 = i;
                  break;
              }
          }
      }
      for (i = 1; i < total_result_count0[no]; i++) {
          if (document.getElementById(target2 + no + '_' + i)) {
              document.getElementById(target2 + no + '_' + i).style.background = "#fff";
          }
      }
      if (document.getElementById(target2 + no + '_' + counter0)) {
          document.getElementById(target2 + no + '_' + counter0).style.background = "#ccc";
          document.getElementById(search1 + no).value = document.getElementById(target2 + no + '_' + counter0).value;
      } else {
          document.getElementById(search1 + no).value = searchtext0[no];
      }

  } else if (charCode == 37 || charCode == 39 || charCode == 17 || charCode == 18) {

  } else if (charCode == 27) {
      document.getElementById(target + no).style.display = "none";
      document.getElementById(target + no).style.border = "0px";
      document.getElementById(target + no).style.padding = "0px";
      document.getElementById(target + no).value = searchtext0[no];

  } else if (charCode == 13) {


      document.getElementById(target4 + no).value = document.getElementById('result_' + no + '_' + counter0).value + ",";
      document.getElementById(target4 + no).focus();
      document.getElementById(target + no).style.display = "none";

  } else {


      searchtext0[no] = document.getElementById(search1 + no).value;

      showResult(textval, no, target, target1, target5);


  }


}

function mainWindowChat(b,c,e,d,f){

	//Resetting the file field values to prevent issues 
	reset_filefield();
	var c_theme=getCookievalue("Current_Theme");
	if(c_theme!="100")
		{
	//Themes Based Modifications for Transparency Effect
	document.getElementById("second_scroll").style.background="";
	document.getElementById("footer_txt_id").style.color="#FFFFFF";
	//End
		}
	
	var current_view=getCookievalue("current_view");
	if(current_view=="3pane")
		{
	    document.getElementById("footer_table").style.display="none";
		  document.getElementById("msg_display").innerHTML="<div class=\"warning_message_Txt\">{cfn:getmessage(776)}</div><div class=\"warning_message_Txt_sec\">{cfn:getmessage(777)}</div></div><div id='footer_txt_id1' class='footer_txt_new'>{$footer}{if($memoryusage_publicview_area==1)}<br><br>{$memorymsg}{endif}</div></div>";
		}
	var a=reply_mail_id="",a=getCookievalue("folder");
	a.substring(0,6)=="custom"&&(a=a.substring(6));
    document.getElementById("backchat_tootltip").title="";
   
	if(document.getElementById("backchatbtnid").style.display=="")
		{document.getElementById("backchatbtnid").style.display="none";}
	if(right_ads_status!=0)//Check Global Ad display Status.
	{
		if(document.getElementById("rightads_td").style.display=="")
	
		{
		document.getElementById("mailPageOuterid").style.right="0px";   
		}
	}
	if(!isNaN(a))document.getElementById("customFLI"+a).style.backgroundColor="",document.getElementById("customFLI"+a).style.fontWeight="";
	if("{$chat_enable}"==1){
		disableReplylinks();
		disableReplylinksChat();
		document.getElementById("leftmenu_inbox").className="leftunSelected";
		document.getElementById("leftmenu_starred").className="leftunSelected";
		document.getElementById("leftmenu_chats").className="leftSelected";
		document.getElementById("leftmenu_draft").className="leftunSelected";
		document.getElementById("leftmenu_sent").className="leftunSelected";
		document.getElementById("leftmenu_spam").className="leftunSelected";
		document.getElementById("leftmenu_trash").className="leftunSelected";
		if(document.getElementById("moreListChat2").style.display=="")document.getElementById("moreListChat2").style.display="none";
		document.getElementById("mail_subheader").style.display="none";
		document.getElementById("chat_subheader").style.display="";
		d=totalchat;
		idString=":";
		idz="";
		pair1="";
		document.getElementById("newMail").style.display="none";
		if(current_view=="2pane")
			{
		document.getElementById("mailContent").style.display="";
		document.getElementById("mailContent11").style.display="none";
		document.getElementById("mailContent").innerHTML="";
			}
		else
			{
			document.getElementById("splitdiv1").style.display="";
			document.getElementById("mailContent11").style.display="";
			document.getElementById("mailContent11").innerHTML="";
			document.getElementById("mailContent").style.display="none";
				
			}
		SetCookie("folder",b,1);
		SetCookie("chat_page",c,1);
		totl=d;
		fetchPageChat(b,c,e,f)}else mainWindow(b,c,e,d,f)};
function fetchPageChat(b,d,e,f)
{//alert("Fetch Page");

var a=Array(16);
a[0]="id";
a[1]="chatid";
a[2]="receiver";a[3]="message";
a[4]="time";
a[5]="readflag";
a[6]="responders";
a[7]="name";
a[8]="msg";
a[9]="firstsender";
a[10]="subject1";
a[11]="fromall";
a[12]="subject2";
a[13]="fromdtls";
a[14]="todtls";
a[15]="toreply";
a[16]="stripmsg";

//PAne View
var current_view=getCookievalue("current_view");
//

totalchat=getCookievalue("chats");
if(chat_refresh_flag==1)
{
fetchPageAjaxChat(this[b],d,e,a,totalchat,f,b)
}

if(isArrayAvailable(b)==1)
if(this[b].isPageAvailable(b,d,e)==1)
{a=totalchat;f=Math.floor(a/e);a%e!=0&&(f+=1);
for(var m=this[b].getResultPage(b,d,e),a='<div id="additionalMail_1" style="display: none;";></div>',ss='<div id="additionalMail_1" style="display: none;";></div>',
g=0;xx=this[b].fetchRow(m);)
{var c=xx[0],j=xx[3],n=xx[2];
var hash_id=encode64(c);var encr="",encr1="";
if(xx[5]==1)
{
	var i="readmail",k="readContent",l="twopaneMailRead"; zc="threepaneMailRead";
}
else 
{
	i="unreadmail",k="unreadContent",l="twopaneMailUnRead"; zc="threepaneMailUnRead";
}
var h=xx[16],h=h.replace(/e0d71f32e332df0bf09e2f879dd14d77/g,"&nbsp;"),o=xx[4];
a=a+'<div class="'+l+'" id="twopaneMail_'+c+'" onMouseOver="mouseoverMail('+c+",'"+b+"','"+b+"','"+b+'\')" onMouseOut="mouseoutMail('+c+",'"+b+"','"+b+"','"+b+'\')"><div id="shortDiv_mail_'+c+'" class=\"mail-list-in\"><table class=\"mail-list-tbl\" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout:fixed;border-collapse: collapse;height:40px;vertical-align:middle;"><tr ><td width="24px" style=""><input type="checkbox" class="mailCheckBox"  id="cbt_'+c+'" onClick="clickCheckboxChat('+c+",'"+b+"',chats,"+d+',0)"></td><td width="22px" style=""><div class="star" id="star_'+c+'"  ><i class="fa fa-comments-o"></i></div></td><td width="20%"  style="text-overflow:ellipsis;overflow:hidden;white-space:nowrap;line-height:25px;vertical-align:middle;padding-left:5px;cursor: pointer;padding-right:15px;" onClick="clickonDivChat(chats,'+c+","+g+",0,50,"+c+","+d+',0)" >',a=a+"<span class="+i+' id="fromaddress_span'+c+'" ><a href="#'+b+"/"+hash_id+'" >'+n+"</a></span>",a=a+'</td><td style="text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:50%;cursor: pointer;padding-left:10px;" onClick="clickonDivChat(chats,'+c+","+g+",0,50,"+c+","+d+',0)">',a=a+'<span  class="mail_sub_cont"><span  id="mailsubject_span'+c+'" ',a=a+' class="'+i+'" ><a href="#'+b+"/"+hash_id+'" >'+j+"</a>",a=a+' </span><span id="mailcontent_span'+c+'" class="'+k+'" style=""><a href="#'+b+"/"+hash_id+'" >';
h!=""&&j!=""&&(a+="&nbsp;-&nbsp; ");
a=a+""+h+"</a></span></span></td>";
a=a+'<td onClick="clickonDivChat(chats,'+c+","+g+",0,50,"+c+","+d+',0)" style="cursor: pointer;"><span class="fromDate_short"><a href="#'+b+"/"+hash_id+'" >'+o+"</a></span></td></table></div></div>";

//Three  Pane

ss=ss+'<div  onClick="clickonDivChat(chats,'+c+','+g+',0,50,'+c+','+d+',0)" class="'+zc+'" id="threepaneMail_'+c+'" onMouseOver="mouseoverMail('+c+",'"+b+"','"+b+"','"+b+'\')" onMouseOut="mouseoutMail('+c+",'"+b+"','"+b+"','"+b+'\')"><div id="shortDiv_mail_'+c+'" class=\"mail-list-in\"><table class=\"mail-list-tbl\" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout:fixed;border-collapse: collapse;height:40px;vertical-align:middle;"><tr ><td width="10%" style=""><input type="checkbox" class="mailCheckBox"  id="cbt1_'+c+'" onClick="clickCheckboxChat('+c+",'"+b+"',chats,"+d+',0)"></td><td width="10%" style=""><div class="star" id="star_3pane_'+c+'"  ><i class="fa fa-comments-o"></i></div></td>';
ss=ss+'<td width="50%"  style="text-overflow:ellipsis;overflow:hidden;white-space:nowrap;line-height:25px;vertical-align:middle;padding-left:5px;cursor: pointer;padding-right:15px;" onClick="clickonDivChat(chats,'+c+","+g+",0,50,"+c+","+d+',0)" >';
ss=ss+'<span class='+i+' id="fromaddress_span'+c+'" ><a href="#'+b+'/'+hash_id+'">'+n+'</a></span>';
ss=ss+'</td><td width="20%" onClick="clickonDivChat(chats,'+c+','+g+',0,50,'+c+','+d+',0)" style="cursor: pointer;"><span class="fromDate_short"><a href="#'+b+'/'+hash_id+'" >'+o+'</a></span></td>';
ss=ss+='</tr><tr><td colspan="4" style="text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:50%;cursor: pointer;padding-left:10px;" onClick="clickonDivChat(chats,'+c+","+g+",0,50,"+c+","+d+',0)">';
ss=ss+'<span  class="mail_sub_cont"><span  id="mailsubject_span'+c+'" class="'+i+'" ><a href="#'+b+"/"+hash_id+'" >'+j+"</a>";
ss=ss+' </span></td></tr><tr><td style="text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:50%;cursor: pointer;padding-left:10px;" colspan="4"><span id="mailcontent_span'+c+'" class="'+k+'" onClick="clickonDivChat(chats,'+c+","+g+",0,50,"+c+","+d+',0)" style=""><a href="#'+b+"/"+hash_id+'" >';
h!=""&&j!=""&&(ss+="&nbsp;-&nbsp; ");
ss=ss+""+h+"</a></span></span></td></tr>";
ss=ss+'</table></div></div>';

//End Three Pane




g+=1



}
if(current_view=="2pane")
	{
f>1&&(d==1?(d="{cfn:getmessage(432)}",encr=encode64("p"+f),encr1=encode64("p2"),a=a+'<div class="pageingDiv sddm"><a class="last_bvtn cntrl_btn" href="#'+b+"/"+encr+'" onClick="javascript:mainWindowChat(\''+b+"',"+f+","+e+","+totl+',3)"><span>{cfn:getmessage(431)}</span></a><a class="last_bvtn cntrl_btn" href="#'+b+"/"+encr1+'" onClick="javascript:mainWindowChat(\''+b+"',2,"+e+","+totl+',2)"><span>{cfn:getmessage(433)}</span></a></div>'):d==f?(prev=parseInt(f)-1,encr=encode64("p"+prev),encr1=encode64("p1"),a=a+'<div class="pageingDiv sddm"><a class="last_bvtn cntrl_btn" href="#'+b+"/"+encr+'" onClick="javascript:mainWindowChat(\''+b+"',"+prev+","+e+","+totl+',3)"><span>{cfn:getmessage(432)}</span></a><a class="last_bvtn cntrl_btn" href="#'+b+"/"+encr1+'" onClick="javascript:mainWindowChat(\''+b+"',1,"+e+","+totl+","+totl+',2)"><span>{cfn:getmessage(442)}</span></a></div>'):(prev=parseInt(d)-1,next=parseInt(d)+1,encr=encode64("p"+next),encr1=encode64("p"+prev),a=a+'<div class="pageingDiv sddm"><a class="last_bvtn cntrl_btn" href="#'+b+"/"+encr+'" onClick="javascript:mainWindowChat(\''+b+"',"+next+","+e+","+totl+',2)"><span>{cfn:getmessage(433)}</span></a><a class="last_bvtn cntrl_btn" href="#'+b+"/"+encr1+'" onClick="javascript:mainWindowChat(\''+b+"',"+prev+","+e+","+totl+',3)"><span>{cfn:getmessage(432)}</span></a></div>'));a+="";document.getElementById("heading").innerHTML="<i class=\"fa fa-comments\"></i> {cfn:getmessage(429)}";document.getElementById("short_detail").setAttribute("class","short");g==0?(document.getElementById("mailContent").innerHTML='<div class="warningTxt"><i class="fa fa-exclamation-circle"></i> {cfn:getmessage(30)}</div>',document.getElementById("chat_subheader").style.display="none"):
document.getElementById("mailContent").innerHTML=a;
	}
else
	{//alert("3pane");
//3pane
f>1&&(d==1?(d="{cfn:getmessage(432)}",encr=encode64("p"+f),encr1=encode64("p2"),ss=ss+'<div class="pageingDiv sddm"><a class="last_bvtn cntrl_btn" href="#'+b+"/"+encr+'" onClick="javascript:mainWindowChat(\''+b+"',"+f+","+e+","+totl+',3)"><span>{cfn:getmessage(431)}</span></a><a class="last_bvtn cntrl_btn" href="#'+b+"/"+encr1+'" onClick="javascript:mainWindowChat(\''+b+"',2,"+e+","+totl+',2)"><span>{cfn:getmessage(433)}</span></a></div>'):d==f?(prev=parseInt(f)-1,encr=encode64("p"+prev),encr1=encode64("p1"),ss=ss+'<div class="pageingDiv sddm"><a class="last_bvtn cntrl_btn" href="#'+b+"/"+encr+'" onClick="javascript:mainWindowChat(\''+b+"',"+prev+","+e+","+totl+',3)"><span>{cfn:getmessage(432)}</span></a><a class="last_bvtn cntrl_btn" href="#'+b+"/"+encr1+'" onClick="javascript:mainWindowChat(\''+b+"',1,"+e+","+totl+","+totl+',2)"><span>{cfn:getmessage(442)}</span></a></div>'):(prev=parseInt(d)-1,next=parseInt(d)+1,encr=encode64("p"+next),encr1=encode64("p"+prev),ss=ss+'<div class="pageingDiv sddm"><a class="last_bvtn cntrl_btn" href="#'+b+"/"+encr+'" onClick="javascript:mainWindowChat(\''+b+"',"+next+","+e+","+totl+',2)"><span>{cfn:getmessage(433)}</span></a><a class="last_bvtn cntrl_btn" href="#'+b+"/"+encr1+'" onClick="javascript:mainWindowChat(\''+b+"',"+prev+","+e+","+totl+',3)"><span>{cfn:getmessage(432)}</span></a></div>'));ss+="";document.getElementById("heading").innerHTML="<i class=\"fa fa-comments\"></i> {cfn:getmessage(429)}";document.getElementById("short_detail").setAttribute("class","short");g==0?(document.getElementById("mailContent11").innerHTML='<div class="warningTxt"><i class="fa fa-exclamation-circle"></i> {cfn:getmessage(30)}</div>',document.getElementById("chat_subheader").style.display="none"):
document.getElementById("mailContent11").innerHTML=ss;
//End
	}
//document.getElementById("mailContent").innerHTML=a;
//document.getElementById("mailContent11").innerHTML=ss;

document.getElementById("mailContent").style.width="100%";
if(document.getElementById("rightads_td").style.display=="")
{	
	document.getElementById("rightads_td").style.display="none"
	document.getElementById('mailPageOuterid').style.right="0px";
  
}

}
else 
fetchPageAjaxChat(this[b],d,e,a,totalchat,f,b);
else this[b]=new Table(b,a,totl,20),fetchPageAjaxChat(this[b],d,e,a,totalchat,f,b)};

function fetchPageAjaxChat(h,d,e,n,f,l,c)
{//alert("Fetch Page Ajax");
chat_refresh_flag=0;

var current_view=getCookievalue("current_view");


l=(new Date).getTime();
h=this.chats;
$.ajax({type:"GET",cache:!1,url:"{url:(mail/getchat)}/"+c+"/"+d+"/"+e+"/"+n+"/"+f+"/"+l,
success:function(g)
{var j=Math.floor(f/e);f%e!=0&&(j+=1);
for(var k=Array(100),k=g==""?"":g.split("{nesote_t}"),l=k.length/17,g=0,p=(parseInt(d)-1)*e+1,b='<div id="additionalMail_1" style="display: none;";></div>',ss='<div id="additionalMail_1" style="display: none;";></div>',q=0;q<l;q++){
for(var a=Array(17),i=0;i<17;i++)a[i]=k[i];k.splice(0,17);
h.isItemAvailable("chats",a[0])==0&&(h.insertToposition(c,
p,a),h.totl++,p++);
a=h.isItemAvailable("chats",a[0]);
xx=h.getResultItembyIndex(c,a);
xx[0]=xx[0].replace(/^[\s]+/,"").replace(/[\s]+$/,"").replace(/[\s]{2,}/," ");
var a=xx[0],i=xx[3],n=xx[2];
if(xx[5]==1)
var o="readmail",r="readContent",s="twopaneMailRead",zc="threepaneMailRead";
else o="unreadmail",r="unreadContent",s="twopaneMailUnRead",zc="threepaneMailUnRead";
var hash_id=encode64(a);var encr="",encr1="";

var m=xx[16],m=m.replace(/e0d71f32e332df0bf09e2f879dd14d77/g,"&nbsp;"),t=xx[4];
b=b+'<div class="'+s+'" id="twopaneMail_'+a+'" onMouseOver="mouseoverMail('+a+",'"+c+"','"+h+"','"+c+'\')" onMouseOut="mouseoutMail('+a+",'"+c+"','"+h+"','"+c+'\')"><div id="shortDiv_mail_'+a+'" class=\"mail-list-in\"><table class=\"mail-list-tbl\" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout:fixed;border-collapse: collapse;height:40px;vertical-align:middle;"><tr  ><td width="24px" style=""><input type="checkbox" class="mailCheckBox"  id="cbt_'+a+'" onClick="clickCheckboxChat('+a+",'"+c+"',chats,"+d+',0)"></td><td width="22px" style=""><div class="star" id="star_'+a+'"  ><i class="fa fa-comments-o"></i></div></td><td width="20%"  style="text-overflow:ellipsis;overflow:hidden;white-space:nowrap;line-height:25px;vertical-align:middle;padding-left:5px;cursor: pointer;padding-right:15px;" onClick="clickonDivChat(chats,'+a+","+g+",0,50,"+a+","+d+',0)" >',b=b+"<span class="+o+' id="fromaddress_span'+a+'" ><a href="#'+c+"/"+hash_id+'" >'+n+"</a></span>",b=b+'</td><td style="text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:50%;cursor: pointer;padding-left:10px;" onClick="clickonDivChat(chats,'+a+","+g+",0,50,"+a+","+d+',0)">',b=b+'<span  class="mail_sub_cont"><span  id="mailsubject_span'+a+'"',b=b+' class="'+o+'" ><a href="#'+c+"/"+hash_id+'" >'+i+"</a>",b=b+' </span><span id="mailcontent_span'+a+'" class="'+r+'" style=""><a href="#'+c+"/"+hash_id+'" >';m!=""&&i!=""&&(b+="&nbsp;-&nbsp; ");
b=b+""+m+"</a></span></span></td>";
b=b+'<td onClick="clickonDivChat(chats,'+a+","+g+",0,50,"+a+","+d+',0)" style="cursor: pointer;"><span class="fromDate_short"><a href="#'+c+"/"+hash_id+'" >'+t+"</a></span></td></table></div></div>";

//3pane

ss=ss+'<div onClick="clickonDivChat(chats,'+a+','+g+',0,50,'+a+','+d+',0)" class="'+zc+'" id="threepaneMail_'+a+'" onMouseOver="mouseoverMail('+a+",'"+c+"','"+h+"','"+c+'\')" onMouseOut="mouseoutMail('+a+",'"+c+"','"+h+"','"+c+'\')"><div id="shortDiv_mail_'+a+'" class=\"mail-list-in\"><table class=\"mail-list-tbl\" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout:fixed;border-collapse: collapse;height:40px;vertical-align:middle;"><tr><td width="10%" style=""><input type="checkbox" class="mailCheckBox"  id="cbt1_'+a+'" onClick="clickCheckboxChat('+a+",'"+c+"',chats,"+d+',0)"></td><td width="10%" style=""><div class="star" id="star_3pane_'+a+'"  ><i class="fa fa-comments-o"></i></div></td><td width="60%"  style="text-overflow:ellipsis;overflow:hidden;white-space:nowrap;line-height:25px;vertical-align:middle;padding-left:5px;cursor: pointer;padding-right:15px;" onClick="clickonDivChat(chats,'+a+","+g+",0,50,"+a+","+d+',0)" >';
ss=ss+"<span class="+o+' id="fromaddress_span'+a+'" ><a href="#'+c+"/"+hash_id+'" >'+n+"</a></span>";
ss=ss+'</td><td width="20%" onClick="clickonDivChat(chats,'+a+','+g+',0,50,'+a+','+d+',0)" style="cursor: pointer;"><span class="fromDate_short"><a href="#'+c+'/'+hash_id+'" >'+t+'</a></span></td></tr>';
ss=ss+'<tr><td style="text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:50%;cursor: pointer;padding-left:10px;" colspan="4"  onClick="clickonDivChat(chats,'+a+','+g+',0,50,'+a+','+d+',0)">';
ss=ss+'<span  class="mail_sub_cont"><span  id="mailsubject_span'+a+'" class="'+o+'" ><a href="#'+c+'/'+hash_id+'" >'+i+'</a>';
ss=ss+'</span></td></tr><tr><td style="text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:50%;cursor: pointer;padding-left:10px;" colspan="4"><span id="mailcontent_span'+a+'" class="'+r+'" style=""><a href="#'+c+'/'+hash_id+'" >';
m!=""&&i!=""&&(ss+="&nbsp;-&nbsp; ");
ss=ss+""+m+'</a></span></span></td></tr>';
ss=ss+'</table></div></div>';
g+=1}


//End


if(current_view=="2pane")
	{

	if(document.getElementById("mailContent11").style.display=="")
		document.getElementById("mailContent11").style.display="none";
	
	
j>1&&(d==1?(k="{cfn:getmessage(432)}",encr=encode64("p"+j),encr1=encode64("p2"),b=b+'<div class="pageingDiv sddm"><a class="last_bvtn cntrl_btn" href="#'+c+"/"+encr+'" onClick="javascript:mainWindowChat(\''+c+"',"+j+","+e+","+f+',3)"><span>{cfn:getmessage(431)}</span></a><a  class="last_bvtn cntrl_btn" href="#'+c+"/"+encr1+'"  onClick="javascript:mainWindowChat(\''+c+"',2,"+e+","+f+',2)"><span>{cfn:getmessage(433)}</span></a></div>'):d==j?(prev=parseInt(j)-1,encr=encode64("p"+prev),encr1=encode64("p1"),b=b+'<div class="pageingDiv sddm"><a class="last_bvtn cntrl_btn" href="#'+c+"/"+encr+'" onClick="javascript:mainWindowChat(\''+c+"',"+prev+","+e+","+f+',3)"><span>{cfn:getmessage(432)}</span></a><a class="last_bvtn cntrl_btn" href="#'+c+"/"+encr1+'" onClick="javascript:mainWindowChat(\''+c+"',1,"+e+","+f+","+f+',2)"><span>{cfn:getmessage(442)}</span></a></div>'):(prev=parseInt(d)-1,next=parseInt(d)+1,encr=encode64("p"+next),encr1=encode64("p"+prev),b=b+'<div class="pageingDiv sddm"><a class="last_bvtn cntrl_btn" href="#'+c+"/"+encr+'" onClick="javascript:mainWindowChat(\''+c+"',"+next+","+e+","+f+',2)"><span>{cfn:getmessage(433)}</span></a><a href="#'+c+"/"+encr1+'" onClick="javascript:mainWindowChat(\''+c+"',"+prev+","+e+","+f+',3)"><span>{cfn:getmessage(432)}</span></a></div>'));b+="";document.getElementById("heading").innerHTML="<i class=\"fa fa-comments\"></i> {cfn:getmessage(429)}";document.getElementById("preloaddiv").style.display="";document.getElementById("preloadimage").style.display="none";
document.getElementById("short_detail").setAttribute("class","short");g==0?(document.getElementById("mailContent").innerHTML='<div class="warningTxt"><i class="fa fa-exclamation-circle"></i> {cfn:getmessage(30)}</div>',document.getElementById("chat_subheader").style.display="none"):document.getElementById("mailContent").innerHTML=b;document.getElementById("mailContent").style.width="100%";if(document.getElementById("rightads_td").style.display=="")document.getElementById("rightads_td").style.display="none"
	}
	
else
	{

	if(document.getElementById("mailContent").style.display=="")
		document.getElementById("mailContent").style.display="none";
	
	j>1&&(d==1?(k="{cfn:getmessage(432)}",encr=encode64("p"+j),encr1=encode64("p2"),ss=ss+'<div class="pageingDiv sddm"><a class="last_bvtn cntrl_btn" href="#'+c+"/"+encr+'" onClick="javascript:mainWindowChat(\''+c+"',"+j+","+e+","+f+',3)"><span>{cfn:getmessage(431)}</span></a><a class="last_bvtn cntrl_btn" href="#'+c+"/"+encr1+'"  onClick="javascript:mainWindowChat(\''+c+"',2,"+e+","+f+',2)"><span>{cfn:getmessage(433)}</span></a></div>'):d==j?(prev=parseInt(j)-1,encr=encode64("p"+prev),encr1=encode64("p1"),ss=ss+'<div class="pageingDiv sddm"><a class="last_bvtn cntrl_btn" href="#'+c+"/"+encr+'" onClick="javascript:mainWindowChat(\''+c+"',"+prev+","+e+","+f+',3)"><span>{cfn:getmessage(432)}</span></a><a class="last_bvtn cntrl_btn" href="#'+c+"/"+encr1+'" onClick="javascript:mainWindowChat(\''+c+"',1,"+e+","+f+","+f+',2)"><span>{cfn:getmessage(442)}</span></a></div>'):(prev=parseInt(d)-1,next=parseInt(d)+1,encr=encode64("p"+next),encr1=encode64("p"+prev),ss=ss+'<div class="pageingDiv sddm"><a class="last_bvtn cntrl_btn" href="#'+c+"/"+encr+'" onClick="javascript:mainWindowChat(\''+c+"',"+next+","+e+","+f+',2)"><span>{cfn:getmessage(433)}</span></a><a class="last_bvtn cntrl_btn" href="#'+c+"/"+encr1+'" onClick="javascript:mainWindowChat(\''+c+"',"+prev+","+e+","+f+',3)"><span>{cfn:getmessage(432)}</span></a></div>'));ss+="";document.getElementById("heading").innerHTML="<i class=\"fa fa-comments\"></i> {cfn:getmessage(429)}";document.getElementById("preloaddiv").style.display="";document.getElementById("preloadimage").style.display="none";
	document.getElementById("short_detail").setAttribute("class","short");g==0?(document.getElementById("mailContent11").innerHTML='<div class="warningTxt"> <i class="fa fa-exclamation-circle"></i> {cfn:getmessage(30)}</div>',document.getElementById("chat_subheader").style.display="none"):document.getElementById("mailContent11").innerHTML=ss;document.getElementById("mailContent").style.width="100%";if(document.getElementById("rightads_td").style.display=="")document.getElementById("rightads_td").style.display="none"
	
	}



}})};



function morefnChat()
{
  if(moreflagchat==0)
  {
      
      moveflagChat=0;
      var url1=window.location.hash;
          var contnt="<div class=\"in\">";
      if(idz=="")
      {
      var selectall="{cfn:getmessage(85)}";
          contnt=contnt+"<a href=\""+url1+"\"  onClick=\"selectallchat()\">"+selectall+"</a>";
      }
      else
      {
          var asd=idz.split(",");
          for(var incr=0;incr<(asd.length);incr++)
          {
              var asdf=asd[(asd.length-1)].split("&");
              var crntFoldername=asdf[2];
              
              var id=asdf[0].replace(":","");
              var objct=this[crntFoldername];
              var star=0;var read=0;var unstar=0;var unread=0;
              var aa=objct.getResultPage(crntFoldername,asdf[1],mailsPerpage);
              
              while(xx=objct.fetchRow(aa))
              {
                  if(xx[0]==id)
                  {
                      
                      if(xx[5]==1)
                      read=1;
                      else
                      unread=1;
                  }
              }
          }
          var url31="";
          
          var read="{cfn:getmessage(74)}";var unread="{cfn:getmessage(75)}";var deselectall="{cfn:getmessage(86)}";var selectall="{cfn:getmessage(85)}";
              if((read==1)&&(unread==0))
          contnt=contnt+"<a href=\"javascript:readChat(0,'')\" >"+unread+"</a>";
          else if((read==0)&&(unread==1))
          contnt=contnt+"<a href=\"javascript:readChat(1,'')\" >"+read+"</a>";
          else 
          contnt=contnt+"<a href=\"javascript:readChat(0,'')\" >"+unread+"</a><a href=\"javascript:readChat(1,'')\" >"+read+"</a>";
          
          contnt=contnt+"<a href=\"javascript:selectallchat()\">"+selectall+"</a><a href=\"javascript:deselectallchat()\" >"+deselectall+"</a>";
      }
      contnt=contnt+"</div>";
      document.getElementById("moreListChat2").style.display="";
      document.getElementById("moreListChat2").innerHTML=contnt;
      moreflagchat=1;
  }
  else
  {
      moreflagchat=0;
      document.getElementById("moreListChat2").style.display="none";
  }
}

function removeAllOptions(b){var a;for(a=b.options.length-1;a>=0;a--)b.remove(a)}function addoption1(b,a,d){var c=document.createElement("OPTION");c.text=a;c.value=d;b.options.add(c)};
function fldrnm(a){if(a==1)return xxx=0,"{cfn:getmessage(19)}";else if(a==2)return xxx=0,"{cfn:getmessage(20)}";else if(a==3)return xxx=0,"{cfn:getmessage(21)}";else if(a==4)return xxx=0,"{cfn:getmessage(12)}";else if(a==6)return xxx=0,"{cfn:getmessage(205)}";else if(a==5)return xxx=0,"{cfn:getmessage(22)}";else if(a==0)return xxx=0,"{cfn:getmessage(164)}";else{if("{$customfolders[0]}"==a)return xxx=0,"{$customfolders[1]}";findFolderName(a);return document.getElementById("foldrd").value}};
//Called from Search Function
function findnumbers(folder,keyword,nmz)
{//alert("cc");
var c=(new Date).getTime();
$.ajax({
type:"GET",cache:!1,
url:"{url:(mail/findnumber)}/"+keyword+"/"+folder+"/"+crntime,
success:function(data){
//The data contains the number of results of a folder and keyword

//Disable some Menu Items if not available.in page refresh of search 
if(document.getElementById("cotnct_lmenuid").style.display=="")
	{
	   document.getElementById("cotnct_lmenuid").style.display="none";
	}
if(document.getElementById("contact_subheader").style.display=="")
{
   document.getElementById("contact_subheader").style.display="none";
}

if(document.getElementById("splitbuttonid").style.display=="")
{
   document.getElementById("splitbuttonid").style.display="none";
}

if(document.getElementById("mailPageOuterid").style.right=="201px")
	{
	 document.getElementById("mailPageOuterid").style.right="0px";
	}

//End

           searcHcnt=data;
          SetCookie(nmz,searcHcnt,1);// Sets a Cookie in the browser containing the no.of results.
          mainWindow(nmz,1,mailsPerpage,searcHcnt,2);//Calls the Main Window.
          var temp="<i class='fa fa-search'></i> {cfn:getmessage(163)}";
          temp=temp.replace("{search}",keyword);
          var fldrNam=fldrnm(folder);
          while(xxx!=0)
          {
              var aa=1;
          }
          temp=temp.replace("{folder}",fldrNam);
          document.getElementById("heading").innerHTML=temp;
          window.location.hash=nmz;}
          });}

function clickonDivChat(names,mailId,pageNo,pageStatus,noConversations,currentId,mainPage,loopvariable)
{
	var c_theme=getCookievalue("Current_Theme");
	if(c_theme!="100")
		{
	//Themes Based Modifications for Transparency Effect
	document.getElementById("second_scroll").style.background="#FFFFFF";
	document.getElementById("footer_txt_id").style.color="#000000";

	//End
		}
	//Hide Reply Links
	if(document.getElementById("mail_box_reply_links").style.display=="")
		document.getElementById("mail_box_reply_links").style.display="none";
	
 	
//mail_open=1;	
	var current_url1=window.location.href;
	var current_url2=current_url1.split("#");

	var remaining_url=encode64("p"+mainPage);
	remaining_url="chats"+"/"+remaining_url;
	var new_url=current_url2[0]+"#"+remaining_url;
	
	SetCookie("backurl",new_url,1);
	
	
	
var enc_mailid=encode64(mailId);
window.location.hash="chats/"+enc_mailid;

var foldername=getCookievalue("folder");

if(document.getElementById("backchatbtnid").style.display=="none")
	{
     document.getElementById("backchatbtnid").style.display="";
     if(foldername=="chats")
     {  document.getElementById("backchat_tootltip").title="{cfn:getmessage(779)}";
     reinstall_tooltip();
     }
     
    }


document.getElementById("mail_subheader").style.display="none";
  
document.getElementById("chat_subheader").style.display="";
var avail=isArrayAvailable(names);
  
  var arry=new Array(16);
  arry[0]='id';
  arry[1]='chatid';
  arry[2]='receiver';
  arry[3]='message';
  arry[4]='time';
  arry[5]='readflag';
  arry[6]='responders';
  arry[7]='name';
  arry[8]='msg';
  arry[9]='firstsender';
  arry[10]='subject1';
  arry[11]='fromall';
  arry[12]='subject2';
  arry[13]='fromdtls';
  arry[14]='todtls';
  arry[15]='toreply';
  arry[16]='stripmsg';
  
  if(avail==0)
  {
  
  
      this[names]=new Table(names,arry,100,100);
  }
  
  

  var objct=this['chats'];
  var avail1=objct.isItemAvailable('chats',mailId);
  if(avail1!=0)
  {
  
          var arz1=new Array(1);
          arz1[0]='readflag';
          var arz2=new Array(1);
          arz2[0]=1;
          var arz3=new Array(1);
          arz3[0]=mailId;
          this['chats'].update(names,arz1,arz2);
          this['chats'].where('id=?',arz3);
          this['chats'].action();
      var currentTime=new Date();
      var crntime=currentTime.getTime();
      var url31="{url:(mail/changeChatreadflag)}/"+mailId+"/"+crntime;
  
  changeReadflag("chats",mailId);
  var mnp=getCookievalue("chat_page");
var opj=objct.getResultItemM('chats',mailId,mnp,mailsPerpage);	
  
  var id=2;var itr=0;
  clickCheckboxChat(mailId,names,'chats',mainPage,1);
  var tble="";
  enableReplylinksChat();
  while(xx=objct.fetchRow(opj))
  {
  
      if(mailId==xx[0])
      {
           var subject=xx[3];
           var from=xx[9];
           var to=xx[7];
           var time=xx[4];
           var chatmessage=xx[8];
          chatmessage=chatmessage.replace(/e0d71f32e332df0bf09e2f879dd14d77/g, '&nbsp;');
           var responders=xx[6];
           var chatid=xx[0];
           var designId=chatid;
           var subject1=xx[10];
           var fromdtls=xx[13];
           var todtls=xx[14];
           var starField="<i class='fa fa-comments-o'></i>";
          tble=tble+"<h2>"+subject+"</h2><div class=\"mailBox\">";
           tble=tble+"<div id=\"mailDiv_"+designId+"\" class=\"mailBoxOpened\" >";var url_print="{url:(chat/printmailChat/)}"+chatid;
                          tble=tble+"<div id=\"short_"+designId+"\" class=\"mailBoxTitle\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\"  >"+starField+"</span><span  class=\"fromName\" >{cfn:getmessage(54)}:"+from+"</span><span class=\"titleContent\" style=\"float:left;\">{cfn:getmessage(436)} "+to+"</span><span class=\"showDetailBtn\" style=\"float:left;\"><a href=\"javascript:showDetails('"+designId+"');\">{cfn:getmessage(282)}</a></span></span><span class=\"mailBoxRT\"></span><!-- <span id=\"mailactionsdrop\" class=\"fromDate noArrow\"><div class=\"popup\"><a href=\"javascript:createDraftChat("+chatid+",1,'"+designId+"')\" class=\"fromDate noArrow\"><div class=\"in\">{cfn:getmessage(15)}</div></a><a href=\"javascript:createDraftChat("+chatid+",2,'"+designId+"')\" class=\"fromDate noArrow\"><div class=\"in\">{cfn:getmessage(16)}</div></a><a href=\"javascript:createDraftChat("+chatid+",3,'"+designId+"')\" class=\"fromDate noArrow\"><div class=\"in\">{cfn:getmessage(17)}</div></a><a class=\"fromDate noArrow\" href="+url_print+" target=\"_blank\"><div class=\"in\">{cfn:getmessage(646)}</div></a></div><div class=\"in\"><img class=\"iconsCornner arLt\" alt=\"\" src=\"images/filler.gif\"></div></span> --><span class=\"fromDate noArrow\"><div class=\"in\">"+time+"</div></span></div>";
                          
                          
                          tble=tble+"<div  class=\"mailBoxTitle\" style=\"display: none;\" id=\"detail_"+designId+"\"><span class=\"mailBoxLT\"></span><span class=\"mailBoxMT\"><span class=\"titleStar\" >"+starField+"</span><span  class=\"fromName\" >{cfn:getmessage(54)}:"+from+"</span><span class=\"showDetailBtn\"> <a href=\"javascript:hideDetails('"+designId+"')\">{cfn:getmessage(283)}</a></span></span><span class=\"mailBoxRT\"></span>";
                          tble=tble+"<span class=\"fromDate noArrow\"><div class=\"in\">"+time+"</div></span></div>";
                          tble=tble+"<div class=\"mailBoxM\"   ><div class=\"row\" id=\"detail1_"+designId+"\" style=\"display:none;\"><div class=\"detailedList\" >";
                          
                          tble=tble+"<div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(54)}:</div><div class=\"row floatL\"><div>"+fromdtls+"</div></div></div><div style=\"clear:both\"></div>";
                          
                          tble=tble+"<div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(31)}:</div><div class=\"row floatL\"><div>"+todtls+"</div></div></div><div style=\"clear:both\"></div>";
                          tble=tble+"<div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(34)}:</div><div class=\"row floatL\"><div>"+subject1+"</div></div></div><div style=\"clear:both\"></div><div class=\"row\"><div class=\"blackTxt\">{cfn:getmessage(383)}:</div><div class=\"row floatL\"><div>"+time+"</div></div></div></div></div><div style=\"clear:both\"></div>";
                          
                          tble=tble+"<span class=\"mailContent\" >"+chatmessage+"</span></div>";
                      
                      var url31="{url:(mail/createdraft)}";var url_print="{url:(chat/printmailChat/)}"+chatid;
                          tble=tble+"<div class=\"mailBoxFooter\" id=replyfooter1_"+designId+"><span class=\"mailBoxLF\"></span><span class=\"mailBoxBM\"><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-r\"></span><a href=\"javascript:createDraftChat("+chatid+",1,'"+designId+"')\"> {cfn:getmessage(15)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-a\"></span><a href=\"javascript:createDraftChat("+chatid+",2,'"+designId+"')\">{cfn:getmessage(16)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-f\"></span><a href=\"javascript:createDraftChat("+chatid+",3,'"+designId+"')\">{cfn:getmessage(17)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner print-btn\"></span><a href="+url_print+" target=\"_blank\">{cfn:getmessage(646)}</a></div></span><span class=\"mailBoxRF\"></span></div>";
                          tble=tble+"<div id=reply_"+designId+" style=\"display: none;\" class=\"replyWindow\">";
                          tble=tble+"<div class=\"row\" style=\"display: none;\"  id=replyfooter2_"+designId+" style=\"padding-top:5px;\"><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-r\"></span><a href=\"javascript:createDraftzforChat("+chatid+",1,'"+url31+"')\">{cfn:getmessage(15)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-a\"></span><a href=\"javascript:createDraftzforChat("+chatid+",2,'"+url31+"')\">{cfn:getmessage(16)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner reply-f\"></span><a href=\"javascript:createDraftzforChat("+chatid+",3,'"+url31+"')\">{cfn:getmessage(17)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner print-btn\"></span><a href="+url_print+" target=\"_blank\">{cfn:getmessage(646)}</a></div></div>";
                          tble=tble+"</div></div></div>";

              document.getElementById('loadingDiv').style.display="none";
              document.getElementById('preloaddiv').style.display="";
              document.getElementById('preloadimage').style.display="none";
              document.getElementById("short_detail").setAttribute("class", "detailmail");
              document.getElementById('mailContent').style.width="100%";
              if(name!="draft")
              {
                  if(right_ads_status!=0)//Check Global Ad display Status.
				{
              if(document.getElementById('rightads_td').style.display=="none")
                  {document.getElementById('rightads_td').style.display="";
                  document.getElementById('mailPageOuterid').style.right="201px";
                  }
				}

                  
              }
              else
              {
                  document.getElementById('rightads_td').style.display="none";
                  document.getElementById('mailPageOuterid').style.right="0px";

              }
              var current_view=getCookievalue("current_view");
              if(current_view=="3pane")
            	  {
            	  
            	  		document.getElementById("backchatbtnid").style.display="none";
              			document.getElementById('msg_display').innerHTML=tble;
            	  }
              else
              document.getElementById('mailContent').innerHTML=tble;//alert(tble);

          	document.getElementById("splitbuttonid").style.display="none";
          	//alert(tble);
              //document.getElementById('rightads').style.display="";
              document.getElementById("loadingDiv").style.display="none";
                  document.getElementById("short_detail").setAttribute("class", "detailmail");
          document.getElementById('mailContent').style.width="100%";
          
              //readChat(1,'');
           
      }
  }
  
  }
  else
  {
      
	  fetchdetailAjaxChat('chats',pageNo,mailId);
  }
}
//Called on chat refresh
function fetchdetailAjaxChat(h,o,j){

chat_refresh_flag=1;
document.getElementById("heading").innerHTML="<i class=\"fa fa-comments\"></i> {cfn:getmessage(429)}";
clickCheckboxChat(j,h,h,o,1);
var d=this.chats;d.totl2=parseInt(d.totl1)+parseInt(totalchat);
h=(new Date).getTime();$.ajax({type:"GET",cache:!1,url:"{url:(chat/getchatdetail/)}"+j+"/"+h,success:function(a){for(var f=Array(100),f=a==""?"":a.split("{nesote_t}"),a=f.length/17,i=0;i<a;i++){for(var g=Array(17),e=0;e<17;e++)g[e]=f[e];d.insert("chats",2,g,"id","desc")}d.isItemAvailable("chats",j);f=d.getResultItemM("chats",j,o,mailsPerpage);for(a="";xx=d.fetchRow(f);){var i=xx[3],g=xx[9],e=xx[7],k=xx[4],l=xx[8],l=
l.replace(/e0d71f32e332df0bf09e2f879dd14d77/,"&nbsp;"),c=xx[0],b=c,h=xx[10],m=xx[13],n=xx[14],url_print="{url:(chat/printmailChat/)}"+c,a=a+"<h2>"+i+'</h2><div class="mailBox">',a=a+'<div id="mailDiv_'+b+'" class="mailBoxOpened">',a=a+'<div id="short_'+b+'" class="mailBoxTitle"><span class="mailBoxLT"></span><span class="mailBoxMT"><span class="titleStar"  ><i class="fa fa-comments-o"></i></span><span  class="fromName" >{cfn:getmessage(54)}:'+g+'</span><span class="titleContent" style="float:left;">{cfn:getmessage(436)} '+e+'</span><span class="showDetailBtn" style="float:left;"><a href="javascript:showDetails(\''+b+'\');">{cfn:getmessage(282)}</a></span></span><span class="mailBoxRT"></span><!-- <span id="mailactionsdrop" class="fromDate noArrow"><div class="popup"><a href="javascript:createDraftChat('+c+",1,'"+b+'\')" class="fromDate noArrow"><div class="in">{cfn:getmessage(15)}</div></a><a  class="fromDate noArrow" href="javascript:createDraftChat('+c+",2,'"+b+'\')"><div class="in">{cfn:getmessage(16)}</div></a><a  class="fromDate noArrow" href="javascript:createDraftChat('+c+",3,'"+b+'\')"><div class="in">{cfn:getmessage(17)}</div></a><a class="fromDate noArrow"  href="'+url_print+'" target=\"_blank\"><div class="in">{cfn:getmessage(646)}</div></a></div><div class="in"><img class="iconsCornner arLt" alt="" src="images/filler.gif"></div></span> --><span class="fromDate noArrow"><div class="in">'+k+"</div></span></div>",a=a+'<div  class="mailBoxTitle" style="display: none;" id="detail_'+b+'"><span class="mailBoxLT"></span><span class="mailBoxMT"><span class="titleStar"   ><i class="fa fa-comments-o"></i></span><span  class="fromName" >{cfn:getmessage(54)}:'+g+'</span>\t<span class="showDetailBtn"> <a href="javascript:hideDetails(\''+b+'\')">{cfn:getmessage(283)}</a></span></span><span class="mailBoxRT"></span>',a=a+'<span class="fromDate noArrow"><div class="in">'+k+"</div></span></div>",a=a+'<div class="mailBoxM"   ><div class="row" id="detail1_'+b+'" style="display:none;"><div class="detailedList" >',a=a+'<div class="row"><div class="blackTxt">{cfn:getmessage(54)}:</div><div class="row floatL"><div>'+m+'</div></div></div><div style="clear:both"></div>',a=a+'<div class="row"><div class="blackTxt">{cfn:getmessage(31)}:</div><div class="row floatL"><div>'+n+'</div></div></div><div style="clear:both"></div>',a=a+'<div class="row"><div class="blackTxt">{cfn:getmessage(34)}:</div><div class="row floatL"><div>'+h+'</div></div></div><div style="clear:both"></div><div class="row"><div class="blackTxt">{cfn:getmessage(383)}:</div><div class="row floatL"><div>'+k+'</div></div></div></div></div><div style="clear:both"></div>',a=a+'<span class="mailContent" >'+l+"</span>";a+="</div>";a=a+'<div class="mailBoxFooter" id=replyfooter1_'+b+' style="width:100%;"><span class="mailBoxLF"></span><span class="mailBoxBM"><div class="replyLink commonBtngc floatL"><span><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner reply-r"></span><a href="javascript:createDraftChat('+c+",1,'"+b+'\')">{cfn:getmessage(15)}</a></div><div class="replyLink commonBtngc floatL"><span><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner reply-a"></span><a href="javascript:createDraftChat('+c+",2,'"+b+'\')">{cfn:getmessage(16)}</a></div><div class="replyLink commonBtngc floatL"><span><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner reply-f"></span><a href="javascript:createDraftChat('+c+",3,'"+b+'\')">{cfn:getmessage(17)}</a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner print-btn\"></span><a href="'+url_print+'" target=\"_blank\">{cfn:getmessage(646)}</a></div></span><span class="mailBoxRF"></span></div>';
a=a+"<div id=reply_"+b+' style="display: none;" class="replyWindow">';a=a+'<div class="row" style="display: none;"  id=replyfooter2_'+b+' style="padding-top:5px;"><div class="replyLink commonBtngc floatL"><span><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner reply-r"></span><a href="javascript:createDraftzforChat('+c+',1)">{cfn:getmessage(15)}</a></div><div class="replyLink commonBtngc floatL"><span><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner reply-a"></span><a href="javascript:createDraftzforChat('+c+',2)"> {cfn:getmessage(16)}</a></div><div class="replyLink commonBtngc floatL"><span><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner reply-f"></span><a href="javascript:createDraftzforChat('+c+',3)"> {cfn:getmessage(17)} </a></div><div class=\"replyLink commonBtngc floatL\"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner print-btn\"></span><a href="'+url_print+'" target=\"_blank\">{cfn:getmessage(646)}</a></div></div>';a+="</div></div></div>";

if(right_ads_status!=0)//Check Global Ad display Status.
{
if(document.getElementById('rightads_td').style.display!="none")
{
document.getElementById('mailPageOuterid').style.right="201px";
	}


document.getElementById("splitbuttonid").style.display="none";

	
	
}


document.getElementById("preloaddiv").style.display="";document.getElementById("preloadimage").style.display="none";document.getElementById("mailContent").innerHTML=a}}})};

function replychat(a,e){var url_print="{url:(chat/printmailChat/)}"+a;reply_mail_id=reply_mail_id+a+",";var d=this.chats;if(document.getElementById("reply_"+a).style.display=="none")document.getElementById("reply_"+a).style.display="";if(document.getElementById("replyfooter1_"+a).style.display=="")document.getElementById("replyfooter1_"+a).style.display="none";for(var b='<div class="row"   id=replyfooter2_'+a+' style="padding-top:5px;"><div class="replyLink commonBtngc floatL" style="display:none"><span><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner reply-r"></span><a href="javascript:createDraftChat('+a+",1,'"+a+'\')">{cfn:getmessage(15)}</a></div><div class="replyLink commonBtngc floatL" style="display:none"><span><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner reply-a"></span><a href="javascript:createDraftChat('+a+",2,'"+a+'\')">{cfn:getmessage(16)}</a></div><div class="replyLink commonBtngc floatL" style="display:none"><span><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner reply-f"></span><a href="javascript:createDraftChat('+a+",3,'"+a+'\')">{cfn:getmessage(17)}</a></div><div class=\"replyLink commonBtngc floatL\" style="display:none"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner print-btn\"></span><a href="'+url_print+'" target=\"_blank\">{cfn:getmessage(646)}</a></div></div><div style="clear:both"></div>',f=d.getResultItem("chats",a);xx=d.fetchRow(f);){
var repfrom=new Array();repfrom[0]="";repfrom[1]="";
if(xx[13].indexOf("<")>=0)
{
repfrom=xx[13].split("<");
}
if(repfrom[1]!="")
repfrom[1]=repfrom[1].replace(">","");
else 
repfrom[1]=xx[13];
if(repfrom[0]!="")
repfrom[0]=" "+repfrom[0]+" ";
var replymsg="<div style=\"font:small arial;\" > On "+xx[4]+", <span><b>"+repfrom[0]+"</b> <<a target=\"_blank\" href=\"mailto:"+repfrom[1]+"\">"+repfrom[1]+"</a>></span><br/></div>";

var c=xx[15],g="{$reply_pre}:"+xx[10],b=b+'<div id="sendFooter2_0" class="row marginT10" ><span class="sendBtn"><a href="javascript:mailFurtherChat(1,'+a+')">{cfn:getmessage(37)}</a></span><span class="commonBtn commonBtngc floatL"> <a class="position_tooltip"  href="javascript:mailFurtherChat(2,'+a+')" title="{cfn:getmessage(36)}"><i class="fa fa-file-text"></i></a> </span> <span class="commonBtn commonBtngc floatL"><a class="position_tooltip"  href="javascript:mailFurtherChat(3,'+a+')" title="{cfn:getmessage(59)}"><i class="fa fa-trash"></i></a></span></div>',b=b+'<div class="row marginT10" ><div class="row"><div class="coloum70 floatL"><span class="boldTxt">{cfn:getmessage(31)}:</span></div><div class="coloum floatL" style="width:89%;float:left;"><input autocomplete="off" type="text" name="to_'+a+'" id="to_'+a+'" value="'+c+'" onKeyUp="javascript:keymovement(event,this.value,\''+a+'\',1);" style="width: 99%; height: 30px;"><input type="hidden" name="search_'+a+'" id="search_'+a+'" value="" ></div><div style="clear: both;" ></div><div id="livesearch_'+a+'" class="livesearch" style="position:static;margin-left:74px;"></div></div></div>',b=b+'<div class="row marginT10"><div class="coloum70 floatL" ><span class="boldTxt">{cfn:getmessage(34)}:</span></div><div class="coloum floatL" style="width:89%;"><input type="text" name="subject_'+a+'" id="subject_'+a+'" value="'+g+'" style="width: 99%; height: 30px;"></div></div><div style="clear: both;" ></div>',b=b+'<div class="row marginT10" id="cc_bcc_'+a+'"><span id="spancc_'+a+'" class="commonLink"><a href="javascript:showccfun(\''+a+'\')" >{cfn:getmessage(201)}</a></span><span class="normalTxt floatL">|</span><span id="spanbcc_'+a+'" class="commonLink"><a href="javascript:showbccfun(\''+a+'\')">{cfn:getmessage(202)}</a></span></div><div style="clear: both;" ></div>',b=b+'<div id="showcc_'+a+'" style="display: none;" class="row marginT10"><div class="coloum70 floatL" ><span class="boldTxt">{cfn:getmessage(32)}:</span></div><div class="coloum floatL" style="width:89%;float:left;"><input autocomplete="off" type="text" name="cc_'+a+'" id="cc_'+a+'" value="" onKeyUp="javascript:keymovement(event,this.value,\''+a+'\',2);" style="width: 99%; height: 30px;"><input type="hidden" name="searchcc_'+a+'" id="searchcc_'+a+'" value="" ></div><div style="clear: both;" ></div><div id="livesearchcc_'+a+'" class="livesearch" style="position:static;margin-left:74px;"></div></div>',b=b+'<div id="showbcc_'+a+'" style="display: none;" class="row marginT10"><div class="coloum70 floatL" ><span class="boldTxt">{cfn:getmessage(33)}:</span></div><div class="coloum floatL" style="width:89%;float:left;"><input autocomplete="off" type="text" name="bcc_'+a+'" id="bcc_'+a+'" value="" onKeyUp="javascript:keymovement(event,this.value,\''+a+'\',3);" style="width: 99%; height: 30px;"><input type="hidden" name="searchbcc_'+a+'" id="searchbcc_'+a+'" value="" ></div><div style="clear: both;" ></div><div id="livesearchbcc_'+a+'" class="livesearch" style="position:static;margin-left:74px;"></div></div>',b=b+'<div class="row marginT10" id="cc_only_'+a+'" style="display: none;"><span id="spancc_'+a+'" class="commonLink"><a href="javascript:showccfun2(\''+a+'\')">{cfn:getmessage(201)}</a></span></div><div class="row marginT10" id="bcc_only_'+a+'" style="display: none;"><span id="spanbcc_'+a+'" class="commonLink"><a href="javascript:showbccfun2(\''+a+'\')">{cfn:getmessage(202)}</a></span></div><div style="clear: both;" ></div>',b=b+'<span  class="attachLink"><a href="javascript:addfilefield(\''+a+'\')"><div id="attachlink_'+a+'"><span><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner attach-a"></span><span class="boldTxt">{cfn:getmessage(35)}</span></div></a></span><input type="hidden" value="" id="attachcount_'+a+'" name="attachcount_'+a+'"><div id="filedivcontainer_'+a+'_0" class="attachBox"></div><div id="additionalattach_'+a+'" class="attachLink" style="display: none"><a href="javascript:addfilefield(\''+a+'\')"><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner attach-a">{cfn:getmessage(60)} </a></div>',b=b+'<div class="row marginT10" style=" width:100%;"><div onkeyup="autoSave(\''+a+'\')" style="background-color:#ffffff; width: auto;height:auto; "><textarea  name="chatBody_'+a+'" style="  width: 1100px;height:500px; background-color:#FFFFFF;" id="chatBody_'+a+'"><br /><br />'+replymsg+'<blockquote  style="border-left: 1px solid rgb(204, 204, 204); margin: 0px 12px 12px 5px; padding-left: 1ex;">'+xx[8]+"</blockquote></textarea></div></div>",b=b+'<div id="sendFooter2_0" class="row marginT10" ><span class="sendBtn"><a href="javascript:mailFurtherChat(1,'+a+')">{cfn:getmessage(37)}</a></span><span class="commonBtn commonBtngc floatL"> <a class="position_tooltip"  href="javascript:mailFurtherChat(2,'+a+')" title="{cfn:getmessage(36)}"><i class="fa fa-file-text"></i></a> </span> <span class="commonBtn commonBtngc floatL"><a class="position_tooltip" href="javascript:mailFurtherChat(3,'+a+')" title="{cfn:getmessage(59)}"><i class="fa fa-trash"></i></a> </span></div>',b=b+'<input type="hidden" id="draftid_'+a+'" value="'+e+'">';b+="</div>";
document.getElementById("reply_"+a).innerHTML=b;

//(new nicEditor({fullPanel:!0})).panelInstance("chatBody_"+a);
var bb="chat_Body_"+a;

CKEDITOR.replace("chatBody_"+a);


var editor=CKEDITOR.instances[bb];
if(signature<2){signature==0?(c="{noescape:$signature}",document.getElementById("chatBody_"+a),c="<table><tr><td>"+replymsg+xx[8]+"</td></tr><tr><td>"+c+"</td></tr></table>",editor.setData(c)):getNewSignature("chatBody_"+a,xx[8],1,replymsg);}if(document.getElementById("nic_edit_nesote_webmail")){document.getElementById("nic_edit_nesote_webmail").focus();}}};

function replyAllchat(c,f){
	var url_print="{url:(chat/printmailChat/)}"+c;
	reply_mail_id=reply_mail_id+a+",";
	var a=c,e=this.chats;
	if(document.getElementById("reply_"+a).style.display=="none")document.getElementById("reply_"+a).style.display="";
	if(document.getElementById("replyfooter1_"+a).style.display=="")document.getElementById("replyfooter1_"+a).style.display="none";
	for(var b='<div class="row"   id=replyfooter2_'+a+' style="padding-top:5px;"><div class="replyLink commonBtngc floatL" style="display:none"><span><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner reply-r"></span><a href="javascript:createDraftChat('+c+",1,'"+a+'\')">{cfn:getmessage(15)}</a></div><div class="replyLink commonBtngc floatL" style="display:none"><span><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner reply-a"></span><a href="javascript:createDraftChat('+c+",2,'"+a+'\')"> {cfn:getmessage(16)} </a></div><div class="replyLink commonBtngc floatL" style="display:none"><span><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner reply-f"></span><a href="javascript:createDraftChat('+c+",3,'"+a+'\')"> {cfn:getmessage(17)} </a></div><div class=\"replyLink commonBtngc floatL\" style="display:none"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner print-btn\"></span><a href="'+url_print+'" target=\"_blank\">{cfn:getmessage(646)}</a></div></div><div style="clear:both"></div>',
g=e.getResultItem("chats",c);xx=e.fetchRow(g);){
var repfrom=new Array();repfrom[0]="";repfrom[1]="";
if(xx[13].indexOf("<")>=0)
{
repfrom=xx[13].split("<");
}
if(repfrom[1]!="")
repfrom[1]=repfrom[1].replace(">","");
else 
repfrom[1]=xx[13];
if(repfrom[0]!="")
repfrom[0]=" "+repfrom[0]+" ";
var replymsg="<div style=\"font:small arial;\" > On "+xx[4]+", <span><b>"+repfrom[0]+"</b> <<a target=\"_blank\" href=\"mailto:"+repfrom[1]+"\">"+repfrom[1]+"</a>></span><br/></div>";

var d=xx[11],h="{$reply_pre}:"+xx[12],b=b+'<div id="sendFooter2_0" class="row marginT10" ><span class="sendBtn"><a href="javascript:mailFurtherChat(1,'+a+')">{cfn:getmessage(37)}</a></span><span class="commonBtn commonBtngc floatL"> <a class="position_tooltip"  href="javascript:mailFurtherChat(2,'+a+')" title="{cfn:getmessage(36)}"><i class="fa fa-file-text"></i></a> </span> <span class="commonBtn commonBtngc floatL"><a class="position_tooltip"  href="javascript:mailFurtherChat(3,'+a+')" title="{cfn:getmessage(59)}"><i class="fa fa-trash"></i></a></span></div>',b=b+'<div class="row marginT10" ><div class="row"><div class="coloum70 floatL"><span class="boldTxt">{cfn:getmessage(31)}:</span></div><div class="coloum floatL" style="width:89%;float:left;"><input autocomplete="off" type="text" name="to_'+a+'" id="to_'+a+'" value="'+d+'" onKeyUp="javascript:keymovement(event,this.value,\''+a+'\',1);" style="width: 99%; height: 30px;"><input type="hidden" name="search_'+a+'" id="search_'+a+'" value="" ></div><div style="clear: both;" ></div><div id="livesearch_'+a+'" class="livesearch" style="position:static;margin-left:74px;"></div></div></div>',b=b+'<div class="row marginT10"><div class="coloum70 floatL" ><span class="boldTxt">{cfn:getmessage(34)}:</span></div><div class="coloum floatL" style="width:89%;"><input type="text" name="subject_'+a+'" id="subject_'+a+'" value="'+h+'" style="width: 99%; height: 30px;"></div></div><div style="clear: both;" ></div>',b=b+'<div class="row marginT10" id="cc_bcc_'+a+'"><span id="spancc_'+a+'" class="commonLink"><a href="javascript:showccfun(\''+a+'\')" >{cfn:getmessage(201)}</a></span><span class="normalTxt floatL">|</span><span id="spanbcc_'+a+'" class="commonLink"><a href="javascript:showbccfun(\''+a+'\')">{cfn:getmessage(202)}</a></span></div><div style="clear: both;" ></div>',b=b+'<div id="showcc_'+a+'" style="display: none;" class="row marginT10"><div class="coloum70 floatL" ><span class="boldTxt">{cfn:getmessage(32)}:</span></div><div class="coloum floatL" style="width:89%;float:left;"><input autocomplete="off" type="text" name="cc_'+a+'" id="cc_'+a+'" value="" onKeyUp="javascript:keymovement(event,this.value,\''+a+'\',2);" style="width: 99%; height: 30px;"><input type="hidden" name="searchcc_'+a+'" id="searchcc_'+a+'" value="" ></div><div style="clear: both;" ></div><div id="livesearchcc_'+a+'" class="livesearch" style="position:static;margin-left:74px;"></div></div>',b=b+'<div id="showbcc_'+a+'" style="display: none;" class="row marginT10"><div class="coloum70 floatL" ><span class="boldTxt">{cfn:getmessage(33)}:</span></div><div class="coloum floatL" style="width:89%;float:left;"><input autocomplete="off" type="text" name="bcc_'+a+'" id="bcc_'+a+'" value="" onKeyUp="javascript:keymovement(event,this.value,\''+a+'\',3);" style="width: 99%; height: 30px;"><input type="hidden" name="searchbcc_'+a+'" id="searchbcc_'+a+'" value="" ></div><div style="clear: both;" ></div><div id="livesearchbcc_'+a+'" class="livesearch" style="position:static;margin-left:74px;"></div></div>',b=b+'<div class="row marginT10" id="cc_only_'+a+'" style="display: none;"><span id="spancc_'+a+'" class="commonLink"><a href="javascript:showccfun2(\''+a+'\')">{cfn:getmessage(201)}</a></span></div><div class="row marginT10" id="bcc_only_'+a+'" style="display: none;"><span id="spanbcc_'+a+'" class="commonLink"><a href="javascript:showbccfun2(\''+a+'\')">{cfn:getmessage(202)}</a></span></div><div style="clear: both;" ></div>',b=b+'<span  class="attachLink"><a href="javascript:addfilefield(\''+a+'\')"><div id="attachlink_'+a+'"><span><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner attach-a"></span><span class="boldTxt">{cfn:getmessage(35)}</span></div></a></span><input type="hidden" value="" id="attachcount_'+a+'" name="attachcount_'+a+'"><div id="filedivcontainer_'+a+'_0" class="attachBox"></div><div id="additionalattach_'+a+'" class="attachLink" style="display: none"><a href="javascript:addfilefield(\''+a+'\')"><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner attach-a">{cfn:getmessage(60)} </a></div>',b=b+'<div class="row marginT10" style=" width:100%;"><div onkeyup="autoSave(\''+a+'\')" style="background-color:#ffffff; width: auto;height:auto; "><textarea  name="chatBody_'+a+'" style="  width: 1100px;height:500px; background-color:#FFFFFF;" id="chatBody_'+a+'"><br /><br />'+replymsg+'<blockquote  style="border-left: 1px solid rgb(204, 204, 204); margin: 0px 12px 12px 5px; padding-left: 1ex;">'+xx[8]+"</blockquote></textarea></div></div>",b=b+'<div id="sendFooter2_0" class="row marginT10" ><span class="sendBtn"><a href="javascript:mailFurtherChat(1,'+a+')">{cfn:getmessage(37)}</a></span><span class="commonBtn commonBtngc floatL"> <a class="position_tooltip"  href="javascript:mailFurtherChat(2,'+a+')" title="{cfn:getmessage(36)}"><i class="fa fa-file-text"></i></a> </span> <span class="commonBtn commonBtngc floatL"><a class="position_tooltip"  href="javascript:mailFurtherChat(3,'+a+')" title="{cfn:getmessage(59)}"><i class="fa fa-trash"></i></a> </span></div>',b=b+'<input type="hidden" id="draftid_'+a+'" value="'+f+'">';b+="</div>";document.getElementById("reply_"+a).innerHTML=b;
CKEDITOR.replace("chatBody_"+a);
//(new nicEditor({fullPanel:!0})).panelInstance("chatBody_"+a);
if(signature<2){
	signature==0?(d="{noescape:$signature}",d="<table><tr><td>"+replymsg+xx[8]+"</td></tr><tr><td>"+d+"</td></tr></table>",CKEDITOR.instances["chatBody_"+a].setData(d)):getNewSignature("chatBody_"+a,xx[8],1,replymsg);}if(document.getElementById("nic_edit_nesote_webmail")){document.getElementById("nic_edit_nesote_webmail").focus();}}};
function forwardchat(a,e){
	var url_print="{url:(chat/printmailChat/)}"+a;
	reply_mail_id=reply_mail_id+a+",";
	var d=this.chats;
	if(document.getElementById("reply_"+a).style.display=="none")document.getElementById("reply_"+a).style.display="";
	document.getElementById("replyfooter1_"+a).style.display="none";
	for(var b='<div class="row"   id=replyfooter2_'+a+' style="padding-top:5px;"><div class="replyLink commonBtngc floatL" style="display:none"><span><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner reply-r"></span><a href="javascript:createDraftChat('+a+",1,'"+a+'\')">{cfn:getmessage(15)}</a></div><div class="replyLink commonBtngc floatL" style="display:none"><span><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner reply-a"></span><a href="javascript:createDraftChat('+a+",2,'"+a+'\')">{cfn:getmessage(16)}</a></div><div class="replyLink commonBtngc floatL" style="display:none"><span><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner reply-f"></span><a href="javascript:createDraftChat('+a+",3,'"+a+'\')">{cfn:getmessage(17)}</a></div><div class=\"replyLink commonBtngc floatL\" style="display:none"><span><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner print-btn\"></span><a href="'+url_print+'" target=\"_blank\">{cfn:getmessage(646)}</a></div></div><div style="clear:both"></div>',
f=d.getResultItem("chats",a);xx=d.fetchRow(f);){
var repfrom=new Array();repfrom[0]="";repfrom[1]="";
if(xx[13].indexOf("<")>=0)
{
repfrom=xx[13].split("<");
}
if(repfrom[1]!="")
repfrom[1]=repfrom[1].replace(">","");
else 
repfrom[1]=xx[13];
if(repfrom[0]!="")
repfrom[0]=" "+repfrom[0]+" ";

var repto=new Array();var tolist="";
if(xx[14]!="")
{
  if(xx[14].substring(xx[14].length-1,xx[14].length)==",")
  var newx2=xx[14].substring(0,xx[14].length-1);
  else
  var newx2=xx[14];
  var x2=newx2.split(",");
  for(var i=0;i<x2.length;i++)
  {
  repto[0]="";repto[1]="";
  if(x2[i].indexOf("<")>=0)
  {
  repto=x2[i].split("<");
  }
  if(repto[1]!="")
  repto[1]=repto[1].replace(">","");
  else 
  repto[1]=x2[i];
  
  tolist+=" <span><b>"+repto[0]+"</b> "+repto[1]+"</span>,";
  }
  if(tolist.substring(tolist.length-1,tolist.length)==",")
  tolist=tolist.substring(0,tolist.length-1);
}
var fwdmsg="<div style=\"font:small arial;\">---------- Forwarded message ----------<br>From: <span><b>"+repfrom[0]+"</b>"+repfrom[1]+"</span><br>Date: "+xx[4]+"<br>Subject: "+xx[10]+"<br>To: "+tolist+"<br /><br /><br /></div>";

var c="{$forward_pre}:"+xx[10],b=b+'<div id="sendFooter2_0" class="row marginT10" ><span class="sendBtn"><a href="javascript:mailFurtherChat(1,'+a+')">{cfn:getmessage(37)}</a></span><span class="commonBtn commonBtngc floatL"> <a class="position_tooltip" href="javascript:mailFurtherChat(2,'+a+')" title="{cfn:getmessage(36)}"><i class="fa fa-file-text"></i></a></span> <span class="commonBtn commonBtngc floatL"><a class="position_tooltip" href="javascript:mailFurtherChat(3,'+a+')" title="{cfn:getmessage(59)}"><i class="fa fa-trash"></i></a></span></div>',b=b+'<div class="row marginT10" ><div class="row"><div class="coloum70 floatL"><span class="boldTxt">{cfn:getmessage(31)}:</span></div><div class="coloum floatL" style="width:89%;float;left;"><input autocomplete="off" type="text" name="to_'+a+'" id="to_'+a+'" value="" onKeyUp="javascript:keymovement(event,this.value,\''+a+'\',1);" style="width: 99%; height: 30px;"><input type="hidden" name="search_'+a+'" id="search_'+a+'" value="" ></div><div style="clear: both;" ></div><div id="livesearch_'+a+'" class="livesearch" style="position:static;margin-left:74px;"></div></div></div>',b=b+'<div class="row marginT10"><div class="coloum70 floatL" ><span class="boldTxt">{cfn:getmessage(34)}:</span></div><div class="coloum floatL" style="width:89%;"><input type="text" name="subject_'+a+'" id="subject_'+a+'" value="'+c+'" style="width: 99%; height: 30px;"></div></div><div style="clear: both;" ></div>',b=b+'<div class="row marginT10" id="cc_bcc_'+a+'"><span id="spancc_'+a+'" class="commonLink"><a href="javascript:showccfun(\''+a+'\')" >{cfn:getmessage(201)}</a></span><span class="normalTxt floatL">|</span><span id="spanbcc_'+a+'" class="commonLink"><a href="javascript:showbccfun(\''+a+'\')">{cfn:getmessage(202)}</a></span></div><div style="clear: both;" ></div>',b=b+'<div id="showcc_'+a+'" style="display: none;" class="row marginT10"><div class="coloum70 floatL" ><span class="boldTxt">{cfn:getmessage(32)}:</span></div><div class="coloum floatL" style="width:89%;float:left;"><input autocomplete="off" type="text" name="cc_'+a+'" id="cc_'+a+'" value="" onKeyUp="javascript:keymovement(event,this.value,\''+a+'\',2);" style="width: 99%; height: 30px;"><input type="hidden" name="searchcc_'+a+'" id="searchcc_'+a+'" value="" ></div><div style="clear: both;" ></div><div id="livesearchcc_'+a+'" class="livesearch" style="position:absolute;margin-left:74px;"></div></div>',b=b+'<div id="showbcc_'+a+'" style="display: none;" class="row marginT10"><div class="coloum70 floatL" ><span class="boldTxt">{cfn:getmessage(33)}:</span></div><div class="coloum floatL" style="width:89%;float:left;"><input autocomplete="off" type="text" name="bcc_'+a+'" id="bcc_'+a+'" value="" onKeyUp="javascript:keymovement(event,this.value,\''+a+'\',3);" style="width: 99%; height: 30px;"><input type="hidden" name="searchbcc_'+a+'" id="searchbcc_'+a+'" value="" ></div><div style="clear: both;" ></div><div id="livesearchbcc_'+a+'" class="livesearch" style="position:static;margin-left:74px;"></div></div>',b=b+'<div class="row marginT10" id="cc_only_'+a+'" style="display: none;"><span id="spancc_'+a+'" class="commonLink"><a href="javascript:showccfun2(\''+a+'\')">{cfn:getmessage(201)}</a></span></div><div class="row marginT10" id="bcc_only_'+a+'" style="display: none;"><span id="spanbcc_'+a+'" class="commonLink"><a href="javascript:showbccfun2(\''+a+'\')">{cfn:getmessage(202)}</a></span></div><div style="clear: both;" ></div>',b=b+'<span  class="attachLink"><a href="javascript:addfilefield(\''+a+'\')"><div id="attachlink_'+a+'"><span><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner attach-a"></span><span class="boldTxt">{cfn:getmessage(35)}</span></div></a></span><input type="hidden" value="" id="attachcount_'+a+'" name="attachcount_'+a+'"><div id="filedivcontainer_'+a+'_0" class="attachBox"></div><div id="additionalattach_'+a+'" class="attachLink" style="display: none"><a href="javascript:addfilefield(\''+a+'\')"><img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner attach-a">{cfn:getmessage(60)} </a></div>',b=b+'<div class="row marginT10" style=" width:100%;"><div onkeyup="autoSave(\''+a+'\')" style="background-color:#ffffff; width: auto;height:auto; "><textarea  name="chatBody_'+a+'" style="  width: 1100px;height:500px; background-color:#FFFFFF;" id="chatBody_'+a+'"><br /><br />'+fwdmsg+xx[8]+"</textarea></div></div>",b=b+'<div id="sendFooter2_0" class="row marginT10" ><span class="sendBtn"><a href="javascript:mailFurtherChat(1,'+a+')">{cfn:getmessage(37)}</a></span><span class="commonBtn commonBtngc floatL"> <a class="position_tooltip"  href="javascript:mailFurtherChat(2,'+a+')" title="{cfn:getmessage(36)}"><i class="fa fa-file-text"></i></a> </span> <span class="commonBtn commonBtngc floatL"><a class="position_tooltip"  href="javascript:mailFurtherChat(3,'+a+')" title="{cfn:getmessage(59)}"><i class="fa fa-trash"></i></a> </span></div>',b=b+'<input type="hidden" id="draftid_'+a+'" value="'+e+'">';b+="</div>";document.getElementById("reply_"+a).innerHTML=b;
//(new nicEditor({fullPanel:!0})).panelInstance("chatBody_"+a);
CKEDITOR.replace("chatBody_"+a);
if(signature<2){
	signature==0?(c="{noescape:$signature}",c="<table><tr><td>"+fwdmsg+xx[8]+"</td></tr><tr><td>"+c+"</td></tr></table>",CKEDITOR.instances["chatBody_"+a].setData(c)):getNewSignature("chatBody_"+a,xx[8],0,fwdmsg)}document.getElementById("to_"+a).focus()}};
function mailFurther(h,g,a){
	var b=document.getElementById("to_"+a).value;
	b==""&&(b=" ");
	var c=document.getElementById("cc_"+a).value;
	c==""&&(c=" ");
	var d=document.getElementById("bcc_"+a).value;
	d==""&&(d=" ");
	var e=document.getElementById("subject_"+a).value;
	e==""&&(e=" ");
	var editor1="mailBody_"+a;
	var editor = CKEDITOR.instances[editor1];
	var f=editor.getData();//nicEditors.findEditor("mailBody_"+a).getContent();
	f==""&&(f=" ");
	h==1?b==" "&&c==" "&&d==" "?alert("{cfn:getmessage(437)}"):senDmail(b,c,d,e,f,g,a):h==2?savEmail(b,c,d,e,f,g,a):discarDmail(g,a)};

function mailFurtherChat(g,a){
    
	var b=document.getElementById("to_"+a).value;
	b==""&&(b=" ");
	var c=document.getElementById("cc_"+a).value;
	c==""&&(c=" ");
	var d=document.getElementById("bcc_"+a).value;
	d==""&&(d=" ");
	var e=document.getElementById("subject_"+a).value;
	e==""&&(e=" ");
	var f=CKEDITOR.instances["chatBody_"+a].getData();//nicEditors.findEditor("chatBody_"+a).getContent();
	f==""&&(f=" ");g==1?b==" "&&c==" "&&d==" "?alert("{cfn:getmessage(437)}"):senDmailChat(b,c,d,e,f,a):g==2?savEmail(b,c,d,e,f,g,a)/*savEmailChat(b,c,d,e,f,a)*/:discarDmailChat(a)};
function senDmailChat(b,c,d,e,f,a){
notify_display("{cfn:getmessage(781)}","info");
if((parseInt(last_send_timer)<parseInt(mail_sending_delay))&&parseInt(last_send_timer)!=parseInt(0))
{   var last_send_temp=parseInt(mail_sending_delay)-parseInt(last_send_timer); 
var last_tmp=setInterval(function(){ last_send_temp=parseInt(last_send_temp)-parseInt(1);if(last_send_temp==0){last_send_timer=0;clearInterval(last_tmp);senDmailChat(b,c,d,e,f,a);};notify_display("{cfn:getmessage(781)}"+" <span id='timer_send'> Please wait "+last_send_temp+" seconds</span>","info"); }, 1000);//Starts the timer
}
if(last_send_timer==0){
last_send_timer="";clear_send_timer();
	var g=document.getElementById("draftid_"+a).value,h=(new Date).getTime(),b=encodeURIComponent(b),c=encodeURIComponent(c),d=encodeURIComponent(d),e=encodeURIComponent(e),f=encodeURIComponent(f),a=encodeURIComponent(a);
	$.ajax(
			{
				type:"POST",cache:!1,url:"{url:(chat/sendmail)}",data:"to="+b+"&cc="+c+"&bcc="+d+"&subject="+e+"&content="+f+"&time="+h+"&draftid="+g+"&mailid="+a,success:function(data){
if(data=="limitreached"){
notify_display("{cfn:getmessage(782)}","warning");return false;
}
if(last_send_timer=="")//If Last send timer is not defined.
{
last_send_object=setInterval(function(){ update_send_timer();},1000);//Starts the timer
}

notify_display("{cfn:getmessage(768)}","success");

				mainWindowChat("chats",1,mailsPerpage,totalchat,2)}
				}
			)}};



function savEmailChat(f,g,h,i,j,d){
	var e=idz.split(":");
	if(e!="")var c=e[1].split("&");
	var e=e==""?document.getElementById("draftid_"+d).value:c[0],d=document.getElementById("attachcount_"+d).value,a=d==0||d==""?"":'<img src="images/filler.gif"  alt=" " border="0" align="absmiddle" class="iconsCornner attach-a">',k=new Date,d=k.getTime(),c=this.draft,b=Array(13);b[0]=e;b[1]="{$username}";
	b[2]=f;
	b[3]=g;
	b[4]=h;
	b[5]=i;
	b[6]=j;
	b[7]=0;
	b[8]=0;
	b[9]=k;
	b[10]=a;
	b[11]=d;
	b[12]="draft";
	a=Array(13);
	a[0]="id";
	a[1]="from_list";
a[2]="to_list";
a[3]="cc";
a[4]="bcc";a[5]="subject";a[6]="body";a[7]="readflag";a[8]="starflag";a[9]="time";a[10]="status";a[11]="time_int";a[12]="back_folder";
isArrayAvailable("draft")!=0?c.isItemAvailable("draft",e)==0?(c.insert("draft",2,b,"time_int","desc"),c.totl2=parseInt(c.totl2)+1):(c.update("draft",a,b),c.where("id=?",e),c.action()):(c=getCookievalue("draft"),c=parseInt(c)+1,SetCookie("draft",c,1));f=encodeURIComponent(f);g=encodeURIComponent(g);h=encodeURIComponent(h);i=encodeURIComponent(i);
j=encodeURIComponent(j);$.ajax({
	type:"POST",cache:!1,url:"{url:(chat/savemail)}",data:"to="+f+"&cc="+g+"&bcc="+h+"&subject="+i+"&content="+j+"&time="+d+"&draftid="+e,success:function(a){
		a==1&&(Unread[1][1]=parseInt(Unread[1][1])+1,setUnreadcount()),notify_display("{cfn:getmessage(449)}","success")}
	}
	)};

function discarDmail(b,a)
{
	
var draft_obj=this["draft"];
var c=document.getElementById("draftid_"+a).value;(new Date).getTime();
$.ajax({type:"POST",cache:!1,url:"{url:(mail/discardmail)}",
data:"draftid="+c,success:function(){b==0?mainWindow("inbox",1,mailsPerpage,totalInbox,2):(document.getElementById("reply_"+a).style.display="none",document.getElementById("replyfooter1_"+a).style.display="")
if(isArrayAvailable("draft")!=0)
{
var itemavld=draft_obj.isItemAvailable("draft",c);
if(itemavld!=0)
{
var drftCnt=parseInt(Unread[1][1])-parseInt(1);
Unread[1][1]=drftCnt; 
SetCookie("draft",drftCnt,1);
setUnreadcount();

//Deleting Items from Draft Array.

   id1=new Array(1);
   id1[0]=c;
   draft_obj.deleteEntry("draft");
   draft_obj.where('id=?',id1);
   draft_obj.action();
 //Deleting Items from Draft Array.


}
}
}})};


function discarDmailChat(a){var b=document.getElementById("draftid_"+a).value;(new Date).getTime();$.ajax({type:"POST",cache:!1,url:"{url:(chat/discardmail)}",data:"draftid="+b,success:function(){a==0?mainWindowChat("chats",1,mailsPerpage,totalchat,2):(document.getElementById("reply_"+a).style.display="none",document.getElementById("replyfooter1_"+a).style.display="")}})};
function deletemailChat(){moveflag=0;document.getElementById("moveto2").style.display="none";var d=idz.split(":")[1].split(","),c="";for(i=0;i<d.length;i++){var a=d[i].split("&");a[2]="chats";var b=this[a[2]].getResultItem(a[2],a[0]);if((this[a[2]].fetchRow(b)[7]==0||a[2]=="chats")&&a[2]!="sent"&&a[2]!="trash"&&a[2]!="starred")for(b=0;b<customFoldercount;b++)Unread[b][0]==a[2]&&(Unread[b][1]=parseInt(Unread[b][1])-1);b=Array(1);b[0]=a[0];this[a[2]].deleteEntry(a[2]);this[a[2]].where("id=?",b);this[a[2]].action();if(document.getElementById("scrapDiv_"+a[0]))document.getElementById("scrapDiv_"+a[0]).style.display="none",document.getElementById("star_"+a[0]).style.display="none",document.getElementById("cbt_"+a[0]).style.display="none",document.getElementById("twopaneMail_"+a[0]).style.display="none";b=getCookievalue(a[2]);crnt_cookie1=parseInt(b)-1;SetCookie(a[2],crnt_cookie1,1);c=c==""?a[0]:c+","+a[0]}setUnreadcount();mainWindowChat(a[2],a[1],mailsPerpage,crnt_cookie1,2);(new Date).getTime();c=encodeURIComponent(c);$.ajax({type:"POST",cache:!1,url:"{url:(chat/deletechatemail/)}",data:"mailid="+c,success:function(){}})};
var timer=null;

function chatclick1(e)
{
	var f=(new Date).getTime(),c=screen.width,d=screen.height,a=0;
	//c>=1152&&d>=768?a=5:c>=1024&&d>=768?a=4:c<1024&&d<768&&(a=3); Changed due to chatbox width change
	c>=1152&&d>=768?a=4:c>=1024&&d>=768?a=3:c<1024&&d<768&&(a=2);
	$.ajax({
		type:"GET",cache:!1,url:"{url:(chat/insertsession/)}"+e+"/"+f+"/"+a,success:function(b){
			b!=""&&(b=b.replace(/^[\s]+/,"").replace(/[\s]+$/,"").replace(/[\s]{2,}/," "),b=="signout"?alert("{cfn:getmessage(394)}"):(str=b.split("+*+"),chatWith2(str[0],str[1],str[2],str[3],str[4],a,str[5],str[6])))}})};
function chatWith2(a,c,d,i,e,h,j,f){
	for(var a=a.replace(/^[\s]+/,"").replace(/[\s]+$/,"").replace(/[\s]{2,}/," "),b=arr.split(","),c=0;c<b.length;c++)if(b[c]!=""){document.getElementById("chattextarea"+b[c]).className="chatboxtextarea";var g="divhide"+b[c]}g=b==""?0:b.length;for(c=0;c<g;c++)if(b[c]==a){g="divhide"+b[c];f="chatminimize"+b[c];e="chatboxhead"+b[c];if(document.getElementById(g).value==0)document.getElementById(g).value=1;if(document.getElementById(g).value==1)document.getElementById(g).value=
0,document.getElementById(f).style.display="",document.getElementById(e).style.display="",c="divhide"+a,f="chatminimize"+a,e="chatboxhead"+a,document.getElementById(c).value=0,document.getElementById(f).style.display="",document.getElementById(e).style.display="",f="chattextarea"+a,document.getElementById(f).className="chatboxtextareaselected",document.getElementById(f).focus();c="chattextarea"+a;document.getElementById(c).className="chatboxtextareaselected";document.getElementById(c).focus();getmsg(a,1,d);return}c="close"+a;b="";arr+=a+",";userarr+=d+",";g="";g=arr==""?0:arr.substring(0,arr.length-1).split(",").length-1;b+='<input type="hidden" value="0" id="divhide'+a+'">';b+='<div id="chatboxhead'+a+'" class="chatboxhead">';b+=g%2==0?'<div class="chatTheme" id="chatTheme'+a+'"></div>':'<div class="chatTheme2" id="chatTheme'+a+'"></div>';b+='<a href="javascript:void(0)" class="aclass" onclick="javascript:toggleChatBoxGrowth(\''+a+"','"+d+"')\">";b+='<div class="chatboxtitle" id="headername_'+a+'">'+i+"</div>";b+="</a>";b+='<div class="chatboxoptions" style="padding:2px;">';b+='<a href="javascript:void(0)" id="minimize_'+a+'" title="{cfn:getmessage(439)}" onclick="javascript:toggleChatBoxGrowth(\''+a+"','"+d+"')\">";b+='<i class="fa fa-minus fachatbox"></i>';b+="</a>";b+=' <a href="javascript:void(0)" onclick="javascript:closeChatBox(\''+a+"','"+d+'\')" title="Close">';b+='<i class="fa fa-times fachatbox"></i>';b+="</a>";b+="</div>";b+='<br clear="all"/>';b+="</div>";b+='<div class="minimzeclaas" id="chatminimize'+a+'" style="display:" onclick="javascript:ss123(\''+a+"')\">";b+='<div class="chatboxcontent1" id="chatcontent'+a+'" >';b+='<div  id="chatrequest_'+a+'">';b+='<a href="#" class="invitechat" onclick="javascript:invitechat(\''+a+"')\">{cfn:getmessage(395)}</a>";b+="</div>";b+='<div id="chataccept_'+a+'" style="display:none;">{cfn:getmessage(395)}<br><input type="text"  autocomplete="off" name="chatuser'+a+'" id="chatuser'+a+'" value="" size="22" class="invitechattextbox" onKeyUp="javascript:keymovement_ch(event,this.value,\''+a+"','"+d+'\');" ><div style="clear:both"></div>';b+='<div id="livesearch_ch_'+a+'"   class="livesearchchat" style="display:none; border: 0px;  background-color: white;float:left;"></div><div style="clear:both"></div>';b+='<span style="padding-left:2px;">';b+='<a href="#" onclick="javascript:invitetochatfn(\''+a+"','"+d+'\')" class="invitechat">{cfn:getmessage(372)}</a>';b+="</span>";b+='<span style="padding-left:10px;">';b+='<a href="#" class="invitechat" onclick="javascript:cancelinvitechat(\''+a+"')\">{cfn:getmessage(267)}</a>";b+="</span>";b+="</div>";b+="</div>";b+='<div id="chatboxmessage_'+a+'" class="chatboxcontent"></div>';b+=j!=""?'<div class="chatboxinput" style="z-index:100;"><div class="typestatus" id="typestatus_'+a+'" style="display:none;">&nbsp;&nbsp;&nbsp;</div><div class="statusmsg" id="statusmsg_'+a+'">'+j+"</div>":'<div class="chatboxinput" style="z-index:100;"><div class="typestatus" id="typestatus_'+a+'" style="display:none;">&nbsp;&nbsp;&nbsp;</div><div class="statusmsg" id="statusmsg_'+a+'" style="display:none;"></div>';b+='<textarea class="chatboxtextarea" id="chattextarea'+a+'" onclick="javascript:clickyfn(\''+a+"')\" onblur=\"javascript:blurfnchat('"+a+"')\" onkeydown=\"javascript:return checkChatBoxInputKey(event,'"+a+"');\" onkeypress=\"javascript:return checkChatBoxInputKey1(event,'"+a+"',this.value);\" onkeyup=\"javascript:return checkChatBoxInputKey2(event,'"+a+'\',this.value);" wrap="hard"  rows="2"></textarea>';"{$smileys}"==1&&(b+='<div style="clear:both"><div id="smileys_'+a+'" style="z-index:103;position:absolute;margin-top:-60px;margin-left:88px;"></div><div style="clear:both"></div><div style="margin-left:234px;margin-top:-20px;width:100%;position:absolute;"><a href="javascript:getsmiley('+a+')"><img src="images/filler.gif"  alt=" " class="iconsCornner chat-sml" border="0" style="padding:1px;"></a></div>');b+="</div></div>";b+='<input type="hidden" id="smileyvalue_'+a+'" value="0"><input type="hidden" id="search_ch_'+a+'" value=""><input id="chat_id_'+a+'" type="hidden" value=""><input id="lastuser'+a+'" type="hidden" value="">';creatediv(g,c,b,200,200,10,10);c="chattextarea"+a;document.getElementById(c).className="chatboxtextareaselected";document.getElementById(c).focus();getmsg(a,0,d);d=a="";c=0;arr!=""&&(a=arr.substring(0,arr.length-1),d=a.split(","));c=d.length;if(c>h){a+=",";if(e!=""){h=e.split(",");d=a;for(c=0;c<h.length;c++)e=h[c]+",",d=d.replace(e,"");d=d.split(",");for(e=0;e<d.length-1;e++)h=d[e],c=h+",",i=arr,removediv("close"+h),arr=arr.replace(c,""),gparr=gparr.replace(c,""),rearrange(h,i,arr)}a+=",";if(f!=""){f=f.split(",");d=a;for(c=0;c<f.length;c++)e=f[c]+",",d=d.replace(e,"");d=d.split(",");for(e=0;e<d.length-1;e++)userarr=userarr.replace(d[e],"")}}};
function getname(a,i,d){
	var e=screen.width,c=screen.height,h=0;
	//e>=1152&&c>=768?h=5:e>=1024&&c>=768?h=4:e<1024&&c<768&&(h=3);
	e>=1152&&c>=768?h=4:e>=1024&&c>=768?h=3:e<1024&&c<768&&(h=2);
	e=(new Date).getTime();
	if(d==0){
		document.getElementById("divhide"+a).value=0;
		var f=arr,c="chatminimize"+a,g=a+",";
		document.getElementById("divhide"+a).value=0;
		document.getElementById("close"+a).style.display="none";
		arr=arr.replace(g,"");
		gparr=gparr.replace(g,"");
		userarr=userarr.replace(i+",","");
		removediv("close"+a);
		rearrange(a,f,arr)
		}if(d==2)c="divhide"+a,g="chatminimize"+a,
document.getElementById(c).value==0?(document.getElementById("minimize_"+a).title="{cfn:getmessage(438)}",f="headername_"+a,document.getElementById(g).style.display="none",document.getElementById(c).value=1):(document.getElementById("minimize_"+a).title="{cfn:getmessage(439)}",f="headername_"+a,document.getElementById(g).style.display="",document.getElementById(c).value=0,f="chattextarea"+a,document.getElementById(f).className="chatboxtextareaselected",document.getElementById(f).focus(),document.getElementById("chatboxmessage_"+
a).scrollTop=document.getElementById("chatboxmessage_"+a).scrollHeight);d==3?(value=document.getElementById("chatuser"+a).value,str=value.split("<"),str1=str[1].split(">"),a="{url:(chat/invitechat/)}"+str1[0]+"/"+a+"/"+e):a="{url:(chat/closeandlookup/)}"+a+"/"+i+"/"+d+"/"+e+"/"+h;
$.ajax({
			type:"GET",cache:!1,url:a,success:function(a){

				str=a.split("+*+");
				var b=str[1];
				if(d==2)a="chatminimize"+b,document.getElementById("headername_"+b).innerHTML=str[0],document.getElementById("headername_"+b).innerHTML=
str[0];
				else if(d==3){st1=a.split("+*+");
				var a="chatboxmessage_"+b,c=document.getElementById(a).innerHTML+"<br>"+st1[0];
				document.getElementById(a).innerHTML=c;
				if(st1[2]!="")document.getElementById("headername_"+b).innerHTML=st1[2],gparr+=b+",";
				a="chataccept_"+b;document.getElementById("chatrequest_"+b).style.display="";
				document.getElementById(a).style.display="none";document.getElementById("chatuser"+b).value="";
				a="chattextarea"+b;
				document.getElementById(a).className="chatboxtextareaselected";
				document.getElementById(a).focus();
document.getElementById("chatboxmessage_"+b).scrollTop=document.getElementById("chatboxmessage_"+b).scrollHeight}}})};

function getmsg(c,d,e){var f=(new Date).getTime(),a="",g="chatboxmessage_"+c;if(d==1)a=document.getElementById(g).innerHTML;a=encodeURIComponent(a);$.ajax({type:"POST",cache:!1,url:"{url:(chat/lookupmessage)}",data:"divid="+c+"&prevmsg="+a+"&userid="+e+"&crttime="+f,success:function(b){
	str=b.split("+*+");
	b=str[1];if(str[0]!="")document.getElementById("chatboxmessage_"+b).innerHTML=str[0];var a="chattextarea"+b;document.getElementById(a).focus();document.getElementById(a).className="chatboxtextareaselected";
document.getElementById("chatboxmessage_"+b).scrollTop=document.getElementById("chatboxmessage_"+b).scrollHeight}})};

function checkChatBoxInputKey1(a,b,c){document.getElementById("titlesetup").value="";var e=(new Date).getTime(),c=document.getElementById("chattextarea"+b).value,d=a.which?a.which:a.keyCode;d>32&&d<126&&a.shiftKey==0&&c!=""&&$.ajax({type:"GET",cache:!1,url:"{url:(chat/typingstatus/1/)}"+b+"/"+e,success:function(){}})};

function checkChatBoxInputKey3(c,d){var a="chattextarea"+c,b="";if(document.getElementById(a))b=document.getElementById(a).value,b=b.replace(/^\s+|\s+$/g,"");a=(new Date).getTime();b!=""&&$.ajax({type:"GET",cache:!1,url:"{url:(chat/typingstatus/)}"+d+"/"+c+"/"+a,success:function(){}})};

function checkChatBoxInputKey(event,divid) 
{
    
var chathead="chatboxhead"+divid;
var s=document.getElementById("chatboxhead"+divid).className;
if(s=="chatboxalert")
{				
                      document.getElementById("chatboxhead"+divid).className="chatboxhead";
                      var id1="chattextarea"+divid;
       document.getElementById("chatboxmessage_"+divid).scrollTop=document.getElementById("chatboxmessage_"+divid).scrollHeight
        setUser();
      }	
          
         if(event.keyCode == 13 && event.shiftKey == 0)  {
             //alert("ss");
      var id1="chattextarea"+divid;
      message = document.getElementById(id1).value; 
      
      var message = message.replace(/^\s+|\s+$/g,"");
      
       var currentTime = new Date();
      var crttime = currentTime.getTime();
      
      //Additional
      var date_iso=currentTime.toISOString();
      //
      
      if (message != '') {
      
      var userid="{$userid}";var username="";var setstr="";
      
        username="<b>{cfn:getmessage(284)}:</b> ";var userimage="{cfn:getuserimage($userid)}";
        
       var message2=htmlEntities(message);
        var message1=message2; 
        message1 = message1.replace(/\s/g,"&nbsp;");
        var sml="{$smileys}";
                             if(sml==1)
                             {
                                 //alert("cc");
                  message1=message1.replace(/:\)/gi,"<img src='images/filler.gif' border=\"0\" align=\"absmiddle\" class=\"smileyCornner smiley-1\">");
                  message1=message1.replace(/:\(/gi,"<img src='images/filler.gif' border=\"0\" align=\"absmiddle\" class=\"smileyCornner smiley-2\">");
                  message1=message1.replace(/:d/gi,"<img src='images/filler.gif' border=\"0\" align=\"absmiddle\" class=\"smileyCornner smiley-3\">");
                  message1=message1.replace(/:D/gi,"<img src='images/filler.gif' border=\"0\" align=\"absmiddle\" class=\"smileyCornner smiley-3\">");
                  message1=message1.replace(/:P/gi,"<img src='images/filler.gif' border=\"0\" align=\"absmiddle\" class=\"smileyCornner smiley-4\">");
                  message1=message1.replace(/:p/gi,"<img src='images/filler.gif' border=\"0\" align=\"absmiddle\" class=\"smileyCornner smiley-4\">");
                  message1=message1.replace(/\(\*\)/gi,"<img src='images/filler.gif' border=\"0\" align=\"absmiddle\" class=\"smileyCornner smiley-5\">");
                  message1=message1.replace(/\(\-\)/gi,"<img src='images/filler.gif' border=\"0\" align=\"absmiddle\" class=\"smileyCornner smiley-6\">");
                  message1=message1.replace(/:\|/gi,"<img src='images/filler.gif' border=\"0\" align=\"absmiddle\" class=\"smileyCornner smiley-7\">");
                  message1=message1.replace(/\(;/gi,"<img src='images/filler.gif' border=\"0\" align=\"absmiddle\" class=\"smileyCornner smiley-8\">");
                  message1=message1.replace(/:-\*/gi,"<img src='images/filler.gif' border=\"0\" align=\"absmiddle\" class=\"smileyCornner smiley-9\">");
                  message1=message1.replace(/:-v/gi,"<img src='images/filler.gif' border=\"0\" align=\"absmiddle\" class=\"smileyCornner smiley-10\">");
                  message1=message1.replace(/:-V/gi,"<img src='images/filler.gif' border=\"0\" align=\"absmiddle\" class=\"smileyCornner smiley-10\">");
                  message1=message1.replace(/:\*\)/gi,"<img src='images/filler.gif' border=\"0\" align=\"absmiddle\" class=\"smileyCornner smiley-11\">");
                  message1=message1.replace(/B-\)/gi,"<img src='images/filler.gif' border=\"0\" align=\"absmiddle\" class=\"smileyCornner smiley-11\">");
                  message1=message1.replace(/b-\)/gi,"<img src='images/filler.gif' border=\"0\" align=\"absmiddle\" class=\"smileyCornner smiley-12\">");
                  message1=message1.replace(/x-\(/gi,"<img src='images/filler.gif' border=\"0\" align=\"absmiddle\" class=\"smileyCornner smiley-13\">");
                  message1=message1.replace(/X-\(/gi,"<img src='images/filler.gif' border=\"0\" align=\"absmiddle\" class=\"smileyCornner smiley-13\">");
                  message1=message1.replace(/:\*B/gi,"<img src='images/filler.gif' border=\"0\" align=\"absmiddle\" class=\"smileyCornner smiley-14\">");
                  message1=message1.replace(/:\*b/gi,"<img src='images/filler.gif' border=\"0\" align=\"absmiddle\" class=\"smileyCornner smiley-14\">");
                  message1=message1.replace(/\*:A/gi,"<img src='images/filler.gif' border=\"0\" align=\"absmiddle\" class=\"smileyCornner smiley-15\">");
                  message1=message1.replace(/\*:a/gi,"<img src='images/filler.gif' border=\"0\" align=\"absmiddle\" class=\"smileyCornner smiley-15\">");
                  message1=message1.replace(/:-\$/gi,"<img src='images/filler.gif' border=\"0\" align=\"absmiddle\" class=\"smileyCornner smiley-16\">");
                  
                  }
      
      message = message.replace(/\s/g,"e0d71f32e332df0bf09e2f879dd14d77");
      

      
      
     setstr=document.getElementById("chatboxmessage_"+divid).innerHTML+"<br><div id=\"mediv\"><img width='32px' height='32px' src='"+userimage+"'/><div id='newdiv'>"+username+"</br>"+message1+"</br></div></div>";
  document.getElementById("chatboxmessage_"+divid).innerHTML=setstr;
       document.getElementById("chatboxmessage_"+divid).scrollTop=document.getElementById("chatboxmessage_"+divid).scrollHeight
      var val =document.getElementById("chattextarea"+divid).value;
      var re = new RegExp("\n","g");
      var newVal = val.replace(re, "");
      document.getElementById("chattextarea"+divid).value = newVal;
      document.getElementById("chattextarea"+divid).value= "";
      document.getElementById("chattextarea"+divid).focus();
      message=encodeURIComponent(message);

      
$.ajax({

type: "POST",cache: false,
url: "{url:(chat/insertmessage)}",
data: "message="+message+"&divid="+divid+"&crttime="+crttime+"&userid="+{$userid},
success: function(data) {
      if(data!="")
          {
          var text=data.split("+*+");
          if(text[0]!="")
          {
              if(document.getElementById("statusmsg_"+text[1]))
          {
          
              document.getElementById("chatboxmessage_"+divid).innerHTML+=text[0];
              document.getElementById("chatboxmessage_"+divid).scrollTop=document.getElementById("chatboxmessage_"+divid).scrollHeight
          }
          
          }
          }	
     
          }
          });
           return false;
          }
          else
          {
          return false;
          }
}
else 
return true;
} 



function setstatus(id,img,title,signout,chatstatus,logoutstatus,self_signout,self_chatstatus,self_logoutstatus,stmsg)
{
var s1="";
      
  var grpstatus=0; var gpcnt=0;
if(gparr!="")
{
      var newgparr=new Array(); 
      newgparr=gparr.substring(0,gparr.length-1);
      newgparr=newgparr.split(",");
      gpcnt=newgparr.length;
         for(var j=0;j<gpcnt;j++)
         {
         if(id==newgparr[j])
          {
              grpstatus=1;
              if(self_signout==1)
                  {
                  var title1="{cfn:getmessage(485)}";
                  
              title1="<img  src=\"images/filler.gif\" alt=\" \" class=\"iconsCornner chat-gp2\" border=\"0\" align=\"absmiddle\">"+title1;
                  if(document.getElementById("headername_"+id))
                  document.getElementById("headername_"+id).innerHTML=title1;
              }
          }
          else
          grpstatus=0;
         }
}
       
        if(grpstatus==0)
        {
          if(document.getElementById("headername_"+id))
          s1=document.getElementById("headername_"+id).innerHTML;
                          
               var sts="<img src='images/filler.gif' class=\""+img+"\" border=\"0\" align=\"absmiddle\">"+title;
           if(s1!=sts && sts!="")
              {		
              if(document.getElementById("headername_"+id))
              document.getElementById("headername_"+id).innerHTML=sts;
              }
      }
       if(self_signout==1 || self_chatstatus==5 || self_logoutstatus==1)
       {
          if(document.getElementById("typestatus_"+id))
          {
              document.getElementById("typestatus_"+id).style.display="";
              if(grpstatus==0)
              document.getElementById("typestatus_"+id).innerHTML="{cfn:getmessage(483)}";
              else
              document.getElementById("typestatus_"+id).innerHTML="{cfn:getmessage(484)}";
              document.getElementById("statusmsg_"+id).style.display="none";
          }
       }
      else if(stmsg!="" && grpstatus==0)
       {
          if(document.getElementById("statusmsg_"+id))
          {
              document.getElementById("statusmsg_"+id).style.display="";
              document.getElementById("statusmsg_"+id).innerHTML="<br>"+stmsg;
          }
       }
       else
       {
       document.getElementById("statusmsg_"+id).style.display="none";
       if(document.getElementById("typestatus_"+id).innerHTML=="{cfn:getmessage(483)}")
        document.getElementById("typestatus_"+id).style.display="none";
       }
      
       
                                  
}

function alterTitle(b,c){var a=document.getElementById("titlesetup").value;c=="nonfocus"&&a!=""?(a=b=="{cfn:getmessage(396)}"?b+"...":b+" {cfn:getmessage(397)}...",document.title=document.title==a?"{$servicename}":a,setTimeout("alterTitle(string,state,played)",3E3)):document.title="{$servicename}"};
var counter_chat;
      function test1(){counter_chat==0?test2():counter_chat==10?counter_chat=0:(counter_chat+=1,setTimeout("test1()",1E3))}function test2(){counter_chat=0}function test1(){counter_chat==0?test2():counter_chat==10?counter_chat=0:(counter_chat+=1,setTimeout("test1()",1E3))}function test2(){counter_chat=0};      
var c_total=0;
function mainContactWindow(contact,pageNo,size,ttl,insrt,contactGroup)
{
//Fix Transparency for themes.
	
	document.getElementById("second_scroll").style.background="#FFFFFF";
	document.getElementById("footer_txt_id").style.color="#000000";
	document.getElementById("footer_txt_id").style.textShadow="none";
	//
	
	//Removing Settings window heights 
	if(document.getElementById("mailPageOuterid").style.top=="63px")
		document.getElementById("mailPageOuterid").style.top=116;
	if(document.getElementById("mailPageOuterid").style.zIndex=="10003")
		document.getElementById("mailPageOuterid").style.zIndex="inherit";

      var q="";
      q=getCookievalue("currentcontact");
  
      document.getElementById("contact_subheader").style.display="";
      if(document.getElementById("chat_subheader").style.display=="")
      document.getElementById("chat_subheader").style.display="none";
      
      if(q!=0 && q!=-1)
      {
  if(document.getElementById(q))
      document.getElementById(q).style.backgroundColor="";
      if(document.getElementById(q))
      document.getElementById(q).style.fontWeight="";
      }
  if(contact=="mycontacts")
  {
  document.getElementById("0").className="leftSelected";
  
  if(addressbook==1)
  document.getElementById("-1").className="leftunSelected";
  if(q!=0)
  {
  if(document.getElementById(q))
  document.getElementById(q).className="leftunSelected";
  }
  
  }
  else if(contact=="global")
  {
  if(addressbook==1)
  document.getElementById("-1").className="leftSelected";
  
  document.getElementById("0").className="leftunSelected";
  if(q!=-1)
  {
  if(document.getElementById(q))
  document.getElementById(q).className="leftunSelected";
  }
  
  }
  else
  {
  
  document.getElementById("0").className="leftunSelected";
  if(addressbook==1)
  document.getElementById("-1").className="leftunSelected";
  if(document.getElementById(q))
  document.getElementById(q).className="leftunSelected";
  document.getElementById(contact).className="leftSelected";
  }
  contactidString="";
  document.getElementById("contactsC").style.display="";
  document.getElementById("contactList").style.display="";
  document.getElementById("contactDetails").style.display="";

  if(document.getElementById("newcontact").style.display=="")
      document.getElementById("newcontact").style.display="none";
  
  
      if(contactGroup==0)
          {
          SetCookie("currentcontact",0,1);
          //document.getElementById("c_heading").innerHTML="<i class=\"fa fa-book\"></i> {cfn:getmessage(209)}";
          document.getElementById("heading").innerHTML="<i class=\"fa fa-book\"></i> {cfn:getmessage(209)}";
               size=getCookievalue("mycontacts");
                      c_total=ttl=size;
          }
      else if(contactGroup==-1)
          {
          SetCookie("currentcontact",-1,1);
          //document.getElementById('c_heading').innerHTML="<i class=\"fa fa-globe\"></i> {cfn:getmessage(456)}";
          document.getElementById('heading').innerHTML="<i class=\"fa fa-globe\"></i> {cfn:getmessage(456)}";
          
          size=getCookievalue("globalcontacts");
          c_total=ttl=size;
          }
      else
      {
          SetCookie("currentcontact",contact,1);
          //document.getElementById('c_heading').innerHTML="<i class=\"fa fa-users\"></i> "+contactGroup;
          document.getElementById('heading').innerHTML="<i class=\"fa fa-users\"></i> "+contactGroup;
          
          size=getCookievalue("cont_"+contact);
          c_total=ttl=size;
          }
      
      
      //Check Advertisement in right panel. is shown or not.
     if(document.getElementById("rightads_td").style.display=="")
    document.getElementById("rightads_td").style.display="none";
  
  
  
  fetchContact(contact,pageNo,size,insrt,contactGroup);
}
function fetchContact(contact,pageNo,size,insrt,contactGroup)
{
var name=contact;


  var arry=new Array(11);
  arry[0]='id';
  arry[1]='mailid';
  arry[2]='conatctgroup';
  arry[3]='firstname';
  arry[4]='lastname';
  arry[5]='date_of_birth';
  arry[6]='title';
  arry[7]='company';
  arry[8]='phone';
  arry[9]='address';
  arry[10]='website';
  document.getElementById("contactDetails").innerHTML="";
  var avail=isArrayAvailable(contact);
  if(avail==1)
  {

      var no_pages=Math.floor(size/size);
      if((c_total%size)!=0)
      no_pages=no_pages+1;
      var aa=this[contact].getResultPage(contact,pageNo,size);
      var contactContent="";
      var itr=0;var id=2;
      var p=0;
          while(xx=this[contact].fetchRow(aa))
          {
          document.getElementById('noContactTD').style.display="";
              var contactId=xx[0];
              var mailId=xx[1];
              var contactGroup=xx[2];
              var firstName=xx[3];
              var lastName=xx[4];
              var date_of_birth=xx[5];
              var title=xx[6];
              var company=xx[7];
              var phone=xx[8];
              if(phone==0)
              phone="";
              var address=xx[9];
              var website=xx[10];
          contactContent=contactContent+"<table class=\"contactListTable\" id=\"contactListTable_"+contactId+"\" cellpadding=\"0\" cellspacing=\"0\" border=0 ><tr><td style=\"color:#6cc2f0;\" class=\"contactListTD\" valign=\"top\"><span style=\"padding-left:2px;\"><input type=\"checkbox\" id=\"Ccb_"+contactId+"\" onClick=\"contactselection("+contactId+")\" ></span><i class=\"fa c_env fa-envelope\"></i><span style=\"padding-left:5px;\"><a href=\"javascript:contactClick('"+contact+"','"+name+"',"+pageNo+","+size+","+contactId+")\" style=\"\">";
                  
                  if(firstName!="")
                      contactContent=contactContent+""+firstName+"&nbsp;"+lastName+"</a></span></td></tr></table>";
                  else
                      
                  contactContent=contactContent+""+mailId+"</a></td></tr></table>";
              if(p==0)
              {
                  var firstid=contactId;
              if(contactGroup!=-1)
              {
                  contactidString=contactId+",";
                  var contactdetails="<table style=\"font-size:12px;width:100%;\" cellpadding=\"0\" cellspacing=\"0\">";
                          contactdetails=contactdetails+"<tr><td colspan=2>&nbsp;</td></tr><tr><td colspan=2  style=\" font-weight: 700;font-size:14px;\">{cfn:getmessage(179)}</td></tr><tr><td colspan=2>&nbsp;</td></tr>";
                  
                  contactdetails=contactdetails+"<tr><td style=\"width:180px;\"><span class=\"\" >{cfn:getmessage(40)}</span></td><td style=\"font-size:15px;\"><input type=\"text\" id=\"edit_firstname\" value=\""+firstName+"\" size=\"25\"><span class=\"mandatory\">*</span></td></tr>";
                  contactdetails=contactdetails+"<tr><td colspan=2>&nbsp;</td></tr><tr><td style=\"width:180px;\"><span class=\"\">{cfn:getmessage(41)}</span></td><td style=\"font-size:15px;\"><input type=\"text\" id=\"edit_lastname\" value=\""+lastName+"\" size=\"25\"><span class=\"mandatory\">*</span></td></tr>";
              contactdetails=contactdetails+"<tr><td colspan=2>&nbsp;</td></tr><tr><td style=\"width:180px;\"><span class=\"\">{cfn:getmessage(42)}</span></td><td><input type=\"text\" id=\"edit_email\" value=\""+mailId+"\" size=\"25\"><span class=\"mandatory\">*</span></td></tr>";
              
          
              contactdetails=contactdetails+"<tr><td colspan=2>&nbsp;</td></tr><tr><td style=\"width:180px;\"><span class=\"\">{cfn:getmessage(43)}</span></td><td><input type=\"text\" id=\"edit_dob\" value=\""+date_of_birth+"\" size=\"25\">&nbsp;{cfn:getmessage(62)}</td></tr>";
          
              contactdetails=contactdetails+"<tr><td colspan=2>&nbsp;</td></tr><tr><td style=\"width:180px;\"><span class=\"\">{cfn:getmessage(44)}</span></td><td><input type=\"text\" id=\"edit_title\" value=\""+title+"\" size=\"25\"></td></tr>";
              
              contactdetails=contactdetails+"<tr><td colspan=2>&nbsp;</td></tr><tr><td style=\"width:180px;\"><span class=\"\">{cfn:getmessage(45)}</span></td><td><input type=\"text\" id=\"edit_company\" value=\""+company+"\" size=\"25\"></td></tr>";
          
              contactdetails=contactdetails+"<tr><td colspan=2>&nbsp;</td></tr><tr><td style=\"width:180px;\"><span class=\"\">{cfn:getmessage(46)}</span></td><td><input type=\"text\" id=\"edit_phone\" value=\""+phone+"\" size=\"25\"></td></tr>";
              
              contactdetails=contactdetails+"<tr><td colspan=2>&nbsp;</td></tr><tr><td style=\"width:180px;\"><span class=\"\">{cfn:getmessage(47)}</span></td><td><input type=\"text\" id=\"edit_address\" value=\""+address+"\" size=\"25\"></td></tr>";
          
              contactdetails=contactdetails+"<tr><td colspan=2>&nbsp;</td></tr><tr><td style=\"width:180px;\"><span class=\"\">{cfn:getmessage(48)}</span></td><td><input type=\"text\" id=\"edit_website\" placeholder=\"http://www.example.com\" value=\""+website+"\" size=\"25\"></td></tr>";
              

              
                  contactdetails=contactdetails+"<tr><td colspan=2>&nbsp;</td></tr><tr><td style=\"width:180px;\"><span class=\"\">{cfn:getmessage(49)}</span> </span></td><td id=\"contact_dropdown\" style=\"padding-left:0px;\">";
                  contactdetails=contactdetails+"<select name=\"edit_group\" id=\"edit_group\" class=\"SelectContact\" >";
                  
                  if(contactGroup==0)
                      contactdetails=contactdetails+"<option selected=\"selected\" value=\"0\">{cfn:getmessage(453)}</option>";
                  else
                  {	
                      contactdetails=contactdetails+"<option value=\"0\">{cfn:getmessage(453)}</option>";
                  }
                  
                  if(conatct_drop_down!=0)
                      {
                      for(var y=0;y<(conatct_drop_down.length);y++)
                          {
                          
                              contactdetails=contactdetails+"<option value=\""+conatct_drop_down[y][0]+"\"";
                              if(conatct_drop_down[y][0]==contactGroup)
                                  contactdetails=contactdetails+"selected=\"selected\"";
                              contactdetails=contactdetails+">"+conatct_drop_down[y][1]+"</option>";
                          }
                    }
                      
                      contactdetails=contactdetails+" </select></td></tr>";
                      contactdetails=contactdetails+"<tr><td colspan=2>&nbsp;</td></tr><tr><td>&nbsp;</td><td><input type=\"submit\" onClick=\"javascript:submitEditContact("+contactGroup+")\" value=\"{cfn:getmessage(63)}\"></td></tr>";
              
              contactdetails=contactdetails+"<tr><td colspan=2>&nbsp;</td></tr></table>";
              contactdetails=contactdetails+"<input type=\"hidden\" id=\"contactid\" value=\""+contactId+"\" ></form>";
              document.getElementById('contactDetails').innerHTML=contactdetails;
              document.getElementById('edit_firstname').focus();
              
              }
              else
                  {
                  var country=xx[6];
                  contactidString=contactId+",";
                  var contactdetails="<table style=\"font-size:12px;width:100%;\">";
                  contactdetails=contactdetails+"<tr><td colspan=\"2\"><div style=\"padding: 20px 10px 10px 20px; font-weight: 700;font-size:13px;\">"+firstName+"&nbsp;"+lastName+"</div></td></tr>";
                  
                  contactdetails=contactdetails+"<tr><td colspan=2>&nbsp;</td></tr><tr><td style=\"width:180px;\"><span class=\"\">{cfn:getmessage(42)}</span></td><td><span style=\"color: rgb(51, 102, 153);\">"+mailId+"</span></td></tr>";
              
              if(date_of_birth!="")
              contactdetails=contactdetails+"<tr><td colspan=2>&nbsp;</td></tr><tr><td style=\"width:180px;\"><span class=\"\">{cfn:getmessage(43)}</span></td><td><span class=\"contactDetails\">"+date_of_birth+"</span></td></tr>";
              if(country!="")
              contactdetails=contactdetails+"<tr><td colspan=2>&nbsp;</td></tr><tr><td style=\"width:180px;\"><span class=\"\">{cfn:getmessage(123)}</span></td><td><span class=\"contactDetails\">"+country+"</span></td></tr>";
              
          
              contactdetails=contactdetails+"<tr><td colspan=2>&nbsp;</td></tr></table>";
              contactdetails=contactdetails+"<input type=\"hidden\" id=\"contactid\" value=\""+contactId+"\" >";
              document.getElementById('contactDetails').innerHTML=contactdetails;
                  }
              }
          p=p+1;
          
          
      }
          contactContent=contactContent+"";
          if(p!=0)
              {
              document.getElementById('noContactDiv').style.display="none";
              
              document.getElementById('contactList').innerHTML=contactContent;
                  document.getElementById('contactListTable_'+firstid).className="shortContactDivSelected";
              
              document.getElementById('Ccb_'+firstid).checked=true;
              }	
              else
              {
                  document.getElementById('noContactTD').style.display="none";
              
                  document.getElementById('noContactDiv').style.display="";
              document.getElementById('noContactDiv').innerHTML="{cfn:getmessage(66)}";	
              
              }
              
      }
      else
  {
  var no_pages=Math.floor(c_total/size);
  if((c_total%size)!=0)
  no_pages=no_pages+1;

  this[contact]=new Table(name,arry,c_total,20);

  fetchContactAjax(this[contact],pageNo,size,arry,c_total,insrt,name,contact);
  }
  
}

function fetchContactAjax(contact,pageNo,size,fieldz,totl,insrt,name,contactGroup)
{

  document.getElementById("contactDetails").innerHTML="";
      document.getElementById('loadingDiv').style.display="";
  
 
  var currentTime=new Date();
  var crntime=currentTime.getTime();
$.ajax({

type: "GET",cache: false,
url: "{url:(contacts/getcontacts)}/"+name+"/"+contactGroup+"/"+crntime,

success: function(data) {
          var values=new Array(100);
          var x=data;
          if(x=="")
              values="";
          else
              values=x.split("{nesote_c}");
          var number=values.length/11;
              for(var i=0;i<number;i++)
              {
                  var arry=new Array(11);
                  for(var j=0;j<11;j++)
                  {
                      arry[j]=values[j];
                  }
                  
                  values.splice(0,11);	
                  contact.insert(name,insrt,arry,'firstname','asc');
              }
              var opj=contact.getResultPage(name,pageNo,size);
              
              var id=2;var itr=0;
              
              var contactContent="";
              var p=0;
                  document.getElementById('noContactTD').style.display="";
              while(xx=contact.fetchRow(opj))
              {
              
                  var contactId=xx[0];
                  var mailId=xx[1];
                  var contactGroup=xx[2];
                  var firstName=xx[3];
                  var lastName=xx[4];
                  var date_of_birth=xx[5];
                  var title=xx[6];
                  var company=xx[7];
                  var phone=xx[8];
                  if(phone==0)
                  phone="";
                  var address=xx[9];
                  var website=xx[10];
                  contactContent=contactContent+"<table class=\"contactListTable\" id=\"contactListTable_"+contactId+"\" cellpadding=\"0\" cellspacing=\"0\" border=0 ><tr><td style=\"color:#6cc2f0;\" class=\"contactListTD\" valign=\"top\"><span style=\"padding-left:2px;\"><input type=\"checkbox\" id=\"Ccb_"+contactId+"\" onClick=\"contactselection("+contactId+")\" ></span><i class=\"fa c_env fa-envelope\"></i><span style=\"padding-left:5px;\"><a href=\"javascript:contactClick('"+contact+"','"+name+"',"+pageNo+","+size+","+contactId+")\" style=\"\">";
                  
                  if(firstName!="")
                      contactContent=contactContent+""+firstName+"&nbsp;"+lastName+"</a></span></td></tr></table>";
                  else
                      
                  contactContent=contactContent+""+mailId+"</a></td></tr></table>";
                  
                  if(p==0)
                      {
                  var firstid=contactId;
                      if(contactGroup!=-1)
                      {
                          contactidString=contactId+",";
                          var contactdetails="<table style=\"font-size:12px;width:100%;\" cellpadding=\"0\" cellspacing=\"0\" >";
                          contactdetails=contactdetails+"<tr><td colspan=2>&nbsp;</td></tr><tr><td colspan=2  style=\" font-weight: 700;font-size:14px;\">{cfn:getmessage(179)}</td></tr><tr><td colspan=2>&nbsp;</td></tr>";
                          
                          contactdetails=contactdetails+"<tr><td style=\"width:180px;\"><span class=\"\">{cfn:getmessage(40)}</span></td><td style=\"font-size:15px;\"><input type=\"text\" id=\"edit_firstname\" value=\""+firstName+"\" size=\"25\"><span class=\"mandatory\">*</span></td></tr>";
                          contactdetails=contactdetails+"<tr><td colspan=2>&nbsp;</td></tr><tr><td style=\"width:180px;\"><span class=\"\">{cfn:getmessage(41)}</span></td><td style=\"font-size:15px;\"><input type=\"text\" id=\"edit_lastname\" value=\""+lastName+"\" size=\"25\"><span class=\"mandatory\">*</span></td></tr>";
                      contactdetails=contactdetails+"<tr><td colspan=2>&nbsp;</td></tr><tr><td style=\"width:180px;\"><span class=\"\">{cfn:getmessage(42)}</span></td><td><input type=\"text\" id=\"edit_email\" value=\""+mailId+"\" size=\"25\"><span class=\"mandatory\">*</span></td></tr>";
                      
                  
                      contactdetails=contactdetails+"<tr><td colspan=2>&nbsp;</td></tr><tr><td style=\"width:180px;\"><span class=\"\">{cfn:getmessage(43)}</span></td><td><input type=\"text\" id=\"edit_dob\" value=\""+date_of_birth+"\" size=\"25\">&nbsp;{cfn:getmessage(62)}</td></tr>";
                  
                      contactdetails=contactdetails+"<tr><td colspan=2>&nbsp;</td></tr><tr><td style=\"width:180px;\"><span class=\"\">{cfn:getmessage(44)}</span></td><td><input type=\"text\" id=\"edit_title\" value=\""+title+"\" size=\"25\"></td></tr>";
                      
                      contactdetails=contactdetails+"<tr><td colspan=2>&nbsp;</td></tr><tr><td style=\"width:180px;\"><span class=\"\">{cfn:getmessage(45)}</span></td><td><input type=\"text\" id=\"edit_company\" value=\""+company+"\" size=\"25\"></td></tr>";
                  
                      contactdetails=contactdetails+"<tr><td colspan=2>&nbsp;</td></tr><tr><td style=\"width:180px;\"><span class=\"\">{cfn:getmessage(46)}</span></td><td><input type=\"text\" id=\"edit_phone\" value=\""+phone+"\" size=\"25\"></td></tr>";
                      
                      contactdetails=contactdetails+"<tr><td colspan=2>&nbsp;</td></tr><tr><td style=\"width:180px;\"><span class=\"\">{cfn:getmessage(47)}</span></td><td><input type=\"text\" id=\"edit_address\" value=\""+address+"\" size=\"25\"></td></tr>";
                  
                      contactdetails=contactdetails+"<tr><td colspan=2>&nbsp;</td></tr><tr><td style=\"width:180px;\"><span class=\"\">{cfn:getmessage(48)}</span></td><td><input type=\"text\" id=\"edit_website\" placeholder=\"http://www.example.com\" value=\""+website+"\" size=\"25\"></td></tr>";
                      contactdetails=contactdetails+"<tr><td colspan=2>&nbsp;</td></tr><tr><td style=\"width:180px;\"><span class=\"\">{cfn:getmessage(49)} </span></td><td id=\"contact_dropdown\" style=\"padding-left:0px;\">";
                      contactdetails=contactdetails+"<select name=\"edit_group\" id=\"edit_group\" class=\"SelectContact\">";
                      
                      if(contactGroup==0)
                          contactdetails=contactdetails+"<option selected=\"selected\" value=\"0\">{cfn:getmessage(453)}</option>";
                      else
                      {	
                          contactdetails=contactdetails+"<option value=\"0\">{cfn:getmessage(453)}</option>";
                      }
                      if(conatct_drop_down!=0)
                      {
                          for(var y=0;y<(conatct_drop_down.length);y++)
                              {
                              
                                  contactdetails=contactdetails+"<option value=\""+conatct_drop_down[y][0]+"\"";
                                  if(conatct_drop_down[y][0]==contactGroup)
                                      contactdetails=contactdetails+"selected=\"selected\"";
                                  contactdetails=contactdetails+">"+conatct_drop_down[y][1]+"</option>";
                              }
                      }
                          
                          contactdetails=contactdetails+" </select></td></tr>";
                      
                      contactdetails=contactdetails+"<tr><td colspan=2>&nbsp;</td></tr><tr><td>&nbsp;</td><td><input type=\"submit\" onClick=\"javascript:submitEditContact("+contactGroup+")\" value=\"{cfn:getmessage(63)}\" id=\"edit_contactForm\"></td></tr>";
                      
                      contactdetails=contactdetails+"<tr><td colspan=2>&nbsp;</td></tr></table>";
                      contactdetails=contactdetails+"<input type=\"hidden\" id=\"contactid\" value=\""+contactId+"\" >";
                      document.getElementById('contactDetails').innerHTML=contactdetails;
                          
                      }
                      else
                          {
                          var country=xx[6];
                          contactidString=contactId+",";
                          var contactdetails="<table style=\"font-size:12px;width:100%;height:100%;\">";
                          contactdetails=contactdetails+"<tr><td colspan=\"2\"><div style=\"padding: 20px 10px 10px 20px; font-weight: 700;font-size:13px;\">"+firstName+"&nbsp;"+lastName+"</div></td></tr>";
                          
                          contactdetails=contactdetails+"<tr><td colspan=2>&nbsp;</td></tr><tr><td style=\"width:180px;\">{cfn:getmessage(42)}</td><td><span style=\"color: rgb(51, 102, 153);\">"+mailId+"</span></td></tr>";
                      
                      if(date_of_birth!="")
                      contactdetails=contactdetails+"<tr><td colspan=2>&nbsp;</td></tr><tr><td style=\"width:180px;\">{cfn:getmessage(43)}</td><td><span class=\"contactDetails\">"+date_of_birth+"</span></td></tr>";
                      if(country!="")
                      contactdetails=contactdetails+"<tr><td colspan=2>&nbsp;</td></tr><tr><td style=\"width:180px;\">{cfn:getmessage(123)}</td><td><span class=\"contactDetails\">"+country+"</span></td></tr>";
                      
                  
                      contactdetails=contactdetails+"<tr><td colspan=2>&nbsp;</td></tr><tr><td colspan=2>&nbsp;</td></tr><tr><td colspan=2>&nbsp;</td></tr></table>";
                      contactdetails=contactdetails+"";
                      document.getElementById('contactDetails').innerHTML=contactdetails;
                          }
                      }
                  p=p+1;
                  
                  
              }
              
              contactContent=contactContent+"";
              
              
              document.getElementById('contactList').style.display="";
              
              document.getElementById('preloaddiv').style.display="";
              document.getElementById('preloadimage').style.display="none";
              if(p!=0)
              {
          
              document.getElementById('noContactDiv').style.display="none";
              
              document.getElementById('contactList').innerHTML=contactContent;
              document.getElementById('contactListTable_'+firstid).className="shortContactDivSelected";
              document.getElementById('Ccb_'+firstid).checked=true;
              }	
              else
              {
                  document.getElementById('noContactTD').style.display="none";
              
                  document.getElementById('noContactDiv').style.display="";
              document.getElementById('noContactDiv').innerHTML="{cfn:getmessage(66)}";	
              
              }
              document.getElementById('loadingDiv').style.display="none";
      }
  });
}
function contactClick(i,e,b,f,c){i=this[e];for(e=i.getResultPage(e,b,f);xx=i.fetchRow(e);){if(c==xx[0]){var c=xx[0],b=xx[1],d=xx[2],f=xx[3],l=xx[4],j=xx[5],g=xx[6],m=xx[7],k=xx[8];k==0&&(k="");var n=xx[9],o=xx[10];contactidString1=contactidString.replace(",","");var a=Array(1E3);contactidString=contactidString.substring(0,contactidString.length-1);for(var a=contactidString.split(","),p=a.length,h=0;h<p;h++)document.getElementById("Ccb_"+a[h]).checked=!1,document.getElementById("contactListTable_"+
a[h]).className="shortContactDivUnSelected";document.getElementById("contactListTable_"+c).className="shortContactDivSelected";document.getElementById("Ccb_"+c).checked=!0;if(d!=-1){contactidString=c+",";a='<table style="font-size:12px;width:100%;" cellpadding="0" cellspacing="0">';a+='<tr><td colspan=2>&nbsp;</td></tr><tr><td colspan=2  style=" font-weight: 700;font-size:14px;">{cfn:getmessage(179)}</td></tr><tr><td colspan=2>&nbsp;</td></tr>';a=a+'<tr><td style="width:180px;"><span class="">{cfn:getmessage(40)}</span></td><td style="font-size:15px;"><input type="text" id="edit_firstname" value="'+f+'" size="25"><span class="mandatory">*</span></td></tr>';a=a+'<tr><td colspan=2>&nbsp;</td></tr><tr><td style="width:180px;"><span class="">{cfn:getmessage(41)}</span></td><td style="font-size:15px;"><input type="text" id="edit_lastname" value="'+l+'" size="25"><span class="mandatory">*</span></td></tr>';a=a+'<tr><td colspan=2>&nbsp;</td></tr><tr><td style="width:180px;"><span class="">{cfn:getmessage(42)}</span></td><td><input type="text" id="edit_email" value="'+b+'" size="25"><span class="mandatory">*</span></td></tr>';
a=a+'<tr><td colspan=2>&nbsp;</td></tr><tr><td style="width:180px;"><span class="">{cfn:getmessage(43)}</span></td><td><input type="text" id="edit_dob" value="'+j+'" size="25">&nbsp;{cfn:getmessage(62)}</td></tr>';a=a+'<tr><td colspan=2>&nbsp;</td></tr><tr><td style="width:180px;"><span class="">{cfn:getmessage(44)}</span></td><td><input type="text" id="edit_title" value="'+g+'" size="25"></td></tr>';a=a+'<tr><td colspan=2>&nbsp;</td></tr><tr><td style="width:180px;"><span class="">{cfn:getmessage(45)}</span></td><td><input type="text" id="edit_company" value="'+m+'" size="25"></td></tr>';a=a+'<tr><td colspan=2>&nbsp;</td></tr><tr><td style="width:180px;"><span class="">{cfn:getmessage(46)}</span></td><td><input type="text" id="edit_phone" value="'+k+'" size="25"></td></tr>';a=a+'<tr><td colspan=2>&nbsp;</td></tr><tr><td style="width:180px;"><span class="">{cfn:getmessage(47)}</span></td><td><input type="text" id="edit_address" value="'+n+'" size="25"></td></tr>';a=a+'<tr><td colspan=2>&nbsp;</td></tr><tr><td style="width:180px;"><span class="">{cfn:getmessage(48)}</span></td><td><input type="text" id="edit_website" placeholder="http://www.example.com" value="'+
o+'" size="25"></td></tr>';a+='<tr><td colspan=2>&nbsp;</td></tr><tr><td style="width:180px;"><span class="">{cfn:getmessage(49)} </span></td><td id="contact_dropdown" style="padding-left:0px;">';a+='<select name="edit_group" id="edit_group" class="SelectContact">';a+=d==0?'<option selected="selected" value="0">{cfn:getmessage(453)}</option>':'<option value="0">{cfn:getmessage(453)}</option>';if(conatct_drop_down!=0)for(b=0;b<conatct_drop_down.length;b++)a=a+'<option value="'+conatct_drop_down[b][0]+'"',conatct_drop_down[b][0]==d&&(a+='selected="selected"'),a=a+">"+conatct_drop_down[b][1]+"</option>";a+=" </select></td></tr>";a=a+'<tr><td colspan=2>&nbsp;</td></tr><tr><td>&nbsp;</td><td><input type="submit" onClick="javascript:submitEditContact('+d+')" value="{cfn:getmessage(63)}"></td></tr>';a+="<tr><td colspan=2>&nbsp;</td></tr></table>";a=a+'<input type="hidden" id="contactid" value="'+c+'" >'}else contactidString=c+",",g=xx[6],a='<table style="font-size:12px;width:100%;">',a=a+'<tr><td colspan="2"><div style="padding: 20px 10px 10px 20px; font-weight: 700;font-size:13px;">'+f+"&nbsp;"+l+"</div></td></tr>",a=a+'<tr><td colspan=2>&nbsp;</td></tr><tr><td style="width:180px;">{cfn:getmessage(42)}</td><td><span style="color: rgb(51, 102, 153);">'+b+"</span></td></tr>",j!=""&&(a=a+'<tr><td colspan=2>&nbsp;</td></tr><tr><td style="width:180px;">{cfn:getmessage(43)}</td><td><span class="contactDetails">'+j+"</span></td></tr>"),g!=""&&(a=a+'<tr><td colspan=2>&nbsp;</td></tr><tr><td style="width:180px;">{cfn:getmessage(123)}</td><td><span class="contactDetails">'+g+"</span></td></tr>"),a+="</table>",a+="";document.getElementById("contactDetails").innerHTML=""}document.getElementById("contactListTable_"+c).className="shortContactDivSelected"}document.getElementById("contactDetails").innerHTML=a;d!=-1&&document.getElementById("edit_firstname").focus()};

var filevar_c=0;
var deletevar_c=0;


function getNewContactFolders()
{

  var currentTime=new Date();
  var crntime=currentTime.getTime();
  $.ajax({

type: "GET",cache: false,
url: "{url:(contacts/folderdropdown)}/"+crntime,

success: function(data) {
              var x=data;
              document.getElementById("contact_dropdown").innerHTML=x;
              
          }
      });
}
function submitNewContact(){
      var tot_c={$gpcount};
      var firstname=trim(document.getElementById("cfirstname").value);
      if(firstname==""||firstname=="null")
      {
          var msg="{cfn:getmessage(112)}";
          alert(msg);document.getElementById("cfirstname").focus();return 0;
      }
      var lastname=trim(document.getElementById("clastname").value);
      if(lastname==""||lastname=="null")
      {
          var msg="{cfn:getmessage(113)}";
          alert(msg);document.getElementById("clastname").focus();return 0;
      }
      var email=trim(document.getElementById("cemail").value);
      
      if(email=="")
      {
          var msg="{cfn:getmessage(224)}";
          alert(msg);document.getElementById("cemail").focus();return 0;
      }
      var dob=trim(document.getElementById("cdob").value);
      if(dob=="null")
       { dob="";}
      var e=checkemail(email);
      if(!e)
      {
          var msg="{cfn:getmessage(225)}";
          alert(msg);document.getElementById("cemail").focus();return 0;
      }
      var title=trim(document.getElementById("ctitle").value);
if(title=="null")
{
  title="";
}
      
      var company=trim(document.getElementById("ccompany").value);
      
if(company=="null")
{
company="";
}

      var phone=trim(document.getElementById("cphone").value);

if(phone=="null")
{
  phone="";
} 

     if(phone!="")
      {
          if(isNaN(phone))
          {
              var msg="{cfn:getmessage(226)}";
              alert(msg);document.getElementById("cphone").focus();return 0;
              
          }
      }
      var website=trim(document.getElementById("cwebsite").value);
if(website=="null")  
 website="";	
  if(document.getElementById("cgroup"))
      group=document.getElementById("cgroup").value;

if(group=="null")
group=0;

      var address=document.getElementById("caddress").value;
       
if(address=="null")
address="";
if(group==0)
           var s="mycontacts";
       else
           var s=group;
       var avl=isArrayAvailable(s);
       if(avl)
       {
          
           var  contact4=this[s];
      
       }
      var currentTime=new Date();
      var crntime=currentTime.getTime();
      $.ajax({

type: "POST",cache: false,
url: "{url:(contacts/newcontact)}",
data: "firstname="+firstname+"&lastname="+lastname+"&email="+email+"&dob="+dob+"&title="+title+"&company="+company+"&phone="+phone+"&website="+website+"&group="+group+"&address="+address,
success: function(data) {
              var x=data;
                res=x.split("||");
               var  message=res[0];
               var c_flag=res[1];
               c_total=res[2];
               var id=res[3];
               var arry1=new Array(11);
                  arry1[0]=id;
                  arry1[1]=email;
                  arry1[2]=group;
                  arry1[3]=firstname;
                  arry1[4]=lastname;
                  arry1[5]=dob;
                  arry1[6]=title;
                  arry1[7]=company;
                  arry1[8]=phone;
                  arry1[9]=address;
                  arry1[10]=website;
                   new_contact_add=1;
              
                    if(c_flag==0)
                   { 
                  
                    //document.getElementById("messages").style.display="";
               //document.getElementById("message_mail").innerHTML=message;
               //toastr.info(message);
               notify_display(message,"info");
               //setTimeout("hideconatctmessage()",5000);
                   }
               if(c_flag==1)
                   { 
                  
                   //document.getElementById("messages").style.display="";
               //document.getElementById("message_mail").innerHTML=message;
               //toastr.info(message);
               notify_display(message,"info");
               //setTimeout("hideconatctmessage()",5000);
                      var arry=new Array(11);
                      arry[0]=id;
                      arry[1]=email;
                      arry[2]=group;
                      arry[3]=firstname;
                      arry[4]=lastname;
                      arry[5]=dob;
                      arry[6]=title;
                      arry[7]=company;
                      arry[8]=phone;
                      arry[9]=address;
                      arry[10]=website;
                      
                   if(group==0)
                       {
                      
                      
                       contact4.insert('mycontacts',2,arry1,'firstname','asc');
                      
                       contact4.totl2=parseInt(contact4.totl2)+parseInt(1);
                       
                          var tocontactNo=getCookievalue("mycontacts");
                          tocontactNo++;
                          SetCookie("mycontacts",tocontactNo,1);
                          mainContactWindow('mycontacts',1,c_total,c_total,2,0);
                       }
                   else
                       {
                       var tocontactNo=getCookievalue("cont_"+group);
                          tocontactNo++;
                          SetCookie("cont_"+group,tocontactNo,1);
                          var avl=isArrayAvailable(s);
                           if(avl)
                           {
                       contact4.insert(group,2,arry,'firstname','asc');
                           }
                           var f_name=getContactName(group);
                          mainContactWindow(group,1,c_total,c_total,2,f_name);
                       }
                   }
      }
      });
  };
function submitEditContact(f){var k=trim(document.getElementById("edit_firstname").value);if(k==""||k=="null"){var t;alert("{cfn:getmessage(112)}");document.getElementById("edit_firstname").focus();return 0}var l=trim(document.getElementById("edit_lastname").value);if(l==""||l=="null")return alert("{cfn:getmessage(113)}"),document.getElementById("edit_lastname").focus(),0;var i=trim(document.getElementById("edit_email").value);if(i==""||i=="null")return alert("{cfn:getmessage(224)}"),document.getElementById("edit_email").focus(),0;var o=trim(document.getElementById("edit_dob").value);
if(!checkemail(i))return alert("{cfn:getmessage(225)}"),document.getElementById("edit_email").focus(),0;var p=trim(document.getElementById("edit_title").value),q=trim(document.getElementById("edit_company").value);
var m=trim(document.getElementById("edit_phone").value);
if(m!=""||m!="null"){if(isNaN(m)){alert("{cfn:getmessage(226)}");document.getElementById("edit_phone").focus();return 0;}}

var r=trim(document.getElementById("edit_website").value),d=document.getElementById("edit_group").value,s=trim(document.getElementById("edit_address").value),h=document.getElementById("contactid").value,e=this[f==0?"mycontacts":f],j=d==0?"mycontacts":d;if(isArrayAvailable(j))var g=this[j];(new Date).getTime();$.ajax({type:"POST",cache:!1,url:"{url:(contacts/editcontact)}",data:"firstname="+k+"&lastname="+l+"&email="+i+"&dob="+o+"&title="+p+"&company="+q+"&phone="+m+"&website="+r+"&group="+d+"&address="+s+"&cid="+h,success:function(n){res=n.split("||");
if(k===null){k="";}if(l===null){l="";}if(o===null){o="";}if(p===null){p="";}if(q===null){q="";}if(m===null){m="";}if(r===null){r="";}if(s===null){s="";}

var n=res[0],b=res[1];c_total=res[2];var a=Array(11),c=Array(11);a[0]="id";a[1]="mailid";a[2]="conatctgroup";a[3]="firstname";a[4]="lastname";a[5]="date_of_birth";a[6]="title";a[7]="company";a[8]="phone";a[9]="address";a[10]="website";c[0]=h;c[1]=i;c[2]=d;c[3]=k;c[4]=l;c[5]=o;c[6]=p;c[7]=q;c[8]=m;c[9]=s;c[10]=r;if(b==1)if(f==0){if(f==d)b=Array(1),b[0]=h,e.update("mycontacts",a,c),e.where("id=?",b),e.action();else if(b=Array(1),b[0]=h,e.deleteEntry("mycontacts"),e.where("id=?",b),e.action(),b=getCookievalue("mycontacts"),a=getCookievalue("cont_"+d),b--,a++,SetCookie("mycontacts",b,1),SetCookie("cont_"+d,a,1),a=isArrayAvailable(j),a==1)g.insert(d,
2,c,"firstname","asc"),g.totl2=parseInt(g.totl2)+1;mainContactWindow("mycontacts",1,c_total,c_total,2,0)}else{if(f==d)b=Array(1),b[0]=h,e.update(f,a,c),e.where("id=?",b),e.action();else if(b=Array(1),b[0]=h,e.deleteEntry(f),e.where("id=?",b),e.action(),b=getCookievalue(f),d==0?(a=getCookievalue("mycontacts"),a++,SetCookie("mycontacts",a,1)):(a=getCookievalue("cont_"+d),a++,SetCookie("cont_"+d,a,1)),b--,SetCookie("cont_"+f,b,1),a=isArrayAvailable(j),a==1)d!=0?g.insert(d,2,c,"firstname","asc"):g.insert("mycontacts",
2,c,"firstname","asc"),g.totl2=parseInt(g.totl2)+1;mainContactWindow(f,1,c_total,c_total,2,0)}notify_display(n,"info");}})};
function backref(back_refernces)
{
$.ajax({

type: "GET",cache: false,
url: "{url:(mail/backreferences/)}"+back_refernces,
async: false,

success: function(data) 
{
 backref_string=data;
return backref_string;
  }
  });

}



function moveTo(destination)
{   
 var inbxobj=this['inbox'];
 var sntobj=this['sent'];
     var spmobj=this['spam'];          
     var trshobj=this['trash'];
     var urdhobj=this['unread'];
 var currentTime=new Date();
 var crntime=currentTime.getTime();
 
  var cstfolcnt=customFoldercount-1;
  var cstfolcnt1=cstfolcnt-5;
 

     var cstfolarr=new Array(cstfolcnt1);
     if(cstfolcnt1>0)
     {
     var o=0;
 for(var j=cstfolcnt;j>5;j--)
 {

  cstfolarr[j]=this[Unread[j][0]];
   o++;

     }
     
     }
    
  
  
  moveflag=0;
  document.getElementById("moveto2").style.display="none";
  
  var zz=idz.split(":");
  var asd=zz[1].split(",");
  var idstring1="";//alert("iii"+asd);
  for(i=0;i<(asd.length);i++)
  {
      var asdf=asd[i].split("&");
      if(asdf[2]!='starred')
      {	
                  
          if(document.getElementById('twopaneMail_'+asdf[0]))
          {
                          document.getElementById('twopaneMail_'+asdf[0]).style.display="none";
          }
          var crnt_cookie=getCookievalue(asdf[2]);
          crnt_cookie1=parseInt(crnt_cookie)-parseInt(1);
          SetCookie(asdf[2],crnt_cookie1,1);
         
          var hhh=this[asdf[2]].getResultItem(asdf[2],asdf[0]);
          var aaw=this[asdf[2]].fetchRow(hhh);
          if(aaw[7]==0)
          {
              if((asdf[2]!='sent')&&(asdf[2]!='draft')&&(asdf[2]!='trash')&&(asdf[2]!='starred'))
              {
                  for(var urdcnt=0;urdcnt<customFoldercount;urdcnt++)
                  {
                      if(Unread[urdcnt][0]==asdf[2])
                      Unread[urdcnt][1]=parseInt(Unread[urdcnt][1])-parseInt(1);
                  }
              }
          }
          
          var all_objects=asdf[5].split(".");
          for(var k=0;k<(all_objects.length-1);k++)
          {
          var all_obj=all_objects[k].split("_");
          var id1=new Array(1);
          id1[0]=all_obj[1];
          if(isArrayAvailable(all_obj[0]))
          {
          this[all_obj[0]].deleteEntry(all_obj[0]);
          this[all_obj[0]].where('id=?',id1);
          this[all_obj[0]].action();
          }
          
          }
          
      }
      if(idstring1=="")
      idstring1=asdf[0]+"?"+asdf[2];
      else
      idstring1=idstring1+","+asdf[0]+"?"+asdf[2];
  }
  setUnreadcount();
    
  if(asdf[2]=="spam" )
  {
  backref(idstring1);
  var destination="";
  
  } 
  
  
 if((asdf[2]=="spam"))
 url="mailid="+idstring1+"&foldernane="+asdf[2]+"&tofoldernane="+destination+"&backref_string="+backref_string;
 else
 url="mailid="+idstring1+"&foldernane="+asdf[2]+"&tofoldernane="+destination;
          
  var currentTime=new Date();
  var crntime=currentTime.getTime();
  
  $.ajax({

type: "POST",cache: false,
url: "{url:(mail/moveto/)}",
data: url,

success: function(data) {
    
          var x=data;
          if(x!="")
          {  
            
            var items=x.split("{nesote_separator}");
            for(var i=0;i<(items.length);i++)
            {
            
            var x4=items[i].split("{nesote_:}");
            var arry=new Array(14);
              for(var j=0;j<16;j++)
              {
                  var x3=x4[0].split("{nesote_,}");
                  arry[j]=x3[j];
              }
              if(x3[12]=="inbox")
              {
              
              var nam=inbxobj;
              Unread[0][2]=1;
              
              var numbr=getCookievalue(x3[12]);
                   numbr=parseInt(numbr)+parseInt(1);
                   SetCookie(x3[12],numbr,1);
              
              }
              else if(x3[12]=="sent")
              {
              var nam=sntobj;
              Unread[2][2]=1;
              var numbr=getCookievalue(x3[12]);
                   numbr=parseInt(numbr)+parseInt(1);
                   SetCookie(x3[12],numbr,1);
              }

              else if(x3[12]=="spam")
              {
              var nam=spmobj;
              Unread[3][2]=1;
                  var numbr=getCookievalue(x3[12]);
                   numbr=parseInt(numbr)+parseInt(1);
                   SetCookie(x3[12],numbr,1);
              }
              else 
              {
              for(var w=cstfolcnt;w>5;w--)
                    {
                 
                         if(x3[12]==Unread[w][0])
                         {
                         for(var urdcnt=0;urdcnt<customFoldercount;urdcnt++)
              {
                  if((Unread[urdcnt][0]==Unread[w][0]))
                  
                  {
                  Unread[urdcnt][2]=1;
                  var numbr=getCookievalue(x3[12]);
                   numbr=parseInt(numbr)+parseInt(1);
                   SetCookie(x3[12],numbr,1);
                  break;
                  }
              }
                          var cus_obj=cstfolarr[w];
                          var nam=cus_obj;
                          
                           o++;
                          }
                          }
              }
              
      
          if(x3[7]==0)
          {
              if((x3[12]!='sent')&&(x3[12]!='draft')&&(x3[12]!='trash')&&(x3[12]!='starred'))
              {
                  for(var urdcnt=0;urdcnt<customFoldercount;urdcnt++)
                  {
                      if(Unread[urdcnt][0]==x3[12])
                      Unread[urdcnt][1]=parseInt(Unread[urdcnt][1])+parseInt(1);
                  }
              }
          }
              setUnreadcount();
            }
          
           
           
            if(destination.substring(0,6)=="custom")
              {
                  {loopstart:customfolders:1000}
                  if(destination.substring(6)=='{$customfolders[0]}')
                  destination='{$customfolders[1]}'
                  {loopend:customfolders}
              }
              
              var noz=items.length;
              if((noz==1)&&(destination!=""))
              {
              var message="{cfn:getmessage(447)} "+destination;
              }
              else if((noz>1)&&(destination!=""))
              {
              var message="{cfn:getmessage(460)} "+destination;
              }
              else if((noz==1)&&(destination==""))
              {
              var message="{cfn:getmessage(662)}";
              }
              else if((noz>1)&&(destination==""))
              {
              var message="{cfn:getmessage(660)}";
              }
              
              //document.getElementById("messages").style.display="";
              //document.getElementById("message_mail").innerHTML=message;
                             
              //setTimeout("hidemailmessage()",5000);
            //Toast Messages.
            //toastr.info(message);
              notify_display(message,"info");
            
             
             
          }
          else
          {
              alert("{cfn:getmessage(448)}");
          }
          
            mainWindow(asdf[2],asdf[1],mailsPerpage,crnt_cookie1,2);
      }
              
   });
}

function deletemail(id)
{ 
moveflag=0;
document.getElementById("moveto2").style.display="none";
var zz=idz.split(":");//alert(idz);
var asd=zz[1].split(",");
var delcnt=asd.length;
var idstring1="";
for(i=0;i<asd.length;i++)
{
var asdf=asd[i].split("&");

var hhh=this[asdf[2]].getResultItemM(asdf[2],asdf[0],asdf[1],mailsPerpage);
var aaw=this[asdf[2]].fetchRow(hhh);
if(aaw[7]==0||asdf[2]=="draft")
if(asdf[2]!="sent"&&asdf[2]!="trash"&&asdf[2]!="starred")
for(var urdcnt=0;urdcnt<customFoldercount;urdcnt++)
if(Unread[urdcnt][0]==asdf[2])Unread[urdcnt][1]=parseInt(Unread[urdcnt][1])-parseInt(1);

          var all_objects=asdf[5].split(".");
          var obj_length=all_objects.length;
          if(obj_length>1)
          obj_length=obj_length-1;
       
          for(var k=0;k<obj_length;k++)
          {
          var all_obj=all_objects[k].split("_");
          var id1=new Array(1);
          id1[0]=all_obj[1];
          if(isArrayAvailable(all_obj[0]))
          {
          this[all_obj[0]].deleteEntry(all_obj[0]);
          this[all_obj[0]].where('id=?',id1);
          this[all_obj[0]].action();
          }
          
          }

var current_view=getCookievalue("current_view");
if(current_view=="2pane")
{	
   if(document.getElementById("twopaneMail_"+asdf[0]))
   {
     document.getElementById("twopaneMail_"+asdf[0]).style.display="none";
   }
}
else
{
	if(document.getElementById("threepaneMail_"+asdf[0]))
	   {
	     document.getElementById("threepaneMail_"+asdf[0]).style.display="none";
	   }
	if(document.getElementById("msg_display").innerHTML)
		{
		document.getElementById("msg_display").innerHTML="<div class=\"warning_message_Txt\">{cfn:getmessage(776)}</div><div class='warning_message_Txt_sec'>{cfn:getmessage(777)}</div><div id='footer_txt_id1' class='footer_txt_new'>{$footer}{if($memoryusage_publicview_area==1)}<br><br>{$memorymsg}{endif}</div></div>";
		}
	
}
var crnt_cookie=getCookievalue(asdf[2]);
crnt_cookie1=parseInt(crnt_cookie)-parseInt(1);
SetCookie(asdf[2],crnt_cookie1,1);
if(idstring1=="")
idstring1=asdf[0]+"?"+asdf[2];
else
idstring1=idstring1+","+asdf[0]+"?"+asdf[2];
}
setUnreadcount();

var obj=this["trash"];
var currentTime=new Date;var crntime=currentTime.getTime();
var crtfild=asdf[2];
var object=this[asdf[2]];

if(id==0)
var tofolder="";//for discard drafts

if(id==1)//move to trash
var url="mailid="+idstring1+"&foldernane="+asdf[2]+"&tofoldernane=trash";
else if(id==0)//discard drafts
var url="mailid="+idstring1+"&foldernane="+asdf[2]+"&tofoldernane="+tofolder;
$.ajax({type:"POST",cache:false,
url:"{url:(mail/moveto/)}",
data:url,
success:function(data)
{
mainWindow(asdf[2],asdf[1],mailsPerpage,crnt_cookie1,2);
var x=data;
var items=x.split("{nesote_separator}");
if(asdf[2]!="trash")
{
  for(var i=0;i<(items.length);i++)
     {
            
            var x4=items[i].split("{nesote_:}");
            var arry=new Array(14);
              for(var j=0;j<16;j++)
              {
                  var x3=x4[0].split("{nesote_,}");
                  arry[j]=x3[j];
              }	
                                      
              if(x3[12]=="trash")
              {
              var nam=obj;
              Unread[4][2]=1;
              }
              if(isArrayAvailable(x3[12]))
              {		
              nam.insert(x3[12],2,arry,'time_int','desc');
              nam.totl2=parseInt(nam.totl2)+parseInt(1);
             var x5=x4[1].split("{nesote_ref}");
             nam.sortnew(nam,2,arry,'time','desc');
              for(var i1=0;i1<x3[13];i1++)
              {
                  for(var i2=0;i2<19;i2++)
                  {
                      var x6=x5[i1].split("{nesote_,}");
                      x6[i2]=x6[i2];										
                  }
                  
                  var namez=x6[17];
                  insertArray(namez,x6,x3[13]);
              
              }
              }
              var objCount=getCookievalue("trash");
              objCount=parseInt(objCount)+parseInt(items.length);
              }

var objCount=getCookievalue("trash");
objCount=parseInt(objCount)+parseInt(items.length);
SetCookie("trash",objCount,1)
}
var noz=items.length;
if((crtfild=="trash")||(crtfild=="draft"))
if(delcnt==1)var message="{cfn:getmessage(477)}";
else 
var message="{cfn:getmessage(476)}";
else if(noz==1)
var message="{cfn:getmessage(446)}";
else var message="{cfn:getmessage(459)}";
//document.getElementById("messages").style.display="";
//document.getElementById("message_mail").innerHTML=message;setTimeout("hidemailmessage()",5E3)
//toastr.info(message);
notify_display(message,"info");
}})};
var c_filevar=0;
var c_deletevar=0;


function addcontactgroupfn(evt,value,id,flag)
{

  var executevalue=2;
  var n=1;
  var c_filevartemp=c_filevar-1;
      
          var charcode= (evt.which) ? evt.which : event.keyCode;
          if(charcode==13)
          {
          if(value!="")
          {
            if(flag==2)
            {
               var url1="{url:(contacts/editfolder/)}"+id+"/"+value;	//alert(url1);
               var s="editC"+id;

  
  document.getElementById(s).style.display="none";
               
            }
            else
            {
              Conatctblurfn();
                  
               if(flag==1)
                  {
                   var folder=getCookievalue("currentcontact");
                   var url1="{url:(contacts/newgroup/)}"+value+"/"+contactidString+"/"+folder;
                  }
               if(flag==0)
                  {
                      var url1="{url:(contacts/newgroup/)}"+value;
                  }
            }
            var folder=getCookievalue("currentcontact");
          if(folder==0)
              {
                  var objct=this["mycontacts"];
                  size=getCookievalue("mycontacts");
              }
          else if(folder==-1)
              {
                  var objct=this["global"];
                  size=getCookievalue("globalcontacts");
              }
          else
              {
                  var objct=this[folder];
                  size=getCookievalue("cont_"+folder);
              }
               
              if((folder!=-1 || folder!=0) && flag!=2 )
              {
                n=0;
              }
        else if((folder!=-1 && folder!=0 && flag==2 ))
        {
           n=0;
        }
       
        if(n==0)
        {
        
        $.ajax({

type: "GET",cache: false,
url: url1,

success: function(data) {
              var t=data;
                  if(flag!=2)
                  {
                      var ar=new Array(1000);
                       ar=t.split("/");	var mes=ar[2];
                       var newF=ar[0];
                        newF=newF.replace(/^[\s]+/,'').replace(/[\s]+$/,'').replace(/[\s]{2,}/,' ');//for trimming 
                       if(newF!=0)
                       { flag=2;//reset Flag for editing later.
                          cid=newF;
                       
           contactidString="";
                          var contentDiv="<div style=\"clear:both\"></div><div id=\"spC"+cid+"\" ><a class='cg_href' href=\"javascript:mainContactWindow("+newF+",1,0,0,2,'"+value+"')\" title=\""+value+"\" onMouseOver=\"showeditImageC("+cid+")\" onMouseOut=\"hideeditImageC("+cid+")\" >	<span   class=\"abc\" id=\"custom"+cid+"_name\"><i class='fa fa-users'></i>"+value+"<span    id=\"custom"+cid+"_count\"> </span></span>";
                      
                       contentDiv=contentDiv+"<span  style=\"display:none;\"  id=\"editimageC"+cid+"\" onClick=\"editgropufnC("+cid+")\" class=\"editBtn\"><img  src=\"images/filler.gif\" alt=\" \"  class=\"iconsCornner arrow-d\" title=\"{cfn:getmessage(26)}\" border=\"0\" align=\"absmiddle\"> </span> </a> </div>";
                  
             contentDiv=contentDiv+"<div id=\"editC"+cid+"\" style=\"display: none;float:left;padding-left:25px;padding-right:0px;width:100%; height:26px; background-color:#B6D8F5\"><input    type=\"text\" id=\"editgroupnameC"+cid+"\"  name=\"editgroupnameC"+value+"\"   value=\""+value+"\"  onKeyUp=\"addcontactgroupfn(event,this.value,"+cid+","+flag+")\"  onBlur=\"ConatctblurfnE("+cid+")\" maxlength='12' size=\"15\" align=\"absmiddle\" style=\"height:26px;\"></div> ";
                  
                   
                       new_contact_gp_add=1;
                          var FID1="C_filedivcontainer"+c_filevar;
                      
                      var container = document.getElementById('C_customfolders');
                  
                       var new_element = document.createElement('li');
                       new_element.setAttribute('id', newF);
                       new_element.innerHTML = contentDiv;
                      
                       var pos1=parseInt(c_cpcount)+parseInt(1);
                       //container.insertBefore(new_element, container.getElementsByTagName("li")[pos1]);
                      container.appendChild(new_element);
                      
                  
                       var values=new Array(1000);
                       values=contactidString.split(",");
                       arrylen=(values.length)-1;
                       c_cpcount++;
                       
                          
                       contactidString="";
                
                       var v=conatct_drop_down.length;
                           conatct_drop_down[v]=new Array(2);
                      if(flag==0)
                      {
                  
                      ConatctblurfnE(newF);
                      SetCookie("cont_"+newF,0,1);
                      conatct_drop_down[v][0]=newF;
                      conatct_drop_down[v][1]=value;
                      conatct_drop_down[v][2]=0;
                       mainContactWindow(newF,1,arrylen,arrylen,2,value);
                       }
                       if(flag==1)
                      {
                      var size1=ar[3];
                      ConatctblurfnE(newF);
                      SetCookie("currentcontact",newF,1);
                      conatct_drop_down[v][0]=newF;
                      conatct_drop_down[v][1]=value;
                      conatct_drop_down[v][2]=size1;
                      SetCookie("cont_"+newF,size1,1);
                       mainContactWindow(newF,1,size1,size1,2,value);
                       }
                       }
                  }
                  else
                  {
                      var ar=new Array(1000);
                       ar=t.split("/");	
                       var mes=ar[2];
                       var newF=ar[0];
                        newF=newF.replace(/^[\s]+/,'').replace(/[\s]+$/,'').replace(/[\s]{2,}/,' ');//for trimming 
                       if(newF!=0)
                       {
                          cid=newF;
                  
               document.getElementById("spC"+cid).innerHTML="<a class='cg_href' href=\"javascript:mainContactWindow("+newF+",1,0,0,2,'"+value+"')\" title=\""+value+"\" onMouseOver=\"showeditImageC("+cid+")\" onMouseOut=\"hideeditImageC("+cid+")\" >	<span   class=\"abc\" id=\"custom"+cid+"_name\"><i class='fa fa-users'></i>"+value+"<span    id=\"custom"+cid+"_count\"> </span></span><span  style=\"display:none;\"  id=\"editimageC"+cid+"\" onClick=\"editgropufnC("+cid+")\" class=\"editBtn\"><img     src=\"images/filler.gif\" alt=\" \"  class=\"iconsCornner arrow-d\" title=\"{cfn:getmessage(26)}\" border=\"0\" align=\"absmiddle\"> </span> </a>";
               document.getElementById("editC"+cid).innerHTML="<input    type=\"text\" id=\"editgroupnameC"+cid+"\"  name=\"editgroupnameC"+cid+"\"   value=\""+value+"\"  onKeyUp=\"addcontactgroupfn(event,this.value,"+cid+","+flag+")\"      onBlur=\"ConatctblurfnE("+cid+")\" maxlength='12' size=\"15\" align=\"absmiddle\" style=\"height:26px;\">";
document.getElementById("editC"+cid).style.display="none";
               
                      
                       new_contact_gp_add=1;
                              var FID1="C_filedivcontainer"+filevar;
                      
                      // document.getElementById(newF).innerHTML=contentDiv;
                       
                       ConatctblurfnE(newF);
                       SetCookie("currentcontact",newF,1);
                      var size1=getCookievalue("cont_"+newF);

                      for(var y=0;y<(conatct_drop_down.length);y++)
                      {
                      if(conatct_drop_down[y][0]==newF)
                      conatct_drop_down[y][1]=value;
                      }
                       mainContactWindow(newF,1,size1,size1,2,value);
                  
                  }
                  }
                      //document.getElementById("messages").style.display="";
                        //   document.getElementById("message_mail").innerHTML=mes;
              // toastr.info(mes);
              notify_display(mes,"info");  
              // setTimeout("hideconatctmessage()",5000);
            }		  
      });
        }
 }
 else
 {
// document.getElementById("messages").style.display="";
 //document.getElementById("message_mail").innerHTML="{cfn:getmessage(325)}";
// toastr.info("{cfn:getmessage(325)}");
 notify_display("{cfn:getmessage(325)}","info");

 //setTimeout("hideconatctmessage()",5000);
 }
}
}


function contactMorefn()
{
  if(contact_moreaction==1)
  {
  
      var str=contactidString;
      currentfolder=getCookievalue("currentcontact");
      
      if(currentfolder==-1)
          execute=1;
      else
          execute=0;
          $.ajax({

type: "GET",cache: false,
url: "{url:(contacts/getcontactdropdown/)}"+str+"/"+currentfolder+"/"+execute,

success: function(data) {
          document.getElementById("contact_more_div").style.display="";
          
          var x=data;
          var s=x.split('///');
          var string=s[0];
          var mailid=s[1];
          document.getElementById("contact_more_div").innerHTML=string;
          }
      });
} 
  
}

function changefn(execute,groupid)
{
  //execte 1 for add to,0 for remove from
  var folder=getCookievalue("currentcontact");
  if(folder==-1)
      globalornot=1;
  else
      
      globalornot=0;
      
      if(groupid==0)
      var to_folder="mycontacts";
      else if(groupid==-1)
      var to_folder="global";
      else
      var to_folder=groupid;
      
      
      var avail=isArrayAvailable(to_folder);
      if(avail==1)
      {
          if(groupid==0)
          var contact5=this['mycontacts'];
          else if(groupid==-1)
              var contact5=this['global'];
          else if(groupid!=0)
              var contact5=this[groupid];
      }
      
      if(folder==0)
      var crnt_folder="mycontacts";
      else if(folder==-1)
      var crnt_folder="global";
      else
      var crnt_folder=folder;
      
      var avail1=isArrayAvailable(crnt_folder);//alert(avail1);
      if(avail1==1)
      {
      if(folder==0)
          var contact3=this['mycontacts'];
          else if(folder==-1)
              var contact3=this['global'];
          else if(folder!=0)
              var contact3=this[folder];
          
      }
      
      var rmflag=0;
      if(execute==0)
      {
          if(to_folder!=crnt_folder)
          { 
          rmflag=1;
          Values=contactidString.split(",");
          var Arrylen=(Values.length);
          var Arry1=new Array(11);var mailid_contact="";
           for(var y=0;y<Arrylen;y++)
          {
          if(Values[y]!="")
          {
                 var h=contact3.getResultItem(crnt_folder,Values[y]);
                 var xx=contact3.fetchRow(h);        				 								 					
              mailid_contact+=xx[1]+",";
                  
            }
          }
          contactidString=mailid_contact;
      }	
  }
      
     $.ajax({

type: "GET",cache: false,
url: "{url:(contacts/addorremovegroup/)}"+groupid+"/"+contactidString+"/"+execute+"/"+folder+"/"+globalornot+"/"+rmflag,

success: function(data) {
           var text=data;
           
           var values=text.split('/');
            var gid=values[0]; var mailid=values[1]; var flag=values[2];
            var msg=values[3];var execute=values[4];var p=0;
            var groupName=values[5];
            var values=new Array(1000);
            contactidString=contactidString.substring(0,(contactidString.length)-1);
               values=contactidString.split(",");
               var arrylen=(values.length);
               var arry1=new Array(11);
               
              var crnt_value_to=getCookievalue("cont_"+groupid);
              var crnt_value_from=getCookievalue("cont_"+folder);
               contactidString="";
          
              if(execute==1)
              {
                       if(avail==1) //tofolder
                      {
                           for(var y=0;y<arrylen;y++)
                           { 
                           if(values[y]!="")
                              { 
                          if(avail1==1)//current folder
                              {  
                                      var h=contact3.getResultItem(crnt_folder,values[y]);
                                          
                                  
                                          xx=contact3.fetchRow(h);//alert(xx);
                                          arry1[0]=xx[0];
                                          arry1[1]=xx[1];
                                          arry1[2]=xx[2];
                                          arry1[3]=xx[3];
                                          arry1[4]=xx[4];
                                          arry1[5]=xx[5];
                                          arry1[6]=xx[6];
                                          arry1[7]=xx[7];
                                          arry1[8]=xx[8];
                                          arry1[9]=xx[9];
                                          arry1[10]=xx[10];
                                      contact5.insert(groupid,2,arry1,'firstname','asc');
                                      contact5.totl2=parseInt(contact5.totl2)+parseInt(1);
                        
                              }
                              }
                              }
                          
              
                          
                              
                      }
                  
                          for(var y1=0;y1<(conatct_drop_down.length);y1++)
                                  {
                                  if(conatct_drop_down[y1][0]==groupid)
                                  
                                  conatct_drop_down[y1][2]=arrylen;
                                  }
                                  
                       size=parseInt(crnt_value_to)+parseInt(arrylen);
                       
                       
              
              
                       SetCookie("cont_"+groupid,size,1);
                                  mainContactWindow(groupid,1,size,size,2,groupName);
                                  
                                   
              }
              else
              {
                   var size=getCookievalue("cont_"+groupid);
                           for(var y=0;y<arrylen;y++)
                           {
                              if(to_folder==crnt_folder)
                                              {
                                                  var idz1=new Array(1);
                                                  idz1[0]=values[y];	
                                                  contact3.deleteEntry(to_folder);
                                                  contact3.where('id=?',idz1);
                                                  contact3.action();
                                              }
                                              else
                                              {//alert("ddf");
                                              if(avail==1)
                                              {
                                              
                                                 var idz2=new Array(1);
                                                 idz2[0]=values[y];//	alert(idz2);
                                                 contact5.deleteEntry(to_folder);
                                                 contact5.where('mailid=?',idz2);
                                                 contact5.action();
                                                
                                              }
                                              }	 
                                   
                          
                                          
                                  
                              
                                   }
                                  
                          
                              
                               for(var y1=0;y1<(conatct_drop_down.length);y1++)
                                  {
                                  if(conatct_drop_down[y1][0]==groupid)
                                  
                                  conatct_drop_down[y1][2]= conatct_drop_down[y1][2]-arrylen;
                                  }
                                  
                                  if(to_folder==crnt_folder)
                                              {
                                              crnt_value_from=parseInt(crnt_value_from)-parseInt(arrylen);
                                                  SetCookie("cont_"+folder,crnt_value_from,1);
                                              }
                                              else
                                              {
                                              crnt_value_from=parseInt(crnt_value_to)-parseInt(arrylen);
                                              SetCookie("cont_"+groupid,crnt_value_from,1);
                                              }
                   mainContactWindow(groupid,1,crnt_value_from,crnt_value_from,2,groupName);
                           
                   
              }		//document.getElementById("messages").style.display="";
                      //     document.getElementById("message_mail").innerHTML=msg;
               //toastr.info(msg);
               notify_display(msg,"info");  
               // setTimeout("hideconatctmessage()",5000);
           
          }
      });
     document.getElementById("contact_more_div").style.display="none";
} 
function deleteContact()
{
var folder=getCookievalue("currentcontact");
var flag=1;
   for(var y=0;y<(conatct_drop_down.length);y++)
                      {
                      if(conatct_drop_down[y][0]==folder)
                      
                     if(conatct_drop_down[y][2]==0)
                     flag=0;
                    
                      }
                      
                      if(contactidString=="")
                      flag=2;
        if(flag==1)
        {
          if(folder==-1)
              var contact3=this['global'];
          else if(folder==0)
          var contact3=this['mycontacts'];
          else
          var contact3=this[folder];
      
      var url="{url:(contacts/deletecontact/)}"+folder+"/"+contactidString;
  if(folder!=-1)
  {
       $.ajax({

type: "GET",cache: false,
url:url,

success: function(data) {

     
          var text=data;
          
        var values=text.split('/');
            var t=values[0];var msg=values[3];var mailid=values[1];var p=0;
            grpName=values[4];
            var values1=new Array(1000);
            contactidString=contactidString.substring(0,(contactidString.length)-1);
               values1=contactidString.split(",");
               var arrylen=(values1.length);
               for(var s=0;s<arrylen;s++)
                   {
              
                   var idz1=new Array(1);
                   idz1[0]=values1[s]; 	
                     contact3.deleteEntry(folder);
                  contact3.where('id=?',idz1);
                  contact3.action();
                   }
                    for(var y=0;y<(conatct_drop_down.length);y++)
                      {
                      if(conatct_drop_down[y][0]==folder)
                      
                    conatct_drop_down[y][2]=conatct_drop_down[y][2]-arrylen;
                   
                    
                      }
       
         if(folder==0)
         {
         folder="mycontacts";
         
          
            var size=getCookievalue("mycontacts");
            
                      var pt=size-arrylen;
                       SetCookie("mycontacts",pt,1);
           }
           else
           {
                  var size=getCookievalue("cont_"+folder);
            
                      var pt=size-arrylen;
                       SetCookie("cont_"+folder,pt,1);
           }
          mainContactWindow(folder,1,pt,pt,2,grpName);
             // document.getElementById("messages").style.display="";
               //            document.getElementById("message_mail").innerHTML=msg;
              // toastr.info(msg);
              notify_display(msg,"info");

              //        setTimeout("hideconatctmessage()",5000);
           
}
});
      }
      else
      {
      document.getElementById("messages").style.display="";
      document.getElementById("message_mail").innerHTML="{cfn:getmessage(461)}";
      setTimeout("hideconatctmessage()",5000);
      }

      }
      else if(flag==2)
      alert("{cfn:getmessage(172)}");
      else
      {
      document.getElementById("messages").style.display="";
      document.getElementById("message_mail").innerHTML="{cfn:getmessage(66)}";
      setTimeout("hideconatctmessage()",5000);
      }


} 

function deletecontactF(){var b=getCookievalue("currentcontact");if(b!=0&&b!=-1&&confirm("{cfn:getmessage(197)}")){var d=this[b];$.ajax({type:"GET",cache:!1,url:"{url:(contacts/deletegroup/)}"+b,success:function(c){c=c.split("/");d.truncate();var a=document.getElementById(b);a.parentNode.removeChild(a);SetCookie("currentcontact",0,1);new_contact_gp_add=1;c_cpcount--;c=c[1];for(a=0;a<conatct_drop_down.length;a++)conatct_drop_down[a][0]==b&&conatct_drop_down.splice(a,1);document.getElementById("messages").style.display=
"";document.getElementById("message_mail").innerHTML=c;setTimeout("hideconatctmessage()",5E3);mainContactWindow("mycontacts",1,c_total,c_total,2,0)}})}};

function changeTheme(a){$.ajax({type:"GET",cache:false,url:"{url:(settings/settheme/)}"+a,success:function(a){window.location.reload()}})}
function reloadWindow(){window.location.reload()}function reloadWindow_chat(){window.location.href="{url:(mail/mailbox#settings/chat)}"};
function settingswindow(id)
{
	//Coded for adjusting Heights of Settings iframe
	document.getElementById("mailPageOuterid").style.top="0";
	document.getElementById("mailPageOuterid").style.zIndex="10003";
	
	document.getElementById("mailPageOuterid").style.top="0";
	document.getElementById("mailPageOuterid").style.zIndex="10003";
	
	
	//Fix Transparency for themes.
	
	document.getElementById("second_scroll").style.background="#FFFFFF";
	document.getElementById("footer_txt_id").style.color="#000000";
	document.getElementById("footer_txt_id").style.textShadow="none";
	//
	
	

if(id==1)
{
var url="{url:(settings/webmailsettings)}";
  //document.getElementById("s_heading").innerHTML="<i class=\"fa fa-envelope\"></i>  {cfn:getmessage(68)}";
  document.getElementById("heading").innerHTML="<i class=\"fa fa-envelope\"></i>  {cfn:getmessage(68)}";
  
  document.getElementById("settings_webmail").className="leftSelected";
  document.getElementById("settings_spam").className="leftunSelected";
  document.getElementById("settings_option").className="leftunSelected";
  document.getElementById("settings_filter").className="leftunSelected";
 
  if({$chat_enable}==1)
  document.getElementById("settings_chat").className="leftunSelected";
  if({$portal_status}==0)
  document.getElementById("settings_password").className="leftunSelected";
  document.getElementById("settings_profile").className="leftunSelected";
  if({$calendar_enable}==1)
  document.getElementById("settings_calendar").className="leftunSelected";
  document.getElementById("right_mailsectionid").style.display="none";
  document.getElementById("cotnct_lmenuid").style.display="none";
  document.getElementById("contact_subheader").style.display="none";

  if(document.getElementById('rightads_td').style.display=="")
	{  
  document.getElementById('rightads_td').style.display="none";
  document.getElementById('mailPageOuterid').style.right="0px";
	}
  
}
else if(id==2)
{
var url="{url:(settings/antispamsettings)}";
//  document.getElementById("s_heading").innerHTML="<i class=\"fa fa-exclamation-triangle\"></i>  {cfn:getmessage(70)}";
  document.getElementById("heading").innerHTML="<i class=\"fa fa-exclamation-triangle\"></i>  {cfn:getmessage(70)}";

  document.getElementById("settings_webmail").className="leftunSelected";
  document.getElementById("settings_spam").className="leftSelected";
  document.getElementById("settings_option").className="leftunSelected";
  document.getElementById("settings_filter").className="leftunSelected";
  document.getElementById("right_mailsectionid").style.display="none";
  document.getElementById("cotnct_lmenuid").style.display="none";
  document.getElementById("contact_subheader").style.display="none";

  if(document.getElementById('rightads_td').style.display=="")
	{  
document.getElementById('rightads_td').style.display="none";
document.getElementById('mailPageOuterid').style.right="0px";
	}
  if({$chat_enable}==1)
  document.getElementById("settings_chat").className="leftunSelected";
  if({$portal_status}==0)
  document.getElementById("settings_password").className="leftunSelected";
  document.getElementById("settings_profile").className="leftunSelected";
  if({$calendar_enable}==1)
  document.getElementById("settings_calendar").className="leftunSelected";
}
else if(id==3)
{
var url="{url:(settings/emailfilter)}";
  //document.getElementById("s_heading").innerHTML="<i class=\"fa fa-filter\"></i>  {cfn:getmessage(71)}";
  document.getElementById("heading").innerHTML="<i class=\"fa fa-filter\"></i>  {cfn:getmessage(71)}";
  
  if(document.getElementById('rightads_td').style.display=="")
	{  
document.getElementById('rightads_td').style.display="none";
document.getElementById('mailPageOuterid').style.right="0px";
	}
  document.getElementById("right_mailsectionid").style.display="none";
  document.getElementById("cotnct_lmenuid").style.display="none";
  document.getElementById("contact_subheader").style.display="none";

  document.getElementById("settings_webmail").className="leftunSelected";
  document.getElementById("settings_spam").className="leftunSelected";
  document.getElementById("settings_option").className="leftunSelected";
  document.getElementById("settings_filter").className="leftSelected";

  if({$chat_enable}==1)
  document.getElementById("settings_chat").className="leftunSelected";
  if({$portal_status}==0)
  document.getElementById("settings_password").className="leftunSelected";
  document.getElementById("settings_profile").className="leftunSelected";
  if({$calendar_enable}==1)
  document.getElementById("settings_calendar").className="leftunSelected";
}
else if(id==4)
{
var url="{url:(settings/mailoptions)}";
 // document.getElementById("s_heading").innerHTML="<i class=\"fa fa-cog\"></i>  {cfn:getmessage(72)}";
  document.getElementById("heading").innerHTML="<i class=\"fa fa-cog\"></i>  {cfn:getmessage(72)}";
  
 if(document.getElementById('rightads_td').style.display=="")
	{  
document.getElementById('rightads_td').style.display="none";
document.getElementById('mailPageOuterid').style.right="0px";
	}
  document.getElementById("right_mailsectionid").style.display="none";
  document.getElementById("cotnct_lmenuid").style.display="none";
  document.getElementById("contact_subheader").style.display="none";

  document.getElementById("settings_webmail").className="leftunSelected";
  document.getElementById("settings_spam").className="leftunSelected";
  document.getElementById("settings_option").className="leftSelected";
  document.getElementById("settings_filter").className="leftunSelected";

  if({$chat_enable}==1)
  document.getElementById("settings_chat").className="leftunSelected";
  if({$portal_status}==0)
  document.getElementById("settings_password").className="leftunSelected";
  document.getElementById("settings_profile").className="leftunSelected";
  if({$calendar_enable}==1)
  document.getElementById("settings_calendar").className="leftunSelected";
}
else if(id==5)
{
if({$portal_status}==0)
var url="{url:(settings/changepassword)}";
  //document.getElementById("s_heading").innerHTML="<i class=\"fa fa-lock\"></i>  {cfn:getmessage(73)} ";
  document.getElementById("heading").innerHTML="<i class=\"fa fa-lock\"></i>  {cfn:getmessage(73)} ";
  
  if(document.getElementById('rightads_td').style.display=="")
	{  
document.getElementById('rightads_td').style.display="none";
document.getElementById('mailPageOuterid').style.right="0px";
	}
  document.getElementById("right_mailsectionid").style.display="none";
  document.getElementById("cotnct_lmenuid").style.display="none";
  document.getElementById("contact_subheader").style.display="none";

  document.getElementById("settings_webmail").className="leftunSelected";
  document.getElementById("settings_spam").className="leftunSelected";
  document.getElementById("settings_option").className="leftunSelected";
  document.getElementById("settings_filter").className="leftunSelected";

  if({$chat_enable}==1)
  document.getElementById("settings_chat").className="leftunSelected";
  if({$portal_status}==0)
  document.getElementById("settings_password").className="leftSelected";
  document.getElementById("settings_profile").className="leftunSelected";
  if({$calendar_enable}==1)
  document.getElementById("settings_calendar").className="leftunSelected";
}
else if(id==6)
{

if(portal_status==1)
var url="{url:(settings/portal_editprofile)}";
else
var url="{url:(settings/editprofile)}";
//document.getElementById("s_heading").innerHTML="<i class=\"fa fa-user\"></i>  {cfn:getmessage(361)}";
document.getElementById("heading").innerHTML="<i class=\"fa fa-user\"></i>  {cfn:getmessage(361)}";

if(document.getElementById('rightads_td').style.display=="")
{  
document.getElementById('rightads_td').style.display="none";
document.getElementById('mailPageOuterid').style.right="0px";
}
  document.getElementById("settings_webmail").className="leftunSelected";
  document.getElementById("settings_spam").className="leftunSelected";
  document.getElementById("settings_option").className="leftunSelected";
  document.getElementById("settings_filter").className="leftunSelected";
  document.getElementById("right_mailsectionid").style.display="none";
  document.getElementById("cotnct_lmenuid").style.display="none";
  document.getElementById("contact_subheader").style.display="none";

  if({$chat_enable}==1)
  document.getElementById("settings_chat").className="leftunSelected";
  if({$portal_status}==0)
  document.getElementById("settings_password").className="leftunSelected";
  document.getElementById("settings_profile").className="leftSelected";
  if({$calendar_enable}==1)
  document.getElementById("settings_calendar").className="leftunSelected";
}
else if(id==7)
{

  var url="{url:(settings/chatsettings)}";
 // document.getElementById("s_heading").innerHTML="<i class=\"fa fa-comments\"></i>  {cfn:getmessage(370)}";
  document.getElementById("heading").innerHTML="<i class=\"fa fa-comments\"></i>  {cfn:getmessage(370)}";
  
 if(document.getElementById('rightads_td').style.display=="")
	{  
document.getElementById('rightads_td').style.display="none";
document.getElementById('mailPageOuterid').style.right="0px";
	}
  document.getElementById("right_mailsectionid").style.display="none";
  document.getElementById("cotnct_lmenuid").style.display="none";
  document.getElementById("contact_subheader").style.display="none";

  document.getElementById("settings_webmail").className="leftunSelected";
  document.getElementById("settings_spam").className="leftunSelected";
  document.getElementById("settings_option").className="leftunSelected";
  document.getElementById("settings_filter").className="leftunSelected";

  if({$chat_enable}==1)
  document.getElementById("settings_chat").className="leftSelected";
  if({$portal_status}==0)
  document.getElementById("settings_password").className="leftunSelected";
  document.getElementById("settings_profile").className="leftunSelected";
  if({$calendar_enable}==1)
  document.getElementById("settings_calendar").className="leftunSelected";
  }
else if(id==8)
{
var url="{url:(settings/calendar)}";
//document.getElementById("s_heading").innerHTML="<i class=\"fa fa-calendar\"></i>  {cfn:getmessage(3)}";
document.getElementById("heading").innerHTML="<i class=\"fa fa-calendar\"></i>  {cfn:getmessage(3)}";
if(document.getElementById('rightads_td').style.display=="")
{  
document.getElementById('rightads_td').style.display="none";
document.getElementById('mailPageOuterid').style.right="0px";
}
document.getElementById("right_mailsectionid").style.display="none";
document.getElementById("cotnct_lmenuid").style.display="none";
document.getElementById("contact_subheader").style.display="none";

  document.getElementById("settings_webmail").className="leftunSelected";
  document.getElementById("settings_spam").className="leftunSelected";
  document.getElementById("settings_option").className="leftunSelected";
  document.getElementById("settings_filter").className="leftunSelected";

  if({$chat_enable}==1)
  document.getElementById("settings_chat").className="leftunSelected";
  if({$portal_status}==0)
  document.getElementById("settings_password").className="leftunSelected";
  document.getElementById("settings_profile").className="leftunSelected";
  if({$calendar_enable}==1)
  document.getElementById("settings_calendar").className="leftSelected";
}
  document.getElementById('loadingDiv').style.display="";
var parent=document.getElementById('settingsDiv');
var child=document.getElementById('settingsFrame');
if(child)
parent.removeChild(child);
makeFrame(url,id);

}
function getfolderid(name)
{
if(name=="inbox")
var id=1;
else if(name=="draft")
var id=2;
else if(name=="sent")
var id=3;
else if(name=="spam")
var id=4;
else if(name=="trash")
var id=5;
else if(name=="starred")
var id=6;
else if(name.substring(0,6)=="custom")
var id=name.substring(6);

return id;
}

function fetchDetailResults(name,mailId,arry,status,pageNo,pageStatus,parentId,mainPage,loopvariable,object,search_object)
{
}
function createAttachmentdiv(foldername,mailid)
{
document.getElementById("bodytest").style.display='';
var currentTime=new Date;
var crntime=currentTime.getTime();
$.ajax({type:"GET",cache:false,url:"{url:(mail/attachdivcontent)}/"+foldername+"/"+mailid+"/"+crntime,
success:function(data)
{var x=data;   
 if(x!=0)
 {
 var valus=x.split("/");
 var as=x[0]*30;
 if(as>0)
 {
   document.getElementById('forwardz').style.display="none";
     //var filestringz='<iframe id="upload_forward_'+0+'" name="upload_forward_'+0+'" src="{url:(mail/upload_forward)}/'+mailid+"/"+0+"/"+0+'" class="iframestyle"  style="width:100%;height:'+as+'px;border:0px solid #fff;" scrolling="no"></iframe>';
     var filestringz='<iframe id="upload_forward_'+0+'" name="upload_forward_'+0+'" src="{url:(mail/upload_forward)}/'+mailid+"/"+0+"/"+0+'" class="iframestyle" scrolling="no" frameborder="0" marginheight="0" marginwidth="0" allowtransparency="true"></iframe>';
     document.getElementById("forwardz").innerHTML="";
document.getElementById("forwardz").innerHTML=filestringz;
//document.getElementById("filedivcontainer_0_0_0").innerHTML="";
  $('#forwardz').fadeIn(800);
document.getElementById("attachlink_0_0").style.display="none";
document.getElementById("additionalattach_0_0").style.display=""
 } document.getElementById("bodytest").style.display='none';  }   }   });
 }
function findFolderName(a){$.ajax({type:"GET",cache:!1,url:"{url:(mail/getfoldername)}/"+a,success:function(a){xxx=0;document.getElementById("foldrd").value=a}})};
function searchfn(){folderCreated!=0&&searchFolders("{url:(mail/createfolderlist)}");var a=document.getElementById("search").value;if(a==""||a=="{cfn:getmessage(323)}")document.getElementById("search").value=""}function displayfn(){var a=document.getElementById("search").value;if(a==""||a=="{cfn:getmessage(323)}")document.getElementById("search").value="{cfn:getmessage(323)}"};
function getNewSignature(b,c,r1,r2){/*b-id. c-content*/if(r1==1)c="<br /><br />"+r2+"<blockquote style=\"border-left: 1px solid rgb(204, 204, 204); margin: 0px 12px 12px 5px; padding-left: 1ex;\">"+c+"</blockquote>";if(r1==0)c="<br /><br />"+r2+c;var d=(new Date).getTime();$.ajax({type:"GET",cache:!1,url:"{url:(settings/getsignature)}/"+d,success:function(a){
	a=c+"<br><br>"+a;
	 
	var editor = CKEDITOR.instances[b];
	editor.setData(a);


	//nicEditors.findEditor(b).setContent(a)
	
	}})};
var filevar_a=0;
function addfilefield(id){//console.log(filevar_a);
	var draftid=document.getElementById("draftid_"+id).value;
	filevar_a=filevar_a+1;
	filevar_count=filevar_count+1;
	document.getElementById("filedivcontainer_0_0_0").style.display="";
	filestring='<iframe id="upload_target'+filevar_a+'" name="upload_target'+filevar_a+'" src="{url:(mail/upload_frame)}/'+draftid+"/"+filevar_a+"/"+id+'"  class="iframestyle" scrolling="no" frameborder="0" marginheight="0" marginwidth="0" allowtransparency="true"></iframe>';
	filestring=filestring+'<div id="filedivcontainer_'+id+"_"+filevar_a+'" class="attachBox" ></div>';
	var filevartemp=filevar_a-1;//console.log(filevartemp);console.log("filedivcontainer_"+id+"_"+filevartemp);
	document.getElementById("filedivcontainer_"+id+"_"+filevartemp).innerHTML=filestring;
	document.getElementById("attachcount_"+id).value=filevar_a;
	document.getElementById("attachlink_"+id).style.display="none";
	document.getElementById("additionalattach_"+id).style.display=""};
function reset_filefield()
{filevar_a=0;}
function getsmiley(b){var a=document.getElementById("smileyvalue_"+b).value;if(a==0)document.getElementById("smileys_"+b).innerHTML='<map name="Map1" class="smileyOver"><area shape="rect" coords="0,0,20,20" href="javascript:smileyClick('+b+',1);" ><area shape="rect" coords="20,0,40,20" href="javascript:smileyClick('+b+',2);"><area shape="rect" coords="40,0,60,20" href="javascript:smileyClick('+b+',3);"><area shape="rect" coords="60,0,80,20" href="javascript:smileyClick('+b+',4);"><area shape="rect" coords="80,0,100,20" href="javascript:smileyClick('+b+',9);"><area shape="rect" coords="100,0,120,20" href="javascript:smileyClick('+b+',10);"><area shape="rect" coords="120,0,140,20" href="javascript:smileyClick('+b+',11);"><area shape="rect" coords="140,0,160,20" href="javascript:smileyClick('+b+',12);"><area shape="rect" coords="0,20,20,40" href="javascript:smileyClick('+b+',5);"><area shape="rect" coords="20,20,40,40" href="javascript:smileyClick('+b+',6);"><area shape="rect" coords="40,20,60,40" href="javascript:smileyClick('+b+',7);"><area shape="rect" coords="60,20,80,40" href="javascript:smileyClick('+b+',8);"><area shape="rect" coords="80,20,100,40" href="javascript:smileyClick('+b+',13);"><area shape="rect" coords="100,20,120,40" href="javascript:smileyClick('+b+',14);"><area shape="rect" coords="120,20,140,40" href="javascript:smileyClick('+b+',15);"><area shape="rect" coords="140,20,160,40" href="javascript:smileyClick('+b+',16);"></map><img src="images/smilyeset.jpg" usemap="#Map1" style="margin-bottom:5px;" border=0>',document.getElementById("smileyvalue_"+b).value=1;else if(a==1)document.getElementById("smileyvalue_"+b).value=0,document.getElementById("smileys_"+b).innerHTML=""}
setInterval("getmail2()",30000);
function smileyClick(b,a){var d="chattextarea"+b,c="";a==1?c=":)":a==2?c=":(":a==3?c=":d":a==4?c=":P":a==5?c="(*)":a==6?c="(-)":a==7?c=":|":a==8?c="(;":a==9?c=":-*":a==10?c=":-v":a==11?c=":*)":a==12?c="B-)":a==13?c="x-(":a==14?c=":*B":a==15?c="*:A":a==16?c=":-$":a==17?c=":-^":a==18?c=":-!":a==19?c=":-D":a==20?c=":X":a==21?c=":=)":a==22?c="?=)":a==23?c=":-o":a==24&&(c=":-Z");document.getElementById("smileys_"+b).innerHTML="";document.getElementById("smileyvalue_"+b).value=0;var e=document.getElementById(d).value;
document.getElementById(d).value=e+c;document.getElementById(d).className="chatboxtextareaselected";document.getElementById(d).focus()};
function morefn()
{
  if(moreflag==0)
  {
      if(document.getElementById("moveto2").style.display=="")
      document.getElementById("moveto2").style.display="none";
      moveflag=0;
      var url1=window.location.hash;
      var contnt="<div class=\"in\">";
      if(idz=="")
      {   if(mail_open==0)
           contnt=contnt+"<a href=\""+url1+"\"  onClick=\"selectall()\">{cfn:getmessage(85)}</a>";
      }
      else
      {
          var asd=idz.split(",");
          for(var incr=0;incr<(asd.length);incr++)
          {
              var asdf=asd[(asd.length-1)].split("&");
              var crntFoldername=asdf[2];
              
              var id=asdf[0].replace(":","");
              var objct=this[crntFoldername];
              var star=0;var read=0;var unstar=0;var unread=0;
              var aa=objct.getResultPage(crntFoldername,asdf[1],mailsPerpage);
              
              while(xx=objct.fetchRow(aa))
              {
               if(xx[0]==id)
                  {
                      if(xx[9]==1)
                      star=1;
                      else
                      unstar=1;
                      if(xx[7]==1)
                      read=1;
                      else
                      unread=1;
                  }
              }
          }
          if((crntFoldername!="draft")&&(crntFoldername!="sent")&&(crntFoldername!="starred"))
          {
              if((read==1)&&(unread==0))
              contnt=contnt+"<a href=\"javascript:read(0)\">{cfn:getmessage(75)}</a>";
              else if((read==0)&&(unread==1))
              contnt=contnt+"<a href=\"javascript:read(1)\">{cfn:getmessage(74)}</a>";
              else 
              contnt=contnt+"<a href=\"javascript:read(0)\">{cfn:getmessage(75)}</a><a href=\"javascript:read(1)\">{cfn:getmessage(74)}</a>";
          }
          if((crntFoldername!="spam")&&(crntFoldername!="trash"))
          {
              if(crntFoldername=="starred")
              {
                  contnt=contnt+"<a href=\"javascript:star(0)\">{cfn:getmessage(444)}</a>";
              }
              else
              {
                  if((star==1)&&(unstar==0))
                  contnt=contnt+"<a href=\"javascript:star(0)\">{cfn:getmessage(444)}</a>";
                  else if((star==0)&&(unstar==1))
                  contnt=contnt+"<a href=\"javascript:star(1)\">{cfn:getmessage(443)}</a><a href=\"javascript:star(0)\">{cfn:getmessage(444)}</a>";
                  else
                  contnt=contnt+"<a href=\"javascript:star(1)\">{cfn:getmessage(443)}</a>";
              }
              
          }
          if(mail_open==0)
          contnt=contnt+"<a href=\"javascript:selectall()\">{cfn:getmessage(85)}</a><a href=\"javascript:deselectall()\">{cfn:getmessage(86)}</a>";
      }
      contnt=contnt+"</div>";
      document.getElementById("moreList2").style.display="";
      document.getElementById("moreList2").innerHTML=contnt;
      moreflag=1;
  }
  else
  {
      moreflag=0;
      document.getElementById("moreList2").style.display="none";
  }
}
function movetofn()
{

  if(moveflag==0)
  {
      moreflag=0;
      if(document.getElementById("moreList2").style.display=="")
      document.getElementById("moreList2").style.display="none";
      var folder=getCookievalue("folder");
      var page=getCookievalue("mail_page");
      if(idz=="")
      {
          alert("{cfn:getmessage(445)}");
      }
      else
      {
          var asd=idz.split(",");
          var idstringz="";
          for(var incr=0;incr<(asd.length);incr++)
          {
              var asdf=asd[incr].split("&");
              var fldr=asdf[2];
              asdf[0]=asdf[0].replace(":","");
              if(idstringz=="")
              idstringz=asdf[0]+"{nesote:+;}";
              else
              idstringz=idstringz+asdf[0]+"{nesote:+;}";
          }
          
          var currentTime=new Date();
          var crntime=currentTime.getTime();
             
           $.ajax({

type: "POST",cache: false,
url: "{url:(mail/movetoselect/)}",
data: "folder="+fldr+"&ids="+idstringz,
success: function(data) {
          
         
                  var x=data;
                  if(x=="<ul id=\"moveto\" name=\"moveto\" ></ul>")
                  {
                      alert("{cfn:getmessage(357)}");
                  }
                  document.getElementById("moveto2").style.display="";
                  document.getElementById("moveto2").innerHTML=x;
                  
              }
                      
          });
         
          moveflag=1;
      }
  }
  else
  {
      document.getElementById("moveto2").style.display="none";
      moveflag=0;
  }
}
function setUnreadcount()
{
var a=Unread[0][1]>0?Unread[0][1]:"";document.getElementById("1_count").innerHTML=a;
if(a=="")
document.getElementById("1_count").className="";
else
document.getElementById("1_count").className="mailcounter";
	
a=Unread[1][1]>0?Unread[1][1]:"";document.getElementById("2_count").innerHTML=a;
if(a=="")
	document.getElementById("2_count").className="";
else
	document.getElementById("2_count").className="mailcounter";

a=Unread[3][1]>0?Unread[3][1]:"";document.getElementById("4_count").innerHTML=a;
if(a=="")
	document.getElementById("4_count").className="";
else
	document.getElementById("4_count").className="mailcounter";

for(a=6;a<customFoldercount;a++)
{
var b=Unread[a][1]>0?Unread[a][1]:"";document.getElementById(Unread[a][0]+"_count").innerHTML=b
if(b=="")
	document.getElementById(Unread[a][0]+"_count").className="";
else
	document.getElementById(Unread[a][0]+"_count").className="mailcounter";

}}
function disableReplylinks(){document.getElementById("three_3").style.display="none";document.getElementById("four_4").style.display="none";document.getElementById("two_2").style.display="none";
document.getElementById("two_chat_2").style.display="none";document.getElementById("three_chat_3").style.display="none";document.getElementById("four_chat_4").style.display="none";
}
function enableReplylinks(){document.getElementById("three_3").style.display="";document.getElementById("four_4").style.display="";document.getElementById("two_2").style.display=""}
function insertArray(a,b,c){
var d=Array(17);
d[0]="id";d[1]="from_list";d[2]="to_list";
d[3]="cc";d[4]="bcc";d[5]="subject";d[6]="body";d[7]="readflag";
d[8]="starflag";d[9]="time";d[10]="status";d[11]="mail_references";
d[12]="original_folder";d[13]="original_body";d[14]="cntnt_display";
d[15]="time_int";d[16]="short_cntnt";d[17]="object";d[18]="date";d[19]="search_objects"
isArrayAvailable(a)||(this[a]=new Table(a,d,c,20));
this[a].insert(a,2,b,"time_int","desc")
}

function star(type)
{
var folder=getCookievalue("folder");
var page=getCookievalue("mail_page");

var current_view=getCookievalue("current_view");

var fieldz=new Array(1);
fieldz[0]="starflag";

var objct=this[folder];
var asd=idz.split(",");
var idstringz="";var org_folder="";var object="";

  for(var i=0;i<(asd.length);i++)
  {
   var asdf=asd[i].split("&");
    asdf[0]=asdf[0].replace(":","");
    asdf[5]=asdf[5].replace(":","");
   idstringz+=asdf[0]+",";
   object+=asdf[4]+",";
   
   var maiLid=asdf[0];
   var result=objct.getResultItem(folder,maiLid);
   var val=objct.fetchRow(result);
   org_folder=org_folder+val[12]+",";	 
  }
  org_folder=org_folder.substring(0,org_folder.length-1);
  var currentTime=new Date();
  var crntime=currentTime.getTime();
  var aryAvail=isArrayAvailable('starred');
  if(aryAvail==1)
  {
      var opject=this['starred'];
  }
  var aa=objct.getResultPage(folder,page,mailsPerpage);
  while(xx=objct.fetchRow(aa))
  {
    for(var l=0;l<asd.length;l++)
    {
      var asdf=asd[l].split("&");
      asdf[0]=asdf[0].replace(":","");
      asdf[5]=asdf[5].replace(":","");
      
      var maiLid=asdf[0];
      if(maiLid==xx[0])
          { 
          
               
              asdf[5]=asdf[5].substr(0,asdf[5].length-1);
              var folder_search=asdf[5].split(".");
          
             for(var k=0;k<folder_search.length;k++)
             {
              var folders=folder_search[k].split("_");
              var objct1=this[folders[0]];	
              var inner_obj=this[folder_search[k]];       
              aValues=new Array(1);
              aValues[0]=type;
              var idz1=new Array(1);
              idz1[0]=folders[1];
              
              if(isArrayAvailable(folders[0]))
              {
                  var itemavail=objct1.isItemAvailable(folders[0],folders[1]);
                  if(itemavail!=0)
                  {			
                       
                  objct1.update(folders[0],fieldz,aValues);
                  objct1.where('id=?',idz1);
                  objct1.action();
                  }
              }
              if(isArrayAvailable(folder_search[k]))
              { 
                if(type==0)
                { 
                
                   var cc=inner_obj.getResultPage(folder_search[k],1,50);
                   while(xxx=inner_obj.fetchRow(cc))
                   {
                      var idz1=new Array(1);
                      idz1[0]=xxx[0];
                      inner_obj.update(folder_search[k],fieldz,aValues);
                      inner_obj.where('id=?',idz1);
                      inner_obj.action(); 					   									    
                   }
                
                  
                }
               else
                {
                 var itemavails=inner_obj.isItemAvailable(folder_search[k],maiLid);
                  if(itemavails!=0)
                  {
                  var idz1=new Array(1);
                  idz1[0]=xx[0];
                  inner_obj.update(folder_search[k],fieldz,aValues);
                  inner_obj.where('id=?',idz1);
                  inner_obj.action();
                  }
               
               }	
              }
          
              
              
              
              
              if(type==1)
              {
                   var aryAvail=isArrayAvailable('starred'); 
                   if(aryAvail==1)
                   {
                      var isStar=opject.isItemAvailable('starred',xx[0]);
                      if(isStar==0)
                          {
                              var rset=objct.getResultItem(folder,xx[0]);
                              var values=objct.fetchRow(rset);
                              opject.insert('starred',2,values,'time_int','desc');			
                              opject.totl2=parseInt(opject.totl2)+parseInt(asd.length);
                          }	    
                      
                   }
                   document.getElementById("star_"+xx[0]).innerHTML="<a href=\"javascript:markstar("+xx[0]+","+page+",0,"+maiLid+",'"+xx[14]+"','"+xx[15]+"')\"><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner str-y\"></a>";
              }
              else
              {
               
                 var aryAvail=isArrayAvailable('starred');
                  if(aryAvail==1)
                  {
                      var isStar=opject.isItemAvailable('starred',xx[0]);
                      if(isStar!=0)
                      { 
                          var idz1=new Array(1);
                          idz1[0]=xx[0];//alert(idz1);
                          opject.deleteEntry('starred');
                          opject.where('id=?',idz1);
                          opject.action();
                          
                         
                          if(folder=='starred')
                          {
                                if(current_view=="2pane")              
                              document.getElementById('twopaneMail_'+xx[0]).style.display="none";
                                else
                                document.getElementById('threepaneMail_'+xx[0]).style.display="none";
                                  	
                              
                          
                                      
                          }
                      }
                  }
                  document.getElementById("star_"+xx[0]).innerHTML="<a href=\"javascript:markstar("+xx[0]+","+page+",1,"+maiLid+",'"+xx[14]+"','"+xx[15]+"')\"><img src=\"images/filler.gif\" alt=\" \" border=\"0\" align=\"absmiddle\" class=\"iconsCornner str-g\"></a>";
               
               
              }
          }
              
       }
       
    
    }
  }
  var flag=1;
  
  $.ajax({

type: "POST",cache: false,
url: "{url:(mail/star/)}",
data: "type="+type+"&foldernane="+org_folder+"&mailid="+idstringz+"&object="+object+"&flag="+flag,
success: function(data) {
          var x=data;
          document.getElementById("moreList2").style.display="none";
      }
              
  });
  
  

}
function read(type)
{
  var current_view=getCookievalue("current_view");
  var folder=getCookievalue("folder");
  var page=getCookievalue("mail_page");
  var objct=this[folder];
  
  var fieldz=new Array(1);
  fieldz[0]="readflag";
  var aValues=new Array(1);
  aValues[0]=type;
  
  var asd=idz.split(",");
  var idstringz="";
  for(var i=0;i<asd.length;i++)
  {
   var asdf=asd[i].split("&");
   asdf[0]=asdf[0].replace(":","");
  
    var mailid=asdf[0];
    idstringz+=asdf[4]+",";
    var search_obj=asdf[4].indexOf(">");
  if(search_obj!=-1)
  {
  var start_pos=search_obj+1;
  var length=asdf[4].length;
  var Flder=asdf[4].substr(start_pos,length);
  var Folders=Flder.split("_");
  }
  else
  {
    var Folders=asdf[4].split("_");
  }  
  if(isArrayAvailable(asdf[4]))
  {
   var crnt_folder=this[asdf[4]];
   var idAry=new Array(1);
   idAry[0]=mailid;
   crnt_folder.update(asdf[4],fieldz,aValues);
   crnt_folder.where('id=?',idAry);
   crnt_folder.action();
  }
  
    if(isArrayAvailable(Folders[0]))
    {
      var Folder_obj=this[Folders[0]];
      var itemavl=Folder_obj.isItemAvailable(Folders[0],Folders[1]);
      if(itemavl!=0)
       {
          
        var cc=Folder_obj.getResultItem(Folders[0],Folders[1]);
        var bb=Folder_obj.fetchRow(cc);
        var readflg=bb[7];
        }
    }
     asdf[5]=asdf[5].replace(":","");
    asdf[5]=asdf[5].substr(0,asdf[5].length-1);
    
    var folder_search=asdf[5].split(".");
    for(var k=0;k<folder_search.length;k++)
    {
     var folders=folder_search[k].split("_");
      if(isArrayAvailable(folders[0]))
      { 
          var obj=this[folders[0]];
          
          var itemavails=obj.isItemAvailable(folders[0],folders[1]);
          if(itemavails!=0)
          {
             
              
               var idArry=new Array(1);
               idArry[0]=folders[1];
               obj.update(folders[0],fieldz,aValues);
               obj.where('id=?',idArry);
               obj.action();
               
               
          }
      }
      if(isArrayAvailable(folder_search[k]))
      {
         var inner_obj=this[folder_search[k]];
          var aa=inner_obj.getResultPage(folder_search[k],1,50);
          while(xx=inner_obj.fetchRow(aa))
          {
               var idArry=new Array(1);
               idArry[0]=xx[0];
               inner_obj.update(folder_search[k],fieldz,aValues);
               inner_obj.where('id=?',idArry);
               inner_obj.action();
            
          } 
      }
     }
       if(type==1)
      { 
          if(folder!="sent" && folder!="draft")
          {
        	  if(current_view=="2pane")
        	  {
                if(document.getElementById('fromaddress_span'+asdf[0]))
                {
                  document.getElementById('fromaddress_span'+asdf[0]).className="readmail";
                  document.getElementById('mailsubject_span'+asdf[0]).className="readmail";
                  document.getElementById('mailcontent_span'+asdf[0]).className="readContent";
                  document.getElementById('twopaneMail_'+asdf[0]).className="twopaneMailRead ";
                  

                }
             }
                else
                	{
                     if(document.getElementById('fromaddress_span_3pane'+asdf[0]))
                     {
                      document.getElementById('fromaddress_span_3pane'+asdf[0]).className="readmail";
                      document.getElementById('mailsubject_span_3pane'+asdf[0]).className="readmail";
                      document.getElementById('mailcontent_span_3pane_'+asdf[0]).className="readContent";
                      document.getElementById('threepaneMail_'+asdf[0]).className="threepaneMailRead ";
                      

                     }

                	}
                
          }
          if((Folders[0]!='sent')&&(Folders[0]!='draft')&&(Folders[0]!='trash')&&(Folders[0]!='starred'))
          {
            if(readflg==0)
            {
              for(var urdcnt=0;urdcnt<customFoldercount;urdcnt++)
              {
                  if(Unread[urdcnt][0]==Folders[0])
                  Unread[urdcnt][1]=parseInt(Unread[urdcnt][1])-parseInt(1);
              }
            }	
          }
          
          
          
          
      }
      else
      {
          if(folder!="sent" && folder!="draft")
          {
        	  if(current_view=="2pane")
        	 { 
              if(document.getElementById('fromaddress_span'+asdf[0]))
              {
              
                  document.getElementById('fromaddress_span'+asdf[0]).className="unreadmail";
                  document.getElementById('mailsubject_span'+asdf[0]).className="unreadmail";
                  document.getElementById('mailcontent_span'+asdf[0]).className="unreadContent";
                  document.getElementById('twopaneMail_'+asdf[0]).className="twopaneMailUnRead ";

              }
        	 }
        	  else
        		  {
                  if(document.getElementById('fromaddress_span_3pane'+asdf[0]))
                  {
                  
                      document.getElementById('fromaddress_span_3pane'+asdf[0]).className="unreadmail";
                      document.getElementById('mailsubject_span_3pane'+asdf[0]).className="unreadmail";
                      document.getElementById('mailcontent_span_3pane_'+asdf[0]).className="unreadContent";
                      document.getElementById('threepaneMail_'+asdf[0]).className="threepaneMailUnRead ";
                      

                  }        		  
        		  }
        	  
          }
          if((Folders[0]!='sent')&&(Folders[0]!='draft')&&(Folders[0]!='trash')&&(Folders[0]!='starred'))
          {
            if(readflg==1)
            {
              for(var urdcnt=0;urdcnt<customFoldercount;urdcnt++)
              {
                  if(Unread[urdcnt][0]==Folders[0])
                  Unread[urdcnt][1]=parseInt(Unread[urdcnt][1])+parseInt(1);
              }
             }	
          }
      
      }
      
   
   
  }	
  setUnreadcount();
              $.ajax({

type: "POST",cache: false,
url: "{url:(mail/read/)}",
data: "type="+type+"&foldernane="+folder+"&mailid="+idstringz,
success: function(data) {
      
          
          
      }
              
  });
  


}

function mail_load()
{
var mail_load_value=document.getElementById("mailC_load").value;
while(mail_load!=1)
{
document.getElementById("preview").innerHTML="{cfn:getmessage(451)}";
}
}
function preview_hide(name)
{
document.getElementById("preview").style.display="none";
}
function mouseoverMail(mailid,name,nam,object)
{
	var current_view=getCookievalue("current_view");
	if(current_view=="2pane")
		{
          if(name!="chats")
        	{  
            if(document.getElementById('cb_'+mailid).checked!=true){
            document.getElementById('twopaneMail_'+mailid).className="mailOver";  
              }
            }
          else
        	  {
             if(document.getElementById('cbt_'+mailid).checked!=true)
       	    {
       	    document.getElementById('twopaneMail_'+mailid).className="mailOver";
       	    }
        	  }
		}
	else
		{
if(name=="draft" || name=="starred")//This condition is necessary in starred and chats folder in limited view
			{
				if(document.getElementById('cb_'+mailid).checked!=true)
       	    	{
       	    		document.getElementById('twopaneMail_'+mailid).className="mailOver";
       	    	}
			}
		else{
		if(name!="chats")
			{
		if(document.getElementById('cb1_'+mailid).checked!=true )
		   {
		   	   document.getElementById('threepaneMail_'+mailid).className="mailOver1";
		   } 
			}
		else
			{
		if(document.getElementById('cbt1_'+mailid).checked!=true)
		  {
		  document.getElementById('threepaneMail_'+mailid).className="mailOver1";
		  }
			}
}
	  
		
	}
	
   
  
  
if(name!='draft')
{
var names=object;
var obj=this[names];
var isAvl=obj.isItemAvailable(names,mailid);
if(isAvl!=0)
{
var mnp=getCookievalue("chat_page");
var mail_page=getCookievalue("mail_page");
if(name=="chats")
var bb=this[names].getResultItemM(names,mailid,mnp,mailsPerpage);
else
var bb=this[names].getResultItemM(names,mailid,1,mailsPerpage);

var b1=this[names].fetchRow(bb);//alert(b1[5]);

if(name=="chats")
{
var pp="<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"table-layout:fixed;border-collapse: collapse;height:25px;vertical-align:middle;\"><tr><td>";
pp+="<span style=\"padding:4px 2px;float:right;\"><a href=\"javascript: preview_hide('"+name+"')\" ><img src=\"images/closebutton.png\" border=0></a></span>";
pp+="<span class=\"messageTab\"><h2>"+b1[10]+"</h2></span>";
pp+="<span  class=\"fromName\" >{cfn:getmessage(54)}:"+b1[13]+"</span>";
pp+="<br/><span class=\"mailContent\">"+b1[8]+"</span>";

pp+="</td></tr></table>";
}
else
{
var pp="<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"table-layout:fixed;border-collapse: collapse;height:25px;vertical-align:middle;\"><tr><td>";
pp+="<span style=\"padding:4px 2px;float:right;\"><a href=\"javascript: preview_hide('"+name+"')\" ><img src=\"images/closebutton.png\" border=0></a></span>";
pp+="<span class=\"messageTab\"><h2>"+b1[5]+"</h2></span>";
pp+="<span  class=\"fromName\" >{cfn:getmessage(54)}:"+b1[1]+"</span>";
pp+="<br/><span class=\"mailContent\">"+b1[13]+"</span>";

pp+="</td></tr></table>";
}

if(current_view=="2pane")
	{
/*fnPtr = document.getElementById('twopaneMail_'+mailid).oncontextmenu;
document.getElementById('twopaneMail_'+mailid).oncontextmenu = function () {

document.getElementById("preview").style.display="";
document.getElementById("preview").innerHTML=pp;
document.getElementById("preview").style.marginTop=tempY-parseInt(130)+"px";

return false;};*/
	}
}
}
}

function mouseoutMail(mailId,names,nam,object)
{
	//Additional Coding required for fixing mail selection color in 3pane  
	
	//
	var current_fldr2=names; 

   var current_view=getCookievalue("current_view");
      var names=object;
  var opject=this[names];
  if(isArrayAvailable(names))
  {
      var isAvl=opject.isItemAvailable(names,mailId);
                  if(isAvl!=0)
                  {
                  var mnp=getCookievalue("chat_page");
                  if(names=="chats")
                  var aaaa=this[names].getResultItemM(names,mailId,mnp,mailsPerpage);
                  else	
                  var aaaa=this[names].getResultItem(names,mailId);

                  var asas=this[names].fetchRow(aaaa);
                  if(names=="chats")
                  {
                  var rdflg=asas[5];
                  var s1v="cbt_"+mailId;var s2v="cbt1_"+mailId;
                  
                  }
                  else
                  {
                  var rdflg=asas[7];
                  var s1v="cb_"+mailId;var s2v="cb1_"+mailId;
                  }

              if(rdflg==0 )
              {
              
              if(current_view=="2pane")
            	 { 
                       if(document.getElementById(s1v).checked!=true){
              
                       document.getElementById('twopaneMail_'+mailId).className="twopaneMailUnRead";  
                       }
            	 }
              else
            	  {
                   if(current_fldr2=="draft" || current_fldr2=="starred")//This condition is necessary in starred and draft folder in limited view
                 {
          			 if(document.getElementById(s1v).checked!=true){
                         
                         
                         document.getElementById('twopaneMail_'+mailId).className="twopaneMailUnRead";  
                        }
                 }else{  
                       if(document.getElementById(s2v).checked!=true){
                  
                    
                        document.getElementById('threepaneMail_'+mailId).className="threepaneMailUnRead";  
                       }
            	 
            	  }
            }
                            
              }
              else
              {
            	  
                 if(current_view=="2pane")
                {	 
            	      if(document.getElementById(s1v).checked!=true){
                       document.getElementById('twopaneMail_'+mailId).className="twopaneMailRead";
                     }
                }
                 else
                	 {

if(current_fldr2=="draft" || current_fldr2=="starred")//This condition is necessary in starred and draft folder in limited view
                     {
              			 if(document.getElementById(s1v).checked!=true){
                                                         
                             document.getElementById('twopaneMail_'+mailId).className="twopaneMailRead";  
                            }
                     }  
                	 else
                		 {
                        if(document.getElementById(s2v).checked!=true){
                     document.getElementById('threepaneMail_'+mailId).className="threepaneMailRead";  
                     }

}
                 }
                  
              
              }

          }
    }
}
/**
 * This Function autosave editor contents every 20 characters.
 */
function autoSave(id)
{
  global_draftcount++;
  if(global_draftcount==20)
  {
      var designId=id+"_0";
      mailFurther(2,id,designId);
      global_draftcount=0;
  }
 
}

function mailFurther(id,mailid,designId)
{
    //alert(id);return false;
  var tO=document.getElementById("to_"+designId).value;
  if(tO=="")
  tO=" ";
  var cC=document.getElementById("cc_"+designId).value;
  if(cC=="")
  cC=" ";
  var bcC=document.getElementById("bcc_"+designId).value;
  if(bcC=="")
  bcC=" ";
  var subjecT=document.getElementById("subject_"+designId).value;
  if(subjecT=="" || subjecT==false)
  subjecT=" ";
  
  //Ckeditor
  
  var b1="mailBody_"+designId;
  // Get the editor instance that you want to interact with.
	var editor = CKEDITOR.instances[b1];

	// Get editor contents
	
	 var contenT=editor.getData();
	  
  //
  //var contenT=nicEditors.findEditor('mailBody_'+designId).getContent();
  
  
  if(contenT=="")
  contenT=" ";
  if(id==1)
  {
      if((tO==" ")&&(cC==" ")&&(bcC==" "))
      {
          alert("{cfn:getmessage(437)}");
      }
      else
      {
      
          senDmail(tO,cC,bcC,subjecT,contenT,mailid,designId);//delete from draft if autosaved and then send
      }
  }
  else 
  {
      if(id==2)

      {
          savEmail(tO,cC,bcC,subjecT,contenT,mailid,designId);//update if autosaved else save
      }
      else
      {
    	 

          discarDmail(mailid,designId);//delete from draft if autosaved
      }
  }
}

function hide(designId)
{
  document.getElementById('mailDiv_'+designId).style.display="none";
  document.getElementById('mailDivshort_'+designId).style.display="";
}
function hidemailmessage()
{
  document.getElementById("messages").style.display="none";
}
function  showeditImage(id)
{
      var img="editimage"+id;
document.getElementById(img).style.display="";
}
function  hideeditImage(id)
{
      var img="editimage"+id;
document.getElementById(img).style.display="none";
}
function showDetails(id)
{
  document.getElementById("short_"+id).style.display="none";
  document.getElementById("detail_"+id).style.display="";
  document.getElementById("detail1_"+id).style.display="";

}

function hideDetails(id)
{
  document.getElementById("short_"+id).style.display="";
  document.getElementById("detail_"+id).style.display="none";
  document.getElementById("detail1_"+id).style.display="none";

}
function showccfun(id)
{

document.getElementById("bcc_only_"+id).style.display="";
document.getElementById("cc_only_"+id).style.display="none";
document.getElementById("showcc_"+id).style.display="";
document.getElementById("cc_0_0").style.display="";
document.getElementById("cc_bcc_"+id).style.display="none";


}
function showbccfun(id)
{

document.getElementById("bcc_only_"+id).style.display="none";
document.getElementById("cc_only_"+id).style.display="";
document.getElementById("showbcc_"+id).style.display="";
document.getElementById("bcc_0_0").style.display="";
document.getElementById("cc_bcc_"+id).style.display="none";


}

function showccfun2(id)
{

document.getElementById("cc_only_"+id).style.display="none";
document.getElementById("showcc_"+id).style.display="";


}
function showbccfun2(id)
{

document.getElementById("bcc_only_"+id).style.display="none";
document.getElementById("showbcc_"+id).style.display="";
}

function showccfun_new(id)
{

document.getElementById("bcc_only_"+id).style.display="";
document.getElementById("cc_only_"+id).style.display="none";
document.getElementById("showcc_"+id).style.display="";
document.getElementById("cc_bcc_0").style.display="none";
document.getElementById("cc_0_0").style.display="";

}
function showbccfun_new(id)
{

document.getElementById("bcc_only_"+id).style.display="none";
document.getElementById("cc_only_"+id).style.display="";
document.getElementById("showbcc_"+id).style.display="";
document.getElementById("cc_bcc_0").style.display="none";
document.getElementById("bcc_0_0").style.display="";


}

function showccfun2_new(id)
{

document.getElementById("cc_only_"+id).style.display="none";
document.getElementById("showcc_"+id).style.display="";
document.getElementById("cc_0_0").style.display="";

}
function showbccfun2_new(id)
{

document.getElementById("bcc_only_"+id).style.display="none";
document.getElementById("showbcc_"+id).style.display="";
document.getElementById("bcc_0_0").style.display="";
}
function reduceChar(mail)
{

   var tmp = document.createElement("DIV");
     tmp.innerHTML = mail;
     return tmp.textContent||tmp.innerText;
var textMail1=mail.substring(0,50);
return textMail1;
}
function clickCheckbox(mailId,fldrName,obj,pageNo,type,object,search_object)
{

	var current_view=getCookievalue("current_view");
	
  if(type==1)
  {
      idString=idString+mailId+"&"+pageNo+"&"+fldrName+"&"+obj+"&"+object+"&"+search_object;
      
  }
  else
  {
	  if(current_view=="3pane")
		 {
	  //Three Pane Starts 
	  if(document.getElementById('cb1_'+mailId).checked==true)
		  { document.getElementById('threepaneMail_'+mailId).className="tickedselect1";
		  if(idString==":")
	          idString=idString+mailId+"&"+pageNo+"&"+fldrName+"&"+obj+"&"+object+"&"+search_object;
	          else
	          idString=idString+","+mailId+"&"+pageNo+"&"+fldrName+"&"+obj+"&"+object+"&"+search_object;
	          
		  
		  }//End
		 }
	  
	  
      if(document.getElementById('cb_'+mailId).checked==true)
      {
          document.getElementById('twopaneMail_'+mailId).className="tickedselect";
           

          if(idString==":")
          idString=idString+mailId+"&"+pageNo+"&"+fldrName+"&"+obj+"&"+object+"&"+search_object;
          else
          idString=idString+","+mailId+"&"+pageNo+"&"+fldrName+"&"+obj+"&"+object+"&"+search_object;
          
          
      }
      else
      {		  
  
          if(idz.indexOf(":"+mailId+"&"+pageNo+"&"+fldrName+"&"+obj+"&"+object+"&"+search_object+":")>=0)
          idString=idString.replace(mailId+"&"+pageNo+"&"+fldrName+"&"+obj+"&"+object+"&"+search_object,"");
          else if(idz.indexOf(":"+mailId+"&"+pageNo+"&"+fldrName+"&"+obj+"&"+object+"&"+search_object+",")>=0)
          idString=idString.replace(mailId+"&"+pageNo+"&"+fldrName+"&"+obj+"&"+object+"&"+search_object+",","");
          else if(idz.indexOf(","+mailId+"&"+pageNo+"&"+fldrName+"&"+obj+"&"+object+"&"+search_object+",")>=0)
          idString=idString.replace(mailId+"&"+pageNo+"&"+fldrName+"&"+obj+"&"+object+"&"+search_object+",","");
          else if(idz.indexOf(","+mailId+"&"+pageNo+"&"+fldrName+"&"+obj+"&"+object+"&"+search_object+":")>=0)
          idString=idString.replace(","+mailId+"&"+pageNo+"&"+fldrName+"&"+obj+"&"+object+"&"+search_object,"");
      }
  }
  idz=idString+":";
}
function createDraftzforChat(chatid,type,url)
{
  var currentTime=new Date();
  var crntime=currentTime.getTime();
  $.ajax({

type: "GET",cache: false,
url: "{url:(mail/createdraft)}/"+crntime,

success: function(data) {
              var x=data;
              if(type==1)
              replychat(chatid,x);
              else if(type==2)
              replyAllchat(chatid,x);
              else if(type==3)
              forwardchat(chatid,x);
              
              document.getElementById("draftid_"+chatid).value=x;
                  pair1=chatid+","+type;
          }
      });
}
function createDraftz(mailid,obj,serialNo,name,type,designId,url)
{
   var currentTime=new Date();
      var crntime=currentTime.getTime();
      $.ajax({

  type: "GET",cache: false,
  url: "{url:(mail/createdraft)}/"+crntime,

  success: function(data) {
                  var x=data;
                  if(type==1)
                  reply(mailid,obj,serialNo,name,x,designId);
                  else if(type==2)
                  replyAll(mailid,obj,serialNo,name,x,designId);
                  else if(type==3)
                  forward(mailid,obj,serialNo,name,x,designId);
                  if(mailid==0)
                  document.getElementById("draftid_0_0").value=x;
              }
          });
      
}
function selectallchat()
{
  var current_view=getCookievalue("current_view");
  moreflagchat=0;idString=":";
  var folder=getCookievalue("folder");
  var page=getCookievalue("chat_page");
  var objct1=this[folder];
  var aa1=objct1.getResultPage(folder,page,mailsPerpage);
  while(xx=objct1.fetchRow(aa1))
  {
  
	if(current_view=="2pane")
		{
			if(document.getElementById('twopaneMail_'+xx[0]))
			document.getElementById('twopaneMail_'+xx[0]).className="tickedselect";  
			if(document.getElementById("cbt_"+xx[0]))
			document.getElementById("cbt_"+xx[0]).checked=true;
		}
	else
		{
		    if(document.getElementById('threepaneMail_'+xx[0]))
			document.getElementById('threepaneMail_'+xx[0]).className="tickedselect1";  
			if(document.getElementById("cbt1_"+xx[0]))
			document.getElementById("cbt1_"+xx[0]).checked=true;
		
		}
      if(idString==":")
      idString=idString+xx[0]+"&"+page+"&"+folder+"&"+this[folder];
      else
      idString=idString+","+xx[0]+"&"+page+"&"+folder+"&"+this[folder];
  }
  idz=idString+":";
  document.getElementById("moreListChat2").style.display="none";
}
function deselectallchat()
{
  var current_view=getCookievalue("current_view");
  moreflagchat=0;
  var folder=getCookievalue("folder");
  var page=getCookievalue("chat_page");
  var objct=this[folder];
  var aa=objct.getResultPage(folder,page,mailsPerpage);
  while(xx=objct.fetchRow(aa))
  {//console.log(xx);
      if(folder=="chats")
              {
              var rdflg=xx[5];
          
              }
              else
              {
              var rdflg=xx[7];
          
              }
              if(rdflg==0 )
              {
            	if(current_view=="2pane")
            	{	
                   if(document.getElementById('twopaneMail_'+xx[0]))
                    document.getElementById('twopaneMail_'+xx[0]).className="twopaneMailUnRead";
                }
            	else
            		{
            		   if(document.getElementById('threepaneMail_'+xx[0]))
                       document.getElementById('threepaneMail_'+xx[0]).className="threepaneMailUnRead";
                   
            		}
              }
              else
              {
            	  if(current_view=="2pane")
                   {
            		  if(document.getElementById('twopaneMail_'+xx[0]))
                      document.getElementById('twopaneMail_'+xx[0]).className="twopaneMailRead";
                   }
            	  else
            		  {
            		    if(document.getElementById('threepaneMail_'+xx[0]))
                        document.getElementById('threepaneMail_'+xx[0]).className="threepaneMailRead";
                         
            		  }
              }
              
    if(current_view=="2pane")          
    { if(document.getElementById("cbt_"+xx[0]).checked=="1")
      {
          document.getElementById("cbt_"+xx[0]).checked=false;
      }
    }
    else{
    	if(document.getElementById("cbt1_"+xx[0]).checked=="1")
        {//console.log(document.getElementById("cbtl_"+xx[0]).checked);
            document.getElementById("cbt1_"+xx[0]).checked=false;
        }
        }
  }
  idString=":";
  idz="";
  document.getElementById("moreListChat2").style.display="none";
}

//The below function changes the classes in 3pane according to the classname.
function readchat3pane(type,id)
{
    if(type==0)
         {
          if(document.getElementById('fromaddress_span'+id))
              document.getElementById('fromaddress_span'+id).className="unreadmail";
          if(document.getElementById('mailsubject_span'+id))
              document.getElementById('mailsubject_span'+id).className="unreadmail";
          if(document.getElementById('mailcontent_span'+id))
              document.getElementById('mailcontent_span'+id).className="unreadContent";
              
               if(document.getElementById('threepaneMail_'+id))
              document.getElementById('threepaneMail_'+id).className="threepaneMailUnRead";
          
         }
      if(type==1)
         {
         
            if(document.getElementById('fromaddress_span'+id))
              document.getElementById('fromaddress_span'+id).className="readmail";
            if(document.getElementById('mailsubject_span'+id))
              document.getElementById('mailsubject_span'+id).className="readmail";
             if(document.getElementById('mailcontent_span'+id))
              document.getElementById('mailcontent_span'+id).className="readContent";
              
               if(document.getElementById('threepaneMail_'+id))
              document.getElementById('threepaneMail_'+id).className="threepaneMailRead";
          
         }

}

function readChat(type,url)
{
  if(document.getElementById("moreListChat2").style.display=="")
  document.getElementById("moreListChat2").style.display="none";
  moreflagchat=0;
  var folder=getCookievalue("folder");
  
  var page=getCookievalue("chat_page");
  var fieldz=new Array(1);
  fieldz[0]="readflag";
  var asd=idz.split(",");
  var idstringz="";
  for(var incr=0;incr<(asd.length);incr++)
  {
      var asdf=asd[incr].split("&");
      asdf[0]=asdf[0].replace(":","");
      idstringz=idstringz+asdf[0]+",";
      
          if(type==0)
         {
          if(document.getElementById('fromaddress_span'+asdf[0]))
              document.getElementById('fromaddress_span'+asdf[0]).className="unreadmail";
          if(document.getElementById('mailsubject_span'+asdf[0]))
              document.getElementById('mailsubject_span'+asdf[0]).className="unreadmail";
          if(document.getElementById('mailcontent_span'+asdf[0]))
              document.getElementById('mailcontent_span'+asdf[0]).className="unreadContent";
              
               if(document.getElementById('twopaneMail_'+asdf[0]))
              document.getElementById('twopaneMail_'+asdf[0]).className="twopaneMailUnRead";
          
         }
      if(type==1)
         {
         
            if(document.getElementById('fromaddress_span'+asdf[0]))
              document.getElementById('fromaddress_span'+asdf[0]).className="readmail";
            if(document.getElementById('mailsubject_span'+asdf[0]))
              document.getElementById('mailsubject_span'+asdf[0]).className="readmail";
             if(document.getElementById('mailcontent_span'+asdf[0]))
              document.getElementById('mailcontent_span'+asdf[0]).className="readContent";
              
               if(document.getElementById('twopaneMail_'+asdf[0]))
              document.getElementById('twopaneMail_'+asdf[0]).className="twopaneMailRead";
          
         }
  
  }
  
  var objct=this['chats'];
  
  var aa=objct.getResultPage(folder,page,mailsPerpage);
          while(xx=objct.fetchRow(aa))
          {
              var asd=idz.split(",");
              for(var incr=0;incr<(asd.length);incr++)
              {
                  var asdf=asd[incr].split("&");
                  asdf[0]=asdf[0].replace(":","");
                  if(asdf[0]==xx[0])
                  {
                      var aValues=new Array(1);
                      aValues[0]=type;
                      var idArry=new Array(1);
                      idArry[0]=xx[0];
                      objct.update('chats',fieldz,aValues);
                      objct.where('id=?',idArry);
                      objct.action();
                      
                  }
                  
              }
              
              
          }
          
  
  var currentTime=new Date();
  var crntime=currentTime.getTime();
  $.ajax({

type: "POST",cache: false,
url: "{url:(mail/readChat)}",
data: "type="+type+"&foldernane="+folder+"&mailid="+idstringz,
success: function(data) {
          var x=data;
      }	
  });
}	
function disableReplylinksChat()
{
  document.getElementById("three_chat_3").style.display="none";
  document.getElementById("four_chat_4").style.display="none";
  document.getElementById("two_chat_2").style.display="none";
  document.getElementById("two_2").style.display="none";
  document.getElementById("three_3").style.display="none";
  document.getElementById("four_4").style.display="none";
  
}

function enableReplylinksChat()
{
  document.getElementById("three_chat_3").style.display="";
  document.getElementById("four_chat_4").style.display="";
  document.getElementById("two_chat_2").style.display="";
  
}
function actionfnChat(id)
{
  var details=new Array(3);
  
  if(idz=="")
  {
  var url9=window.location.hash;
  var arr=new Array();
  var arr1=new Array();
  arr=url9.split("#");
  if(arr[1]!="")
  {
  arr1=arr[1].split("/");
  var mail_id=decode64(arr1[1]),mnp=getCookievalue("chat_page");
  idString=":"+mail_id+"&"+mnp+"&chats&"+this["chats"]+":";
  idz=idString;
  }
  }
  details=idz.split(":");
  var detailArray=new Array(50);
  if(details!="")
  detailArray=details[1].split(",");
  
  if((detailArray.length<1 || idz=="" || idz=="::")&&(id==1))
  {
  
      alert("{cfn:getmessage(434)}");
  }
  else if((detailArray.length>1)&&((id==2)||(id==3)||(id==4)))
  {

      alert("{cfn:getmessage(435)}");
  }
  else
  {
      for(i=0;i<(detailArray.length);i++)
      {
          var detailz=new Array(4);
          detailz=detailArray[i].split("&");
          var name=detailz[2]+"_"+detailz[0];
          var obj=this[name];
          if(id==1)
          {
              
              deletemailChat();
          }
          else if(detailArray.length==1)
          {
              if(id==2)
              {
                  createDraftChat(detailz[0],1,detailz[0]);
              }
              else if(id==3)
              {
                  createDraftChat(detailz[0],2,detailz[0]);
              }
              else if(id==4)
              {
                  createDraftChat(detailz[0],3,detailz[0]);
              }
          }
      }
  }
}
function createDraftChat(mailid,type,designid)
{

filevar=0;var ch_var=0;

if(document.getElementById("reply_"+designid))
ch_var=1;


      if(pair1!=mailid+","+type)
      {
      //pair=mailid+","+type;
      createDraftzforChat(mailid,type);
      }
      else if(document.getElementById("reply_"+designid).style.display=="" && ch_var==1)
      {
          document.getElementById("reply_"+designid).style.display="none";
          document.getElementById("replyfooter1_"+designid).style.display="";
      }
      else
      {
      if(ch_var==1)
      {
          document.getElementById("reply_"+designid).style.display="";
          document.getElementById("replyfooter1_"+designid).style.display="none";
          }
      }

  
}
function createDraft(mailid,obj,serialNo,name,type,designId,url)
{
filevar=0;
  if(mailid>0)
  {
      if(pair!=mailid+","+type)
      {
      pair=mailid+","+type;
      createDraftz(mailid,obj,serialNo,name,type,designId,url);
      }
      else if(document.getElementById("reply_"+designId).style.display=="")
      {
          document.getElementById("reply_"+designId).style.display="none";
          document.getElementById("replyfooter1_"+designId).style.display="";
      }
      else
      {
          document.getElementById("reply_"+designId).style.display="";
          document.getElementById("replyfooter1_"+designId).style.display="none";
      }
  }
  else
  {
      createDraftz(mailid,obj,serialNo,name,type,designId,url);
  }
}
function blurfn()
{
 
var s="newcustomFolder"+filevar_m;
document.getElementById(s).style.display="none";
var t1=filevar_m-1;
var olddiv = document.getElementById("custom_divcontainer"+t1);
document.getElementById('div_custm').removeChild(olddiv);	  
}

function blurfn1(id)
{

var s="edit"+id;
var img="editimage"+id;
document.getElementById(img).style.display="";
document.getElementById(s).style.display="none";
document.getElementById(id).style.display="";
}

function editfolderfn(id)
{


if(id>=10)
{
  var FID="customFLI"+id;
  var t='edit'+id;
  var qq='editgroupname'+id;
  var img="editimage"+id;
  document.getElementById(FID).style.backgroundColor="";
document.getElementById(img).style.display="none";

document.getElementById(id).style.display="none";
document.getElementById(t).style.display="";
document.getElementById(qq).focus();
document.getElementById("execute1").value=1;
}
 
}
function setvaluefortb(str,target_box,no){

  if(target_box=="_"+no)
      target_boxs="to_"+no;
  else
      target_boxs=target_box;

      document.getElementById(target_boxs).value=str+",";
      document.getElementById(target_boxs).focus();
      document.getElementById('livesearch'+target_box).style.display="none";




  }
  function setvaluefortb1(str,target_box,no){

      target_boxs="cc_"+no;


      


      document.getElementById(target_boxs).value=str+",";
      document.getElementById(target_boxs).focus();
      document.getElementById('livesearch'+target_boxs).style.display="none";




  }
  function setvaluefortb2(str,target_box,no){


      document.getElementById(target_box).value=str+",";
      document.getElementById(target_box).focus();
      document.getElementById('livesearch'+target_box).style.display="none";

  }
  function getMouseXY(e) 
  {
       document.getElementById('livesearch_{$loopcount}').style.display="none";
       document.getElementById('livesearch_{$loopcount}').style.border="0px";
       document.getElementById('livesearch_{$loopcount}').style.padding="0px";




  }
  function showTheme()
  {
  
  if(document.getElementById("darken").style.display=="none")
  {
  document.getElementById("darken").style.display="block";
  }
  else
  document.getElementById('darken').style.display="none";
  
  
if(document.getElementById('themeSelWrap').style.display=="none")
  document.getElementById('themeSelWrap').style.display="block";
  else
  document.getElementById('themeSelWrap').style.display="none";
  }
  function setthemeheader(themeid)
  {

  {loopstart:themestyle:1000}
  if({$themestyle[0]}==themeid)
  {
  var themestyle="{$themestyle[1]}";
  //document.getElementById("themeheader").style.background=themestyle;
  document.body.style.background=themestyle;
  var old_theme_id=getCookievalue("Current_Theme");
    SetCookie("Current_Theme","{$themestyle[0]}");
  if({$themestyle[0]}!="100")//Default White Theme
  {
	  document.body.className="bodyClass body_light";
     if(old_theme_id=="100")
    	 {
document.body.style.background="";
    	//Fix Transparency for themes.
    	if(mail_open==1)
    		{
    		document.getElementById("second_scroll").style.background="#FFFFFF";
    		document.getElementById("footer_txt_id").style.color="#00000";
    		document.getElementById("footer_txt_id").style.textShadow="none";
    		}
    	else{
    		document.getElementById("second_scroll").style.background="";
    		document.getElementById("footer_txt_id").style.color="none";
    		document.getElementById("footer_txt_id").style.textShadow="none";
    		document.getElementById("footer_txt_id").style.color="none";
    		
    		if(document.getElementById("footer_txt_id").style.display=="")
    		{ 
    			document.getElementById("footer_txt_id1").style.color="none";
    		    document.getElementById("footer_txt_id1").style.textShadow="none";
    		}
    	 }//
    	 }
  }
  else
   {
document.body.style.background="none";
	  document.body.className="bodyClass";
      document.getElementById("footer_txt_id").style.color="none"; 
   }
  
  }
  {loopend:themestyle}
 
   $.ajax({

 type: "GET",cache: false,
 url: "{url:(mail/setTheme)}/"+themeid,
 success: function(data) {
 
 } 

  });
  }
  function insertItem(myid,position,newListItem)
  {
      
  var ul = document.getElementById(myid);
  var li = document.createElement("li");	
  li.innerHTML=newListItem;	
  }
  function contactselection(contactId)
  {
      
      if(document.getElementById('Ccb_'+contactId).checked==true)
      {
          contactidString=contactidString+contactId+',';
          document.getElementById('contactListTable_'+contactId).className="shortContactDivSelected";
      }
      else
      {
      
      document.getElementById('contactListTable_'+contactId).className="shortContactDivUnSelected";
      contactidString=contactidString.replace(contactId+',',"");

      }
      
  }
  function Conatctblurfn()
  {

      var s="tablefiledivcontainer_c_"+c_filevar;
      if(document.getElementById(s))
      {if(document.getElementById(s).style.display=="")
      document.getElementById(s).style.display="none";
      }
  }
  function ConatctblurfnE(id)
  {
      var s="editC"+id;
      var img="editimageC"+id;
      var sp="spC"+id;
      document.getElementById(sp).style.display="";
      document.getElementById(s).style.display="none";

         
  }
  function actionfn(id)
  {
      var t="";
      var details=new Array(3);
      details=idz.split(":");
      var detailArray=new Array(50);
      if(details!="")
      detailArray=details[1].split(",");
      if((details.length<=1))
      {
          alert("{cfn:getmessage(435)}");
      }
      else
      {
          for(i=0;i<(detailArray.length);i++)
          {
              var detailz=new Array(4);
              detailz=detailArray[i].split("&");
              var name=detailz[4];
              var obj=this[name];
              if(id==1)
              {
                  
                  deletemail(1);
              }
              else if(id==5)
              {
                  moveTo('spam');
              }
              else if(id==6)
              {
                moveTo('{cfn:getmessage(659)}');
              }
              else if(id==7)
              {
              deletemail(0);
              }
              
              else if(detailArray.length==1)
              {
                  
                  var replyss=detailz[4];
                  var replyObj=this[replyss];
                  var mail_page=getCookievalue("mail_page");
                  if(isArrayAvailable(detailz[2]))
                  { 
                  
                      var isitem=this[detailz[2]].isItemAvailable(detailz[2],detailz[0]);
                      if(isitem!=0)
                      {
                           var aaaa=this[detailz[2]].getResultItem(detailz[2],detailz[0]);
                           var asas=this[detailz[2]].fetchRow(aaaa);
                           var noConvrsns=parseInt(asas[13])-parseInt(1);
                      }
                  }
                  else
                  {
                      if(isArrayAvailable(detailz[4]))
                      { 
                      
                      var pp=this[detailz[4]].getResultPage(detailz[4],1,50);
                      var bm=0;
                      while(ll=this[detailz[4]].fetchRow(pp))
                      {
                      bm++;
                      }		
                      }
                     var noConvrsns=parseInt(bm)-parseInt(1);
                  }
                  
                  
                  var designId=detailz[0]+"_"+noConvrsns;
                  if(id==2)
                  {
                      createDraft(detailz[0],obj,1,detailz[2],1,designId,t);
                  }
                  else if(id==3)
                  {
                      createDraft(detailz[0],obj,1,detailz[2],2,designId,t);
                  }
                  else if(id==4)
                  {
                      createDraft(detailz[0],obj,1,detailz[2],3,designId,t);
                  }
              }
          }
      }
  }
  function display_imagealltime(name,designId,mailId,foldername,url)
  {
       var disObj=this[name];
      var newCont1=disObj.getResultItem(name,mailId);
      var newCont=disObj.fetchRow(newCont1);
      newCont[6]=newCont[13];
      var fieldz=new Array(1);
      fieldz[0]="cntnt_display";
      var aValues=new Array(1);
      aValues[0]=1;
      disObj.update(name,fieldz,aValues);
      disObj.where('id=?',mailId);
      disObj.action();
      document.getElementById('imagez_'+designId).style.display="none";
      //document.getElementById('contentmaildiv_'+designId).innerHTML=newCont[13];
      
             writeToFrame(newCont[13],designId); 

      
      
     var currentTime=new Date();
      var crntime=currentTime.getTime();
      $.ajax({

  type: "GET",cache: false,
  url: "{url:(mail/adddisplay/)}"+foldername+"/"+mailId+"/"+newCont[1]+"/"+crntime,

  success: function(data) {
          var x=data;
      
       }
  });
  }
      function display_image(name,designId,mailId,foldername,url)
      {
    	  
    	      	  
          var disObj=this[name];
          var newCont1=disObj.getResultItem(name,mailId);
          var newCont=disObj.fetchRow(newCont1);
          newCont[6]=newCont[13];
          
          
          //console.log(disObj);
          //console.log(newCont1);
          //console.log(newCont);
          //console.log("\n HTML Body:"+newCont[6]);
          document.getElementById('imagez_'+designId).style.display="none";
        //  document.getElementById('contentmaildiv_'+designId).innerHTML=newCont[13];
        
               writeToFrame(newCont[13],designId); 

        
                var currentTime=new Date();
              var crntime=currentTime.getTime(); 
  $.ajax({

  type: "GET",cache: false,
  url: "{url:(mail/adddisplaynow/)}"+foldername+"/"+mailId+"/"+crntime,

  success: function(data) {  
          var x=data;
      
          }
  });
  }
      var signature="{$signatureflag}";            //signature
if(signature==0)
signature=2;
else if(signature==1)
	{
	signature=0;
	}

      function setSignature()
      {

      signature=2;
      }
      
    
      
      function makeFrame(src,id) {
             ifrm = document.createElement("IFRAME");
             ifrm.setAttribute("id", "settingsFrame");
             ifrm.setAttribute("src", src);
             ifrm.style.width =100+"%";
             ifrm.setAttribute("scrolling", "no");
             if(id==1)
            	 {
                   ifrm.setAttribute("onload", "javascript:resizeIframesettings(this,250)");

            	 }
             else if(id==7)
        	 {
               ifrm.setAttribute("onload", "javascript:resizeIframesettings(this,50)");

        	 }
             else
            	 {
                     ifrm.setAttribute("onload", "javascript:resizeIframesettings(this,null)");
            	 }
             //ifrm.style.height = 700+"px";
             ifrm.frameBorder = 0;

             document.getElementById('settingsDiv').appendChild(ifrm);
          }
      function showPreloadDivGif()
      {
                  document.getElementById('loadingDiv').style.display="none";
      }
      function search(evt)
      {
          var charCode = (evt.which) ? evt.which : event.keyCode;
          if(charCode==13 || charCode==1)
          {
        	  /**Changed Folder to zero based on new design*/
              var folder=0;//document.getElementById("folders").value;
              var keyword=trim(document.getElementById("search").value);
              if(keyword!="")
              {
            	  select_search();// Call search
            	  
                  //parent.mailframe_new.shortmailframe.search(keyword,folder);
              }
              else
              {
                  //toastr.warning("Please Enter a value ");
            	  notify_display("{cfn:getmessage(307)}","warning");

                  
              }
          }
      }
      function searchFolders(url)
      {
          var currentTime=new Date();
          var crntime=currentTime.getTime();
          $.ajax({

      type: "GET",cache: false,
      url: "{url:(mail/createfolderlist)}/"+crntime,

      success: function(data) {
                  
                      var x=data;
                      document.getElementById("folderdisplay").innerHTML=x;
                  }
              });
      }
      function createDraftsearch(mailid,obj,serialNo,name,type)
      {
          filevar=0;
          if(mailid>0)
          {
              if(pair!=mailid+","+type)
              {
              pair=mailid+","+type;
              createDraftzsearch(mailid,obj,serialNo,name,type);
              }
              else if(document.getElementById("reply_"+mailid).style.display=="")
              {
                  document.getElementById("reply_"+mailid).style.display="none";
              }
              else
              {
                  document.getElementById("reply_"+mailid).style.display="";
              }
          }
          else
          {
              createDraftzsearch(mailid,obj,serialNo,name,type);
          }
      }
      function addCount(mailid)
      {
          drafTcount=drafTcount+1;
          if(drafTcount==20)
          {
              var tO=document.getElementById("to_"+mailid).value;
              var cC=document.getElementById("cc_"+mailid).value;
              var bcC=document.getElementById("bcc_"+mailid).value;
              var subjecT=document.getElementById("subject_"+mailid).value;
              var contenT=document.getElementById("mailBody_"+mailid).value;
              savEmail(tO,cC,bcC,subjecT,contenT);//autosave
              drafTcount=0;
          }
      }
      //Alternate function for javascript trim
      function trim(str)
      {
          if(!str || typeof str != 'string')
              return null;

          return str.replace(/^[\s]+/,'').replace(/[\s]+$/,'').replace(/[\s]{2,}/,' ');
      }
      
      //The Below Function selects the appropriate edit group folder
      function editgroup_select()
      {
          var folder=getCookievalue("currentcontact");
          editgropufnC(folder);         
      }
      
      
      //Javascript fucntion to edit contacts groups.
      function editgropufnC(id)
      {

      var flag=0;

       var folder=getCookievalue("currentcontact");
      
          if(id==-1)
          flag=1;
          if(id==0)
          flag=1;
      if(flag==0)
      {

          var t='editC'+id;
          var qq='editgroupnameC'+id;
          var img="editimageC"+id;
          var sp="spC"+id; 
      document.getElementById(img).style.display="none";
      document.getElementById(sp).style.display="none";
      document.getElementById(t).style.display="";
      document.getElementById(qq).focus();
      //document.getElementById("execute1").value=2;
      }
      else if(flag==1)
      alert("{cfn:getmessage(461)}");
         
      }
      function unselectAllContact()
      {
          var folder=getCookievalue("currentcontact");
          if(folder==0)
              {
                  var objct=this["mycontacts"];
                  size=getCookievalue("mycontacts");
              }
          else if(folder==-1)
              {
                  var objct=this["global"];
                  size=getCookievalue("globalcontacts");
              }
          else
              {
                  var objct=this[folder];
                  size=getCookievalue("cont_"+folder);
              }
          var page=1;
          
          var aa=objct.getResultPage(folder,page,size);
          contactidString="";
          while(xx=objct.fetchRow(aa))
          {
              document.getElementById("Ccb_"+xx[0]).checked=false;
              document.getElementById("contactListTable_"+xx[0]).setAttribute("class", "shortContactDivUnSelected");
              
          }
          document.getElementById("contact_more_div").style.display="none";
      }
      function selectAllContact()
      {
          var folder=getCookievalue("currentcontact");
          if(folder==0)
              {
                  var objct=this["mycontacts"];
                  size=getCookievalue("mycontacts");
              }
          else if(folder==-1)
              {
                  var objct=this["global"];
                  size=getCookievalue("globalcontacts");
              }
          else
              {
                  var objct=this[folder];
                  size=getCookievalue("cont_"+folder);
              }
          var page=1;
          
          var aa=objct.getResultPage(folder,page,size);
          contactidString="";
          while(xx=objct.fetchRow(aa))
          {
              if(document.getElementById("Ccb_"+xx[0]))
              document.getElementById("Ccb_"+xx[0]).checked=true;
              contactidString=contactidString+xx[0]+",";
                  document.getElementById("contactListTable_"+xx[0]).setAttribute("class", "shortContactDivSelected");
          }
           document.getElementById("contact_more_div").style.display="none";
          
      }
      var c_filevar=0;
      var c_deletevar=0;

      function addcustomfolder_contact(flag)
      {

      // flag=1 for new contact is added to new group
          c_filevar=parseInt(c_filevar)+parseInt(1);
          var c_filevartemp=parseInt(c_filevar)-parseInt(1);
          var filestring="<span id=\"tablefiledivcontainer_c_"+c_filevar+"\" style=\"padding-left:0px;\" ><input type=\"text\" name=\"newcustomFolder_c_"+c_filevar+"\" id=\"newcustomFolder_c_"+c_filevar+"\" value=\"New Folder"+"\" onblur=\"Conatctblurfn()\"  onKeyUp=\"addcontactgroupfn(event,this.value,0,"+flag+")\" 	 maxlength=\"12\" size=\"15\" style=\"margin-left:22px;\"></span>"
          
      document.getElementById("C_filedivcontainer"+c_filevartemp).innerHTML=filestring;
          var FID1="C_filedivcontainer"+c_filevar;
                              
                                 var newdiv = document.createElement('div');
             newdiv.setAttribute('id', FID1);
       document.getElementById('div_custm_c').appendChild(newdiv);	
      var s1="newcustomFolder_c_"+c_filevar;
      document.getElementById(s1).focus();
      }
      function checkemail(email)
      {
          var str=email;
          var filter=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i
          if (filter.test(str))
      return true;
          else{
          
              return false;
      }
      }
      function hideconatctmessage()

      {
           document.getElementById("messages").style.display="none";
      }

      function newcontact()
      {

          document.getElementById("newcontact").style.display="";
          document.getElementById("contactList").style.display="none";
          document.getElementById("contactDetails").style.display="none";
          document.getElementById("cfirstname").value="";
          document.getElementById("cfirstname").value="";	
          document.getElementById("clastname").value="";
          document.getElementById("cemail").value="";
          document.getElementById("cdob").value="";
          document.getElementById("ctitle").value="";
          document.getElementById("ccompany").value="";
          document.getElementById("cwebsite").value="";
          document.getElementById("caddress").value="";
          document.getElementById("cphone").value="";
          if(document.getElementById("noContactDiv").style.display=="")
          document.getElementById("noContactDiv").style.display="none";
          
          if(contact_name_change==1 || new_contact_gp_add==1)
          {
          document.getElementById("contact_dropdown").innerHTML="";
          getNewContactFolders();
          
          }
          
      }
      var filevar_c=0;
      var deletevar_c=0;

      function addcustomContact(string)
      {
          
          if(filevar_c>1)
          {

          var s="newfolder"+filevar_c;

          var t=document.getElementById(s).value;

          }
          var rrt2="{cfn:getmessage(455)}";
          if(t!=rrt2||filevar_c==1)
          {

          
              filevar_c=filevar_c+1;
          
          filevartemp=filevar_c-1;
          var filestring="<span id=\"tablefiledivcontainer_c_"+filevar_c+"\" style=\"padding-left:0px;\" ><input type=\"text\" name=\"newcustomFolder_c_"+filevar_c+"\" id=\"newcustomFolder_c_"+filevar_c+"\" value=\"New Folder"+"\" onblur=\"conatct_blurfn()\"  onKeyUp=\"addcontactgroupfn(event,this.value,2)\" 	 maxlength=\"12\" size=\"15\" style=\"margin-left:22px;\"></span>";



          document.getElementById("C_filedivcontainer0"+filevartemp).innerHTML=filestring;

          var s1="newcustomFolder_c_"+filevar_c;

          document.getElementById("attachcount_c").value=filevar_c;



          }
      }
      function getContactName(id)
      {
          for(var y=0;y<(conatct_drop_down.length);y++)
          {
          if(conatct_drop_down[y][0]==id)
          
          return conatct_drop_down[y][1];
          }
      }
      function  showeditImageC(id)
      {
              var img="editimageC"+id;
      document.getElementById(img).style.display="";
      }
      function  hideeditImageC(id)
      {
              var img="editimageC"+id;
      document.getElementById(img).style.display="none";
      }
      
      
          
          function playSound() {

          
           setDefault();
          
          }
          function getFlashMovieObject(flashMovieName)
          {

               if (window.document[flashMovieName]) 
               {
                   return window.document[flashMovieName];
              }
               if (navigator.appName.indexOf("Microsoft Internet")==-1)
              {
                   if (document.embeds && document.embeds[flashMovieName])
                 return document.embeds[flashMovieName]; 
              }
               else 
               {
                    return document.getElementById(flashMovieName);
               }
          }
          function setDefault() // new message for default sound
          {
              var flashMovieName=getFlashMovieObject("swfFile");
              flashMovieName.setMsg('default');
          }
          function setUser() // new message sound for user defined sound
          {
              var flashMovieName=getFlashMovieObject("swfFile");
              flashMovieName.setMsg('user');
          }
          function clickyfn(divid)
          {

           document.getElementById("titlesetup").value="";
              var temp = arr.split(',');
              
              for(var i=0;i<temp.length;i++)
                  { 
                      if(temp[i]!="")
                      {
                          var id123="chattextarea"+temp[i];
                          document.getElementById(id123).className="chatboxtextarea";
                      }
                  }
                  

              var id1="chattextarea"+divid;
              
              document.getElementById(id1).className="chatboxtextareaselected";
              document.getElementById(id1).focus();
              
              
          var chathead="chatboxhead"+divid;
          var s=document.getElementById(chathead).className;

          if(s=="chatboxalert")
          {


                      document.getElementById("close"+divid).className="newchatwindow1";
                      document.getElementById(divid).removeChild("holdingDiv_"+divid);
              document.getElementById("chatboxhead"+divid).className="chatboxhead";
                                  
              var id11="chattextarea"+divid;
              
              document.getElementById(id11).className="chatboxtextareaselected";
              document.getElementById(id11).focus();
              
                  
                   document.getElementById("chatboxmessage_"+divid).scrollTop=document.getElementById("chatboxmessage_"+divid).scrollHeight
                    
                   setUser();
                   
                  }
                  
              var smileyvalue=document.getElementById("smileyvalue_"+divid).value;
          if(smileyvalue==1)
          {
          document.getElementById("smileyvalue_"+divid).value=0;
          document.getElementById("smileys_"+divid).innerHTML="";

          }
              
          }
          function blurfnchat(divid)
          {
              
                          var id123="chattextarea"+divid;
                          document.getElementById(id123).className="chatboxtextarea";
                      
          }
          function ss123(divid)
          {//alert(divid);
          if(!divid)
          divid="";
          if(divid!="")
          {

          var chathead="chatboxhead"+divid;
          var s=document.getElementById(chathead).className;

          if(s=="chatboxalert")
          {

                                  
              document.getElementById("chatboxhead"+divid).className="chatboxhead";
                                  
              var id11="chattextarea"+divid;
              document.getElementById(id11).className="chatboxtextareaselected";
              document.getElementById(id11).focus();
                  
                   document.getElementById("chatboxmessage_"+divid).scrollTop=document.getElementById("chatboxmessage_"+divid).scrollHeight
                   
                   setUser();
                   
                  }
          }

          }
          function getsmiley(divid)
          {

          var smilestring="";
          var smileyvalue=document.getElementById("smileyvalue_"+divid).value;
          if(smileyvalue==0)
          {
                  
                  document.getElementById("smileys_"+divid).innerHTML="<map name=\"Map1\" class=\"smileyOver\"><area shape=\"rect\" coords=\"0,0,20,20\" href=\"javascript:smileyClick("+divid+",1);\" ><area shape=\"rect\" coords=\"20,0,40,20\" href=\"javascript:smileyClick("+divid+",2);\"><area shape=\"rect\" coords=\"40,0,60,20\" href=\"javascript:smileyClick("+divid+",3);\"><area shape=\"rect\" coords=\"60,0,80,20\" href=\"javascript:smileyClick("+divid+",4);\"><area shape=\"rect\" coords=\"80,0,100,20\" href=\"javascript:smileyClick("+divid+",9);\"><area shape=\"rect\" coords=\"100,0,120,20\" href=\"javascript:smileyClick("+divid+",10);\"><area shape=\"rect\" coords=\"120,0,140,20\" href=\"javascript:smileyClick("+divid+",11);\"><area shape=\"rect\" coords=\"140,0,160,20\" href=\"javascript:smileyClick("+divid+",12);\"><area shape=\"rect\" coords=\"0,20,20,40\" href=\"javascript:smileyClick("+divid+",5);\"><area shape=\"rect\" coords=\"20,20,40,40\" href=\"javascript:smileyClick("+divid+",6);\"><area shape=\"rect\" coords=\"40,20,60,40\" href=\"javascript:smileyClick("+divid+",7);\"><area shape=\"rect\" coords=\"60,20,80,40\" href=\"javascript:smileyClick("+divid+",8);\"><area shape=\"rect\" coords=\"80,20,100,40\" href=\"javascript:smileyClick("+divid+",13);\"><area shape=\"rect\" coords=\"100,20,120,40\" href=\"javascript:smileyClick("+divid+",14);\"><area shape=\"rect\" coords=\"120,20,140,40\" href=\"javascript:smileyClick("+divid+",15);\"><area shape=\"rect\" coords=\"140,20,160,40\" href=\"javascript:smileyClick("+divid+",16);\"></map><img src='images/smilyeset.jpg' usemap=\"#Map1\" style=\"margin-bottom:5px;\" border=0>";

              document.getElementById("smileyvalue_"+divid).value=1;//alert(smilestring);	
          }
          else if(smileyvalue==1)
          {
          document.getElementById("smileyvalue_"+divid).value=0;
          document.getElementById("smileys_"+divid).innerHTML=smilestring;

              }
          }
          function closeChatBox(divid,userid) {
              document.getElementById("titlesetup").value="";
              //setUser();
              getname(divid,userid,0);

              }
          function invitechat(divid)
          {
          var id1="chatrequest_"+divid;var id2="chataccept_"+divid;var id3="chatuser"+divid;var id4="livesearch_ch_"+divid;var search_ch="search_ch_"+divid;
          document.getElementById(id1).style.display="none";
          document.getElementById(id2).style.display="";
          var id5="chatcontent"+divid;


          document.getElementById(id3).focus();
          document.getElementById(search_ch).value="";
          document.getElementById(id4).style.display="none";

          }
          function cancelinvitechat(divid)
          {
          var id1="chatrequest_"+divid;var id2="chataccept_"+divid;var id3="chatuser"+divid;//id4="livesearch_"+divid;
          document.getElementById(id1).style.display="";
          document.getElementById(id2).style.display="none";
          document.getElementById(id3).value="";


          var id5="chatcontent"+divid;

          }
          function invitechattextclickfn(divid)
          {
              var id1="chattextarea"+divid;var id2="chatuser"+divid;
              document.getElementById(id1).className="chatboxtextarea";
              document.getElementById(id2).focus();
          }


          function invitetochatfn(divid,userid)
          {

          getname(divid,userid,3);
            
           }
          
          function invitechattextclickfn(divid)
          {
              var id1="chattextarea"+divid;var id2="chatuser"+divid;
              document.getElementById(id1).className="chatboxtextarea";
              document.getElementById(id2).focus();
          }
          function htmlEntities(str) {
              return String(str).replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;');
          }
          function checkChatBoxInputKey2(event,divid,str) {//alert("ll");
              var id1="chattextarea"+divid;
                      var str="";
                      if(document.getElementById(id1))
                      {
                      str=document.getElementById(id1).value;
                      
                      str = str.replace(/^\s+|\s+$/g,"");
                      }
                      var value=0;
                      if(str!="")
                      value=2;
                      else
                      value=0;

              var charCode = (event.which) ? event.which : event.keyCode;
              if(charCode==13)
              value=0;
              //alert(value);
              setTimeout("checkChatBoxInputKey3("+divid+","+value+")",5000);
              }
          function toggleChatBoxGrowth(divid,userid) {

              getname(divid,userid,2);
              ss123(divid); 
                  
              }
          function rearrange(closeid,arrvalue,newarrvalue)
          {
              if(arrvalue!="")
                   {
                    newarr=arrvalue.substring(0,arrvalue.length-1);
                    
                     q=newarr.split(",");
                     var arrcount=q.length;
                    }
                    else
                   var  arrcount=0;
                   
                    if(newarrvalue!=""){
                    newarr1=newarrvalue.substring(0,newarrvalue.length-1);
                    
                     q1=newarr1.split(",");
                     var newarrcount=q1.length;
                    }
                    else
                   var  newarrcount=0;
                    
                   
                  
                   for(var i=0;i<arrcount;i++)
                      {
                          
                      if(q[i]==closeid)
                       {
                          for(var j=0;j<newarrcount;j++)
                          {
                              if(j%2==0)
                              document.getElementById("chatTheme"+q1[j]).className="chatTheme";
                              else
                              document.getElementById("chatTheme"+q1[j]).className="chatTheme2";
                              
                          
                          var olddiv = document.getElementById('close'+q1[j]);
              var sw=1+(j*280);//Changed to 280 for better working,Original 230
                         olddiv.style.right = sw+"px";
                     
                          }
                          
                       }	
                              
                      } 
                              
                 return;  			
          }
          function chatdisplayfn1(divid)
          {
          document.getElementById("chatuser"+divid).value="";
          document.getElementById("chataccept_"+divid).style.display="none";
          document.getElementById("chatrequest_"+divid).style.display="";
          }
          function openchatwindow(divid,userid)
          {

          getname(divid,userid,1);

          }
          function html_entity_decode(str)
           {

          return String(str).replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;');
          }
          function removeHTMLEntities(inputString){
                 var div = document.createElement('div');
                 div.innerHTML = inputString;
                 return div.innerHTML;
              }
          function removediv(divNum)
          {
                  
              var d = document.getElementById("body");
              var olddiv = document.getElementById(divNum);
              d.removeChild(olddiv);
          }
/**The Below function creates a chatbox and appends it to body.
 * 
 */
          function creatediv(no,id, html, width, height, left, top) {

                 var newdiv = document.createElement('div');
                 newdiv.setAttribute('id', id);
              //  newdiv.className="dynamic_chatbox";
                 
              
                 if ((left || top) || (left && top)) {
                     newdiv.style.position = "fixed";
                    newdiv.style.zIndex="999999";
                     if (left) {
                     var sq=1+(no*280);//The value was changed to 289 from 230  for new modifications
                         newdiv.style.right =sq+"px";
                     }
                     
                     if (top) {
                         newdiv.style.bottom ="2px";
                     }
                 }
               newdiv.style.marginRight="15px";
                 if (html) {
                     newdiv.innerHTML = html;
                 } else {
                     newdiv.innerHTML = "nothing";
                 }
                 
                 document.body.appendChild(newdiv);

              }  var viewportwidth;
               var viewportheight;
               function getwindowSize(type)
               {
               // the more standards compliant browsers (mozilla/netscape/opera/IE7) use window.innerWidth and window.innerHeight
               
               if (typeof window.innerWidth != 'undefined')
               {
                    viewportwidth = window.innerWidth,
                    viewportheight = window.innerHeight
               }
               
              // IE6 in standards compliant mode (i.e. with a valid doctype as the first line in the document)


               else if (typeof document.documentElement != 'undefined'
                   && typeof document.documentElement.clientWidth !=
                   'undefined' && document.documentElement.clientWidth != 0)
               {
                     viewportwidth = document.documentElement.clientWidth,
                     viewportheight = document.documentElement.clientHeight
               }
               
               // older versions of IE
               
               else
               {
                     viewportwidth = document.getElementsByTagName('body')[0].clientWidth,
                     viewportheight = document.getElementsByTagName('body')[0].clientHeight
               }
               if(type==1)
                    return viewportwidth;
               else
                   return viewportheight;
               }
               function f_clientWidth() {
                      return f_filterResults (
                          window.innerWidth ? window.innerWidth : 0,
                          document.documentElement ? document.documentElement.clientWidth : 0,
                          document.body ? document.body.clientWidth : 0
                      );
                  }
                  function f_clientHeight() {
                      return f_filterResults (
                          window.innerHeight ? window.innerHeight : 0,
                          document.documentElement ? document.documentElement.clientHeight : 0,
                          document.body ? document.body.clientHeight : 0
                      );
                  }
                  function f_scrollLeft() {
                      return f_filterResults (
                          window.pageXOffset ? window.pageXOffset : 0,
                          document.documentElement ? document.documentElement.scrollLeft : 0,
                          document.body ? document.body.scrollLeft : 0
                      );
                  }
                  function f_scrollTop() {
                      return f_filterResults (
                          window.pageYOffset ? window.pageYOffset : 0,
                          document.documentElement ? document.documentElement.scrollTop : 0,
                          document.body ? document.body.scrollTop : 0
                      );
                  }
                  function f_filterResults(n_win, n_docel, n_body) {
                      var n_result = n_win ? n_win : 0;
                      if (n_docel && (!n_result || (n_result > n_docel)))
                          n_result = n_docel;
                      return n_body && (!n_result || (n_result > n_body)) ? n_body : n_result;
                  }
                  //The Below Fucntion is called on searching 
                  function select_search()
                  {
                  searcHcnt=-1;
                  var folder=0;//This folder value is default for searching all the mail folders.//document.getElementById("folders").value;//alert(folder);
                  var keyword=trim(document.getElementById("search").value);//alert(keyword);
                  var deflt="{cfn:getmessage(323)}";//alert(deflt);
                  if(keyword=="")
                	  {
                	      //toastr.warning("Please Enter a  value");
                	      notify_display("{cfn:getmessage(307)}","warning");
                	      return false;
                	  }
                  if(keyword!=deflt)
                  {
                      var nmz="search"+folder+"_"+keyword;
                      var xx1=0
                      findnumbers(folder,keyword,nmz);//Actual call passing search keyword.
                      
                  }
                  idString=":";idz="";
                  }
                  function clickCheckboxChat(mailId,fldrName,obj,pageNo,type)
                  {
                	  //Get the current display mode.
                	  var current_view=getCookievalue("current_view");
                	  
                      if(type==1)
                      {
                          idString=idString+mailId+"&"+pageNo+"&"+fldrName+"&"+obj;
                      }
                      else
                      {
                    	  
                    	  if(current_view=="2pane")
                    		  {
                    		  
                    		  	if(document.getElementById('cbt_'+mailId).checked==true)
                              	{
                                  	document.getElementById('twopaneMail_'+mailId).className="tickedselect";  
                                  	if(idString==":")
                                 	 idString=idString+mailId+"&"+pageNo+"&"+fldrName+"&"+obj;
                                  	else
                                	  idString=idString+","+mailId+"&"+pageNo+"&"+fldrName+"&"+obj;
                              	}
                              	else
                              	{
                                 	if(idz.indexOf(":"+mailId+"&"+pageNo+"&"+fldrName+"&"+obj+":")>=0)
                                 	idString=idString.replace(mailId+"&"+pageNo+"&"+fldrName+"&"+obj,"");
                                  	else if(idz.indexOf(":"+mailId+"&"+pageNo+"&"+fldrName+"&"+obj+",")>=0)
                                 	idString=idString.replace(mailId+"&"+pageNo+"&"+fldrName+"&"+obj+",","");
                                  	else if(idz.indexOf(","+mailId+"&"+pageNo+"&"+fldrName+"&"+obj+",")>=0)
                                  	idString=idString.replace(mailId+"&"+pageNo+"&"+fldrName+"&"+obj+",","");
                                  	else if(idz.indexOf(","+mailId+"&"+pageNo+"&"+fldrName+"&"+obj+":")>=0)
                                  	idString=idString.replace(","+mailId+"&"+pageNo+"&"+fldrName+"&"+obj,"");
                              	}
                    		  
                    		  
                    		  }
                    	  else
                    		  {
                    			if(document.getElementById('cbt1_'+mailId).checked==true)
                              	{
                                  	document.getElementById('threepaneMail_'+mailId).className="tickedselect1";  
                                  	if(idString==":")
                                 	 idString=idString+mailId+"&"+pageNo+"&"+fldrName+"&"+obj;
                                  	else
                                	  idString=idString+","+mailId+"&"+pageNo+"&"+fldrName+"&"+obj;
                              	}
                              	else
                              	{
                                 	if(idz.indexOf(":"+mailId+"&"+pageNo+"&"+fldrName+"&"+obj+":")>=0)
                                 	idString=idString.replace(mailId+"&"+pageNo+"&"+fldrName+"&"+obj,"");
                                  	else if(idz.indexOf(":"+mailId+"&"+pageNo+"&"+fldrName+"&"+obj+",")>=0)
                                 	idString=idString.replace(mailId+"&"+pageNo+"&"+fldrName+"&"+obj+",","");
                                  	else if(idz.indexOf(","+mailId+"&"+pageNo+"&"+fldrName+"&"+obj+",")>=0)
                                  	idString=idString.replace(mailId+"&"+pageNo+"&"+fldrName+"&"+obj+",","");
                                  	else if(idz.indexOf(","+mailId+"&"+pageNo+"&"+fldrName+"&"+obj+":")>=0)
                                  	idString=idString.replace(","+mailId+"&"+pageNo+"&"+fldrName+"&"+obj,"");
                              	}
                    		  
                    		  }
                    	  
                             }
                      idz=idString+":";
                  }
                  function selectall()
                  {
                      moreflag=0;
                      var folder=getCookievalue("folder");
                      var page=getCookievalue("mail_page");
                      var current_view=getCookievalue("current_view");
                      var objct=this[folder];
                      var aa=objct.getResultPage(folder,page,mailsPerpage);
                      while(xx=objct.fetchRow(aa))
                      {
                      
                            if(current_view=="3pane")
                          {
                            	 if(document.getElementById('threepaneMail_'+xx[0]))
                                     document.getElementById('threepaneMail_'+xx[0]).className="tickedselect1";
                            	 if(document.getElementById("cb1_"+xx[0]))
                                     document.getElementById("cb1_"+xx[0]).checked=true;
                          }
                            else
                            	{
                            	if(document.getElementById('twopaneMail_'+xx[0]))
                                    document.getElementById('twopaneMail_'+xx[0]).className="tickedselect";
                                    
                           	 if(document.getElementById("cb_"+xx[0]))
                                 document.getElementById("cb_"+xx[0]).checked=true;
                            	}
                            	
                     
                      
                     
                          if(idString==":")
                          idString=idString+xx[0]+"&"+page+"&"+folder+"&"+this[folder]+"&"+xx[14]+"&"+xx[15];
                          else
                          idString=idString+","+xx[0]+"&"+page+"&"+folder+"&"+this[folder]+"&"+xx[14]+"&"+xx[15];
                      }
                      idz=idString+":";
                  }

                  function deselectall()
                  {
                      moreflag=0;
                      var folder=getCookievalue("folder");
                      var current_view=getCookievalue("current_view");
                      var page=getCookievalue("mail_page");
                      var objct=this[folder];
                      var aa=objct.getResultPage(folder,page,mailsPerpage);
                      while(xx=objct.fetchRow(aa))
                      {
                                  if(folder=="chats")
                                  {
                                  var rdflg=xx[5];
                              
                                  }
                                  else
                                  {
                                  var rdflg=xx[7];
                              
                                  }
                                  if(rdflg==0 )
                                  {
                                    if(current_view=="3pane")
                                    	{
                                    	  if(document.getElementById('threepaneMail_'+xx[0])){
                                            document.getElementById('threepaneMail_'+xx[0]).className="threepaneMailUnRead";}
                                        }
                                    else
                                    	{
                                    	   if(document.getElementById('twopaneMail_'+xx[0])){
                                            document.getElementById('twopaneMail_'+xx[0]).className="twopaneMailUnRead";}
                                                           
                                    	}
                                    
                                    
                                  }
                                  else
                                  {
                                      if(current_view=="3pane")
                                     {		if(document.getElementById('threepaneMail_'+xx[0]))
                                 		 	{document.getElementById('threepaneMail_'+xx[0]).className="threepaneMailRead";}
                                     }
                                     else
                                    	 {
                                    	   if(document.getElementById('twopaneMail_'+xx[0]))
                                           {document.getElementById('twopaneMail_'+xx[0]).className="twopaneMailRead";}
                                       
                                    	 }
                                  }
                                    
                              if(current_view=="3pane")
                            	  {
                            	   if(document.getElementById("cb1_"+xx[0]).checked=="1")
                                   {
                                       document.getElementById("cb1_"+xx[0]).checked=false;
                                   }
                                 
                            	  }
                              else
                            	  {
                            	   if(document.getElementById("cb_"+xx[0]).checked=="1")
                                   {
                                       document.getElementById("cb_"+xx[0]).checked=false;
                                   }
                                                          	  
                            	  }
                        }
                      idString=":";
                      idz="";
                  }
                  

  function select_adsearch()
  {
   document.getElementById("search_options").style.display="none";
   document.getElementById("searchMain").style.display="";
   searcHcnt=-1;
   
    var from=document.getElementById("se_from").value;
    from=from.replace(/^[\s]+/,'').replace(/[\s]+$/,'').replace(/[\s]{2,}/,' ');
    
    var to=document.getElementById("se_to").value;
    to=to.replace(/^[\s]+/,'').replace(/[\s]+$/,'').replace(/[\s]{2,}/,' ');
    
    var subject=document.getElementById("se_subject").value;
    subject=subject.replace(/^[\s]+/,'').replace(/[\s]+$/,'').replace(/[\s]{2,}/,' ');
    
    var keywords=document.getElementById("se_keywords").value;
    keywords=keywords.replace(/^[\s]+/,'').replace(/[\s]+$/,'').replace(/[\s]{2,}/,' ');
    
    var folderid=document.getElementById("adfolders").value;
    var check=document.getElementById("se_check");
    if(check.checked==true)
    attach=1;
    else
    attach=0;
    if(from=="" && to=="" && subject=="" && keywords=="" && attach==0)
    {
      alert("{cfn:getmessage(668)}");
    }
    else
    {
    ad_keyword=from+"/"+to+"/"+subject+"/"+keywords+"/"+folderid+"/"+attach;
    var string_url="from?"+from+"*to?"+to+"*subject?"+subject+"*keywords?"+keywords+"*folderid?"+folderid+"*attach?"+attach;
    document.getElementById("advance_search").value=string_url;
    findnumbers_ad(ad_keyword,string_url);
    }
  }
  function findnumbers_ad(ad_keyword,string_url)
  {
  
  var result="";
  var string=string_url.split("*");//alert(string[0]);
  
  var string_from=string[0].split("?");//alert(string1);
  if(string_from[1]!="")
  result+="from:"+string_from[1];
  
  var string_to=string[1].split("?");
  if(string_to[1]!="")
  result+=" to:"+string_to[1];
  
  var string_subject=string[2].split("?");
  if(string_subject[1]!="")
  result+=" subject:"+string_subject[1];
  
  var string_keywords=string[3].split("?");
  if(string_keywords[1]!="")
  result+=" keywords:"+string_keywords[1];
  
  var string_folder=string[4].split("?");
  var foldername=fldrnm(string_folder[1]);
  
  var string_attach=string[5].split("?");
  if(string_attach[1]==1)
  result+=" has:"+"attachment";
  
       $.ajax({
           type:"GET", cache: false,
           url:"{url:(mail/findnumbers_ad/)}"+ad_keyword ,
           success: function(data)
               {
        	   
        	 //Disable some Menu Items if not available.
        	   if(document.getElementById("cotnct_lmenuid").style.display=="")
        	   	{
        	   	   document.getElementById("cotnct_lmenuid").style.display="none";
        	   	}
        	   if(document.getElementById("contact_subheader").style.display=="")
        	   {
        	      document.getElementById("contact_subheader").style.display="none";
        	   }

        	   if(document.getElementById("splitbuttonid").style.display=="")
        	   {
        	      document.getElementById("splitbuttonid").style.display="none";
        	   }
        	   
        	   if(document.getElementById("mailPageOuterid").style.right=="201px")
        		{
        		 document.getElementById("mailPageOuterid").style.right="0px";
        		}
        	   
        	   //End
        	   
        	   //alert(data);
               var x=data;
               searcHcnt=x;
               SetCookie(string_url,searcHcnt,1);
               mainWindow(string_url,1,mailsPerpage,searcHcnt,2);
          var temp="{cfn:getmessage(163)}";
          temp=temp.replace("{search}",result);
          temp=temp.replace("{folder}",foldername);
          document.getElementById("heading").innerHTML=temp;
          window.location.hash=string_url;
               
               
               }
   
          });
   
  }
  function emptyspam()
{

var crnt_cookie=getCookievalue("spam");

if(crnt_cookie>0)
{
var answer = confirm("{cfn:getmessage(644)}")
         if (answer)
          {
          
Unread[3][1]=0;
//Unread[3][2]=1;

var aryAvail=isArrayAvailable("spam");
          if(aryAvail==1)
          {
               var opj=this['spam'].getResultPage("spam",1,crnt_cookie);
              while(xx=this['spam'].fetchRow(opj))
              {
               var idz1=new Array(1);
              idz1[0]=xx[0];
              if(this['spam'].isItemAvailable("spam",xx[0]))
              {
              this['spam'].deleteEntry("trash");
              this['spam'].where('id=?',idz1);
              this['spam'].action();
              }
          
          }
          }

SetCookie("spam",0,1);
$.ajax({

type: "GET",cache: false,
url: "{url:(mail/emptyspam)}",

success: function(data) {
setUnreadcount();
mainWindow('spam',1,mailsPerpage,0,2);

      }
});

}
}
else
alert("{cfn:getmessage(445)}");
}
function emptytrash()
{
var crnt_cookie=getCookievalue("trash");

if(crnt_cookie>0)
{
var answer = confirm("{cfn:getmessage(645)}")
         if (answer)
          {
Unread[4][1]=0;
var aryAvail=isArrayAvailable("trash");
          if(aryAvail==1)
          {
               var opj=this['trash'].getResultPage("trash",1,crnt_cookie);
              while(xx=this['trash'].fetchRow(opj))
              {
               var idz1=new Array(1);
              idz1[0]=xx[0];
              if(this['trash'].isItemAvailable("trash",xx[0]))
              {
              this['trash'].deleteEntry("trash");
              this['trash'].where('id=?',idz1);
              this['trash'].action();
              }
          
          }
          }

SetCookie("trash",0,1);
$.ajax({

type: "GET",cache: false,
url: "{url:(mail/emptytrash)}",

success: function(data) {
mainWindow('trash',1,mailsPerpage,0,2);

      }
});

}
}
else
alert("{cfn:getmessage(445)}");
}
function todolist(value) {
if(value!="")
var URL=value;
else
var URL="{url:(todolist/todolist)}";
day = new Date();
id = day.getTime();
eval("page" + id + " = window.open(URL, '" + id + "', 'toolbar=0,scrollbars=1,location=0,statusbar=0,menubar=0,resizable=1,width=320,height=400px,left =1095,top =400');");

}

function splitview() {
	
	if (document.getElementById("splitdiv1").style.display=="none")
		{
		document.getElementById("split_tootltip").title="{cfn:getmessage(78)}";
		reinstall_tooltip();
		disableReplylinks();//Additinal COide if reply links are visible.
		    SetCookie("current_view","3pane",1);
		    var c_fldr=getCookievalue("folder");
		    if(c_fldr==="chats")
		    mainWindowChat('chats',1,"{$sizeMail}","{$totalchat}",2);
		                     //getCurrentSection();
		                       if(document.getElementById("msg_display").innerHTML)
{
document.getElementById("msg_display").innerHTML="<div class=\"warning_message_Txt\">{cfn:getmessage(776)}</div><div class='warning_message_Txt_sec'>{cfn:getmessage(777)}</div><div id='footer_txt_id1' class='footer_txt_new'>{$footer}{if($memoryusage_publicview_area==1)}<br><br>{$memorymsg}{endif}</div></div>";
}
		    document.getElementById("splitdiv1").style.display="";
		    document.getElementById("mailContent").style.display="none";
		    document.getElementById("msg_display").style.display="";
		    document.getElementById("mailContent11").style.display="";
		    
		    document.getElementById("footer_table").style.display="none";
		    
		    $.ajax({

		    	 type: "GET",cache: false,
		    	 url: "{url:(mail/setPane)}/"+"3pane",
		    	 success: function(data) {
		    	 
		    	 } 

		    	  });
		    
		    
		    
		    
		}
	else
		{
		document.getElementById("split_tootltip").title="{cfn:getmessage(77)}";
		reinstall_tooltip();
	        SetCookie("current_view","2pane",1);
            document.getElementById("splitdiv1").style.display="none";
            var c_fldr=getCookievalue("folder");
		    if(c_fldr==="chats")
		    mainWindowChat('chats',1,"{$sizeMail}","{$totalchat}",2);
		    
		    //Additional Code for fixing Transparency
		    //Themes Based Modifications for Transparency Effect
		var c_theme=getCookievalue("Current_Theme");
	if(c_theme!="100")
		{
	document.getElementById("second_scroll").style.background="";
	document.getElementById("footer_txt_id").style.color="#FFFFFF";

	//End
		}	 
	disableReplylinks();//Additinal COide if reply links are visible.
            //getCurrentSection();
            document.getElementById("mailContent").style.display="";
		    document.getElementById("mailContent11").style.display="none";
		    document.getElementById("msg_display").style.display="none";
		    document.getElementById('rightads_td').style.display="none";
		    document.getElementById('mailPageOuterid').style.right="0px"; 
		    document.getElementById("footer_table").style.display="table";

		    
		    $.ajax({

		    	 type: "GET",cache: false,
		    	 url: "{url:(mail/setPane)}/"+"2pane",
		    	 success: function(data) {
		    	 
		    	 } 

		    	  });
		    
		 }
	
	
}

function remove_attach_divs()
{
	var x_1 = document.getElementsByClassName("attachBox");//console.log(x_1);
	var i_1;alert(x_1[1]);
	for (i_1 = 0; i_1 < x_1.length; i_1++) {
		
		filevar_count=0;//filevar_count=filevar_count-1;
	}	
}


</script>

<script src="js/jquery.nicescroll.min.js"></script>
<script src="js/jquery-asTooltip.js"></script> <!-- tool tip -->
<script>
                        $(document).ready(function() {

								  $('.vertmenu,#my_iframe').niceScroll(); // nice scroll  
                                      

                          $.asTooltip.defaults.skin = 'dream';                              
                        });
                        
                        $(document).ready(function() {
                          $("body").asTooltip({
                            selector: '.position_tooltip'
                          });
                        
                          var windheight = $(window).height();
                          
                          $('.secondscroll').css({"height" : windheight-151});
                          
                          $(window).resize(function(){
                              var windheight = $(window).height();
                          
                          $('.secondscroll').css({"height" : windheight-151});
                              
                              });

                          CKEDITOR.on("instanceReady", function(ev) {
                        	  var editor = ev.editor;
                        	  editor.on("focus", function(ev) {
                        	    display();//Hides Livesearch on ckediotr focus
                        	  });
                        	});
                          
                          
                          
						}); // document ready
$(window).on('beforeunload', function(){
    // your logic here
	var prev_url_temp=getCookievalue("backurl");
    if(prev_url_temp!="")
    SetCookie("prev_url_temp",prev_url_temp,1);
});  	                
function reinstall_tooltip()
   {
	$(".postion_tooltip").asTooltip('update');	

	//$(".position_tooltip").asTooltip('destroy');

	// $(".position_tooltip").asTooltip({
         //selector: '.position_tooltip'
      // });					
   }

//Callled when bod is scrolled.
$('.secondscroll').scroll(function(e) {
	
	if ($(".cke_combo")[0]){

    var pp = $('.cke_combo').offset().top;
    
    $('.cke_panel').css({"top" : pp + 30});
	}
	else
		{
		  return;
		}
	
});
/**This Function displays different Notifications
 * 
 */
function  notify_display(nt_msg,mtype)
{
	document.getElementById("load_msg").style.display="none";
	
	document.getElementById("loadingDiv").style.display="";
	
	var notify_div_selector=document.getElementById("notify_msg_div");
	
	if(mtype=="error")
		{
		notify_div_selector.innerHTML="<i class='fa fa-times-circle'></i> "+nt_msg;
		}
	else if(mtype=="success")
	{
		notify_div_selector.innerHTML="<i class='fa fa-info-circle'></i> "+nt_msg;
		
	}
	else if(mtype=="warning")
	{
		notify_div_selector.innerHTML="<i class='fa fa-exclamation-triangle'></i> "+nt_msg;
		
	}
	else if(mtype=="info")
		{
		notify_div_selector.innerHTML="<i class='fa fa-info-circle'></i> "+nt_msg;
		
		}
	else
		{
		  return false;
		}
	document.getElementById("notify_msg_div").style.display="";
	setTimeout(function(){ document.getElementById("notify_msg_div").style.display="none";document.getElementById("loadingDiv").style.display="none"; }, 5000);

		
}

                    </script>

</html>